System.register(["./app.js"],(function(e,t){"use strict";var n,r,a,o,c,l,i,u,s,d,f,m,v,p,h,g,E,y,b,C,N,k,x,S,D,w,R,A,I,O,M,L,P,q,j,T,B,F,z,U,G,W,Y,Z,H,K,X,J,V,_,Q,$,ee,te,ne,re,ae,oe,ce,le,ie,ue,se,de,fe,me,ve,pe,he,ge,Ee,ye,be,Ce,Ne,ke,xe,Se,De,we,Re,Ae,Ie,Oe;return{setters:[function(e){n=e.r,r=e._,a=e.l,o=e.a,c=e.b,l=e.c,i=e.u,u=e.s,s=e.d,d=e.e,f=e.f,m=e.i,v=e.g,p=e.S,h=e.h,g=e.j,E=e.k,y=e.m,b=e.n,C=e.o,N=e.p,k=e.q,x=e.t,S=e.v,D=e.w,w=e.x,R=e.y,A=e.z,I=e.A,O=e.B,M=e.C,L=e.D,P=e.E,q=e.F,j=e.G,T=e.H,B=e.I,F=e.J,z=e.K,U=e.L,G=e.M,W=e.N,Y=e.O,Z=e.P,H=e.Q,K=e.R,X=e.T,J=e.U,V=e.V,_=e.W,Q=e.X,$=e.Y,ee=e.Z,te=e.$,ne=e.a0,re=e.a1,ae=e.a2,oe=e.a3,ce=e.a4,le=e.a5,ie=e.a6,ue=e.a7,se=e.a8,de=e.a9,fe=e.aa,me=e.ab,ve=e.ac,pe=e.ad,he=e.ae,ge=e.af,Ee=e.ag,ye=e.ah,be=e.ai,Ce=e.aj,Ne=e.ak,ke=e.al,xe=e.am,Se=e.an,De=e.ao,we=e.ap,Re=e.aq,Ae=e.ar,Ie=e.as,Oe=e.at}],execute:function(){function Me(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Le=new Map;function Pe(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function qe(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var je,Te,Be,Fe="loading",ze="loaded",Ue="failed",Ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.lazy,c=void 0!==o&&o,l=Le.get(e),i=l?ze:Fe,u=n.useState(i),s=r(u,2),d=s[0],f=s[1],m=n.useRef(!1);n.useEffect((function(){return m.current=!0,function(){m.current=!1}}),[]);var v=n.useCallback(qe((function(){if(d!==ze)return Pe((function(){return Me(a(e),(function(t){m.current?(Le.set(e,t),f(ze)):console.log("image unmounted")}))}),(function(){m.current&&(Le.delete(e),f(Ue))}))})),[f,e]);return n.useEffect((function(){c||v()}),[c]),[d,v]},We=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.layout,o=void 0!==a&&a,c=n.useRef(!0);(o?n.useLayoutEffect:n.useEffect)((function(){if(!c.current)return e();c.current=!1}),t)},Ye=function(e,t){var n=Ze(e,t);return Boolean(n)},Ze=function(e,t){var r=n.useRef(!1);n.useEffect((function(){!1===r.current&&(r.current=!0)}));var a=n.useRef(t);return n.useEffect((function(){a.current=t}),t),r.current&&e.apply(void 0,o(a.current))?{from:a.current,to:t}:null},He=function(e){var t=n.useRef(e);return n.useEffect((function(){t.current=e}),[e]),t.current},Ke=["loadWhenIntersecting","usePlaceholderWhileLoading","animateLoaded","intersectionRoot","intersectionRootMargin","intersectionThreshold","FallbackWhileNotIntersecting","FallbackWhileLoading","useImageStatusHook","src"],Xe=function(e){var t=e.loadWhenIntersecting,a=void 0===t||t,o=e.usePlaceholderWhileLoading,u=void 0===o||o,s=e.animateLoaded,d=void 0===s||s,f=e.intersectionRoot,m=e.intersectionRootMargin,v=e.intersectionThreshold,p=e.FallbackWhileNotIntersecting,h=void 0===p?_e:p,g=e.FallbackWhileLoading,E=void 0===g?Ve:g,y=e.useImageStatusHook,b=void 0===y?Ge:y,C=e.src,N=l(e,Ke),k=b(C,{lazy:a}),x=r(k,2),S=x[0],D=x[1],w=He(S),R=i(C),A=r(R,2),I=A[0],O=A[1];n.useEffect((function(){"loading"!==w&&"loading"===S&&I(),"loaded"!==w&&"loaded"===S&&O()}),[w,S]);var M=function(e){var t=e.root,a=e.rootMargin,o=e.threshold,c=void 0===o?0:o,l=n.useState(!1),i=r(l,2),u=i[0],s=i[1],d=n.useRef();return n.useEffect((function(){var e=d.current;if(!e)return null;if(u)return null;var n=new window.IntersectionObserver((function(t){r(t,1)[0].isIntersecting?(n.unobserve(e),s(!0)):s(!1)}),{root:t,rootMargin:a,threshold:c});return n.observe(e),function(){n.disconnect()}}),[u]),[d,u]}({root:f,rootMargin:m,threshold:v}),L=r(M,2),P=L[0],q=L[1],j=He(q);n.useEffect((function(){a&&!j&&q&&D()}),[a,j,q]);var T=Je(),B=r(T,2),F=B[0],z=B[1];return n.useLayoutEffect((function(){d&&"loaded"!==w&&"loaded"===S&&z()}),[d,w,S]),a&&"loaded"!==S&&!q?n.createElement(h,{ref:P}):u&&"loaded"!==S?n.createElement(E,null):n.createElement("img",c({src:C,ref:F},N))},Je=function(){var e=n.useRef(),t=n.useCallback((function(){var t=e.current,n=window.getComputedStyle(t).getPropertyValue("opacity");t.animate([{opacity:0},{opacity:n}],{duration:300})}));return[e,t]},Ve=n.forwardRef((function(e,t){return n.createElement("img",c({src:Qe,ref:t},e))})),_e=n.forwardRef((function(e,t){return n.createElement("img",c({src:Qe,ref:t},e))})),Qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",$e=function(){return n.createElement(et,null)},et=function(){var e=tt();return n.createElement("div",{className:"new-game"},n.createElement(Xe,{src:u}),n.createElement("button",{onClick:e},"Nouvelle partie"))},tt=s((function(e){return d(d({},e),{},{gameCreated:!0})})),nt=function(e,t){if(e&&"symbol"===e.type)return e.value;if(e&&"dice"===e.type){var n=t[e.value];return f(n)}return null},rt=function(e){var t=e.card,n=e.symbolsInChest,r=e.scoreMarked,a=e.markScoreAllowed;return m(t)?r||a?at(n,{goal:t.numberOfSwords,gamble:t.gambleAmount}):-t.gambleAmount:v(t)?ct(n.map((function(e){return e===p?h:e}))):g(t)?2*ct(n):E(t)||y(t)?ct(n,9):ct(n)},at=function(e,t){var n=t.goal,r=t.gamble;return ot(e,N)>=n?ct(e)+r:-r},ot=function(e,t){return e.filter((function(e){return e===t})).length},ct=function(e,t){var n=lt(e,t);return n.score+n.perfectBonus},lt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=0,r=0,a=it(e);return Object.values(a).forEach((function(e){3===e&&(n+=100),4===e&&(n+=200),5===e&&(n+=500),6===e&&(n+=1e3),7===e&&(n+=2e3),8===e&&(n+=4e3),e>2&&(r+=e)})),e.forEach((function(e){e===b&&(n+=100,a[b]<3&&(r+=1)),e===C&&(n+=100,a[C]<3&&(r+=1))})),{score:n,perfectBonus:r===t?500:0}},it=function(e){var t={};return e.forEach((function(e){t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},ut=n.useMemo,st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentPlayerId,n=void 0===t?k():t,r=e.players,a=void 0===r?x():r;return a.find((function(e){return e.id===n}))},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?R():t;return 0===n},ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?R():t;return n>0},mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,n=void 0===t?A():t,r=e.chestSlots,a=void 0===r?I():r;return Object.keys(a).reduce((function(e,t){var r=nt(a[t],n);return r?[].concat(o(e),[r]):e}),[])},vt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?bt():t;return 3-n},pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dicesToCurse,n=void 0===t?ht():t;return n.length>0},ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,n=void 0===t?A():t,r=e.diceRolledIds,a=void 0===r?O():r,o=e.witchUncursedDiceId,c=void 0===o?M():o,l=e.remainingSpotInCursedArea,i=void 0===l?vt():l,u=a.map((function(e){return n[e]})).filter((function(e){return!!L(e)&&e.id!==c})).slice(0,i);return u},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?q():t,r=e.hasNeverRolled,a=void 0===r?dt():r,o=e.scoreMarked,c=void 0===o?F():o,l=e.threeSkullsOrMoreInCursedArea,i=void 0===l?yt():l,u=e.hasDicesToCurse,s=void 0===u?pt():u;return!(!n||c||!a&&(i?!z(S(n)):s))},Et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dicesToCurse,n=void 0===t?ht():t,r=e.skullCountInCursedArea,a=void 0===r?bt():r,o=n.length,c=o+a;return c},yt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?bt():t;return n>2},bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.diceCursedIds,n=void 0===t?P():t,r=e.symbolsFromCard,a=void 0===r?Ct():r;return n.length+a.filter((function(e){return D(e)})).length},Ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?q():t;if(!n)return[];var r=S(n);return E(r)?[C]:y(r)?[b]:j(r)?[T]:B(r)?[T,T]:[]},Nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scoreMarked,n=void 0===t?F():t,r=e.currentCardId,a=void 0===r?q():r,o=e.threeSkullsOrMoreInCursedArea,c=void 0===o?yt():o,l=e.hasDicesToCurse,i=void 0===l?pt():l;return!(n||(c?!z(S(a)):i||!a))},kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?q():t,r=e.symbolsInChest,a=void 0===r?mt():r,o=e.scoreMarked,c=void 0===o?F():o,l=e.markScoreAllowed,i=void 0===l?Nt():l;return ut((function(){return rt({card:S(n),symbolsInChest:a,scoreMarked:c,markScoreAllowed:i})}),[n,a,c,i])},xt=function(){var e=q(),t=S(e),n=mt(),r=ot(n,N),a=St();return!!m(t)&&r<a},St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?q():t,r=S(n);return m(r)?r.numberOfSwords:null},Dt=s((function(e,t){return d(d({},e),{},{currentPlayerId:t.id,currentCardId:null,currentCardActivated:!1,roundStarted:!0},Ot)})),wt=s((function(e){return d(d({},e),{},{currentCardId:null,currentCardActivated:!1,roundStarted:!1})})),Rt=s((function(e){return d(d({},e),{},{currentCardActivated:!0})})),At=s((function(e){return d(d({},e),{},{isOnSkullIsland:!0})})),It=s((function(e,t){var n=e.players,r=e.currentPlayerId,a=n.find((function(e){return e.id===r})),c=a.score+t;return a.score=c<0?0:c,d(d({},e),{},{players:o(n),scoreMarked:!0})})),Ot={witchUncursedDiceId:null,witchCardEffectUsed:!1,rollCount:0,diceRolledIds:[],diceCursedIds:[],chestSlots:{1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null},scoreMarked:!1,isOnSkullIsland:!1},Mt=s((function(e,t,n,r){var a=n.x,o=n.y,c=e.dices;return t.rolledAreaPosition={x:a,y:o},t.rolledAreaZIndex=r,d(d({},e),{},{dices:d({},c)})})),Lt=s((function(e,t,n){var r=e.chestSlots,a=Object.keys(r).find((function(e){var n=r[e];return n&&"dice"===n.type&&n.value===t.id}));return d(d({},e),{},{chestSlots:d(d(d({},r),a?U({},a,null):{}),{},U({},n,{type:"dice",value:t.id}))})})),Pt=s((function(e,t){var n=e.diceRolledIds,r=e.diceCursedIds;return d(d({},e),{},{diceRolledIds:n.filter((function(e){return e!==t.id})),diceCursedIds:[].concat(o(r),[t.id])})})),qt=s((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.diceRolledIds,a=e.diceCursedIds;return d(d(d({},e),n?{}:{witchUncursedDiceId:t.id,witchCardEffectUsed:!0}),{},{diceRolledIds:[].concat(o(r),[t.id]),diceCursedIds:a.filter((function(e){return e!==t.id}))})})),jt=s((function(e,t){var n=e.diceRolledIds,r=e.chestSlots,a=Object.keys(r).find((function(e){var n=r[e];return n&&"dice"===n.type&&n.value===t.id}));return d(d({},e),{},{diceRolledIds:[].concat(o(n),[t.id]),chestSlots:d(d({},r),{},U({},a,null))})})),Tt=s((function(e,t,n){var r=e.diceRolledIds,a=e.chestSlots;return d(d({},e),{},{diceRolledIds:r.filter((function(e){return e!==t.id})),chestSlots:d(d({},a),{},U({},n,{type:"dice",value:t.id}))})})),Bt=n.useEffect,Ft=function(){return zt(),null},zt=function(){Ut(),Gt(),Wt()},Ut=function(){var e=G(),t=ht(),n=Pt();Bt((function(){if(0===t.length)return function(){};if(e)return t.forEach((function(e){n(e)})),function(){};var r=setTimeout((function(){t.forEach((function(e){n(e)}))}),1e3);return function(){clearTimeout(r)}}),[t])},Gt=function(){var e=S(q()),t=F(),n=It(),r=yt(),a=Ye((function(e){return!e&&r}),[r]),o=kt(),c=m(e);Bt((function(){c&&!t&&a&&n(o)}),[c,t,a,o])},Wt=function(){var e=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rollCount;return 1===(void 0===e?R():e)}(),t=S(q()),n=W(),r=bt(),a=At();Bt((function(){e&&(n||m(t)||r<4||a())}),[e,n,t,r])},Yt=s((function(e){var t=e.cardIds,n=e.cardUsedIds,r=t[0];return d(d({},e),{},{cardIds:t.slice(1),cardUsedIds:[].concat(o(n),[r]),currentCardId:r})})),Zt=s((function(e){var t=e.chestSlots;return d(d({},e),{},{chestSlots:d(d({},t),{},{1:{type:"symbol",value:C}})})})),Ht=s((function(e){var t=e.chestSlots;return d(d({},e),{},{chestSlots:d(d({},t),{},{1:{type:"symbol",value:b}})})})),Kt=s((function(e){var t=e.cardIds,n=e.cardUsedIds;return d(d({},e),{},{cardIds:Y([].concat(o(t),o(n))),cardUsedIds:[]})})),Xt=function(){return Jt(),Vt(),null},Jt=function(){var e=Zt(),t=q(),r=Z(),a=Ye((function(e){return!e===r}),[r]),o=t&&E(S(t));n.useEffect((function(){o&&e()}),[]),n.useEffect((function(){a&&o&&e()}),[a,o])},Vt=function(){var e=Ht(),t=q(),r=Z(),a=Ye((function(e){return!e===r}),[r]),o=t&&y(S(t));n.useEffect((function(){o&&e()}),[]),n.useEffect((function(){a&&o&&e()}),[a,o])},_t=function(){var e=n.useState((function(){return e=[],{listen:function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).once;if(void 0!==n&&n){var r=t;t=function(){c(),r.apply(void 0,arguments)}}e=[].concat(o(e),[t]);var a=!1,c=function(){if(!a){a=!0;for(var n=[],r=e.length,o=!0;r--;){var c=e[r];o&&c===t?o=!1:n.push(c)}e=n}};return c},emit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.forEach((function(e){e.apply(void 0,n)}))}};var e})),t=r(e,1)[0];return[t.listen,t.emit]},Qt=function(e){var t=n.useState(),a=r(t,2),o=a[0],c=a[1];return n.useEffect((function(){return e(c)}),[]),o},$t=function(e){var t=e.rolledAreaRef,r=e.offscreenRef,a=e.diceOverRolledAreaListener,o=Qt(a);return n.createElement("div",{className:"dice-ongoing"},n.createElement("div",{className:"map"}),n.createElement("div",{className:"area",ref:t,style:d({},o?{outline:"2px dotted"}:{})}),n.createElement("div",{className:"offscreen-area",ref:r}))},en=function(e){var t=e.duration,n=void 0===t?300:t,r=e.timingFunction,a=void 0===r?function(e){return e}:r,o=e.onProgress,c=void 0===o?function(){}:o,l=e.onCancel,i=void 0===l?function(){}:l,u=e.onComplete,s=void 0===u?function(){}:u;if(isNaN(n))return console.warn("duration must be a number, received ".concat(n)),function(){};n=parseInt(n,10);var d,f=performance.now(),m=!1,v=0,p=0;return function e(){d=null;var t=performance.now();v=Math.min((t-f)/n,1),p=a(v),c({done:m=1===v,rawProgress:v,progress:p}),m?s():d=window.requestAnimationFrame(e)}(),function(){d&&(window.cancelAnimationFrame(d),d=null),m||(m=!0,i({rawProgress:v,progress:p}))}},tn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.duration,o=void 0===a?300:a,c=t.timingFunction,l=t.condition,i=n.useState(null),u=r(i,2),s=u[0],d=u[1];return nn(e,(function(e,t){return d({value:e}),en({duration:o,timingFunction:c,onProgress:function(n){var r=n.progress,a=Math.round(e+(t-e)*r);d({value:a})},onComplete:function(){d(null)}})}),{condition:l}),s},nn=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.condition,c=void 0===o?function(){return!0}:o,l=n.useState(null),i=r(l,2),u=i[0],s=i[1],d=He(e);n.useEffect((function(){d!==e&&c(e,d)&&s({from:d,to:e})}),[d,e]),n.useEffect((function(){return u?t(u.from,u.to):function(){}}),[u])},rn=function(e){var t=e.value,n=e.duration,r=e.condition,a=tn(t,{duration:n,condition:r});return a?a.value:t},an=["useCount"],on=["useCount"],cn=function(e){var t=e.href,a=e.onLoad,o=void 0===a?function(){}:a,c=i(t),l=r(c,2),u=l[0],s=l[1];return n.useEffect((function(){return u(),ln(t,{onload:function(){s(),o()}})}),[t]),null},ln=(je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.onload,r=void 0===n?function(){}:n,a=document.createElement("link");a.rel="stylesheet",a.type="text/css";var o=H(a,r);return a.href=e,document.head.appendChild(a),function(){o(),document.head.removeChild(a)}},Te=new Map,Be=function(e){if(Te.has(e)){var t=Te.get(e),n=t.useCount,r=l(t,an);n>1?Te.set(e,d({useCount:n-1},r)):(Te.delete(e),r.linkCleanup())}},function(e){if(Te.has(e)){var t=Te.get(e),n=t.useCount,r=l(t,on);return Te.set(e,d({useCount:n+1},r)),Be}for(var a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];var i=je.apply(void 0,[e].concat(o));return Te.set(e,{useCount:1,linkCleanup:i}),Be}),un=function(e,t){for(var n=dn(e,e),r=n.next(),a=r.done,o=r.value;!1===a;){if(t(o))return o;var c=n.next();a=c.done,o=c.value}return null},sn=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r){var a=t.firstChild;if(a)return a}var o=t.nextSibling;if(o)return o;var c=t.parentNode;return c&&c!==n?e(c,n,!0):null},dn=function(e,t){var n=e;return{next:function(){var e=sn(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},fn=function(e){for(var t=e.lastChild;t;){var n=t.lastChild;if(!n)break;t=n}return t},mn=function(e,t){var n=e;return{next:function(){var e=function(e,t){var n=e.previousSibling;if(n)return fn(n)||n;if(e!==t){var r=e.parentNode;if(r&&r!==t)return r}return null}(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},vn=function(e){return un(e,K)||(K(e)?e:null)},pn=function(e){if(3===e.nodeType)return console.warn("cannot trap focus inside a text node"),function(){};if(En.find((function(t){return t.element===e})))return console.warn("focus already trapped inside this element"),function(){};var t=function(){return un(e,hn)},n=function(){return function(e,t){var n=fn(e);if(n)for(var r=mn(n,e),a=r.next(),o=a.done,c=a.value;!1===o;){if(t(c))return c;var l=r.next();o=l.done,c=l.value}return null}(e,hn)},r=function(){return function(e){for(var t=e.root,n=e.predicate,r=mn(e.from,void 0===t?null:t),a=r.next(),o=a.done,c=a.value;!1===o;){if(n(c))return c;var l=r.next();o=l.done,c=l.value}return null}({from:document.activeElement,root:e,predicate:hn})||n()},a=function(){return function(e){for(var t=e.root,n=e.predicate,r=e.skipChildren,a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,a=!1;return{next:function(){var e=sn(r,t,n&&!1===a);return a=!0,r=e,{done:!1===Boolean(e),value:e}}}}(e.from,void 0===t?null:t,void 0!==r&&r),o=a.next(),c=o.done,l=o.value;!1===c;){if(n(l))return l;var i=a.next();c=i.done,l=i.value}return null}({from:document.activeElement,root:e,predicate:hn})||t()},o=yn({element:e,lock:function(){var o=function(t){(function(t){return t.target!==e&&!e.contains(t.target)})(t)&&(t.preventDefault(),t.stopImmediatePropagation())},c=function(e){gn(e)&&(e.preventDefault(),function(e){var o=document.activeElement===document.body;if(e.shiftKey){var c=o?n():r();c&&c.focus()}else{var l=o?t():a();l&&l.focus()}}(e))};return document.addEventListener("mousedown",o,{capture:!0,passive:!1}),document.addEventListener("keydown",c,{capture:!0,passive:!1}),function(){document.removeEventListener("mousedown",o,{capture:!0,passive:!1}),document.removeEventListener("keydown",c,{capture:!0,passive:!1})}}});return function(){o()}},hn=function(e){return!function(e){return e.hasAttribute&&e.hasAttribute("tabIndex")&&Number(e.getAttribute("tabindex"))<0}(e)&&K(e)},gn=function(e){return"Tab"===e.key||9===e.keyCode},En=[],yn=function(e){var t,n=e.lock;En.length>0&&(t=En[En.length-1]).unlock();var r={lock:n,unlock:n()};return En.push(r),function(){if(0!==En.length){var e=En[En.length-1];r===e?(En.pop(),r.unlock(),t&&(t.unlock=t.lock())):console.warn("you must deactivate trap in the same order they were activated")}else console.warn("cannot deactivate an already deactivated trap")}},bn=function(e){if("object"!==J(e)||1!==e.nodeType)throw new TypeError("getScrollableParent first argument must be DOM node");var t=e;return t===document.documentElement?null:"fixed"===X(t,"position")?Cn(t.ownerDocument):On(t)||Cn(t.ownerDocument)},Cn=function(e){if("scrollingElement"in e)return e.scrollingElement;if(Dn(e))return e.documentElement;var t=e.body,n=t&&!/body/i.test(t.tagName)?Nn(t):t;return n&&xn(n)?null:n},Nn=function(e){for(var t=e;t=t.nextSibling;)if(1===t.nodeType&&kn(t))return t;return null},kn=function(e){return e.ownerDocument.body===e},xn=function(e){if(!Rn(e))return!1;if(Sn(e))return!1;var t=e.ownerDocument.documentElement;return!!Rn(t)&&!Sn(t)},Sn=function(e){var t=X(e,"display");return"none"!==t&&("table-row"!==t&&"table-group"!==t&&"table-column"!==t||"collapsed"!==X(e,"visibility"))},Dn=function(e){return!!/^CSS1/.test(e.compatMode)&&wn(e)},wn=function(e){var t=e.createElement("iframe");t.style.height="1px",(e.body||e.documentElement||e).appendChild(t);var n=t.contentWindow.document;n.write('<!DOCTYPE html><div style="height:9999em">x</div>'),n.close();var r=n.documentElement.scrollHeight>n.body.scrollHeight;return t.parentNode.removeChild(t),r},Rn=function(e){return!An(e)||!In(e)},An=function(e){return"visible"===X(e,"overflow-x")||"visible"===X(e,"overflow")},In=function(e){return"visible"===X(e,"overflow-y")||"visible"===X(e,"overflow")},On=function(e){if(e===document.documentElement)return null;for(var t=X(e,"position"),n=e.parentNode;n;){if(V(n))return null;if("absolute"!==t||"static"!==X(n,"position")){if(Rn(n))return n;n=n.parentNode}else n=n.parentNode}return null},Mn=["container","insertTop","insertLeft","insertRight","insertBottom","children","isOpen","requestCloseOnEscape","requestCloseOnClickOutside","closeMethod","stealFocus","restoreStolenFocus","trapFocus","onAfterOpen","onRequestClose","onFocusIn","onFocusOut","backdropProps"],Ln=["onMouseDownActive"],Pn=System.resolve("./assets/dialog.base.css",t.meta.url),qn=n.useEffect,jn=function(e){var t=e.container,a=void 0===t?document.body:t,i=e.insertTop,u=e.insertLeft,s=e.insertRight,f=e.insertBottom,m=e.children,v=e.isOpen,p=e.requestCloseOnEscape,h=void 0===p||p,g=e.requestCloseOnClickOutside,E=void 0!==g&&g,y=e.closeMethod,b=void 0===y?"display-none":y,C=e.stealFocus,N=void 0===C||C,k=e.restoreStolenFocus,x=void 0===k||k,S=e.trapFocus,D=void 0===S||S,w=e.onAfterOpen,R=void 0===w?function(){}:w,A=e.onRequestClose,I=void 0===A?function(){}:A,O=e.onFocusIn,M=void 0===O?function(){}:O,L=e.onFocusOut,P=void 0===L?function(){}:L,q=e.backdropProps,j=void 0===q?{}:q,T=l(e,Mn);if(!a)return null;var B=n.useState(null),F=r(B,2),z=F[0],U=F[1],G=Boolean(z);return Ye((function(e){return!e&&v}),[v])&&R(),qn((function(){if(!v||!G)return function(){};var e=Bn(z),t=function(t){t.relatedTarget||e&&(e=!1,P(t))},n=function(t){M(t),e=!0},r=function(t){Bn(z)?e=!0:(e=!1,P(t))};return z.addEventListener("focus",n,!0),document.addEventListener("focus",r,!0),document.addEventListener("blur",t,!0),function(){z.removeEventListener("focus",n,!0),document.removeEventListener("focus",r,!0),document.removeEventListener("blur",t,!0)}}),[v,G,M,P]),qn((function(){return v&&G?function(e){for(var t=[],n=e.previousSibling;n;)1===n.nodeType&&Rn(n)&&t.push(n),n=n.previousSibling;var r=function(e){var t=[];return function e(n){var r=bn(n);if(r){if(t.push(r),r===document)return;e(r)}}(e),t}(e);t.push.apply(t,o(r));var a=t.map((function(e){var t=e.style.overflow;return e.style.overflow="hidden",function(){t?e.style.overflow=t:e.style.removeProperty("overflow")}}));return function(){a.forEach((function(e){e()}))}}(z):function(){}}),[v,G]),qn((function(){return v&&G&&D?pn(z):function(){}}),[v,G,D]),qn((function(){if(!v||!G||!N)return function(){};var e=document.activeElement,t=vn(z);return t&&t.focus({preventScroll:!0}),function(){t&&("function"==typeof x?x(e):!0===x&&e.focus({preventScroll:!0}))}}),[v,G,N]),qn((function(){if(!v||!z||!z.parentNode)return function(){};var e=[];return Array.from(z.parentNode.children).forEach((function(t){t!==z&&e.push(t)})),e.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){e.forEach((function(e){e.removeAttribute("aria-hidden","true")}))}}),[v,z]),"dom-remove"!==b||v?_.createPortal(n.createElement("div",c({},T,{role:"dialog",className:"dialog--root".concat(T.className?" ".concat(T.className):""),ref:function(e){U(e),T.ref&&T.ref(e)},onKeyDown:function(e){h&&e.keyCode===Fn&&I(e),T.onKeyDown&&T.onKeyDown(e)},tabIndex:"-1",style:d(d({},"display-none"!==b||v?{}:{display:"none"}),"visibility-hidden"!==b||v?{}:{visibility:"hidden"}),hidden:"hidden-attribute"===b&&!v||void 0}),n.createElement(cn,{href:Pn}),v?n.createElement(Tn,c({},j,{className:"dialog--backdrop",onMouseDownActive:function(e){if(e.preventDefault(),!Bn(z)){var t=vn(z);t&&t.focus({preventScroll:!0})}},onClick:function(e){E&&I(e),j.onClick&&j.onClick(e)}})):null,n.createElement("div",{className:"dialog--document"},n.createElement("div",{className:"dialog--insert-top"},i),n.createElement("div",{className:"dialog--main"},n.createElement("div",{className:"dialog--insert-left"},u),n.createElement("div",{className:"dialog--scrollable-content"},m),n.createElement("div",{className:"dialog--insert-right"},s)),n.createElement("div",{className:"dialog--insert-bottom"},f))),a):null},Tn=function(e){var t=e.onMouseDownActive,a=l(e,Ln),o=n.useState(null),i=r(o,2),u=i[0],s=i[1];return qn((function(){return u?(u.addEventListener("mousedown",t,{passive:!1}),function(){u.removeEventListener("mousedown",t,{passive:!1})}):function(){}}),[u]),n.createElement("div",c({ref:function(e){s(e),a.ref&&a.ref(e)}},a))},Bn=function(e){var t=document.activeElement;return e===t||e.contains(t)},Fn=27,zn=System.resolve("./assets/dialog.css",t.meta.url),Un=function(e){return n.createElement(n.Fragment,null,n.createElement(cn,{href:zn}),n.createElement(jn,c({container:Q()},e)))},Gn=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.useState(e),a=r(t,2),o=a[0],c=a[1],l=function(){c(!0)},i=function(){c(!1)};return[o,l,i]},Wn=function(){return n.createElement("div",{className:"star-rain-container"},n.createElement("div",{className:"star",id:"star-01"},n.createElement(Yn,null)),n.createElement("div",{className:"star",id:"star-02"},n.createElement(Yn,null)),n.createElement("div",{className:"star",id:"star-03"},n.createElement(Yn,null)),n.createElement("div",{className:"star",id:"star-04"},n.createElement(Yn,null)),n.createElement("div",{className:"star",id:"star-05"},n.createElement(Yn,null)),n.createElement("div",{className:"star",id:"star-06"},n.createElement(Yn,null)))},Yn=function(){return n.createElement("svg",{viewBox:"0 0 217.791 210.633"},n.createElement("path",{fill:"#FFFFE6",d:"M94.15,77.97c0,0-2-54,10-73.5s23,28.5,25.5,72.5c0,0,69.197,4.589,86.5,21c13.637,12.934-61.5,31-87,33.5 c-2,14.5-1.831,60.464-16.5,75.5c-20,20.5-25.5-50.5-23-78c-19-1.5-81.5-3.5-89-17.5S52.15,85.97,94.15,77.97z"}))},Zn=function(){return n.createElement("svg",{viewBox:"0 0 320 512",width:"32",heiht:"32"},n.createElement("path",{fill:"currentColor",d:"M207.6 256l107.72-107.72c6.23-6.23 6.23-16.34 0-22.58l-25.03-25.03c-6.23-6.23-16.34-6.23-22.58 0L160 208.4 52.28 100.68c-6.23-6.23-16.34-6.23-22.58 0L4.68 125.7c-6.23 6.23-6.23 16.34 0 22.58L112.4 256 4.68 363.72c-6.23 6.23-6.23 16.34 0 22.58l25.03 25.03c6.23 6.23 16.34 6.23 22.58 0L160 303.6l107.72 107.72c6.23 6.23 16.34 6.23 22.58 0l25.03-25.03c6.23-6.23 6.23-16.34 0-22.58L207.6 256z"}))},Hn=["title","spacingClasses","children"],Kn=function(e){var t=e.title,r=e.spacingClasses,a=e.children,o=l(e,Hn);return n.createElement(Un,c({requestCloseOnClickOutside:!0,insertTop:n.createElement(n.Fragment,null,n.createElement("div",{className:"dialog-border-top"}),n.createElement("div",{className:"dialog-title"},n.createElement("div",{className:"dialog-title-text"},t)),n.createElement("div",{className:"dialog-close",onClick:o.onRequestClose},n.createElement(Zn,null))),insertBottom:n.createElement("div",{className:"dialog-border-bottom"}),insertLeft:n.createElement("div",{className:"dialog-border-left"}),insertRight:n.createElement("div",{className:"dialog-border-right"})},o,{className:"dialog-theme-wood ".concat(r||"dialog-spacing-10 dialog-spacing-fluid dialog-spacing-top-fixed"," ").concat(o.className)}),a)},Xn=function(e){var t=e.dialogIsOpen,r=e.closeDialog;return n.createElement(Kn,{className:"score-rules-dialog",isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0,title:"Score",spacingClasses:"dialog-spacing-10 dialog-spacing-fixed"},n.createElement(n.Fragment,null,n.createElement("div",{className:"dialog-box"},n.createElement("div",{className:"dialog-label"},"Combinaisons de dés"),n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Symbols identiques"),n.createElement("span",{className:"symbol-number"},"Combo 3"),n.createElement("span",{className:"symbol-number"},"Combo 4"),n.createElement("span",{className:"symbol-number"},"Combo 5"),n.createElement("span",{className:"symbol-number"},"Combo 6"),n.createElement("span",{className:"symbol-number"},"Combo 7"),n.createElement("span",{className:"symbol-number"},"Combo 8")),n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Points"),n.createElement("span",{className:"points"},"100"),n.createElement("span",{className:"points"},"200"),n.createElement("span",{className:"points"},"500"),n.createElement("span",{className:"points"},"1000"),n.createElement("span",{className:"points"},"2000"),n.createElement("span",{className:"points"},"4000")))),n.createElement("div",{className:"dialog-box"},n.createElement("div",{className:"dialog-label"},"Dés spéciaux"),n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Symbol"),n.createElement(Xe,{src:$}),n.createElement(Xe,{src:ee})),n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Points"),n.createElement("span",{className:"points"},"100"),n.createElement("span",{className:"points"},"100")))),n.createElement("div",{className:"dialog-box last"},n.createElement("div",{className:"dialog-label"},"Bonus coffre parfait"),n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Dés utilisés"),n.createElement("span",{className:"symbol-number"},"8")),n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Points"),n.createElement("span",{className:"points"},"500"))))))},Jn=["id","value"],Vn=function(e,t,n){var r=Qn(n),a=Math.cos(r),o=Math.sin(r),c=t.x-e.x,l=t.y-e.y;return{x:Math.round(a*c+o*l+e.x),y:Math.round(a*l-o*c+e.y)}},_n=function(e){var t=r(e,4),n=t[0],a=t[1],o=t[2],c=t[3];return{x:(n.x+a.x+o.x+c.x)/4,y:(n.y+a.y+o.y+c.y)/4}},Qn=function(e){return e*Math.PI/180},$n=function(e,t){return!!er(t,(function(t){return n=t,o=(a=r(e,2))[0],c=a[1],i=(l=r(n,2))[0],s=((u=l[1]).x-i.x)*(o.y-i.y)-(u.y-i.y)*(o.x-i.x),d=(c.x-o.x)*(o.y-i.y)-(c.y-o.y)*(o.x-i.x),f=(u.y-i.y)*(c.x-o.x)-(u.x-i.x)*(c.y-o.y),(0!==s||0!==d||0!==f)&&0!==f&&(d/=f,(s/=f)>=0&&s<=1&&d>=0&&d<=1);var n,a,o,c,l,i,u,s,d,f}))},er=function(e,t){var n=r(e,4),a=n[0],o=n[1],c=n[2],l=n[3];return!!(t([a,o])||t([o,c])||t([c,l])||t([l,a]))},tr=function(e,t){var n=e.left,r=e.right,a=r-n;n<t.left?r=(n=t.left)+a:r>t.right&&(r=(n=t.right-a)+a);var o=e.top,c=e.bottom,l=c-o;return o<t.top?c=(o=t.top)+l:c>t.bottom&&(c=(o=t.bottom-l)+l),{left:n,right:r,top:o,bottom:c}},nr=function(e){var t=e.left,n=e.right,r=e.top;return{x:t+(n-t)/2,y:r+(e.bottom-r)/2}},rr=function(e,t){var n,r,a,o,c=nr(e);return r=nr(t),a=(n=c).x-r.x,o=n.y-r.y,Math.sqrt(a*a+o*o)},ar=function(e){var t=e.getBoundingClientRect(),n=te(e),r=t.left+n.x,a=t.top+n.y,o=r+t.width,c=a+t.height;return{left:Math.floor(r),top:Math.floor(a),right:Math.floor(o),bottom:Math.floor(c)}},or=function(e,t){var n,r;return r=t,!((n=ar(e)).right<=r.left||n.left>=r.right||n.bottom<=r.top||n.top>=r.bottom)},cr=function(e){var t=e.x,n=e.y,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.color,o=void 0===a?"yellow":a,c=r.autoRemove,l=void 0===c||c,i=r.autoRemoveAfter,u=void 0===i?2e3:i,s=document.createElement("div");s.style.position="absolute",s.style.zIndex="1000",s.style.left="".concat(t,"px"),s.style.top="".concat(n,"px"),s.style.width="5px",s.style.height="5px",s.style.background=o,s.style.border="1px solid red",document.body.appendChild(s);var d,f=function(){document.body.removeChild(s)};return l&&(d=setTimeout(f,u)),function(){f(),clearTimeout(d)}},lr=function(e){var t=e.totalScoreDomNodeRef,r=e.scoreParticle,a=e.animationDelayGetter,o=void 0===a?function(){return 0}:a;return"bonus"===r.type?n.createElement(ir,{totalScoreDomNodeRef:t,scoreParticle:r,animationDelayGetter:o}):"combo"===r.type?n.createElement(ur,{scoreParticle:r,animationDelayGetter:o}):n.createElement(sr,{scoreParticle:r,animationDelayGetter:o})},ir=function(e){var t=e.totalScoreDomNodeRef,r=e.scoreParticle,a=e.animationDuration,o=void 0===a?800:a,c=e.animationDelayGetter,l=ne(r.symbol),i=n.useRef();return n.useEffect((function(){var e=i.current,n=t.current,a=vr(document.querySelector('[data-chest-slot="'.concat(r.chestSlot,'"]')));return dr({particleDomNode:e,totalScoreDomNode:n,x:a.x,y:a.y,duration:o,delay:c(),onfinish:r.onfinish,oncancel:r.oncancel})}),[]),n.createElement("svg",{ref:i,width:"32",height:"32",className:"score-particle--symbol"},n.createElement("image",{href:l,width:"32",height:"32"}),",")},ur=function(e){var t=e.scoreParticle,a=e.animationDuration,o=void 0===a?800:a,c=e.animationDelayGetter,l=mr(),i=r(l,2),u=i[0],s=i[1];return n.useEffect((function(){var e=u.current,n=vr(document.querySelector(".chest .box"));return fr({particleDomNode:e,x:n.x,y:n.y,duration:o,delay:c(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),n.createElement("svg",{ref:u,className:"score-particle--perfect"},n.createElement("g",{ref:s},n.createElement("text",{x:"0",y:"0",dominantBaseline:"text-before-edge"},"Combo ",t.symbolCount)))},sr=function(e){var t=e.scoreParticle,a=e.animationDuration,o=void 0===a?800:a,c=e.animationDelayGetter,l=mr(),i=r(l,2),u=i[0],s=i[1];return n.useEffect((function(){var e=u.current,n=vr(document.querySelector(".chest .box"));return fr({particleDomNode:e,x:n.x,y:n.y,duration:o,delay:c(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),n.createElement("svg",{ref:u,className:"score-particle--combo"},n.createElement("g",{ref:s},n.createElement("text",{x:"0",y:"0",dominantBaseline:"text-before-edge"},"Coffre parfait")))},dr=function(e){var t=e.particleDomNode,n=e.totalScoreDomNode,r=e.x,a=e.y,o=e.duration,c=e.delay,l=e.onfinish,i=void 0===l?function(){}:l,u=e.oncancel,s=void 0===u?function(){}:u,d=ar(t),f=ar(n),m=d.right-d.left,v=d.bottom-d.top,p=r-m/2,h=a-v/2,g=p,E=h-1.1*v,y=f.left,b=f.top;t.style.left="".concat(p,"px"),t.style.top="".concat(h,"px");var C=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.6,opacity:1,transform:"translate(".concat(g-p,"px, ").concat(E-h,"px)")},{transform:"translate(".concat(y-p,"px, ").concat(b-h,"px)")}],{duration:o,delay:c,fill:"forwards"});return C.onfinish=function(){i()},function(){s(),C.cancel()}},fr=function(e){var t=e.particleDomNode,n=e.x,r=e.y,a=e.duration,o=e.delay,c=e.onfinish,l=void 0===c?function(){}:c,i=e.oncancel,u=void 0===i?function(){}:i,s=ar(t),d=n-(s.right-s.left)/2,f=r-(s.bottom-s.top)/2;t.style.left="".concat(d,"px"),t.style.top="".concat(f,"px");var m=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.4,opacity:1,transform:"scale(1.2)"},{}],{duration:a,delay:o,fill:"forwards"});return m.onfinish=function(){l()},function(){u(),m.cancel()}},mr=function(){var e=n.useRef(),t=n.useRef();return n.useLayoutEffect((function(){var n=e.current,r=t.current.getBBox();n.setAttribute("width",Math.ceil(r.width)),n.setAttribute("height",Math.ceil(r.height))}),[]),[e,t]},vr=function(e){var t=ar(e);return nr(t)},pr=function(e){var t=e.addScoreParticle,r=I(),a=A(),o=q(),c=S(o),l=xt();re.forEach((function(e){var o=[];Object.keys(r).forEach((function(t){var n=r[t],l=nt(n,a);l&&hr(l,e,c)&&o.push(t)}));var i=o.length,u=gr[i]||0,s=n.useRef(u),d=n.useRef((function(){}));We((function(){var n=s.current,r=Boolean(n&&u&&n<u),a=Boolean(n&&u&&n>u);if(s.current=u,(!v(c)||!oe(e))&&!l&&u){if(!a){r&&d.current();var f="".concat(i,"-").concat(e,"-combo"),m=t({id:f,type:"combo",value:u-n,symbol:e,symbolCount:i});d.current=m;var p=o.map((function(e){var t=(document.querySelector('[data-chest-slot="'.concat(e,'"] image'))||document.querySelector('[data-chest-slot="'.concat(e,'"] img'))).animate([{transform:"scale(1)",transformOrigin:"center center"},{transform:"scale(1.2)",transformOrigin:"center center"},{transform:"scale(1)",transformOrigin:"center center"}],{duration:400});return function(){t.cancel()}}));return function(){m(),p.forEach((function(e){e()}))}}d.current()}}),[l,c,u])}))},hr=function(e,t,n){if(e===t)return!0;if(v(n)){if(ae(e)&&oe(t))return!0;if(oe(e)&&ae(t))return!0}return!1},gr={3:100,4:200,5:500,6:1e3,7:2e3,8:4e3},Er=n.useState,yr=n.useEffect,br=function(){var e=S(q()),t=Cr();return n.createElement("div",{className:"score-area ".concat(t?"animated":"")},e?n.createElement(Nr,null):null)},Cr=function(){var e=S(q()),t=mt(),n=ot(t,N),r=St();return!(!m(e)||n>=r)},Nr=function(){var e=S(q()),t=F(),a=Cr(),o=Gn(),c=r(o,3),l=c[0],i=c[1],u=c[2],s=G();return n.createElement(n.Fragment,null,g(e)?n.createElement(Rr,null):null,t?n.createElement(Wn,null):null,n.createElement("button",{className:"round-score ".concat(a?"hidden":""),onClick:i},s?n.createElement(Sr,null):n.createElement(kr,null)),m(e)?n.createElement(Ar,null):null,n.createElement(Xn,{dialogIsOpen:l,closeDialog:u}))},kr=function(){var e=kt(),t=n.useRef(),a=_t(),c=r(a,2),i=c[0],u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalScore,a=void 0===t?0:t,c=e.onScoreParticleAdded,i=void 0===c?function(){}:c,u=e.onScoreParticleRemoved,s=void 0===u?function(){}:u,f=e.onScoreParticleMerged,m=void 0===f?function(){}:f,v=n.useState(a),p=r(v,2),h=p[0],g=p[1],E=n.useState([]),y=r(E,2),b=y[0],C=y[1];n.useEffect((function(){g(a)}),[a]);var N=function(e){C((function(t){return[].concat(o(t),[e])})),i(e);var t=!1;return function(){t||(t=!0,C((function(t){return t.filter((function(t){return t!==e}))})),g((function(t){return t-e.value})),s(e))}},k=function(e){var t=e.id,n=e.value,r=l(e,Jn),a=d(d({id:t,value:n},r),{},{oncancel:function(){o()},onfinish:function(){o(),m(a),g((function(e){return e+n}))}}),o=N(a);return o},x=b.reduce((function(e,t){return e+t.value}),0);return[b,k,h-x]}({totalScore:e,onScoreParticleMerged:c[1]}),s=r(u,3),f=s[0],m=s[1],v=s[2];!function(e){var t=e.addScoreParticle;(function(e){var t=e.addScoreParticle,n=I(),r=A(),a=xt();Object.keys(n).forEach((function(e){var o=n[e],c=nt(o,r),l=c&&ce(c);We((function(){if(!a&&l)return t({id:"chest-slot-".concat(e,"-coin"),type:"bonus",value:100,symbol:C,chestSlot:e})}),[a,l])}))})({addScoreParticle:t}),function(e){var t=e.addScoreParticle,n=I(),r=A(),a=xt();Object.keys(n).forEach((function(e){var o=n[e],c=nt(o,r),l=c&&le(c);We((function(){if(!a&&l)return t({id:"chest-slot-".concat(e,"-diamond"),type:"bonus",value:100,symbol:b,chestSlot:e})}),[a,l])}))}({addScoreParticle:t}),pr({addScoreParticle:t}),function(e){var t=e.addScoreParticle,r=I(),a=A(),o=xt(),c=n.useMemo((function(){var e=[];Object.keys(r).forEach((function(t){var n=r[t];n&&"dice"===n.type&&e.push(nt(n,a))}));var t=lt(e).perfectBonus;return Boolean(t)}),[r,a]);We((function(){if(!o&&c)return t({id:"perfect",type:"perfect",value:500})}),[o,c])}({addScoreParticle:t})}({addScoreParticle:m}),Dr({roundScoreDomNodeRef:t,scoreParticleMergedListener:i});var p=n.useRef(null),h=function(){var e=p.current,t=xr(e,600);return p.current=Date.now()+t,t};return n.createElement(n.Fragment,null,n.createElement("span",{ref:t,className:"round-score--value"},n.createElement(rn,{value:v,condition:function(e,t){return e>t},duration:600})),f.map((function(e){return n.createElement(lr,{key:e.id,totalScoreDomNodeRef:t,scoreParticle:e,animationDelayGetter:h})})))},xr=function(e,t){if(!e)return 0;var n=t-(Date.now()-e);return n<=0?0:n},Sr=function(){var e=kt();return n.createElement("span",{className:"round-score--value"},e)},Dr=function(e){var t=e.roundScoreDomNodeRef,r=e.scoreParticleMergedListener,a=Qt(r);n.useEffect((function(){if(a){var e=t.current;return wr({roundScoreDomNode:e})}}),[a])},wr=function(e){var t=e.roundScoreDomNode,n=e.duration,r=void 0===n?500:n,a=e.easing,o=void 0===a?"ease-in-out":a,c=t.animate([{transform:"scale(1.8)"}],{duration:r,easing:o});return function(){c.cancel()}},Rr=function(){return Z()?n.createElement("div",{className:"pirate-hook"}):n.createElement("div",{style:{display:"none"},className:"pirate-hook"})},Ar=function(){var e=kt(),t=mt(),a=ot(t,N),o=St(),c=new Array(o).fill(""),l=a>=o,i=Ye((function(e){return e<a}),[a]),u=Er(!1),s=r(u,2),d=s[0],f=s[1];return yr((function(){i&&f(!0)}),[i]),yr((function(){if(d){var e=setTimeout((function(){f(!1)}),300);return function(){clearTimeout(e)}}return function(){}}),[d]),n.createElement(n.Fragment,null,n.createElement("div",{className:"ropes ".concat(l?"challenge-won":"")},c.map((function(e,t){return a>=t+1?n.createElement("div",{key:t,className:"rope rope-".concat(t+1," cut-rope")}):n.createElement("div",{key:t,className:"rope rope-".concat(t+1)})}))),d&&a<=o?n.createElement("div",{className:"sword-slice"},n.createElement("div",{className:"triangle-left"}),n.createElement("div",{className:"triangle-right"})):null,n.createElement("div",{className:"negative-round-score rotate-".concat(a," ").concat(l?"removed":"")},e))},Ir=50,Or=System.resolve("./assets/cursed-grid.png",t.meta.url),Mr=function(e){var t=e.chestRef,r=e.diceOverChestListener,a=I(),o=yt(),c=Qt(r),l=S(q()),i=o&&z(l);return n.createElement("div",{className:"chest"},n.createElement("div",{ref:t,className:"dice-area ".concat(z(l)?"glow":""),style:d({},c?{outline:"2px dotted"}:{})},n.createElement("div",{className:"box"},Object.keys(a).map((function(e){return n.createElement("div",{className:"slot",key:e,"data-chest-slot":e},n.createElement(Lr,{chestSlotContent:a[e]}))}))),n.createElement("div",{className:"top-left-corner"}),n.createElement("div",{className:"top-right-corner"}),n.createElement("div",{className:"bottom-left-corner"}),n.createElement("div",{className:"bottom-right-corner"}),o&&!i?n.createElement(Pr,null):null),n.createElement(br,null))},Lr=function(e){var t=e.chestSlotContent,r=S(q());if(!t)return null;if("symbol"===t.type){var a=t.value;return n.createElement("button",{className:"dice",style:{width:Ir,height:Ir,color:"#eaeaea",margin:"5px",backgroundColor:r.color1,borderColor:r.color2,borderWidth:"2px",borderStyle:"solid"}},n.createElement(Xe,{src:ne(a),draggable:"false",style:{width:"100%",height:"100%"}}))}return null},Pr=function(){return n.createElement("div",{className:"cursed-cover"},n.createElement(Xe,{draggable:"false",src:Or,alt:"cursed-cover"}))},qr={animals:{name:"Animaux",rule:"Les singes et les perroquest obtenus sur les dés comptent comme un même symbol dans une combinaison.",more:"Par exemple 2 perroquets et 3 singes forment une conbinaison de 5 dés identiques, soit 500 points."},chest:{name:"Coffre au trésor",rule:'Lorsque le joueur sauvegarde ses dés, grâce à la carte "Coffre au trésor" les dés sont protégés du mauvais sort.',more:"Ainsi même lorsque le joueur obtient 3 têtes de morts, son tour prends fin, mais il peut marquer les points totalisés grâce aux dés sauvegardés!"},coin:{name:"Pièce d'or",rule:"Le joueur commence son tour avec un symbol pièce d'or. Il rapporte des points aussi bien dans une combinaison de dés que comme simple pièce (+100)."},diamond:{name:"Diamant",rule:"Le joueur commence son tour avec un symbol diamant. Il rapporte des points aussi bien dans une combinaison de dés que comme simple diamant (+100)."},pirate:{name:"Capitaine des pirates",rule:"Grâce à l'aide du capitaine, tous les points comptabilisés pendant ce tour sont doublés !"},witch:{name:"Sorcière",rule:"Avec ses potions magiques, la sorcière permet exceptionnellement au joueur de relancer, une fois, un dé avec une tête de mort."},"1skull":{name:"Tête de mort",rule:"Le tour du joueur débute avec un symbole tête de mort."},"2skulls":{name:"2 têtes de mort",rule:"Le tour du joueur débute avec 2 symboles tête de mort."},"2sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 2 symbols sabres. Si il y parvient, il gagne +300 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -300 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"3sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 3 symbols sabres. Si il y parvient, il gagne +500 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -500 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"4sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 4 symbols sabres. Si il y parvient, il gagne +1000 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -1000 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."}},jr=function(e){var t=e.dialogIsOpen,r=e.closeDialog,a=e.card,o=qr[a.type];return n.createElement(Kn,{className:"card-rules-dialog",isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0,title:"Carte"},o?n.createElement(n.Fragment,null,n.createElement("div",{className:"dialog-label"},o.name),n.createElement("div",{style:{textAlign:"center"}},n.createElement(Xe,{className:"current-card",src:ie(a),width:"150",alt:a.type})),n.createElement("div",{className:"text-rule"},o.rule),o.more?n.createElement("div",{className:"text-rule"},o.more):null):"No rule")},Tr=["card"],Br=n.forwardRef((function(e,t){var r=e.card,a=l(e,Tr);return n.createElement("div",c({className:"card current-card",ref:t,width:"55",height:"55",style:{backgroundColor:r.color1,borderColor:r.color2}},a),n.createElement(Xe,{src:ue(r),alt:r.type,width:"55",height:"55"}))})),Fr=System.resolve("./assets/swords-disabled.png",t.meta.url),zr=function(){var e=q(),t=mt(),r=St();if(!e)return null;var a=S(e);if(!m(a))return null;var o=ot(t,N),c=new Array(r).fill("");return n.createElement("div",{className:"sword-challenge-indicators"},c.map((function(e,t){return o>=t+1?n.createElement(Ur,{key:t}):n.createElement(Gr,{key:t})})))},Ur=function(){return n.createElement("div",{className:"sword-icon"},n.createElement(Xe,{src:u}))},Gr=function(){return n.createElement("div",{className:"sword-icon disabled"},n.createElement(Xe,{src:Fr}))},Wr=function(e){var t=e.openScoreboard,r=e.headerSmallCardRef,a=S(q()),o=Z();return n.createElement("div",{className:"header"},n.createElement("div",{className:"card-container",style:{opacity:o?"1":"0"}},n.createElement("div",{className:"small-card"},a?n.createElement(Yr,{headerSmallCardRef:r,currentCard:a}):n.createElement(Zr,null)),o&&n.createElement(zr,null)),n.createElement(Hr,{openScoreboard:t}),n.createElement(Kr,null))},Yr=function(e){var t=e.headerSmallCardRef,a=e.currentCard,o=n.useState(!1),c=r(o,2),l=c[0],i=c[1];return n.createElement(n.Fragment,null,n.createElement(Br,{onClick:function(){i(!0)},card:a,ref:t}),n.createElement(jr,{card:a,dialogIsOpen:l,closeDialog:function(){i(!1)}}))},Zr=function(){return n.createElement("div",{className:"card default-card",style:{backgroundImage:"url(".concat(se,")"),backgroundSize:"217px"}})},Hr=function(e){var t=e.openScoreboard,r=st();return n.createElement(Xe,{onClick:t,className:"avatar",src:r&&r.character.img,alt:"player",style:{borderColor:r&&r.character.color||"white"},width:"55",height:"55"})},Kr=function(){var e=st(),t=e.score,r=tn(t,{duration:1200,timingFunction:function(e){return 1-Math.pow(1-e,5)}});return n.createElement("div",{className:"total-score"},n.createElement("span",{className:"score",style:{backgroundColor:e&&e.character.color||"white"}},r?r.value:t))},Xr=function(e,t){var n=t.rolledAreaDomNode,r=ar(n),a={left:6.25,right:r.right-r.left-56.25,top:6.25,bottom:r.bottom-r.top-56.25},o=[];return e.forEach((function(e,t){e.visibleFaceIndex=_r(e);var n=function(e){var t=0;return function n(){var r=Jr(e,a),c=Vr(),l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_n(e);return e.map((function(e){return Vn(n,e,t)}))}(r,c);return!o.some((function(e){return t=e,er(l,(function(e){return $n(e,t)}));var t}))||t>50?{rectangle:r,rotation:c,rotatedRectangle:l}:(t++,n())}()}(e),r=n.rectangle,c=n.rotation,l=n.rotatedRectangle;o.push(l),e.rolledAreaZIndex=t+1,e.rolledAreaPosition=r[0],e.rotation=c})),e},Jr=function(e,t){var n={x:Qr(t.left,t.right),y:Qr(t.top,t.bottom)};return[{x:n.x,y:n.y},{x:n.x+Ir,y:n.y},{x:n.x+Ir,y:n.y+Ir},{x:n.x,y:n.y+Ir}]},Vr=function(){return Qr(-35,35)},_r=function(e){return Qr(0,e.faces.length-1)},Qr=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},$r=function(e){var t=e.rolledAreaRef,r=gt(),a=O(),o=dt(),c=ea(),l=S(q()),i=yt(),u=a.length<2&&!o,s=i&&z(l),d=u||s;return r?n.createElement("div",{className:"roll-action"},n.createElement("button",{onClick:function(){c(t.current)},disabled:d},"Lancer",u&&!s&&n.createElement("span",{className:"button-subtitle"},"(au moins 2 dés !)")),s&&n.createElement(Xe,{src:de,className:"skull-symbol"})):null},ea=s((function(e,t){var n=e.dices,r=e.rollCount,a=e.diceRolledIds,o=(0===r?Object.keys(n):a).map((function(e){return n[e]}));return Xr(o,{rolledAreaDomNode:t}),d(d({},e),{},{rollCount:r+1,witchUncursedDiceId:null,diceRolledIds:o.map((function(e){return e.id})),dices:d({},n)})})),ta=function(e){var t=e.onRoundOver,r=e.rolledAreaRef;return n.createElement("div",{className:"footer actions"},n.createElement($r,{rolledAreaRef:r}),n.createElement(na,null),n.createElement(ra,{onRoundOver:t}))},na=function(){var e=kt(),t=It(),r=Nt(),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hasRolledOnce,n=void 0===t?ft():t,r=e.scoreMarked,a=void 0===r?F():r,o=e.currentCardId,c=void 0===o?q():o,l=e.hasDicesToCurse,i=void 0===l?pt():l;return!(a||i||!c||!n)}(),o=e<0?"-":"+";return a?n.createElement("div",{className:"collect-action"},n.createElement("button",{onClick:function(){t(e)},disabled:!r},n.createElement("span",null,"Collecter"),n.createElement("span",{className:"score"},o," ",Math.abs(e))),!r&&n.createElement(Xe,{src:de,className:"skull-symbol"})):null},ra=function(e){var t=e.onRoundOver,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollDiceAllowed,n=void 0===t?gt():t,r=e.markScoreAllowed,a=void 0===r?Nt():r,o=e.hasDicesToCurse,c=void 0===o?pt():o;return!n&&!a&&!c}(),a=wt(),o=kt(),c=yt(),l=xt(),i=mt();return r?n.createElement("div",{className:"next-round-action"},n.createElement("button",{onClick:function(){a(),t({reason:c?"3-skulls":l?"chalenge-failed":"user-collect",value:o,symbolsInChest:i})}},"Terminer mon tour")):null},aa=System.resolve("./assets/witch-label.png",t.meta.url),oa=function(e){var t=e.cursedAreaRef,r=S(q());return n.createElement("div",{className:"skull-island"},fe(r)?n.createElement(la,null):null,n.createElement("div",{className:"bottle"},n.createElement("div",{className:"area",ref:t},j(r)?n.createElement(ca,{card:r}):null,B(r)?n.createElement(n.Fragment,null,n.createElement(ca,{card:r}),n.createElement(ca,{card:r})):null)))},ca=function(e){var t=e.card;return n.createElement("button",{className:"dice",style:{width:Ir,height:Ir,color:"#eaeaea",margin:"1px 5px",backgroundColor:t.color1,borderColor:t.color2,borderWidth:"2px"}},n.createElement(Xe,{src:de,style:{width:"100%",height:"100%"}}))},la=function(){return Z()?n.createElement("div",{className:"witch-label"},n.createElement(Xe,{src:aa}),n.createElement("svg",{x:"0px",y:"0px",width:"156.083px",height:"208.667px",viewBox:"0 0 156.083 208.667"},n.createElement("path",{id:"path_01",fill:"none",stroke:"#E4AD30",d:"M8.406,107.82 c2.541,2.178,2.375,2.875,14.25,3.5c14.782,0.778,19.26-11.965,19.26-11.965S47.918,88,40.251,72.917s-18.916,4.583-9.083,8.167 s27.759-1.338,35.142-12.417C74.75,56,77.583,45.333,79.25,37S78.477,15.833,66.31,3.833"}),n.createElement("path",{id:"path_02",fill:"none",stroke:"#E4AD30",d:"M44.031,110.094 c0,0,1,1.313-4.438,3.344s-14.244,7.281-32.125-2"}),n.createElement("path",{id:"path_03",fill:"none",stroke:"#E4AD30",d:"M42.125,103.688 c0,0,1.313,6.594-9.313,8.625S10.281,108.719,9.406,101"}),n.createElement("path",{id:"path_04",fill:"none",stroke:"#E4AD30",d:"M33.114,112.253c0,0,39.886-19.253,43.011,24.747 c0.372,0.447-0.959,1.208-2.542,1.625"}))):n.createElement(Xe,{style:{display:"none"},src:aa})},ia=function(e){var t=e.parent,r=e.children;return t?_.createPortal(n.createElement(n.Fragment,null,r),t):null},ua=function(e){var t=e.rotate,n=e.scale,r=e.translate;return[].concat(o(t?["rotate(".concat(t,"deg)")]:[]),o(n&&1!==n?["scale(".concat(n,")")]:[]),o(r?["translate(".concat(r,")")]:[])).join("")},sa=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.trailing,c=void 0!==o&&o,l=function a(){for(var o=arguments.length,l=new Array(o),i=0;i<o;i++)l[i]=arguments[i];clearTimeout(t);var u=Date.now();if(n){var s=u-n;if(s<r){if(c){var d=r-s;t=setTimeout((function(){return a.apply(void 0,l)}),d)}}else n=u,e.apply(void 0,l)}else n=u,e.apply(void 0,l)},i=function(){clearTimeout(t)};return l.cancel=i,l},da=function(e,t){var n,r,a=t.logLevel,o=void 0===a?"warn":a,c=t.onGrip,l=void 0===c?function(){}:c,i=t.onLongGrip,u=void 0===i?function(){}:i,s=t.onClick,f=void 0===s?function(){}:s,m=t.onDrag,v=void 0===m?function(){}:m,p=t.onRelease,h=void 0===p?function(){}:p,g=t.onCancel,E=void 0===g?function(){}:g,y=t.longGripMs,b=void 0===y?300:y,C=me({logLevel:o}),N=!1,k=function(){},x=function(){},S=function(){};C.debug("enable drag on",e);var D,w,R,A,I,O=ve(e,"dragstart",(function(e){e.preventDefault()})),M=ve(e,"mousedown",(function(e){if(3===e.which)C.debug("ignore right click");else{q(ma(e),e);var t=sa((function(e){T(ma(e),e)}));S=function(){return t.cancel()},k=ve(document,"mousemove",t),x=ve(document,"mouseup",(function(e){x(),k(),B(ma(e),e)}))}}),{passive:!0}),L=ve(e,"touchstart",(function(e){q(va(e),e);var t=sa((function(e){T(va(e),e)}));S=function(){return t.cancel()},k=ve(document,"touchmove",t),x=ve(document,"touchend",(function(e){x(),k(),B(va(e),e)}))}),{passive:!0}),P=ve(e,"click",(function(e){N||"none"!==I||f(e)})),q=function(t,n){C.debug("gripping node at",t),r=!0,I="none",R=t,D=t,w=fa(e),l({x:w.x,y:w.y,event:n}),A=setTimeout(j,b)},j=function(){N=!0,u()},T=function(e,t){if(D.x!==e.x||D.y!==e.y){D=e;var n=R.x-w.x,r=R.y-w.y,a={x:e.x-n,y:e.y-r},o=e.x-R.x,c=e.y-R.y;C.debug("move node at",a),v(d(d({event:t},a),{},{relativeX:o,relativeY:c,setDropEffect:function(e){I=e}}))}else C.debug("no real move")},B=function(e,t){C.debug("releasing node"),r=!1,clearTimeout(A);var a=R.x-w.x,o=R.y-w.y;h({event:t,dropEffect:I,x:D.x-a,y:D.y-o}),n=setTimeout((function(){N=!1}))};return function(e){O(),P(),M(),L(),k(),x(),clearTimeout(A),clearTimeout(n),S(),function(e){r&&(C.debug("cancelling drag",e),r=!1,E({event:e}))}(e)}},fa=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top}},ma=function(e){return{x:e.pageX,y:e.pageY}},va=function(e){var t=e.changedTouches[0];return{x:t.pageX,y:t.pageY}},pa=n.useEffect,ha=n.useState,ga=function(e){var t=e.dice,a=e.diceAnimation,c=e.anmationDebug,l=void 0!==c&&c,i=e.parentNode,u=e.zIndex,s=e.x,d=e.y,m=e.rotation,v=e.draggable,p=e.onDiceClick,h=e.onDiceDrag,g=e.onDiceDrop,E=e.onDiceDragEnd,y=e.disapear,b=e.appear;e.traceUpdate;var C=Q(),N=pe(t.id),k=he(t.id),x=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chestSlots,t=void 0===e?I():e;return Object.keys(t).reduce((function(e,n){var r=t[n];return r&&"dice"===r.type?[].concat(o(e),[r.value]):e}),[])}().includes(t.id),S=ha(!1),D=r(S,2),w=D[0],R=D[1],A=ha(null),O=r(A,2),M=O[0],P=O[1],q=He(i),j=a?q:i;pa((function(){if(!v||!N||!C)return function(){};var e=!1,n=da(N,{onGrip:function(){R(!0)},onClick:function(e){p(t,e)},onDrag:function(n){var r,a,o=n.x,c=n.y,l=n.relativeX,i=n.relativeY,u=n.setDropEffect,s=(r={left:o,right:o+Ir,top:c,bottom:c+Ir},a=ar(C),tr(r,a));P({x:s.left,y:s.top}),(e=e||Math.abs(l)>10||Math.abs(i)>10)&&h(t,{relativeX:l,relativeY:i,setDropEffect:u,diceRectangle:s})},onRelease:function(e){var n=e.dropEffect,r=e.x,a=e.y;"none"!==n&&g(t,{diceRectangle:{left:r,right:r+Ir,top:a,bottom:a+Ir}}),R(!1),P(null),E(t)},onCancel:function(){R(!1),P(null),E(t)}});return function(){n()}}),[v,N,C,p,h,g,E]),pa((function(){if(!a||!N)return function(){};var e=a.from,t=a.to,n=a.onfinish;l&&(cr(e),cr(t));var r="translate(".concat(Math.floor(t.x-e.x),"px, ").concat(Math.floor(t.y-e.y),"px)"),o=N.parentNode.animate([{transform:r}],{duration:500,fill:"forwards",easing:"cubic-bezier(0, 0.55, 0.45, 1)"});return o.onfinish=n,function(){o.cancel()}}),[N,a]);var T=L(t),B=a&&a.from?a.from.x:M?M.x:s,F=a&&a.from?a.from.y:M?M.y:d,z=M||a?1e3:u;return n.createElement(ia,{parent:j},n.createElement("svg",{"data-dice-id":t.id,className:"dice",onClick:v?void 0:function(e){p(t,e)},style:{width:Ir,height:Ir,left:"".concat(B,"px"),top:"".concat(F,"px"),zIndex:z,cursor:v?w?"grabbing":"grab":void 0,position:M||a?"fixed":void 0}},n.createElement("g",{ref:k,className:y?"dice-cursed-disapear":b?"dice-cursed-appear":"",style:{transform:ua({rotate:m||0,scale:w?"1.1":"1"}),transitionProperty:"transform",transitionDuration:"500ms",transitionTimingFunction:"cubic-bezier(0, 0.55, 0.45, 1)",transformOrigin:"center center"}},n.createElement("rect",{className:"dice-background",width:"100%",height:"100%",rx:"5",ry:"5",fill:Ea(T,x).fill,stroke:Ea(T,x).stroke,strokeWidth:"1"}),n.createElement("image",{href:ne(f(t)),draggable:"false",style:{width:"100%",height:"100%"}}))))},Ea=function(e,t){return e?{fill:"black",stroke:"black"}:t?{fill:"none",stroke:"none"}:{fill:"#eaeaea",stroke:"#b9b9b9"}},ya=function(e){var t=e.offscreenDomNode,a=e.chestDomNode,o=e.rolledAreaDomNode,c=e.cursedAreaDomNode,l=e.onDiceOverChestChange,i=void 0===l?function(){}:l,u=e.onDiceOverRolledAreaChange,s=void 0===u?function(){}:u,f=A(),m=I(),v=O(),p=P(),h=M(),g=ge(),E=S(q()),y=F(),b=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cursedCount;return(void 0===e?Et():e)>2}(),C=pt(),N=n.useReducer((function(e,t){return d(d({},e),{},U({},t.key,t.value))}),{}),k=r(N,2),x=k[0],D=k[1],w=Mt(),R=Tt(),j=jt(),T=qt(),B=Lt(),z=n.useRef(null);return Object.keys(f).map((function(e){var r=f[e],l=ja(r,{chestSlots:m,diceRolledIds:v,diceCursedIds:p}),u=Ta(l,{chestDomNode:a,rolledAreaDomNode:o,cursedAreaDomNode:c,offscreenDomNode:t}),N=u.parentNode,k=r.id!==h&&N===o&&L(r),S=N===c,A=ka(r,v),I=n.useCallback((function(e){var t=ba(e,{currentCard:E,witchCardEffectUsed:g,diceIsInRolledArea:A,diceIsInCursedArea:S,chestSlots:m,hasDicesToCurse:C,threeSkullsOrMore:b,scoreMarked:y});if("keep"===t){var n=Ma(m);R(e,n)}else"unkeep"===t?j(e):"uncurse"===t&&T(e)}),[A,S,m,y,b,E,g]),O=n.useCallback((function(e,t){z.current=Na({dragDiceGesture:t,chestDomNode:a,rolledAreaDomNode:o});var n=Ca(e,{diceIsInRolledArea:A,chestSlots:m,dropTargetRef:z,rolledAreaDomNode:o,chestDomNode:a,hasDicesToCurse:C,threeSkullsOrMore:b,scoreMarked:y});t.setDropEffect(n),i("keep"===n?e:null),s("unkeep"===n?e:null)}),[A,m,z,o,a,y,b,i,s]),M=n.useCallback((function(e,t){var n=Ca(e,{diceIsInRolledArea:A,chestSlots:m,dropTargetRef:z,rolledAreaDomNode:o,chestDomNode:a,scoreMarked:y,threeSkullsOrMore:b}),r=!1,c=null;if("reposition-in-rolled-area"===n){var l=Ia(t.diceRectangle,o),i=Oa(e,{dices:f,diceRolledIds:v});w(e,l,i)}else if("back-to-rolled-area"===n)r=!0,c=Ra(e.rolledAreaPosition,o);else if("keep"===n){var u=La(e,{chestSlots:m,rectangle:t.diceRectangle,chestDomNode:a});R(e,u),r=!0,c=Aa(u,a)}else if("reposition-in-chest"===n){var s=La(e,{chestSlots:m,rectangle:t.diceRectangle,chestDomNode:a});Pa(e,m)!==s&&(B(e,s),r=!0,c=Aa(s,a))}else if("back-to-chest"===n){var d=Pa(e,m);r=!0,c=Aa(d,a)}else if("unkeep"===n){var p=Ia(t.diceRectangle,o);w(e,p,Oa(e,{dices:f,diceRolledIds:v})),j(e),r=!0,c=Ra(p,o)}r&&D({key:e.id,value:{from:{x:t.diceRectangle.left,y:t.diceRectangle.top},to:c,onfinish:function(){setTimeout((function(){D({key:e.id,value:null})}))}}})}),[A,m,z,o,a,y,b]),P=n.useCallback((function(){i(null),s(null)}),[i,s]),q=d(d({key:r.id},u),{},{dice:r,diceAnimation:x[r.id],witchCardEffectUsed:g,disapear:k,appear:S,onDiceClick:I,onDiceDrag:O,onDiceDrop:M,onDiceDragEnd:P});return n.useMemo((function(){return n.createElement(ga,q)}),Object.keys(q).map((function(e){return q[e]})))}))},ba=function(e,t){var n=t.currentCard,r=t.witchCardEffectUsed,a=t.diceIsInRolledArea,o=t.diceIsInCursedArea,c=t.chestSlots,l=t.hasDicesToCurse,i=t.threeSkullsOrMore,u=t.scoreMarked;return a?Sa(e,{hasDicesToCurse:l,threeSkullsOrMore:i,scoreMarked:u})?"keep":"none":xa(e,c)?Da(e,{threeSkullsOrMore:i,scoreMarked:u})?"unkeep":"none":o&&wa(e,{currentCard:n,witchCardEffectUsed:r,scoreMarked:u,threeSkullsOrMore:i})?"uncurse":"none"},Ca=function(e,t){var n=t.diceIsInRolledArea,r=t.chestSlots,a=t.dropTargetRef,o=t.rolledAreaDomNode,c=t.chestDomNode,l=t.hasDicesToCurse,i=t.threeSkullsOrMore,u=t.scoreMarked;return n?a.current===o?"reposition-in-rolled-area":a.current===c&&Sa(e,{hasDicesToCurse:l,threeSkullsOrMore:i,scoreMarked:u})?"keep":"back-to-rolled-area":xa(e,r)?a.current===c?"reposition-in-chest":a.current===o&&Da(e,{scoreMarked:u,threeSkullsOrMore:i})?"unkeep":"back-to-chest":"none"},Na=function(e){var t=e.dragDiceGesture,n=e.chestDomNode,r=e.rolledAreaDomNode;return or(n,t.diceRectangle)?n:or(r,t.diceRectangle)?r:null},ka=function(e,t){return t.includes(e.id)},xa=function(e,t){return Object.keys(t).some((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},Sa=function(e,t){var n=t.hasDicesToCurse,r=t.threeSkullsOrMore,a=t.scoreMarked;return!(L(e)||n||r||a)},Da=function(e,t){var n=t.scoreMarked,r=t.threeSkullsOrMore;return!n&&!r},wa=function(e,t){var n=t.currentCard,r=t.witchCardEffectUsed,a=t.scoreMarked,o=t.threeSkullsOrMore;return!(!fe(n)||r||a||o)},Ra=function(e,t){var n,r,a,o,c=(n={left:e.x,top:e.y,right:0,bottom:0},r=ar(t),a=n.right-n.left,o=n.bottom-n.top,{left:r.left+n.left,top:r.top+n.top,right:r.left+n.left+a,bottom:r.top+n.top+o});return{x:c.left,y:c.top}},Aa=function(e,t){var n=qa(e,t),r=ar(n);return{x:r.left+5,y:r.top+5}},Ia=function(e,t){var n=function(e,t){var n=ar(t);return function(e,t){var n=e.left-t.left,r=n+(e.right-e.left),a=e.top-t.top;return{left:n,right:r,top:a,bottom:a+(e.bottom-e.top)}}(tr(e,n),n)}(e,t);return{x:n.left,y:n.top}},Oa=function(e,t){var n=t.diceRolledIds,r=t.dices;if(0===n.length)return 1;var a=n.slice(1).reduce((function(e,t){var n=r[t];return n.rolledAreaZIndex>e.rolledAreaZIndex?n:e}),r[n[0]]);return a===e?e.rolledAreaZIndex:a.rolledAreaZIndex+1},Ma=function(e){return Object.keys(e).find((function(t){return!e[t]}))},La=function(e,t){var n=t.chestSlots,r=t.rectangle,a=t.chestDomNode,o=new Map,c=[];Object.keys(n).forEach((function(t){var r=n[t];if(!r||"dice"===r.type&&r.value===e.id){var l=qa(t,a);o.set(l,t),c.push(l)}}));var l=function(e,t){var n=e.map((function(e){return ar(e)})),r=function(e,t){var n=rr(t,e[0]);return e.reduce((function(e,r){var a=rr(t,r);return a<n?(n=a,r):e}))}(n,t);return e[n.indexOf(r)]}(c,r);return o.get(l)},Pa=function(e,t){return Object.keys(t).find((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},qa=function(e,t){return t.querySelector('[data-chest-slot="'.concat(e,'"]'))},ja=function(e,t){var n=t.chestSlots,r=t.diceRolledIds,a=t.diceCursedIds,o=Object.keys(n).find((function(t){return n[t]&&"dice"===n[t].type&&n[t].value===e.id}));return o?{type:"chest-slot",value:o}:r.includes(e.id)?{type:"rolled-area",value:d(d({},e.rolledAreaPosition),{},{rotation:e.rotation,zIndex:e.rolledAreaZIndex})}:a.includes(e.id)?{type:"cursed-area",value:void 0}:{type:"offscreen-area"}},Ta=function(e,t){var n=e.type,r=e.value,a=t.chestDomNode,o=t.rolledAreaDomNode,c=t.cursedAreaDomNode,l=t.offscreenDomNode;return"chest-slot"===n?{parentNode:a.querySelector('[data-chest-slot="'.concat(r,'"]')),zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!0}:"rolled-area"===n?{parentNode:o,zIndex:r.zIndex,rotation:r.rotation,x:r.x,y:r.y,draggable:!0}:"cursed-area"===n?{parentNode:c,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}:{parentNode:l,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}},Ba=function(e){var t=e.dialogIsOpen,r=e.closeDialog,a=e.headerSmallCardRef,o=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cardIds;return(void 0===e?w():e).map((function(e){return S(e)}))}(),c=q(),l=S(c)||null,i=n.useRef(),u=n.useRef(),s=n.useRef();return n.createElement(Un,{className:"draw-card-dialog dialog-spacing-10 dialog-spacing-fluid",isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!1},n.createElement("div",{className:"dialog-content"},n.createElement("div",{className:"dialog-body"},n.createElement("div",{className:"dialog-label"},0===o.length&&!l&&"Paquet de cartes épuisé. Mélangez-le pour pouvoir piocher à nouveau !",0!==o.length&&!l&&"Piochez une carte pour le tour suivant.",l&&n.createElement("span",{className:"card-name"},qr[l.type].name)),n.createElement("div",{className:"card-area"},n.createElement("div",{style:{position:"relative"}},n.createElement(Fa,{backCardRef:i,currentCard:l,remainingCardCount:o.length}),n.createElement(za,{topCardRef:u,smallCardRef:s,currentCard:l})))),n.createElement("div",{className:"dialog-actions"},n.createElement(Ua,{backCardRef:i,cardDeck:o,currentCard:l}),l?n.createElement(Za,{headerSmallCardRef:a,smallCardRef:s,backCardRef:i,topCardRef:u,currentCard:l,closeDialog:r}):null)))},Fa=function(e){var t=e.backCardRef,r=e.currentCard,a=e.remainingCardCount;return n.createElement("div",{ref:t,className:"card default-card",style:{background:"none"}},n.createElement(Xe,{src:se,width:"150"}),r?null:n.createElement("div",{className:"remaining-cards-number"},a))},za=function(e){var t=e.topCardRef,r=e.smallCardRef,a=e.currentCard;return a?n.createElement(n.Fragment,null,n.createElement("div",{className:"card current-card",ref:t},n.createElement("div",{className:"flip-card"},n.createElement("div",{className:"flip-card-inner"},n.createElement("div",{className:"flip-card-front"},n.createElement(Xe,{className:"card default-card",src:se})),n.createElement("div",{className:"flip-card-back"},n.createElement(Xe,{className:"card-img",src:ie(a),width:"150",alt:a.type}))))),n.createElement("div",{className:"small-card"},n.createElement(Br,{card:a,ref:r}))):null},Ua=function(e){var t=e.backCardRef,r=e.cardDeck;return e.currentCard?null:0===r.length?n.createElement(Wa,{backCardRef:t}):n.createElement(Ga,null)},Ga=function(){var e=Yt();return n.createElement("button",{className:"button-card-main button-draw-card",onClick:e},"Piocher")},Wa=function(e){var t=e.backCardRef,a=G(),o=Kt(),c=n.useState(!1),l=r(c,2),i=l[0],u=l[1];return n.useEffect((function(){return i?(o(),a?(u(!1),function(){}):Ya({backCard:t.current,duration:1e3,onfinish:function(){u(!1)}})):function(){}}),[i]),n.createElement("button",{className:"button-card-main button-shuffle-deck",onClick:function(){u(!0)}},"Mélanger")},Ya=function(e){var t=e.backCard,n=e.duration,r=e.onfinish;t.setAttribute("shaking-deck","");var a=setTimeout((function(){t.removeAttribute("shaking-deck",""),r()}),n);return function(){t.removeAttribute("shaking-deck",""),clearTimeout(a)}},Za=function(e){var t=e.headerSmallCardRef,a=e.smallCardRef,o=e.backCardRef,c=e.topCardRef,l=G(),i=Rt(),u=n.useState(!1),s=r(u,2),d=s[0],f=s[1];return n.useEffect((function(){return d?l?(i(),function(){}):Ha({headerSmallCard:t.current,smallCard:a.current,backCard:o.current,topCard:c.current,duration:500,onfinish:function(){i()}}):function(){}}),[d]),n.createElement("button",{className:"button-card-main button-activate-card",onClick:function(){d||f(!0)}},"Commencer")},Ha=function(e){var t=e.headerSmallCard,n=e.topCard,r=e.backCard,a=e.smallCard,o=e.duration,c=e.onfinish;r.style.opacity=0;var l=ar(t),i=n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(0)",opacity:0}],{duration:o,fill:"forwards"}),u=a.animate([{transform:"scale(0)",opacity:0,position:"fixed",top:"".concat(l.top,".px"),left:"".concat(l.left,".px")},{transform:"scale(1)",opacity:1,position:"fixed",top:"".concat(l.top,".px"),left:"".concat(l.left,".px")}],{duration:o,fill:"forwards"});return u.onfinish=c,function(){i.cancel(),u.cancel()}},Ka=function(e){var t=e.openScoreboard,a=e.onRoundStart,o=e.onRoundOver,c=Z(),l=n.useState(!1),i=r(l,2),u=i[0],s=i[1];n.useEffect((function(){a()}),[]);var d=_t(),f=r(d,2),m=f[0],v=f[1],p=_t(),h=r(p,2),g=h[0],E=h[1],y=n.useRef();return n.createElement("div",{className:"round-container"},n.createElement(Xt,null),n.createElement(Wr,{openScoreboard:t,headerSmallCardRef:y}),c?n.createElement(Xa,{diceOverRolledAreaListener:m,diceOverChestListener:g,openScoreboard:t,onRoundOver:o,onRoundMounted:function(e){s(e)}}):null,u?n.createElement(ya,{offscreenDomNode:u.offscreenDomNode,chestDomNode:u.chestDomNode,rolledAreaDomNode:u.rolledAreaDomNode,cursedAreaDomNode:u.cursedAreaDomNode,onDiceOverChestChange:E,onDiceOverRolledAreaChange:v}):null,n.createElement(Ba,{dialogIsOpen:!c,headerSmallCardRef:y}))},Xa=function(e){var t=e.diceOverRolledAreaListener,r=e.diceOverChestListener,a=e.onRoundMounted,o=e.onRoundOver,c=n.useRef(null),l=n.useRef(null),i=n.useRef(null),u=n.useRef(null);return n.useEffect((function(){a({rolledAreaDomNode:c.current,chestDomNode:l.current,cursedAreaDomNode:i.current,offscreenDomNode:u.current})}),[]),n.createElement(n.Fragment,null,n.createElement(Ft,null),n.createElement("div",{className:"chest-and-skulls"},n.createElement(Mr,{chestRef:l,diceOverChestListener:r}),n.createElement(oa,{cursedAreaRef:i})),n.createElement($t,{rolledAreaRef:c,offscreenRef:u,diceOverRolledAreaListener:t}),n.createElement(ta,{onRoundOver:o,rolledAreaRef:c}))},Ja=function(e){var t=e.closeDialog,r=e.dialogIsOpen,a=e.player,o=Dt();return n.createElement(Un,{className:"score-board-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:r,onRequestClose:t,requestCloseOnClickOutside:!0},n.createElement("div",{className:"dialog-content"},n.createElement("div",{className:"dialog-close",onClick:t},n.createElement(Zn,null)),n.createElement("div",{className:"dialog-body"},n.createElement("div",null,"Au tour de",n.createElement("div",{className:"dialog-label"},a.character.name),n.createElement(Xe,{className:"player-img",src:a&&a.character.img,alt:"player",width:"40",height:"40",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(a&&a.character.color||"black")}})),n.createElement("div",{className:"dialog-actions"},n.createElement("button",{onClick:function(){t(),o(a)}},"Jouer")))))},Va=System.resolve("./assets/win-treasure.png",t.meta.url),_a=System.resolve("./assets/boat.png",t.meta.url),Qa=6e3,$a={path1:"M39.582,739.564c0-91.824,39.191-96.32,38.045-166.691s-30.042-70.37-47.326-161.729s38.128-86.388,31.276-186.42C55.405,134.602-3.014,89.176,8.812,129.825c5.333,18.333,30.77-21,30.77-129.825",path2:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0",path3:"M39.582,739.564c0-71.926-15.437-155.074-17.437-253.074s30-185,31.087-217s-31.087-46-31.087-26s33,10,31-32s-31-110-31-144S39.582,0,39.582,0",path4:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0"},eo=function(e){var t=e.openedByUser,a=e.closeScoreboard,o=e.playerAnimation,c=x(),l=st(),i=Ee(),u=n.useState(!1),s=r(u,2),d=s[0],f=s[1],m=function(){f(!0)},v=to();return n.createElement("div",{className:"score-board-container"},t&&n.createElement("div",{className:"cross",onClick:a},"X"),!i&&!l&&n.createElement("div",{className:"action-container"},n.createElement("button",{className:"score-board-action",onClick:function(){m()}},"Commencer à jouer")),n.createElement(Xe,{className:"win-treasure-img",src:Va,alt:"win-treasure",width:"230",height:"150"}),n.createElement("div",{className:"users-path"},c.map((function(e){return n.createElement(no,{key:e.id,player:e,openedByUser:t,pathCoordinates:$a["path".concat(e.id)],score:e.score,character:e.character,openStartPlayerRoundDialog:m,isCurrentPlayer:l&&e.id===l.id,playerAnimation:o})}))),n.createElement(Ja,{dialogIsOpen:d,closeDialog:function(){f(!1)},player:v}))},to=function(){var e,t=st(),n=x();if(t){var r=n.findIndex((function(e){return e.id===t.id}));e=r===n.length-1?n[0]:n[r+1]}else e=n[0];return e},no=function(e){var t=e.pathCoordinates,a=e.player,o=e.openedByUser,c=e.character,l=e.score,i=e.openStartPlayerRoundDialog,u=e.playerAnimation,s=n.useRef(null),d=n.useRef(null),f=n.useRef(null),m=n.useRef(null),v=to(),p=n.useState(null),h=r(p,2),g=h[0],E=h[1],y=n.useState([]),b=r(y,2),C=b[0],N=b[1],k=n.useState(!1),x=r(k,2),S=x[0],D=x[1];return n.useEffect((function(){u&&u.player===a?"user-collect"===u.roundOverReason?(E(u.score),N(u.symbolsInChest)):"3-skulls"===u.roundOverReason?D(!0):"chalenge-failed"===u.roundOverReason&&E(u.score):E(null)}),[u,a]),n.useEffect((function(){if(g){var e=g.from,t=g.to,n=d.current.animate([{offsetDistance:ro(e/Qa)},{offsetDistance:ro(t/Qa)}],{duration:1e3,fill:"forwards"}),r=m.current,a=null;r&&(a=r.animate([{offsetDistance:ro(e/Qa)},{offsetDistance:ro(t/Qa)}],{duration:1e3,fill:"forwards"}));var o=s.current,c=o.getTotalLength();console.log("from",e),console.log("to",t);var l=o.animate([{strokeDashoffset:ao(e/Qa,c)},{strokeDashoffset:ao(t/Qa,c)}],{duration:1e3,fill:"forwards"});return l.onfinish=function(){"finished"===n.playState&&E(null)},n.onfinish=function(){"finished"===l.playState&&E(null)},function(){l.cancel(),n.cancel(),a&&a.cancel()}}}),[g]),n.useEffect((function(){var e=s.current,t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=ao(l/Qa,t)}),[l]),n.createElement("div",{className:"user-path"},n.createElement("svg",{viewBox:"0 0 79.164 739.564",width:"50",height:"450",fill:"none",stroke:"none"},n.createElement("path",{d:t,className:"path-background"}),n.createElement("path",{ref:s,d:t,className:"path-foreground"}),n.createElement("g",{className:"score-indicator"},n.createElement("image",{ref:d,href:_a,width:"26",height:"26",className:"boat",style:{offsetPath:"path('".concat(t,"')"),offsetDistance:ro(l/Qa)}}),C&&C.length>0&&n.createElement("g",{className:"animation-symbols",ref:m,style:{offsetPath:"path('".concat(t,"')"),offsetDistance:ro(l/Qa)}},C.map((function(e,t){return n.createElement("image",{key:t,width:"30",height:"30",className:"symbol symbol-".concat(t+1),href:ne(e)})}))))),n.createElement("div",{className:"speech-bubble"},l),n.createElement("div",{className:"user-avatar ".concat(v.character.id!==c.id||o?"":"next-player"),onClick:function(){v.character.id!==c.id||o||i()}},S&&n.createElement("div",{className:"animation-3skulls",ref:f},n.createElement(oo,null)),n.createElement(co,{character:c})))},ro=function(e){return"".concat(100*e,"%")},ao=function(e,t){return t-e*t},oo=function(){return new Array(3).fill("").map((function(e,t){return n.createElement(Xe,{key:t,width:"30",height:"30",className:"skull skull-".concat(t+1),src:de,animateLoaded:!1})}))},co=function(e){var t=e.character;return n.createElement(Xe,{className:"player-img",src:t.img,alt:"player",width:"40",height:"40",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(t.color||"black")}})},lo=function(){var e=io();return n.createElement("div",{className:"game-configuration"},n.createElement("div",{className:"background-image"}),n.createElement("div",{className:"content"},n.createElement("div",{className:"title"},"A l’abordage !"),n.createElement("div",{className:"subtitle"},"Combien de joueurs participent à l’aventure ?"),n.createElement("div",{className:"buttons"},[1,2,3,4,5].map((function(t){return n.createElement("button",{key:t,onClick:function(){e(t)}},t)})))))},io=s((function(e,t){return d(d({},e),{},{players:new Array(t).fill("").map((function(e,t){return{id:t+1,number:t+1,score:0}}))})})),uo=[{id:1,name:"Luffy",color:"#ef9620",img:System.resolve("./assets/Luffy.png",t.meta.url).href},{id:2,name:"Miss Fortune",color:"#d90f1b",img:System.resolve("./assets/miss_fortune.png",t.meta.url).href},{id:3,name:"Jack Sparrow",color:"#007033",img:System.resolve("./assets/JackSparrow.png",t.meta.url).href},{id:4,name:"Barbe Rouge",color:"#7baac9",img:System.resolve("./assets/BarbeRouge.png",t.meta.url).href},{id:5,name:"Ginette Boulette",color:"#e2500c",img:System.resolve("./assets/GinetteBoulette.png",t.meta.url).href},{id:6,name:"Capitaine Crochet",color:"#952460",img:System.resolve("./assets/CapitaineCrochet.png",t.meta.url).href}],so=function(e){var t=e.players,r=po(),a=mo(),o=t.find((function(e){return!e.character}));return ho(),n.useEffect((function(){ho()}),[]),n.createElement("div",{className:"character-selection-page"},n.createElement(fo,null),o&&n.createElement(n.Fragment,null,n.createElement("p",null,"Joueur ",o.number," : quel pirate êtes vous ?"),n.createElement("div",{className:"characters-container",id:"menu-wrapper"},n.createElement("div",{className:"characters menu"},uo.map((function(e){return n.createElement("div",{className:"character item ".concat(vo(e,t)?"":"disabled"),key:e.id,onClick:function(n){vo(e,t)&&(n.target.animate([{transform:"scale(1)"},{transform:"scale(1.3)"},{transform:"scale(1)"}],{duration:400,fill:"forwards"}),r(o,e))}},n.createElement(Xe,{className:"character-img",width:"40",height:"40",src:e&&e.img,alt:"player",style:{border:"4px solid ".concat(e&&e.color||"black")}}),n.createElement("span",null,e.name))}))),n.createElement("div",{className:"paddles"},n.createElement("button",{className:"left-paddle paddle hidden"},"<"),n.createElement("button",{className:"right-paddle paddle",onClick:function(){ho()}},">")))),!o&&n.createElement("div",{className:"crew-completed"},n.createElement("p",null,"L’équipage est au complet !"),n.createElement(Xe,{style:{opacity:.5},src:ue({type:ye})}),n.createElement("button",{onClick:function(){a()}},"Démarrer la partie")))},fo=function(){var e=x();return n.createElement("div",{className:"crew ".concat(e.length>3?"large-crew":"")},n.createElement("div",{className:"title"},"Votre equipage:"),n.createElement("ul",null,e.map((function(e){return n.createElement("li",{key:e.id},e.character?n.createElement(Xe,{className:"crew-member-img",width:"40px",height:"40px",src:e.character&&e.character.img,alt:"player",style:{border:"4px solid ".concat(e.character&&e.character.color||"black")},loadWhenIntersecting:!1}):n.createElement("div",{className:"placeholder-img"}),n.createElement("span",null,e.character?e.character.name:"Joueur".concat(e.number)))}))))},mo=s((function(e){var t=e.cardIds;return d(d({},e),{},{gameStarted:!0,cardIds:Y(t)})})),vo=function(e,t){return!t.some((function(t){return t.character&&t.character.name===e.name}))},po=s((function(e,t,n){var r=e.players;return t.character=n,d(d({},e),{},{players:o(r)})})),ho=function(){var e=document.getElementsByClassName("item").length,t=function(){return document.getElementById("menu-wrapper")?document.getElementById("menu-wrapper").offsetWidth:null},n=t(),r=123*e;window.onresize=function(){n=t()};var a=r-n,o=document.querySelector(".left-paddle"),c=document.querySelector(".right-paddle");document.querySelector(".menu")&&(document.querySelector(".menu").onscroll=function(){a=r-n;var e=document.querySelector(".menu").scrollLeft,t=a;e<=0?(o.classList.add("hidden"),c.classList.remove("hidden")):e<t?(o.classList.remove("hidden"),c.classList.remove("hidden")):e>=t&&(o.classList.remove("hidden"),c.classList.add("hidden"))}),c&&(c.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e+n;en({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}}),o&&(o.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e-n;en({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}})},go=function(e){var t=e.playerAnimationListener,a=x(),o=k(),c=Ee(),l=Eo(),i=yo(),u=n.useState(!1),s=r(u,2),d=s[0],f=s[1],m=n.useState(null),v=r(m,2),p=v[0],h=v[1],g=n.useState(null),E=r(g,2),y=E[0],b=E[1],C=!c||d,N=a.find((function(e){return e.id===o})),S=n.useRef(null);return n.useEffect((function(){b(p?{player:N,score:{from:S.current,to:N.score},roundOverReason:p.reason,symbolsInChest:p.symbolsInChest}:null)}),[p,o]),n.useEffect((function(){if(t)return t(b)}),[t]),l?n.createElement(lo,null):i?n.createElement(so,{players:a}):C?n.createElement(eo,{openedByUser:d,closeScoreboard:function(){f(!1)},playerAnimation:y}):n.createElement(Ka,{openScoreboard:function(){f(!0)},onRoundStart:function(){S.current=N.score,h(null)},onRoundOver:function(e){h(e)}})},Eo=function(){return 0===x().length},yo=function(){return!be()},bo=s((function(e){return d(d({},e),{},{animationsDisabled:!0})})),Co=s((function(e){return d(d({},e),{},{animationsDisabled:!1})})),No=s((function(e){return d(d({},e),{},{soundDisabled:!0})})),ko=s((function(e){return d(d({},e),{},{soundDisabled:!1})})),xo=s((function(){return Ce})),So=function(){var e=n.useState(),t=r(e,2),a=t[0],o=t[1];return n.useEffect((function(){return Ne.listenAvailabilityChange((function(){o(Ne.isAvailable())}))}),[]),a},Do=function(){return De};function wo(){}function Ro(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var Ao=function(e){var t=e.settingsDialogIsOpen;return Se()?n.createElement(Io,{settingsDialogIsOpen:t}):null},Io=function(e){var t,a,o,c,l=e.checkOnOpen,i=void 0===l||l,u=e.settingsDialogIsOpen,s=Do(),d=(t=n.useState(ke()),o=(a=r(t,2))[0],c=a[1],n.useEffect((function(){return xe((function(){c(ke())}))}),[]),o);return n.useEffect((function(){i&&u&&s()}),[i,u]),n.createElement("fieldset",{style:{minHeight:"4em"}},n.createElement("legend",null,"Mise a jour"),d?n.createElement(Oo,{serviceWorkerUpdate:d}):n.createElement(Mo,null))},Oo=function(e){var t=e.serviceWorkerUpdate,a=t.shouldBecomeNavigatorController,o=t.navigatorWillReload,c=we,l=n.useState(""),i=r(l,2),u=i[0],s=i[1],d=Ro((function(){return s("updating"),function(e,t){return e&&e.then?e.then(wo):Promise.resolve()}(c({onActivating:function(){return s("activating")},onActivated:function(){return s("activated")},onBecomesNavigatorController:function(){return s("")}}))}));return n.createElement(n.Fragment,null,n.createElement("p",null,""===u?"Mise a jour prête":null,"updating"===u||"activating"===u?"Mise a jour...":null,"activated"===u&&o?"Mise a jour activée, la page va se recharger":null,"activated"===u&&!o&&a?"Mise a jour activée, recharger la page pour installer":null,"activated"!==u||o||a?null:"Mise a jour activée"),n.createElement("button",{disabled:Boolean(u),onClick:d},o?"Recharger pour mettre a jour":"Mettre a jour"))},Mo=function(){var e=Do(),t=n.useState(""),a=r(t,2),o=a[0],c=a[1],l=Ro((function(){return c("fetching"),function(e){if(e&&e.then)return e.then(wo)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return function(e,t,n){try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}(e,(function(e){e||c("notfound")}))}),(function(e){c("failed"),console.error(e)})))}));return n.createElement(n.Fragment,null,n.createElement("p",null,"fetching"===o?"Recherche de mise a jour...":null,"notfound"===o?"Pas de mise a jour disponible.":null,"failed"===o?"Une erreur est survenue.":null),n.createElement("button",{disabled:"fetching"===o,onClick:l},"Chercher"))},Lo=System.resolve("./assets/settings.css",t.meta.url),Po=function(){var e=Gn(),t=r(e,3),a=t[0],o=t[1],c=t[2];return n.createElement(n.Fragment,null,n.createElement(cn,{href:Lo}),n.createElement("div",{id:"settings",onClick:function(){o()}},n.createElement("svg",{className:"settings-icon",width:"24px",height:"24px",viewBox:"0 0 24 24"},n.createElement("path",{fill:"currentColor",d:"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"}))),n.createElement(qo,{settingsDialogIsOpen:a,closeSettingsDialog:c}))},qo=function(e){var t=e.settingsDialogIsOpen,a=e.closeSettingsDialog,o=G(),c=bo(),l=Co(),i=Re(),u=No(),s=ko(),d=xo(),f=n.useState(!1),m=r(f,2),v=m[0],p=m[1];return n.createElement(Un,{className:"settings-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:a,requestCloseOnClickOutside:!0},n.createElement("div",{className:"settings-dialog-content"},n.createElement("div",{className:"dialog-close",onClick:a},n.createElement(Zn,null)),n.createElement("div",{className:"dialog-simple-title"},"Settings"),n.createElement("div",{className:"setting-element"},n.createElement("label",null,n.createElement("input",{type:"checkbox",className:o?"checked":"unchecked",checked:o,onChange:function(e){e.target.checked?c():l()}}),o&&n.createElement(To,null),"Désactiver les animations")),n.createElement("div",{className:"setting-element"},n.createElement("label",null,n.createElement("input",{type:"checkbox",className:i?"checked":"unchecked",checked:i,onChange:function(e){e.target.checked?u():s()}}),i&&n.createElement(To,null),"Couper le son")),n.createElement("div",{className:"setting-element"},n.createElement("button",{onClick:function(){p(!0)}},"Annuler la partie")),n.createElement(jo,null),n.createElement(Ao,{settingsDialogIsOpen:t}),n.createElement(Bo,{confirmCancelGameDialogIsOpen:v,closeConfirmCancelGameDialog:function(){p(!1)},performCancelGame:function(){d(),a()}})))},jo=function(){var e=[So(),n.useCallback(Ne.prompt)],t=r(e,2),a=t[0],o=t[1];return a?n.createElement("button",{onClick:function(){o()}},"Installer application"):null},To=function(){return n.createElement("svg",{className:"check-icon",width:"20",height:"20",viewBox:"0 0 512 512"},n.createElement("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"}))},Bo=function(e){var t=e.confirmCancelGameDialogIsOpen,r=e.closeConfirmCancelGameDialog,a=e.performCancelGame;return n.createElement(Un,{className:"confirm-cancel-game-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0},n.createElement("div",{className:"settings-dialog-content"},n.createElement("div",{className:"dialog-close",onClick:r},n.createElement(Zn,null)),n.createElement("div",{className:"title-container"},n.createElement(Xe,{className:"illustration",src:Ae,width:"40",height:"40"}),n.createElement("div",{className:"title"},"Êtes-vous certain de vouloir annuler la partie ?")),n.createElement("div",{className:"content"},"Cette action irréversible effacera la progression actuelle et remettra la partie à zéro !"),n.createElement("div",{className:"confirm-action"},n.createElement("button",{onClick:function(){a(),r()}},"Confirmer"))))},Fo=System.resolve("./assets/app.css",t.meta.url),zo=(e("App",(function(e){return n.createElement("div",{id:"main",ref:Ie()},n.createElement(cn,{href:Fo}),n.createElement(Po,null),n.createElement(zo,e))})),function(e){return Oe()?n.createElement(go,e):n.createElement($e,e)})}}}));
//# sourceMappingURL=root-11ed6aeb.js.map