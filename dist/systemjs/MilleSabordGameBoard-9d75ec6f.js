System.register(["./index-b13949b1.js","./DiceHelpers-12606fb9.js"],(function(e){"use strict";var t,n,r,a,l,c,o,u,i,d,s;return{setters:[function(e){t=e.a,n=e.u,r=e.R,a=e._},function(e){l=e.S,c=e.a,o=e.b,u=e.c,i=e.d,d=e.e,s=e.s}],execute:function(){var f=function(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},m=function(e,t){return!(e.right<=t.left)&&(!(e.left>=t.right)&&(!(e.bottom<=t.top)&&!(e.top>=t.bottom)))},y=r.forwardRef((function(e,t){var n=e.diceArray,a=e.keepDiceAllowed,l=e.keepDice;return r.createElement("div",{className:"diceOnGoing",ref:t},r.createElement("span",{className:"title"},"Dice on going"),r.createElement("div",{className:"area"},n.map((function(e){return r.createElement("button",{key:e.id,disabled:!a,onClick:function(){return l(e)},className:"dice",style:{width:40,height:40,left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),transform:"rotate(".concat(e.rotation,"deg)"),position:"absolute"}},e.symbol)}))))})),p=function(e){var t=e.rollDicePermission,n=e.onClick;return t.allowed?r.createElement("button",{onClick:n},"Roll!"):"3 skulls or more"===t.reaon?null:r.createElement(r.Fragment,null,r.createElement("button",{disabled:!0},"Roll!"),r.createElement("span",null,"(".concat(t.reason,")")))},h=function(e){var t=e.diceArray,n=e.unkeepDiceAllowed,a=e.unkeepDice;return r.createElement("div",{className:"diceKept"},r.createElement("span",{className:"title"},"Dice kept"),r.createElement("div",{className:"area"},t.map((function(e){return r.createElement("button",{key:e.id,disabled:!n,onClick:function(){return a(e)},className:"dice",style:{width:40,height:40}},e.symbol)}))))},k=function(e){var t=e.onClick;return r.createElement("button",{onClick:t,style:{marginLeft:"20px"}},"Mark this score")},E=function(e){var t=e.rollIndex,n=e.isOnSkullIsland,a=e.roundScore,l=e.markScorePermission,c=e.markScore;return-1===t?null:r.createElement("div",null,r.createElement("span",{className:"subtitle"}," Round score: "),r.createElement(b,{isOnSkullIsland:n,markScorePermission:l,roundScore:a,markScore:c}))},b=function(e){var t=e.markScorePermission,n=e.isOnSkullIsland,a=e.roundScore,l=e.markScore;return n?r.createElement("span",null,"XXX -Skull Island- XXX"):r.createElement(r.Fragment,null,r.createElement("span",null,a),t.allowed?r.createElement(k,{onClick:l}):null,r.createElement("div",null,"has-three-skulls-or-more"===t.reason?"Round over !":t.reason))},v=function(e){var t=e.totalScore;return r.createElement("div",null,r.createElement("span",{className:"subtitle"}," Total score: "),r.createElement("span",{className:"totalScore"},t))},S=function(e){var t=e.cardDeck,n=e.cardDrawn,a=e.drawCard,l=e.card;return r.createElement("div",null,!n&&r.createElement("button",{onClick:function(){return a()},style:{marginTop:"20px"}},t.length>0?"Draw a card":"Shuffle the deck"),r.createElement("div",{style:{marginTop:"10px"}},"Remaining cards: ",t.length),r.createElement("span",{className:"card"},l.label))},w=function(e){var t=e.diceCursed,n=e.canRemoveSkull,a=e.removeSkull;return r.createElement("div",{className:"skullIsland"},r.createElement("span",{className:"title"},"Skull Island"),r.createElement("div",{className:"area"},t.map((function(e){return r.createElement("button",{key:e.id,disabled:!n,onClick:function(){return a(e)},className:"dice",style:{width:40,height:40}},e.symbol)}))))},g=function(e){var t=e.nextRoundPermission,n=e.nextRound;return t.allowed?r.createElement("button",{onClick:function(){return n()}},"Start next round"):null},x=function(){return I(C())},C=function(){var e=[];return M.forEach((function(t){e=D(e,t)})),e},M=[{type:"pirate",cardQuantiy:4,label:"Pirate"},{type:"witch",cardQuantiy:4,label:"Witch"},{type:"chest",cardQuantiy:4,label:"Treasure chest"},{type:"animals",cardQuantiy:4,label:"Parrot = monkey"},{type:"diamond",cardQuantiy:4,label:"Diamond"},{type:"coin",cardQuantiy:3,label:"Coin"},{type:"skull",skullAmount:1,cardQuantiy:3,label:"1 skull"},{type:"skull",skullAmount:2,cardQuantiy:2,label:"2 skulls"},{type:"sword-challenge",goal:2,gamble:300,cardQuantiy:2,label:"2 sword challenge"},{type:"sword-challenge",goal:3,gamble:500,cardQuantiy:3,label:"3 sword challenge"},{type:"sword-challenge",goal:4,gamble:1e3,cardQuantiy:2,label:"4 sword challenge"}],D=function(e,t){for(var n=0;n<t.cardQuantiy;n++)e.push(t);return e},I=function(e){for(var t=0;t<100;t++)A(e);return e},A=function(e){var t=N(e.length),n=N(e.length),r=e[t];return e[t]=e[n],e[n]=r,e},N=function(e){return Math.floor(Math.random()*e)},R=function(e){var t=e.dice,n=e.index,r=e.dices,a=e.xMin,l=e.xMax,c=e.yMin,o=e.yMax,u=P(r.slice(0,n),{xMin:a,xMax:l,yMin:c,yMax:o}),i=u.x,d=u.y;t.x=i,t.y=d,t.rotation=Q(),t.symbol=X()},P=function(e,t){var n=t.xMin,r=t.xMax,a=t.yMin,l=t.yMax,c=0;return function t(){var o,u={x:T(n,r),y:T(a,l)};return o=u,e.some((function(e){return m({top:o.y-5,left:o.x-5,bottom:o.y+40+5,right:o.x+40+5},{top:e.y-5,left:e.x-5,bottom:e.y+40+5,right:e.x+40+5})}))?++c>50?u:t():u}()},Q=function(){return T(-35,35)},O={1:l,2:c,3:o,4:u,5:i,6:d},X=function(){return O[j()]},j=function(){return T(1,6)},T=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},F=function(e){var t=e.card,n=e.diceCursed.length;return"skull"===t.type&&(n+=t.skullAmount),n},G=function(e){var t=e.card;return 0===e.rollIndex&&"sword-challenge"!==t.type},K=function(e){var t=e.card,n=e.diceCursed;return F({card:t,diceCursed:n})>=4},U=function(e){return e.map((function(e){return B(e)}))},B=function(e){return e.symbol},q=function(e,t){return e.filter((function(e){return e===t})).length},H=function(e,t){var n=t.perfectEnabled,r=0,a=0,o=L(e);return Object.values(o).forEach((function(e){3===e&&(r+=100),4===e&&(r+=200),5===e&&(r+=500),6===e&&(r+=1e3),7===e&&(r+=2e3),8===e&&(r+=4e3),e>2&&(a+=e)})),e.forEach((function(e){e===c&&(r+=100,o[c]<3&&(a+=1)),e===l&&(r+=100,o[l]<3&&(a+=1))})),n&&a>=e.length&&(r+=500),r},L=function(e){var t={};return e.forEach((function(e){t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},W=(e("MilleSabordGameBoard",(function(e){var t=e.diceArray,n=r.useState(t),l=a(n,2),c=l[0],m=l[1],k=r.useState([]),b=a(k,2),C=b[0],M=b[1],D=r.useState([]),I=a(D,2),A=I[0],N=I[1],P=r.useState([]),Q=a(P,2),O=Q[0],X=Q[1],j=r.useState(0),T=a(j,2),B=T[0],L=T[1],_=r.useState(x()),z=a(_,2),J=z[0],V=z[1],Y=r.useState({}),Z=a(Y,2),$=Z[0],ee=Z[1],te=r.useState(-1),ne=a(te,2),re=ne[0],ae=ne[1],le=r.useState(!1),ce=a(le,2),oe=ce[0],ue=ce[1],ie=r.useState(!1),de=a(ie,2),se=de[0],fe=de[1],me=r.useState(!1),ye=a(me,2),pe=ye[0],he=ye[1],ke=r.useState(!1),Ee=a(ke,2),be=Ee[0],ve=Ee[1],Se=r.useState({}),we=a(Se,2),ge=we[0],xe=we[1],Ce=r.useState(!1),Me=a(Ce,2),De=Me[0],Ie=Me[1],Ae=r.useState(!1),Ne=a(Ae,2),Re=Ne[0],Pe=Ne[1],Qe=r.useState({}),Oe=a(Qe,2),Xe=Oe[0],je=Oe[1],Te=r.useState({}),Fe=a(Te,2),Ge=Fe[0],Ke=Fe[1],Ue=r.useState(!1),Be=a(Ue,2),qe=Be[0],He=Be[1];r.useEffect((function(){F({card:$,diceCursed:O})>2||se?(Ie(!1),Pe(!1)):(Ie(!0),Pe(!0))}),[$,O,se]),r.useEffect((function(){he(function(e){var t=e.isOnSkullIsland,n=e.card,r=e.rollIndex,a=e.diceCursed;return!!t||!(!G({card:n,rollIndex:r})||!K({card:n,diceCursed:a}))}({isOnSkullIsland:pe,card:$,rollIndex:re,diceCursed:O}))}),[$,re,O]),r.useEffect((function(){xe(function(e){var t=e.cardDrawn,n=e.scoreMarked,r=e.card,a=e.diceCursed,l=e.rollIndex,c=e.diceOnGoing;return t?n?{allowed:!1,reason:"round-not-started"}:F({card:r,diceCursed:a})>2?{allowed:!1,reason:"has-three-skulls-or-more"}:l>0&&c.length<2?{allowed:!1,reason:"not-enough-dice-to-roll"}:{allowed:!0,reason:""}:{allowed:!1,reason:"card-not-drawn"}}({cardDrawn:oe,scoreMarked:se,card:$,diceCursed:O}))}),[oe,se,$,O]),r.useEffect((function(){je(function(e){var t=e.rollIndex,n=e.card,r=e.diceCursed;return e.scoreMarked?{allowed:!1}:F({card:n,diceCursed:r})>2?"chest"===n.type&&t>0?{allowed:!0}:{allowed:!1,reason:"has-three-skulls-or-more"}:{allowed:!0}}({rollIndex:re,card:$,diceCursed:O,scoreMarked:se}))}),[$,re,O,se]),r.useEffect((function(){ve(function(e){var t=e.card,n=e.diceKept;if(!e.markScoreAllowed)return"sword-challenge"===t.type?-t.gamble:0;var r=8===n.length,a=U(n);return"sword-challenge"===t.type?q(a,o)>=t.goal?H(a,{perfectEnabled:r})+t.gamble:-t.gamble:"diamond"===t.type||"coin"===t.type?H([].concat(f(a),[t.type]),{perfectEnabled:r}):"animals"===t.type?H(a.map((function(e){return e===u?i:e})),{perfectEnabled:r}):"pirate"===t.type?2*H(a,{perfectEnabled:r}):H(a,{perfectEnabled:r})}({card:$,diceKept:A,markScoreAllowed:Xe.allowed}))}),[$,A,Xe]),r.useEffect((function(){-1===re?Ke({allowed:!1}):ge.allowed||Xe.allowed||Ke({allowed:!0})}),[re,ge,Xe]),r.useEffect((function(){"witch"===$.type?O.length>2||$.effectUsed?He(!1):He(!0):He(!1)}),[$,O]);var Le=W(Xe);r.useEffect((function(){"sword-challenge"!==$.type||se||!Le.allowed||Xe.allowed||Je()}),[$,se,Le,Xe]);var We=r.createRef(),_e=function(e){var t=s(e),n=t.withoutSkulls,r=t.skulls;M(n),X([].concat(f(O),f(r)))},ze=function(e){if(e.symbol===d){"witch"===$.type&&($.effectUsed=!0);var t=O.filter((function(t){return t!==e}));X(t)}else{var n=A.filter((function(t){return t!==e}));N(n)}var r=[].concat(f(C),[e]);M(r)},Je=function(){L(Math.max(B+be,0)),fe(!0)};return r.createElement(r.Fragment,null,r.createElement(S,{cardDeck:J,cardDrawn:oe,drawCard:function(){J.length>0?(ee(J.pop()),V(J),ue(!0)):V(x())},card:$}),r.createElement("div",null,r.createElement(p,{rollDicePermission:ge,onClick:function(){var e;-1===re?(e=c,M(f(c)),m([]),ae(0)):(e=C,ae(re+1)),function(e,t){var n=t.diceParentElement.getBoundingClientRect(),r=n.width-40,a=n.height-40;e.forEach((function(t,n){R({dice:t,index:n,dices:e,xMin:0,xMax:r,yMin:0,yMax:a})}))}(e,{diceParentElement:We.current.querySelector(".area")}),_e(e)}}),r.createElement(g,{nextRoundPermission:Ge,nextRound:function(){m(t),M([]),N([]),X([]),ae(-1),fe(!1),ue(!1),he(!1),ve(0)}})),r.createElement(y,{ref:We,diceArray:C,keepDiceAllowed:De,keepDice:function(e){if(e.symbol===d){"witch"===$.type&&($.effectUsed=!1);var t=[].concat(f(O),[e]);X(t)}else{var n=[].concat(f(A),[e]);N(n)}var r=C.filter((function(t){return t!==e}));M(r)}}),r.createElement(h,{diceArray:A,unkeepDiceAllowed:Re,unkeepDice:ze}),r.createElement(w,{diceCursed:O,canRemoveSkull:qe,removeSkull:function(e){return ze(e)}}),r.createElement(E,{rollIndex:re,isOnSkullIsland:pe,roundScore:be,markScorePermission:Xe,markScore:Je}),r.createElement(v,{totalScore:B}))})),function(e){var t=r.useRef();return r.useEffect((function(){t.current=e})),t.current})}}}));
//# sourceMappingURL=MilleSabordGameBoard-9d75ec6f.js.map
