System.register(["./app.js"],(function(e,t){"use strict";var r,n,a,l,o,s,c,i,d,u,m,f,p,h,g,E,v,y,b,C,N,k,x,S,w,R,D,A,I,O,M,L,P,q,T,j,$,B,F,U,z,G,W,Y,Z,H,K,X,J,V,_,Q,ee,te,re,ne,ae,le,oe,se,ce,ie,de,ue,me,fe,pe,he,ge,Ee,ve,ye,be,Ce,Ne,ke,xe,Se,we,Re;return{setters:[function(e){r=e._,n=e.l,a=e.a,l=e.b,o=e.u,s=e.s,c=e.c,i=e.d,d=e.e,u=e.i,m=e.f,f=e.S,p=e.g,h=e.h,g=e.j,E=e.k,v=e.m,y=e.n,b=e.o,C=e.p,N=e.q,k=e.r,x=e.t,S=e.v,w=e.w,R=e.x,D=e.y,A=e.z,I=e.A,O=e.B,M=e.C,L=e.D,P=e.E,q=e.F,T=e.G,j=e.H,$=e.I,B=e.J,F=e.K,U=e.L,z=e.M,G=e.N,W=e.O,Y=e.P,Z=e.Q,H=e.R,K=e.T,X=e.U,J=e.V,V=e.W,_=e.X,Q=e.Y,ee=e.Z,te=e.$,re=e.a0,ne=e.a1,ae=e.a2,le=e.a3,oe=e.a4,se=e.a5,ce=e.a6,ie=e.a7,de=e.a8,ue=e.a9,me=e.aa,fe=e.ab,pe=e.ac,he=e.ad,ge=e.ae,Ee=e.af,ve=e.ag,ye=e.ah,be=e.ai,Ce=e.aj,Ne=e.ak,ke=e.al,xe=e.am,Se=e.an,we=e.ao,Re=e.ap}],execute:function(){const De=new Map,Ae="loading",Ie="loaded",Oe="failed",Me=function(e){let{lazy:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=De.get(e),l=a?Ie:Ae,[o,s]=r.useState(l),c=r.useRef(!1);r.useEffect((()=>(c.current=!0,()=>{c.current=!1})),[]);const i=r.useCallback((async()=>{if(o!==Ie)try{const t=await n(e);if(!c.current)return void console.log("image unmounted");De.set(e,t),s(Ie)}catch(t){if(!c.current)return;De.delete(e),s(Oe)}}),[s,e]);return r.useEffect((()=>{t||i()}),[t]),[o,i]},Le=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],{layout:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=r.useRef(!0);(n?r.useLayoutEffect:r.useEffect)((()=>{if(!a.current)return e();a.current=!1}),t)},Pe=(e,t)=>{const r=qe(e,t);return Boolean(r)},qe=(e,t)=>{const n=r.useRef(!1);r.useEffect((()=>{!1===n.current&&(n.current=!0)}));const a=r.useRef(t);return r.useEffect((()=>{a.current=t}),t),n.current&&e(...a.current)?{from:a.current,to:t}:null},Te=e=>{const t=r.useRef(e);return r.useEffect((()=>{t.current=e}),[e]),t.current},je=["loadWhenIntersecting","usePlaceholderWhileLoading","animateLoaded","intersectionRoot","intersectionRootMargin","intersectionThreshold","FallbackWhileNotIntersecting","FallbackWhileLoading","useImageStatusHook","src"],$e=e=>{let{loadWhenIntersecting:t=!0,usePlaceholderWhileLoading:n=!0,animateLoaded:s=!0,intersectionRoot:c,intersectionRootMargin:i,intersectionThreshold:d,FallbackWhileNotIntersecting:u=Ue,FallbackWhileLoading:m=Fe,useImageStatusHook:f=Me,src:p}=e,h=l(e,je);const[g,E]=f(p,{lazy:t}),v=Te(g),[y,b]=o(p);r.useEffect((()=>{"loading"!==v&&"loading"===g&&y(),"loaded"!==v&&"loaded"===g&&b()}),[v,g]);const[C,N]=(e=>{let{root:t,rootMargin:n,threshold:a=0}=e;const[l,o]=r.useState(!1),s=r.useRef();return r.useEffect((()=>{const e=s.current;if(!e)return null;if(l)return null;const r=new window.IntersectionObserver((t=>{let[n]=t;n.isIntersecting?(r.unobserve(e),o(!0)):o(!1)}),{root:t,rootMargin:n,threshold:a});return r.observe(e),()=>{r.disconnect()}}),[l]),[s,l]})({root:c,rootMargin:i,threshold:d}),k=Te(N);r.useEffect((()=>{t&&!k&&N&&E()}),[t,k,N]);const[x,S]=Be();return r.useLayoutEffect((()=>{s&&"loaded"!==v&&"loaded"===g&&S()}),[s,v,g]),t&&"loaded"!==g&&!N?r.createElement(u,{ref:C}):n&&"loaded"!==g?r.createElement(m,null):r.createElement("img",a({src:p,ref:x},h))},Be=()=>{const e=r.useRef(),t=r.useCallback((()=>{const t=e.current,r=window.getComputedStyle(t).getPropertyValue("opacity");t.animate([{opacity:0},{opacity:r}],{duration:300})}));return[e,t]},Fe=r.forwardRef(((e,t)=>r.createElement("img",a({src:ze,ref:t},e)))),Ue=r.forwardRef(((e,t)=>r.createElement("img",a({src:ze,ref:t},e)))),ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",Ge=()=>r.createElement(We,null),We=()=>{const e=Ye();return r.createElement("div",{className:"new-game"},r.createElement($e,{src:s}),r.createElement("button",{onClick:e},"Nouvelle partie"))},Ye=c((e=>i(i({},e),{},{gameCreated:!0}))),Ze=(e,t)=>{if(e&&"symbol"===e.type)return e.value;if(e&&"dice"===e.type){const r=t[e.value];return d(r)}return null},He=e=>{let{card:t,symbolsInChest:r,scoreMarked:n,markScoreAllowed:a}=e;return u(t)?n||a?Ke(r,{goal:t.numberOfSwords,gamble:t.gambleAmount}):-t.gambleAmount:m(t)?Je(r.map((e=>e===f?p:e))):h(t)?2*Je(r):g(t)||E(t)?Je(r,9):Je(r)},Ke=(e,t)=>{let{goal:r,gamble:n}=t;return Xe(e,b)>=r?Je(e)+n:-n},Xe=(e,t)=>e.filter((e=>e===t)).length,Je=(e,t)=>{const{score:r,perfectBonus:n}=Ve(e,t);return r+n},Ve=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=0,n=0;const a=_e(e);return Object.values(a).forEach((e=>{3===e&&(r+=100),4===e&&(r+=200),5===e&&(r+=500),6===e&&(r+=1e3),7===e&&(r+=2e3),8===e&&(r+=4e3),e>2&&(n+=e)})),e.forEach((e=>{e===v&&(r+=100,a[v]<3&&(n+=1)),e===y&&(r+=100,a[y]<3&&(n+=1))})),{score:r,perfectBonus:n===t?500:0}},_e=e=>{const t={};return e.forEach((e=>{t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},{useMemo:Qe}=r,et=function(){let{currentPlayerId:e=C(),players:t=N()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.find((t=>t.id===e))},tt=function(){let{rollCount:e=w()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===e},rt=function(){let{rollCount:e=w()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>0},nt=function(){let{dices:e=R(),chestSlots:t=D()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).reduce(((r,n)=>{const a=Ze(t[n],e);return a?[...r,a]:r}),[])},at=function(){let{skullCountInCursedArea:e=dt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 3-e},lt=function(){let{dicesToCurse:e=ot()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.length>0},ot=function(){let{dices:e=R(),diceRolledIds:t=A(),witchUncursedDiceId:r=I(),remainingSpotInCursedArea:n=at()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=t.map((t=>e[t])).filter((e=>!!O(e)&&e.id!==r)).slice(0,n);return a},st=function(){let{currentCardId:e=L(),hasNeverRolled:t=tt(),scoreMarked:r=j(),threeSkullsOrMoreInCursedArea:n=it(),hasDicesToCurse:a=lt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!e&&(!r&&(!!t||(n?!!$(k(e)):!a)))},ct=function(){let{dicesToCurse:e=ot(),skullCountInCursedArea:t=dt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=e.length,n=r+t;return n},it=function(){let{skullCountInCursedArea:e=dt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>2},dt=function(){let{diceCursedIds:e=M(),symbolsFromCard:t=ut()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.length+t.filter((e=>x(e))).length},ut=function(){let{currentCardId:e=L()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)return[];const t=k(e);return g(t)?[y]:E(t)?[v]:P(t)?[q]:T(t)?[q,q]:[]},mt=function(){let{scoreMarked:e=j(),currentCardId:t=L(),threeSkullsOrMoreInCursedArea:r=it(),hasDicesToCurse:n=lt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e&&(r?!!$(k(t)):!n&&!!t)},ft=function(){let{currentCardId:e=L(),symbolsInChest:t=nt(),scoreMarked:r=j(),markScoreAllowed:n=mt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qe((()=>He({card:k(e),symbolsInChest:t,scoreMarked:r,markScoreAllowed:n})),[e,t,r,n])},pt=()=>{const e=L(),t=k(e),r=nt(),n=Xe(r,b),a=ht();return!!u(t)&&n<a},ht=function(){let{currentCardId:e=L()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=k(e);return u(t)?t.numberOfSwords:null},gt=c(((e,t)=>i(i({},e),{},{currentPlayerId:t.id,currentCardId:null,currentCardActivated:!1,roundStarted:!0},Ct))),Et=c((e=>i(i({},e),{},{currentCardId:null,currentCardActivated:!1,roundStarted:!1}))),vt=c((e=>i(i({},e),{},{currentCardActivated:!0}))),yt=c((e=>i(i({},e),{},{isOnSkullIsland:!0}))),bt=c(((e,t)=>{const{players:r,currentPlayerId:n}=e,a=r.find((e=>{let{id:t}=e;return t===n})),l=a.score+t;return a.score=l<0?0:l,i(i({},e),{},{players:[...r],scoreMarked:!0})})),Ct={witchUncursedDiceId:null,witchCardEffectUsed:!1,rollCount:0,diceRolledIds:[],diceCursedIds:[],chestSlots:{1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null},scoreMarked:!1,isOnSkullIsland:!1},Nt=c(((e,t,r,n)=>{let{x:a,y:l}=r;const{dices:o}=e;return t.rolledAreaPosition={x:a,y:l},t.rolledAreaZIndex=n,i(i({},e),{},{dices:i({},o)})})),kt=c(((e,t,r)=>{const{chestSlots:n}=e,a=Object.keys(n).find((e=>{const r=n[e];return r&&"dice"===r.type&&r.value===t.id}));return i(i({},e),{},{chestSlots:i(i(i({},n),a?{[a]:null}:{}),{},{[r]:{type:"dice",value:t.id}})})})),xt=c(((e,t)=>{const{diceRolledIds:r,diceCursedIds:n}=e;return i(i({},e),{},{diceRolledIds:r.filter((e=>e!==t.id)),diceCursedIds:[...n,t.id]})})),St=c((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{diceRolledIds:n,diceCursedIds:a}=e;return i(i(i({},e),r?{}:{witchUncursedDiceId:t.id,witchCardEffectUsed:!0}),{},{diceRolledIds:[...n,t.id],diceCursedIds:a.filter((e=>e!==t.id))})})),wt=c(((e,t)=>{const{diceRolledIds:r,chestSlots:n}=e,a=Object.keys(n).find((e=>{const r=n[e];return r&&"dice"===r.type&&r.value===t.id}));return i(i({},e),{},{diceRolledIds:[...r,t.id],chestSlots:i(i({},n),{},{[a]:null})})})),Rt=c(((e,t,r)=>{const{diceRolledIds:n,chestSlots:a}=e;return i(i({},e),{},{diceRolledIds:n.filter((e=>e!==t.id)),chestSlots:i(i({},a),{},{[r]:{type:"dice",value:t.id}})})})),{useEffect:Dt}=r,At=()=>(It(),null),It=()=>{Ot(),Mt(),Lt()},Ot=()=>{const e=B(),t=ot(),r=xt();Dt((()=>{if(0===t.length)return()=>{};if(e)return t.forEach((e=>{r(e)})),()=>{};const n=setTimeout((()=>{t.forEach((e=>{r(e)}))}),1e3);return()=>{clearTimeout(n)}}),[t])},Mt=()=>{const e=k(L()),t=j(),r=bt(),n=it(),a=Pe((e=>!e&&n),[n]),l=ft(),o=u(e);Dt((()=>{o&&!t&&a&&r(l)}),[o,t,a,l])},Lt=()=>{const e=function(){let{rollCount:e=w()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1===e}(),t=k(L()),r=F(),n=dt(),a=yt();Dt((()=>{e&&(r||u(t)||n<4||a())}),[e,r,t,n])},Pt=c((e=>{const{cardIds:t,cardUsedIds:r}=e,n=t[0];return i(i({},e),{},{cardIds:t.slice(1),cardUsedIds:[...r,n],currentCardId:n})})),qt=c((e=>{const{chestSlots:t}=e;return i(i({},e),{},{chestSlots:i(i({},t),{},{1:{type:"symbol",value:y}})})})),Tt=c((e=>{const{chestSlots:t}=e;return i(i({},e),{},{chestSlots:i(i({},t),{},{1:{type:"symbol",value:v}})})})),jt=c((e=>{const{cardIds:t,cardUsedIds:r}=e;return i(i({},e),{},{cardIds:U([...t,...r]),cardUsedIds:[]})})),$t=()=>(Bt(),Ft(),null),Bt=()=>{const e=qt(),t=L(),n=z(),a=Pe((e=>!e===n),[n]),l=t&&g(k(t));r.useEffect((()=>{l&&e()}),[]),r.useEffect((()=>{a&&l&&e()}),[a,l])},Ft=()=>{const e=Tt(),t=L(),n=z(),a=Pe((e=>!e===n),[n]),l=t&&E(k(t));r.useEffect((()=>{l&&e()}),[]),r.useEffect((()=>{a&&l&&e()}),[a,l])},Ut=()=>{const[e]=r.useState((()=>(()=>{let e=[];return{listen:function(t){let{once:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r){const e=t;t=function(){a(),e(...arguments)}}e=[...e,t];let n=!1;const a=()=>{if(n)return;n=!0;const r=[];let a=e.length,l=!0;for(;a--;){const n=e[a];l&&n===t?l=!1:r.push(n)}e=r};return a},emit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e.forEach((e=>{e(...r)}))}}})()));return[e.listen,e.emit]},zt=e=>{const[t,n]=r.useState();return r.useEffect((()=>e(n)),[]),t},Gt=e=>{let{rolledAreaRef:t,offscreenRef:n,diceOverRolledAreaListener:a}=e;const l=zt(a);return r.createElement("div",{className:"dice-ongoing"},r.createElement("div",{className:"map"}),r.createElement("div",{className:"area",ref:t,style:i({},l?{outline:"2px dotted"}:{})}),r.createElement("div",{className:"offscreen-area",ref:n}))},Wt=e=>{let{duration:t=300,timingFunction:r=(e=>e),onProgress:n=(()=>{}),onCancel:a=(()=>{}),onComplete:l=(()=>{})}=e;if(isNaN(t))return console.warn(`duration must be a number, received ${t}`),()=>{};t=parseInt(t,10);const o=performance.now();let s,c=!1,i=0,d=0;const u=()=>{s=null;const e=performance.now();i=Math.min((e-o)/t,1),d=r(i),c=1===i,n({done:c,rawProgress:i,progress:d}),c?l():s=window.requestAnimationFrame(u)};u();return()=>{s&&(window.cancelAnimationFrame(s),s=null),c||(c=!0,a({rawProgress:i,progress:d}))}},Yt=function(e){let{duration:t=300,timingFunction:n,condition:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[l,o]=r.useState(null);return Zt(e,((e,r)=>(o({value:e}),Wt({duration:t,timingFunction:n,onProgress:t=>{let{progress:n}=t;const a=Math.round(e+(r-e)*n);o({value:a})},onComplete:()=>{o(null)}}))),{condition:a}),l},Zt=function(e,t){let{condition:n=(()=>!0)}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[a,l]=r.useState(null),o=Te(e);r.useEffect((()=>{o!==e&&n(e,o)&&l({from:o,to:e})}),[o,e]),r.useEffect((()=>a?t(a.from,a.to):()=>{}),[a])},Ht=e=>{let{value:t,duration:r,condition:n}=e;const a=Yt(t,{duration:r,condition:n});return a?a.value:t},Kt=["useCount"],Xt=["useCount"],Jt=e=>{let{href:t,onLoad:n=(()=>{})}=e;const[a,l]=o(t);return r.useEffect((()=>(a(),Vt(t,{onload:()=>{l(),n()}}))),[t]),null},Vt=(e=>{const t=new Map,r=e=>{if(!t.has(e))return;const r=t.get(e),{useCount:n}=r,a=l(r,Kt);n>1?t.set(e,i({useCount:n-1},a)):(t.delete(e),a.linkCleanup())};return function(n){if(t.has(n)){const e=t.get(n),{useCount:a}=e,o=l(e,Xt);return t.set(n,i({useCount:a+1},o)),r}for(var a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];const c=e(n,...o);return t.set(n,{useCount:1,linkCleanup:c}),r}})((function(e){let{onload:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=document.createElement("link");r.rel="stylesheet",r.type="text/css";const n=G(r,t);return r.href=e,document.head.appendChild(r),()=>{n(),document.head.removeChild(r)}})),_t=(e,t)=>{const r=er(e,e);let{done:n,value:a}=r.next();for(;!1===n;){if(t(a))return a;({done:n,value:a}=r.next())}return null},Qt=function e(t,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n){const e=t.firstChild;if(e)return e}const a=t.nextSibling;if(a)return a;const l=t.parentNode;return l&&l!==r?e(l,r,!0):null},er=(e,t)=>{let r=e;return{next:()=>{const e=Qt(r,t);return r=e,{done:!1===Boolean(e),value:e}}}},tr=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,a=!1;const l=()=>{const e=Qt(n,t,r&&!1===a);return a=!0,n=e,{done:!1===Boolean(e),value:e}};return{next:l}},rr=e=>{let t=e.lastChild;for(;t;){const e=t.lastChild;if(!e)break;t=e}return t},nr=(e,t)=>{let r=e;return{next:()=>{const e=((e,t)=>{const r=e.previousSibling;if(r){return rr(r)||r}if(e!==t){const r=e.parentNode;if(r&&r!==t)return r}return null})(r,t);return r=e,{done:!1===Boolean(e),value:e}}}},ar=e=>{const t=_t(e,W);return t||(W(e)?e:null)},lr=e=>{if(3===e.nodeType)return console.warn("cannot trap focus inside a text node"),()=>{};if(cr.find((t=>t.element===e)))return console.warn("focus already trapped inside this element"),()=>{};const t=()=>_t(e,or),r=()=>((e,t)=>{const r=rr(e);if(r){const n=nr(r,e);let{done:a,value:l}=n.next();for(;!1===a;){if(t(l))return l;({done:a,value:l}=n.next())}}return null})(e,or),n=()=>(e=>{let{from:t,root:r=null,predicate:n}=e;const a=nr(t,r);let{done:l,value:o}=a.next();for(;!1===l;){if(n(o))return o;({done:l,value:o}=a.next())}return null})({from:document.activeElement,root:e,predicate:or})||r(),a=()=>(e=>{let{from:t,root:r=null,predicate:n,skipChildren:a=!1}=e;const l=tr(t,r,a);let{done:o,value:s}=l.next();for(;!1===o;){if(n(s))return s;({done:o,value:s}=l.next())}return null})({from:document.activeElement,root:e,predicate:or})||t(),l=ir({element:e,lock:()=>{const l=t=>{(t=>t.target!==e&&!e.contains(t.target))(t)&&(t.preventDefault(),t.stopImmediatePropagation())},o=e=>{sr(e)&&(e.preventDefault(),(e=>{const l=document.activeElement===document.body;if(e.shiftKey){const e=l?r():n();e&&e.focus()}else{const e=l?t():a();e&&e.focus()}})(e))};return document.addEventListener("mousedown",l,{capture:!0,passive:!1}),document.addEventListener("keydown",o,{capture:!0,passive:!1}),()=>{document.removeEventListener("mousedown",l,{capture:!0,passive:!1}),document.removeEventListener("keydown",o,{capture:!0,passive:!1})}}});return()=>{l()}},or=e=>!(e=>e.hasAttribute&&e.hasAttribute("tabIndex")&&Number(e.getAttribute("tabindex"))<0)(e)&&W(e),sr=e=>"Tab"===e.key||9===e.keyCode,cr=[],ir=e=>{let t,{lock:r}=e;cr.length>0&&(t=cr[cr.length-1],t.unlock());const n={lock:r,unlock:r()};return cr.push(n),()=>{if(0===cr.length)return void console.warn("cannot deactivate an already deactivated trap");const e=cr[cr.length-1];n===e?(cr.pop(),n.unlock(),t&&(t.unlock=t.lock())):console.warn("you must deactivate trap in the same order they were activated")}},dr=e=>{const t=[],r=e=>{const n=ur(e);if(n){if(t.push(n),n===document)return;r(n)}};return r(e),t},ur=e=>{if("object"!=typeof e||1!==e.nodeType)throw new TypeError("getScrollableParent first argument must be DOM node");const t=e;if(t===document.documentElement)return null;return"fixed"===Y(t,"position")?mr(t.ownerDocument):Nr(t)||mr(t.ownerDocument)},mr=e=>{if("scrollingElement"in e)return e.scrollingElement;if(Er(e))return e.documentElement;const t=e.body,r=t&&!/body/i.test(t.tagName)?fr(t):t;return r&&hr(r)?null:r},fr=e=>{let t=e;for(;t=t.nextSibling;)if(1===t.nodeType&&pr(t))return t;return null},pr=e=>e.ownerDocument.body===e,hr=e=>{if(!yr(e))return!1;if(gr(e))return!1;const t=e.ownerDocument.documentElement;return!!yr(t)&&!gr(t)},gr=e=>{const t=Y(e,"display");return"none"!==t&&("table-row"!==t&&"table-group"!==t&&"table-column"!==t||"collapsed"!==Y(e,"visibility"))},Er=e=>!!/^CSS1/.test(e.compatMode)&&vr(e),vr=e=>{const t=e.createElement("iframe");t.style.height="1px";(e.body||e.documentElement||e).appendChild(t);const r=t.contentWindow.document;r.write('<!DOCTYPE html><div style="height:9999em">x</div>'),r.close();const n=r.documentElement.scrollHeight>r.body.scrollHeight;return t.parentNode.removeChild(t),n},yr=e=>!br(e)||!Cr(e),br=e=>{if("visible"===Y(e,"overflow-x"))return!0;return"visible"===Y(e,"overflow")},Cr=e=>{if("visible"===Y(e,"overflow-y"))return!0;return"visible"===Y(e,"overflow")},Nr=e=>{if(e===document.documentElement)return null;const t=Y(e,"position");let r=e.parentNode;for(;r;){if(Z(r))return null;if("absolute"!==t||"static"!==Y(r,"position")){if(yr(r))return r;r=r.parentNode}else r=r.parentNode}return null},kr=["container","insertTop","insertLeft","insertRight","insertBottom","children","isOpen","requestCloseOnEscape","requestCloseOnClickOutside","closeMethod","stealFocus","restoreStolenFocus","trapFocus","onAfterOpen","onRequestClose","onFocusIn","onFocusOut","backdropProps"],xr=["onMouseDownActive"],Sr=new URL(System.resolve("./assets/dialog.base.css",t.meta.url)),{useEffect:wr}=r,Rr=e=>{let{container:t=document.body,insertTop:n,insertLeft:o,insertRight:s,insertBottom:c,children:d,isOpen:u,requestCloseOnEscape:m=!0,requestCloseOnClickOutside:f=!1,closeMethod:p="display-none",stealFocus:h=!0,restoreStolenFocus:g=!0,trapFocus:E=!0,onAfterOpen:v=(()=>{}),onRequestClose:y=(()=>{}),onFocusIn:b=(()=>{}),onFocusOut:C=(()=>{}),backdropProps:N={}}=e,k=l(e,kr);if(!t)return null;const[x,S]=r.useState(null),w=Boolean(x);return Pe((e=>!e&&u),[u])&&v(),wr((()=>{if(!u||!w)return()=>{};let e=Ar(x);const t=t=>{t.relatedTarget||e&&(e=!1,C(t))},r=t=>{b(t),e=!0},n=t=>{Ar(x)?e=!0:(e=!1,C(t))};return x.addEventListener("focus",r,!0),document.addEventListener("focus",n,!0),document.addEventListener("blur",t,!0),()=>{x.removeEventListener("focus",r,!0),document.removeEventListener("focus",n,!0),document.removeEventListener("blur",t,!0)}}),[u,w,b,C]),wr((()=>u&&w?(e=>{const t=[];let r=e.previousSibling;for(;r;)1===r.nodeType&&yr(r)&&t.push(r),r=r.previousSibling;const n=dr(e);t.push(...n);const a=t.map((e=>{const t=e.style.overflow;return e.style.overflow="hidden",()=>{t?e.style.overflow=t:e.style.removeProperty("overflow")}}));return()=>{a.forEach((e=>{e()}))}})(x):()=>{}),[u,w]),wr((()=>u&&w&&E?lr(x):()=>{}),[u,w,E]),wr((()=>{if(!u||!w||!h)return()=>{};const e=document.activeElement,t=ar(x);return t&&t.focus({preventScroll:!0}),()=>{t&&("function"==typeof g?g(e):!0===g&&e.focus({preventScroll:!0}))}}),[u,w,h]),wr((()=>{if(!u||!x||!x.parentNode)return()=>{};const e=[];return Array.from(x.parentNode.children).forEach((t=>{t!==x&&e.push(t)})),e.forEach((e=>{e.setAttribute("aria-hidden","true")})),()=>{e.forEach((e=>{e.removeAttribute("aria-hidden","true")}))}}),[u,x]),"dom-remove"!==p||u?H.createPortal(r.createElement("div",a({},k,{role:"dialog",className:"dialog--root"+(k.className?` ${k.className}`:""),ref:e=>{S(e),k.ref&&k.ref(e)},onKeyDown:e=>{m&&e.keyCode===Ir&&y(e),k.onKeyDown&&k.onKeyDown(e)},tabIndex:"-1",style:i(i({},"display-none"!==p||u?{}:{display:"none"}),"visibility-hidden"!==p||u?{}:{visibility:"hidden"}),hidden:"hidden-attribute"===p&&!u||void 0}),r.createElement(Jt,{href:Sr}),u?r.createElement(Dr,a({},N,{className:"dialog--backdrop",onMouseDownActive:e=>{if(e.preventDefault(),!Ar(x)){const e=ar(x);e&&e.focus({preventScroll:!0})}},onClick:e=>{f&&y(e),N.onClick&&N.onClick(e)}})):null,r.createElement("div",{className:"dialog--document"},r.createElement("div",{className:"dialog--insert-top"},n),r.createElement("div",{className:"dialog--main"},r.createElement("div",{className:"dialog--insert-left"},o),r.createElement("div",{className:"dialog--scrollable-content"},d),r.createElement("div",{className:"dialog--insert-right"},s)),r.createElement("div",{className:"dialog--insert-bottom"},c))),t):null},Dr=e=>{let{onMouseDownActive:t}=e,n=l(e,xr);const[o,s]=r.useState(null);return wr((()=>o?(o.addEventListener("mousedown",t,{passive:!1}),()=>{o.removeEventListener("mousedown",t,{passive:!1})}):()=>{}),[o]),r.createElement("div",a({ref:e=>{s(e),n.ref&&n.ref(e)}},n))},Ar=e=>{const{activeElement:t}=document;return e===t||e.contains(t)},Ir=27,Or=new URL(System.resolve("./assets/dialog.css",t.meta.url)),Mr=e=>r.createElement(r.Fragment,null,r.createElement(Jt,{href:Or}),r.createElement(Rr,a({container:K()},e))),Lr=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const[t,n]=r.useState(e),a=()=>{n(!0)},l=()=>{n(!1)};return[t,a,l]},Pr=()=>r.createElement("div",{className:"star-rain-container"},r.createElement("div",{className:"star",id:"star-01"},r.createElement(qr,null)),r.createElement("div",{className:"star",id:"star-02"},r.createElement(qr,null)),r.createElement("div",{className:"star",id:"star-03"},r.createElement(qr,null)),r.createElement("div",{className:"star",id:"star-04"},r.createElement(qr,null)),r.createElement("div",{className:"star",id:"star-05"},r.createElement(qr,null)),r.createElement("div",{className:"star",id:"star-06"},r.createElement(qr,null))),qr=()=>r.createElement("svg",{viewBox:"0 0 217.791 210.633"},r.createElement("path",{fill:"#FFFFE6",d:"M94.15,77.97c0,0-2-54,10-73.5s23,28.5,25.5,72.5c0,0,69.197,4.589,86.5,21c13.637,12.934-61.5,31-87,33.5 c-2,14.5-1.831,60.464-16.5,75.5c-20,20.5-25.5-50.5-23-78c-19-1.5-81.5-3.5-89-17.5S52.15,85.97,94.15,77.97z"})),Tr=()=>r.createElement("svg",{viewBox:"0 0 320 512",width:"32",heiht:"32"},r.createElement("path",{fill:"currentColor",d:"M207.6 256l107.72-107.72c6.23-6.23 6.23-16.34 0-22.58l-25.03-25.03c-6.23-6.23-16.34-6.23-22.58 0L160 208.4 52.28 100.68c-6.23-6.23-16.34-6.23-22.58 0L4.68 125.7c-6.23 6.23-6.23 16.34 0 22.58L112.4 256 4.68 363.72c-6.23 6.23-6.23 16.34 0 22.58l25.03 25.03c6.23 6.23 16.34 6.23 22.58 0L160 303.6l107.72 107.72c6.23 6.23 16.34 6.23 22.58 0l25.03-25.03c6.23-6.23 6.23-16.34 0-22.58L207.6 256z"})),jr=["title","spacingClasses","children"],$r=e=>{let{title:t,spacingClasses:n,children:o}=e,s=l(e,jr);return r.createElement(Mr,a({requestCloseOnClickOutside:!0,insertTop:r.createElement(r.Fragment,null,r.createElement("div",{className:"dialog-border-top"}),r.createElement("div",{className:"dialog-title"},r.createElement("div",{className:"dialog-title-text"},t)),r.createElement("div",{className:"dialog-close",onClick:s.onRequestClose},r.createElement(Tr,null))),insertBottom:r.createElement("div",{className:"dialog-border-bottom"}),insertLeft:r.createElement("div",{className:"dialog-border-left"}),insertRight:r.createElement("div",{className:"dialog-border-right"})},s,{className:`dialog-theme-wood ${n||"dialog-spacing-10 dialog-spacing-fluid dialog-spacing-top-fixed"} ${s.className}`}),o)},Br=e=>{let{dialogIsOpen:t,closeDialog:n}=e;return r.createElement($r,{className:"score-rules-dialog",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0,title:"Score",spacingClasses:"dialog-spacing-10 dialog-spacing-fixed"},r.createElement(r.Fragment,null,r.createElement("div",{className:"dialog-box"},r.createElement("div",{className:"dialog-label"},"Combinaisons de dés"),r.createElement("div",{className:"columns"},r.createElement("div",{className:"column"},r.createElement("div",{className:"column-title"},"Symbols identiques"),r.createElement("span",{className:"symbol-number"},"Combo 3"),r.createElement("span",{className:"symbol-number"},"Combo 4"),r.createElement("span",{className:"symbol-number"},"Combo 5"),r.createElement("span",{className:"symbol-number"},"Combo 6"),r.createElement("span",{className:"symbol-number"},"Combo 7"),r.createElement("span",{className:"symbol-number"},"Combo 8")),r.createElement("div",{className:"column"},r.createElement("div",{className:"column-title"},"Points"),r.createElement("span",{className:"points"},"100"),r.createElement("span",{className:"points"},"200"),r.createElement("span",{className:"points"},"500"),r.createElement("span",{className:"points"},"1000"),r.createElement("span",{className:"points"},"2000"),r.createElement("span",{className:"points"},"4000")))),r.createElement("div",{className:"dialog-box"},r.createElement("div",{className:"dialog-label"},"Dés spéciaux"),r.createElement("div",{className:"columns"},r.createElement("div",{className:"column"},r.createElement("div",{className:"column-title"},"Symbol"),r.createElement($e,{src:X}),r.createElement($e,{src:J})),r.createElement("div",{className:"column"},r.createElement("div",{className:"column-title"},"Points"),r.createElement("span",{className:"points"},"100"),r.createElement("span",{className:"points"},"100")))),r.createElement("div",{className:"dialog-box last"},r.createElement("div",{className:"dialog-label"},"Bonus coffre parfait"),r.createElement("div",{className:"columns"},r.createElement("div",{className:"column"},r.createElement("div",{className:"column-title"},"Dés utilisés"),r.createElement("span",{className:"symbol-number"},"8")),r.createElement("div",{className:"column"},r.createElement("div",{className:"column-title"},"Points"),r.createElement("span",{className:"points"},"500"))))))},Fr=["id","value"],Ur=(e,t,r)=>{const n=Gr(r),a=Math.cos(n),l=Math.sin(n),o=t.x-e.x,s=t.y-e.y;return{x:Math.round(a*o+l*s+e.x),y:Math.round(a*s-l*o+e.y)}},zr=e=>{let[t,r,n,a]=e;return{x:(t.x+r.x+n.x+a.x)/4,y:(t.y+r.y+n.y+a.y)/4}},Gr=e=>e*Math.PI/180,Wr=(e,t)=>!!Yr(t,(t=>((e,t)=>{let[r,n]=e,[a,l]=t,o=(l.x-a.x)*(r.y-a.y)-(l.y-a.y)*(r.x-a.x),s=(n.x-r.x)*(r.y-a.y)-(n.y-r.y)*(r.x-a.x);const c=(l.y-a.y)*(n.x-r.x)-(l.x-a.x)*(n.y-r.y);return(0!==o||0!==s||0!==c)&&(0!==c&&(o/=c,s/=c,o>=0&&o<=1&&s>=0&&s<=1))})(e,t))),Yr=(e,t)=>{let[r,n,a,l]=e;if(t([r,n]))return!0;if(t([n,a]))return!0;if(t([a,l]))return!0;return!!t([l,r])},Zr=(e,t)=>{let r=e.left,n=e.right;const a=n-r;r<t.left?(r=t.left,n=r+a):n>t.right&&(r=t.right-a,n=r+a);let l=e.top,o=e.bottom;const s=o-l;return l<t.top?(l=t.top,o=l+s):o>t.bottom&&(l=t.bottom-s,o=l+s),{left:r,right:n,top:l,bottom:o}},Hr=e=>{let{left:t,right:r,top:n,bottom:a}=e;return{x:t+(r-t)/2,y:n+(a-n)/2}},Kr=(e,t)=>((e,t)=>{const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)})(Hr(e),Hr(t)),Xr=e=>{const t=e.getBoundingClientRect(),r=V(e),n=t.left+r.x,a=t.top+r.y,l=n+t.width,o=a+t.height;return{left:Math.floor(n),top:Math.floor(a),right:Math.floor(l),bottom:Math.floor(o)}},Jr=(e,t)=>{const r=Xr(e);return a=t,!((n=r).right<=a.left||n.left>=a.right||n.bottom<=a.top||n.top>=a.bottom);var n,a},Vr=(e,t)=>{const r=e.map((e=>Xr(e))),n=((e,t)=>{let r=Kr(t,e[0]);return e.reduce(((e,n)=>{const a=Kr(t,n);return a<r?(r=a,n):e}))})(r,t);return e[r.indexOf(n)]},_r=function(e){let{x:t,y:r}=e,{color:n="yellow",autoRemove:a=!0,autoRemoveAfter:l=2e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=document.createElement("div");o.style.position="absolute",o.style.zIndex="1000",o.style.left=`${t}px`,o.style.top=`${r}px`,o.style.width="5px",o.style.height="5px",o.style.background=n,o.style.border="1px solid red",document.body.appendChild(o);const s=()=>{document.body.removeChild(o)};let c;return a&&(c=setTimeout(s,l)),()=>{s(),clearTimeout(c)}},Qr=e=>{let{totalScoreDomNodeRef:t,scoreParticle:n,animationDelayGetter:a=(()=>0)}=e;return"bonus"===n.type?r.createElement(en,{totalScoreDomNodeRef:t,scoreParticle:n,animationDelayGetter:a}):"combo"===n.type?r.createElement(tn,{scoreParticle:n,animationDelayGetter:a}):r.createElement(rn,{scoreParticle:n,animationDelayGetter:a})},en=e=>{let{totalScoreDomNodeRef:t,scoreParticle:n,animationDuration:a=800,animationDelayGetter:l}=e;const o=_(n.symbol),s=r.useRef();return r.useEffect((()=>{const e=s.current,r=t.current,o=on(document.querySelector(`[data-chest-slot="${n.chestSlot}"]`));return nn({particleDomNode:e,totalScoreDomNode:r,x:o.x,y:o.y,duration:a,delay:l(),onfinish:n.onfinish,oncancel:n.oncancel})}),[]),r.createElement("svg",{ref:s,width:"32",height:"32",className:"score-particle--symbol"},r.createElement("image",{href:o,width:"32",height:"32"}),",")},tn=e=>{let{scoreParticle:t,animationDuration:n=800,animationDelayGetter:a}=e;const[l,o]=ln();return r.useEffect((()=>{const e=l.current,r=on(document.querySelector(".chest .box"));return an({particleDomNode:e,x:r.x,y:r.y,duration:n,delay:a(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),r.createElement("svg",{ref:l,className:"score-particle--perfect"},r.createElement("g",{ref:o},r.createElement("text",{x:"0",y:"0",dominantBaseline:"text-before-edge"},"Combo ",t.symbolCount)))},rn=e=>{let{scoreParticle:t,animationDuration:n=800,animationDelayGetter:a}=e;const[l,o]=ln();return r.useEffect((()=>{const e=l.current,r=on(document.querySelector(".chest .box"));return an({particleDomNode:e,x:r.x,y:r.y,duration:n,delay:a(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),r.createElement("svg",{ref:l,className:"score-particle--combo"},r.createElement("g",{ref:o},r.createElement("text",{x:"0",y:"0",dominantBaseline:"text-before-edge"},"Coffre parfait")))},nn=e=>{let{particleDomNode:t,totalScoreDomNode:r,x:n,y:a,duration:l,delay:o,onfinish:s=(()=>{}),oncancel:c=(()=>{})}=e;const i=Xr(t),d=Xr(r),u=i.right-i.left,m=i.bottom-i.top,f=n-u/2,p=a-m/2,h=f,g=p-1.1*m,E=d.left,v=d.top;t.style.left=`${f}px`,t.style.top=`${p}px`;const y=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.6,opacity:1,transform:`translate(${h-f}px, ${g-p}px)`},{transform:`translate(${E-f}px, ${v-p}px)`}],{duration:l,delay:o,fill:"forwards"});return y.onfinish=()=>{s()},()=>{c(),y.cancel()}},an=e=>{let{particleDomNode:t,x:r,y:n,duration:a,delay:l,onfinish:o=(()=>{}),oncancel:s=(()=>{})}=e;const c=Xr(t),i=r-(c.right-c.left)/2,d=n-(c.bottom-c.top)/2;t.style.left=`${i}px`,t.style.top=`${d}px`;const u=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.4,opacity:1,transform:"scale(1.2)"},{}],{duration:a,delay:l,fill:"forwards"});return u.onfinish=()=>{o()},()=>{s(),u.cancel()}},ln=()=>{const e=r.useRef(),t=r.useRef();return r.useLayoutEffect((()=>{const r=e.current,n=t.current.getBBox();r.setAttribute("width",Math.ceil(n.width)),r.setAttribute("height",Math.ceil(n.height))}),[]),[e,t]},on=e=>{const t=Xr(e);return Hr(t)},sn=e=>{let{addScoreParticle:t}=e;const r=D(),n=R(),a=pt();Object.keys(r).forEach((e=>{const l=r[e],o=Ze(l,n),s=o&&re(o);Le((()=>{if(!a&&s)return t({id:`chest-slot-${e}-coin`,type:"bonus",value:100,symbol:y,chestSlot:e})}),[a,s])}))},cn=e=>{let{addScoreParticle:t}=e;const r=D(),n=R(),a=pt();Object.keys(r).forEach((e=>{const l=r[e],o=Ze(l,n),s=o&&ne(o);Le((()=>{if(!a&&s)return t({id:`chest-slot-${e}-diamond`,type:"bonus",value:100,symbol:v,chestSlot:e})}),[a,s])}))},dn=e=>{let{addScoreParticle:t}=e;const n=D(),a=R(),l=pt(),o=r.useMemo((()=>{const e=[];Object.keys(n).forEach((t=>{const r=n[t];if(!r)return;"dice"===r.type&&e.push(Ze(r,a))}));const{perfectBonus:t}=Ve(e);return Boolean(t)}),[n,a]);Le((()=>{if(!l&&o)return t({id:"perfect",type:"perfect",value:500})}),[l,o])},un=e=>{let{addScoreParticle:t}=e;const n=D(),a=R(),l=L(),o=k(l),s=pt();Q.forEach((e=>{const l=[];Object.keys(n).forEach((t=>{const r=n[t],s=Ze(r,a);s&&mn(s,e,o)&&l.push(t)}));const c=l.length,i=fn[c]||0,d=r.useRef(i),u=r.useRef((()=>{}));Le((()=>{const r=d.current,n=Boolean(r&&i&&r<i),a=Boolean(r&&i&&r>i);if(d.current=i,m(o)&&te(e))return;if(s)return;if(!i)return;if(a)return void u.current();n&&u.current();const f=t({id:`${c}-${e}-combo`,type:"combo",value:i-r,symbol:e,symbolCount:c});u.current=f;const p=l.map((e=>{const t=(document.querySelector(`[data-chest-slot="${e}"] image`)||document.querySelector(`[data-chest-slot="${e}"] img`)).animate([{transform:"scale(1)",transformOrigin:"center center"},{transform:"scale(1.2)",transformOrigin:"center center"},{transform:"scale(1)",transformOrigin:"center center"}],{duration:400});return()=>{t.cancel()}}));return()=>{f(),p.forEach((e=>{e()}))}}),[s,o,i])}))},mn=(e,t,r)=>{if(e===t)return!0;if(m(r)){if(ee(e)&&te(t))return!0;if(te(e)&&ee(t))return!0}return!1},fn={3:100,4:200,5:500,6:1e3,7:2e3,8:4e3},{useState:pn,useEffect:hn}=r,gn=()=>{const e=k(L()),t=En();return r.createElement("div",{className:"score-area "+(t?"animated":"")},e?r.createElement(vn,null):null)},En=()=>{const e=k(L()),t=nt(),r=Xe(t,b),n=ht();if(!u(e))return!1;return!(r>=n)},vn=()=>{const e=k(L()),t=j(),n=En(),[a,l,o]=Lr(),s=B();return r.createElement(r.Fragment,null,h(e)?r.createElement(xn,null):null,t?r.createElement(Pr,null):null,r.createElement("button",{className:"round-score "+(n?"hidden":""),onClick:l},s?r.createElement(Cn,null):r.createElement(yn,null)),u(e)?r.createElement(Sn,null):null,r.createElement(Br,{dialogIsOpen:a,closeDialog:o}))},yn=()=>{const e=ft(),t=r.useRef(),[n,a]=Ut(),[o,s,c]=function(){let{totalScore:e=0,onScoreParticleAdded:t=(()=>{}),onScoreParticleRemoved:n=(()=>{}),onScoreParticleMerged:a=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[o,s]=r.useState(e),[c,d]=r.useState([]);r.useEffect((()=>{s(e)}),[e]);const u=e=>{d((t=>[...t,e])),t(e);let r=!1;return()=>{r||(r=!0,d((t=>t.filter((t=>t!==e)))),s((t=>t-e.value)),n(e))}},m=e=>{let{id:t,value:r}=e,n=l(e,Fr);const o=i(i({id:t,value:r},n),{},{oncancel:()=>{c()},onfinish:()=>{c(),a(o),s((e=>e+r))}}),c=u(o);return c},f=c.reduce(((e,t)=>e+t.value),0);return[c,m,o-f]}({totalScore:e,onScoreParticleMerged:a});(e=>{let{addScoreParticle:t}=e;sn({addScoreParticle:t}),cn({addScoreParticle:t}),un({addScoreParticle:t}),dn({addScoreParticle:t})})({addScoreParticle:s}),Nn({roundScoreDomNodeRef:t,scoreParticleMergedListener:n});const d=r.useRef(null),u=()=>{const e=d.current,t=bn(e,600);return d.current=Date.now()+t,t};return r.createElement(r.Fragment,null,r.createElement("span",{ref:t,className:"round-score--value"},r.createElement(Ht,{value:c,condition:(e,t)=>e>t,duration:600})),o.map((e=>r.createElement(Qr,{key:e.id,totalScoreDomNodeRef:t,scoreParticle:e,animationDelayGetter:u}))))},bn=(e,t)=>{if(!e)return 0;const r=t-(Date.now()-e);return r<=0?0:r},Cn=()=>{const e=ft();return r.createElement("span",{className:"round-score--value"},e)},Nn=e=>{let{roundScoreDomNodeRef:t,scoreParticleMergedListener:n}=e;const a=zt(n);r.useEffect((()=>{if(!a)return;const e=t.current;return kn({roundScoreDomNode:e})}),[a])},kn=e=>{let{roundScoreDomNode:t,duration:r=500,easing:n="ease-in-out"}=e;const a=t.animate([{transform:"scale(1.8)"}],{duration:r,easing:n});return()=>{a.cancel()}},xn=()=>z()?r.createElement("div",{className:"pirate-hook"}):r.createElement("div",{style:{display:"none"},className:"pirate-hook"}),Sn=()=>{const e=ft(),t=nt(),n=Xe(t,b),a=ht(),l=new Array(a).fill(""),o=n>=a,s=Pe((e=>e<n),[n]),[c,i]=pn(!1);return hn((()=>{s&&i(!0)}),[s]),hn((()=>{if(c){const e=setTimeout((()=>{i(!1)}),300);return()=>{clearTimeout(e)}}return()=>{}}),[c]),r.createElement(r.Fragment,null,r.createElement("div",{className:"ropes "+(o?"challenge-won":"")},l.map(((e,t)=>n>=t+1?r.createElement("div",{key:t,className:`rope rope-${t+1} cut-rope`}):r.createElement("div",{key:t,className:`rope rope-${t+1}`})))),c&&n<=a?r.createElement("div",{className:"sword-slice"},r.createElement("div",{className:"triangle-left"}),r.createElement("div",{className:"triangle-right"})):null,r.createElement("div",{className:`negative-round-score rotate-${n} ${o?"removed":""}`},e))},wn=50,Rn=new URL(System.resolve("./assets/cursed-grid.png",t.meta.url)),Dn=e=>{let{chestRef:t,diceOverChestListener:n}=e;const a=D(),l=it(),o=zt(n),s=k(L()),c=l&&$(s);return r.createElement("div",{className:"chest"},r.createElement("div",{ref:t,className:"dice-area "+($(s)?"glow":""),style:i({},o?{outline:"2px dotted"}:{})},r.createElement("div",{className:"box"},Object.keys(a).map((e=>r.createElement("div",{className:"slot",key:e,"data-chest-slot":e},r.createElement(An,{chestSlotContent:a[e]}))))),r.createElement("div",{className:"top-left-corner"}),r.createElement("div",{className:"top-right-corner"}),r.createElement("div",{className:"bottom-left-corner"}),r.createElement("div",{className:"bottom-right-corner"}),l&&!c?r.createElement(In,null):null),r.createElement(gn,null))},An=e=>{let{chestSlotContent:t}=e;const n=k(L());if(!t)return null;if("symbol"===t.type){const e=t.value;return r.createElement("button",{className:"dice",style:{width:wn,height:wn,color:"#eaeaea",margin:"5px",backgroundColor:n.color1,borderColor:n.color2,borderWidth:"2px",borderStyle:"solid"}},r.createElement($e,{src:_(e),draggable:"false",style:{width:"100%",height:"100%"}}))}return null},In=()=>r.createElement("div",{className:"cursed-cover"},r.createElement($e,{draggable:"false",src:Rn,alt:"cursed-cover"})),On={animals:{name:"Animaux",rule:"Les singes et les perroquest obtenus sur les dés comptent comme un même symbol dans une combinaison.",more:"Par exemple 2 perroquets et 3 singes forment une conbinaison de 5 dés identiques, soit 500 points."},chest:{name:"Coffre au trésor",rule:'Lorsque le joueur sauvegarde ses dés, grâce à la carte "Coffre au trésor" les dés sont protégés du mauvais sort.',more:"Ainsi même lorsque le joueur obtient 3 têtes de morts, son tour prends fin, mais il peut marquer les points totalisés grâce aux dés sauvegardés!"},coin:{name:"Pièce d'or",rule:"Le joueur commence son tour avec un symbol pièce d'or. Il rapporte des points aussi bien dans une combinaison de dés que comme simple pièce (+100)."},diamond:{name:"Diamant",rule:"Le joueur commence son tour avec un symbol diamant. Il rapporte des points aussi bien dans une combinaison de dés que comme simple diamant (+100)."},pirate:{name:"Capitaine des pirates",rule:"Grâce à l'aide du capitaine, tous les points comptabilisés pendant ce tour sont doublés !"},witch:{name:"Sorcière",rule:"Avec ses potions magiques, la sorcière permet exceptionnellement au joueur de relancer, une fois, un dé avec une tête de mort."},"1skull":{name:"Tête de mort",rule:"Le tour du joueur débute avec un symbole tête de mort."},"2skulls":{name:"2 têtes de mort",rule:"Le tour du joueur débute avec 2 symboles tête de mort."},"2sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 2 symbols sabres. Si il y parvient, il gagne +300 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -300 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"3sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 3 symbols sabres. Si il y parvient, il gagne +500 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -500 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"4sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 4 symbols sabres. Si il y parvient, il gagne +1000 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -1000 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."}},Mn=e=>{let{dialogIsOpen:t,closeDialog:n,card:a}=e;const l=On[a.type];return r.createElement($r,{className:"card-rules-dialog",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0,title:"Carte"},l?r.createElement(r.Fragment,null,r.createElement("div",{className:"dialog-label"},l.name),r.createElement("div",{style:{textAlign:"center"}},r.createElement($e,{className:"current-card",src:ae(a),width:"150",alt:a.type})),r.createElement("div",{className:"text-rule"},l.rule),l.more?r.createElement("div",{className:"text-rule"},l.more):null):"No rule")},Ln=["card"],Pn=r.forwardRef(((e,t)=>{let{card:n}=e,o=l(e,Ln);return r.createElement("div",a({className:"card current-card",ref:t,width:"55",height:"55",style:{backgroundColor:n.color1,borderColor:n.color2}},o),r.createElement($e,{src:le(n),alt:n.type,width:"55",height:"55"}))})),qn=new URL(System.resolve("./assets/swords-disabled.png",t.meta.url)),Tn=()=>{const e=L(),t=nt(),n=ht();if(!e)return null;const a=k(e);if(!u(a))return null;const l=Xe(t,b),o=new Array(n).fill("");return r.createElement("div",{className:"sword-challenge-indicators"},o.map(((e,t)=>l>=t+1?r.createElement(jn,{key:t}):r.createElement($n,{key:t}))))},jn=()=>r.createElement("div",{className:"sword-icon"},r.createElement($e,{src:s})),$n=()=>r.createElement("div",{className:"sword-icon disabled"},r.createElement($e,{src:qn})),Bn=e=>{let{openScoreboard:t,headerSmallCardRef:n}=e;const a=k(L()),l=z();return r.createElement("div",{className:"header"},r.createElement("div",{className:"card-container",style:{opacity:l?"1":"0"}},r.createElement("div",{className:"small-card"},a?r.createElement(Fn,{headerSmallCardRef:n,currentCard:a}):r.createElement(Un,null)),l&&r.createElement(Tn,null)),r.createElement(zn,{openScoreboard:t}),r.createElement(Gn,null))},Fn=e=>{let{headerSmallCardRef:t,currentCard:n}=e;const[a,l]=r.useState(!1);return r.createElement(r.Fragment,null,r.createElement(Pn,{onClick:()=>{l(!0)},card:n,ref:t}),r.createElement(Mn,{card:n,dialogIsOpen:a,closeDialog:()=>{l(!1)}}))},Un=()=>r.createElement("div",{className:"card default-card",style:{backgroundImage:`url(${oe})`,backgroundSize:"217px"}}),zn=e=>{let{openScoreboard:t}=e;const n=et();return r.createElement($e,{onClick:t,className:"avatar",src:n&&n.character.img,alt:"player",style:{borderColor:n&&n.character.color||"white"},width:"55",height:"55"})},Gn=()=>{const e=et(),t=e.score,n=Yt(t,{duration:1200,timingFunction:e=>1-Math.pow(1-e,5)});return r.createElement("div",{className:"total-score"},r.createElement("span",{className:"score",style:{backgroundColor:e&&e.character.color||"white"}},n?n.value:t))},Wn=6.25,Yn=(e,t)=>{let{rolledAreaDomNode:r}=t;const n=Xr(r),a=n.right-n.left,l=n.bottom-n.top,o={left:Wn,right:a-56.25,top:Wn,bottom:l-56.25},s=[],c=e=>{let t=0;const r=()=>{const n=Zn(e,o),a=Hn(),l=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zr(e);return e.map((e=>Ur(r,e,t)))}(n,a);return!s.some((e=>{return t=e,Yr(l,(e=>Wr(e,t)));var t}))||t>50?{rectangle:n,rotation:a,rotatedRectangle:l}:(t++,r())};return r()};return e.forEach(((e,t)=>{e.visibleFaceIndex=Kn(e);const{rectangle:r,rotation:n,rotatedRectangle:a}=c(e);s.push(a),e.rolledAreaZIndex=t+1,e.rolledAreaPosition=r[0],e.rotation=n})),e},Zn=(e,t)=>{const r={x:Xn(t.left,t.right),y:Xn(t.top,t.bottom)};return[{x:r.x,y:r.y},{x:r.x+wn,y:r.y},{x:r.x+wn,y:r.y+wn},{x:r.x,y:r.y+wn}]},Hn=()=>Xn(-35,35),Kn=e=>Xn(0,e.faces.length-1),Xn=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),Jn=e=>{let{rolledAreaRef:t}=e;const n=st(),a=A(),l=tt(),o=Vn(),s=k(L()),c=it(),i=a.length<2&&!l,d=c&&$(s),u=i||d;return n?r.createElement("div",{className:"roll-action"},r.createElement("button",{onClick:()=>{o(t.current)},disabled:u},"Lancer",i&&!d&&r.createElement("span",{className:"button-subtitle"},"(au moins 2 dés !)")),d&&r.createElement($e,{src:se,className:"skull-symbol"})):null},Vn=c(((e,t)=>{const{dices:r,rollCount:n,diceRolledIds:a}=e,l=(0===n?Object.keys(r):a).map((e=>r[e]));return Yn(l,{rolledAreaDomNode:t}),i(i({},e),{},{rollCount:n+1,witchUncursedDiceId:null,diceRolledIds:l.map((e=>e.id)),dices:i({},r)})})),_n=e=>{let{onRoundOver:t,rolledAreaRef:n}=e;return r.createElement("div",{className:"footer actions"},r.createElement(Jn,{rolledAreaRef:n}),r.createElement(Qn,null),r.createElement(ea,{onRoundOver:t}))},Qn=()=>{const e=ft(),t=bt(),n=mt(),a=function(){let{hasRolledOnce:e=rt(),scoreMarked:t=j(),currentCardId:r=L(),hasDicesToCurse:n=lt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!(t||n||!r||!e)}(),l=e<0?"-":"+";return a?r.createElement("div",{className:"collect-action"},r.createElement("button",{onClick:()=>{t(e)},disabled:!n},r.createElement("span",null,"Collecter"),r.createElement("span",{className:"score"},l," ",Math.abs(e))),!n&&r.createElement($e,{src:se,className:"skull-symbol"})):null},ea=e=>{let{onRoundOver:t}=e;const n=function(){let{rollDiceAllowed:e=st(),markScoreAllowed:t=mt(),hasDicesToCurse:r=lt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e&&!t&&!r}(),a=Et(),l=ft(),o=it(),s=pt(),c=nt();return n?r.createElement("div",{className:"next-round-action"},r.createElement("button",{onClick:()=>{a(),t({reason:o?"3-skulls":s?"chalenge-failed":"user-collect",value:l,symbolsInChest:c})}},"Terminer mon tour")):null},ta=new URL(System.resolve("./assets/witch-label.png",t.meta.url)),ra=e=>{let{cursedAreaRef:t}=e;const n=k(L());return r.createElement("div",{className:"skull-island"},ce(n)?r.createElement(aa,null):null,r.createElement("div",{className:"bottle"},r.createElement("div",{className:"area",ref:t},P(n)?r.createElement(na,{card:n}):null,T(n)?r.createElement(r.Fragment,null,r.createElement(na,{card:n}),r.createElement(na,{card:n})):null)))},na=e=>{let{card:t}=e;return r.createElement("button",{className:"dice",style:{width:wn,height:wn,color:"#eaeaea",margin:"1px 5px",backgroundColor:t.color1,borderColor:t.color2,borderWidth:"2px"}},r.createElement($e,{src:se,style:{width:"100%",height:"100%"}}))},aa=()=>z()?r.createElement("div",{className:"witch-label"},r.createElement($e,{src:ta}),r.createElement("svg",{x:"0px",y:"0px",width:"156.083px",height:"208.667px",viewBox:"0 0 156.083 208.667"},r.createElement("path",{id:"path_01",fill:"none",stroke:"#E4AD30",d:"M8.406,107.82 c2.541,2.178,2.375,2.875,14.25,3.5c14.782,0.778,19.26-11.965,19.26-11.965S47.918,88,40.251,72.917s-18.916,4.583-9.083,8.167 s27.759-1.338,35.142-12.417C74.75,56,77.583,45.333,79.25,37S78.477,15.833,66.31,3.833"}),r.createElement("path",{id:"path_02",fill:"none",stroke:"#E4AD30",d:"M44.031,110.094 c0,0,1,1.313-4.438,3.344s-14.244,7.281-32.125-2"}),r.createElement("path",{id:"path_03",fill:"none",stroke:"#E4AD30",d:"M42.125,103.688 c0,0,1.313,6.594-9.313,8.625S10.281,108.719,9.406,101"}),r.createElement("path",{id:"path_04",fill:"none",stroke:"#E4AD30",d:"M33.114,112.253c0,0,39.886-19.253,43.011,24.747 c0.372,0.447-0.959,1.208-2.542,1.625"}))):r.createElement($e,{style:{display:"none"},src:ta}),la=e=>{let{parent:t,children:n}=e;return t?H.createPortal(r.createElement(r.Fragment,null,n),t):null},oa=e=>{let{rotate:t,scale:r,translate:n}=e;return[...t?[`rotate(${t}deg)`]:[],...r&&1!==r?[`scale(${r})`]:[],...n?[`translate(${n})`]:[]].join("")},sa=function(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,{trailing:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const l=function l(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];clearTimeout(t);const i=Date.now();if(r){const o=i-r;if(o<n){if(a){t=setTimeout((()=>l(...s)),n-o)}}else r=i,e(...s)}else r=i,e(...s)},o=()=>{clearTimeout(t)};return l.cancel=o,l},ca=(e,t)=>{let{logLevel:r="warn",onGrip:n=(()=>{}),onLongGrip:a=(()=>{}),onClick:l=(()=>{}),onDrag:o=(()=>{}),onRelease:s=(()=>{}),onCancel:c=(()=>{}),longGripMs:d=300}=t;const u=ie({logLevel:r});let m,f,p=!1,h=()=>{},g=()=>{},E=()=>{};u.debug("enable drag on",e);const v=de(e,"dragstart",(e=>{e.preventDefault()})),y=de(e,"mousedown",(e=>{if(3===e.which)return void u.debug("ignore right click");R(da(e),e);const t=sa((e=>{A(da(e),e)}));E=()=>t.cancel(),h=de(document,"mousemove",t),g=de(document,"mouseup",(e=>{g(),h(),I(da(e),e)}))}),{passive:!0}),b=de(e,"touchstart",(e=>{R(ua(e),e);const t=sa((e=>{A(ua(e),e)}));E=()=>t.cancel(),h=de(document,"touchmove",t),g=de(document,"touchend",(e=>{g(),h(),I(ua(e),e)}))}),{passive:!0}),C=de(e,"click",(e=>{p||"none"!==w||l(e)}));let N,k,x,S,w;const R=(t,r)=>{u.debug("gripping node at",t),f=!0,w="none",x=t,N=t,k=ia(e),n({x:k.x,y:k.y,event:r}),S=setTimeout(D,d)},D=()=>{p=!0,a()},A=(e,t)=>{if(N.x===e.x&&N.y===e.y)return void u.debug("no real move");N=e;const r=x.x-k.x,n=x.y-k.y,a={x:e.x-r,y:e.y-n},l=e.x-x.x,s=e.y-x.y;u.debug("move node at",a),o(i(i({event:t},a),{},{relativeX:l,relativeY:s,setDropEffect:e=>{w=e}}))},I=(e,t)=>{u.debug("releasing node"),f=!1,clearTimeout(S);const r=x.x-k.x,n=x.y-k.y;s({event:t,dropEffect:w,x:N.x-r,y:N.y-n}),m=setTimeout((()=>{p=!1}))};return e=>{v(),C(),y(),b(),h(),g(),clearTimeout(S),clearTimeout(m),E(),(e=>{f&&(u.debug("cancelling drag",e),f=!1,c({event:e}))})(e)}},ia=e=>{const t=e.getBoundingClientRect();return{x:t.left,y:t.top}},da=e=>({x:e.pageX,y:e.pageY}),ua=e=>{const t=e.changedTouches[0];return{x:t.pageX,y:t.pageY}},{useEffect:ma,useState:fa}=r,pa=e=>{let{dice:t,diceAnimation:n,anmationDebug:a=!1,parentNode:l,zIndex:o,x:s,y:c,rotation:i,draggable:u,onDiceClick:m,onDiceDrag:f,onDiceDrop:p,onDiceDragEnd:h,disapear:g,appear:E,traceUpdate:v=!1}=e;const y=K(),b=ue(t.id),C=me(t.id),N=function(){let{chestSlots:e=D()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce(((t,r)=>{const n=e[r];return n&&"dice"===n.type?[...t,n.value]:t}),[])}(),k=N.includes(t.id),[x,S]=fa(!1),[w,R]=fa(null),A=Te(l),I=n?A:l;ma((()=>{if(!u||!b||!y)return()=>{};let e=!1;const r=ca(b,{onGrip:()=>{S(!0)},onClick:e=>{m(t,e)},onDrag:r=>{let{x:n,y:a,relativeX:l,relativeY:o,setDropEffect:s}=r;const c=((e,t)=>{const r=Xr(t);return Zr(e,r)})({left:n,right:n+wn,top:a,bottom:a+wn},y);R({x:c.left,y:c.top}),e=e||Math.abs(l)>10||Math.abs(o)>10,e&&f(t,{relativeX:l,relativeY:o,setDropEffect:s,diceRectangle:c})},onRelease:e=>{let{dropEffect:r,x:n,y:a}=e;if("none"!==r){p(t,{diceRectangle:{left:n,right:n+wn,top:a,bottom:a+wn}})}S(!1),R(null),h(t)},onCancel:()=>{S(!1),R(null),h(t)}});return()=>{r()}}),[u,b,y,m,f,p,h]),ma((()=>{if(!n||!b)return()=>{};const{from:e,to:t,onfinish:r}=n;a&&(_r(e),_r(t));const l=`translate(${Math.floor(t.x-e.x)}px, ${Math.floor(t.y-e.y)}px)`,o=b.parentNode.animate([{transform:l}],{duration:500,fill:"forwards",easing:"cubic-bezier(0, 0.55, 0.45, 1)"});return o.onfinish=r,()=>{o.cancel()}}),[b,n]);const M=O(t),L=n&&n.from?n.from.x:w?w.x:s,P=n&&n.from?n.from.y:w?w.y:c,q=w||n?1e3:o;return r.createElement(la,{parent:I},r.createElement("svg",{"data-dice-id":t.id,className:"dice",onClick:u?void 0:e=>{m(t,e)},style:{width:wn,height:wn,left:`${L}px`,top:`${P}px`,zIndex:q,cursor:u?x?"grabbing":"grab":void 0,position:w||n?"fixed":void 0}},r.createElement("g",{ref:C,className:g?"dice-cursed-disapear":E?"dice-cursed-appear":"",style:{transform:oa({rotate:i||0,scale:x?"1.1":"1"}),transitionProperty:"transform",transitionDuration:"500ms",transitionTimingFunction:"cubic-bezier(0, 0.55, 0.45, 1)",transformOrigin:"center center"}},r.createElement("rect",{className:"dice-background",width:"100%",height:"100%",rx:"5",ry:"5",fill:ha(M,k).fill,stroke:ha(M,k).stroke,strokeWidth:"1"}),r.createElement("image",{href:_(d(t)),draggable:"false",style:{width:"100%",height:"100%"}}))))},ha=(e,t)=>e?{fill:"black",stroke:"black"}:t?{fill:"none",stroke:"none"}:{fill:"#eaeaea",stroke:"#b9b9b9"},ga=e=>{let{offscreenDomNode:t,chestDomNode:n,rolledAreaDomNode:a,cursedAreaDomNode:l,onDiceOverChestChange:o=(()=>{}),onDiceOverRolledAreaChange:s=(()=>{})}=e;const c=R(),d=D(),u=A(),m=M(),f=I(),p=fe(),h=k(L()),g=j(),E=function(){let{cursedCount:e=ct()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>2}(),v=lt(),[y,b]=r.useReducer(((e,t)=>i(i({},e),{},{[t.key]:t.value})),{}),C=Nt(),N=Rt(),x=wt(),S=St(),w=kt(),P=r.useRef(null);return Object.keys(c).map((e=>{const k=c[e],R=La(k,{chestSlots:d,diceRolledIds:u,diceCursedIds:m}),D=Pa(R,{chestDomNode:n,rolledAreaDomNode:a,cursedAreaDomNode:l,offscreenDomNode:t}),{parentNode:A}=D,I=k.id!==f&&A===a&&O(k),M=A===l,L=ba(k,u),q=r.useCallback((e=>{const t=Ea(e,{currentCard:h,witchCardEffectUsed:p,diceIsInRolledArea:L,diceIsInCursedArea:M,chestSlots:d,hasDicesToCurse:v,threeSkullsOrMore:E,scoreMarked:g});if("keep"===t){const t=Aa(d);N(e,t)}else"unkeep"===t?x(e):"uncurse"===t&&S(e)}),[L,M,d,g,E,h,p]),T=r.useCallback(((e,t)=>{P.current=ya({dragDiceGesture:t,chestDomNode:n,rolledAreaDomNode:a});const r=va(e,{diceIsInRolledArea:L,chestSlots:d,dropTargetRef:P,rolledAreaDomNode:a,chestDomNode:n,hasDicesToCurse:v,threeSkullsOrMore:E,scoreMarked:g});t.setDropEffect(r),o("keep"===r?e:null),s("unkeep"===r?e:null)}),[L,d,P,a,n,g,E,o,s]),j=r.useCallback(((e,t)=>{const r=va(e,{diceIsInRolledArea:L,chestSlots:d,dropTargetRef:P,rolledAreaDomNode:a,chestDomNode:n,scoreMarked:g,threeSkullsOrMore:E});let l=!1,o=null;if("reposition-in-rolled-area"===r){const r=Ra(t.diceRectangle,a),n=Da(e,{dices:c,diceRolledIds:u});C(e,r,n)}else if("back-to-rolled-area"===r)l=!0,o=Sa(e.rolledAreaPosition,a);else if("keep"===r){const r=Ia(e,{chestSlots:d,rectangle:t.diceRectangle,chestDomNode:n});N(e,r),l=!0,o=wa(r,n)}else if("reposition-in-chest"===r){const r=Ia(e,{chestSlots:d,rectangle:t.diceRectangle,chestDomNode:n});Oa(e,d)!==r&&(w(e,r),l=!0,o=wa(r,n))}else if("back-to-chest"===r){const t=Oa(e,d);l=!0,o=wa(t,n)}else if("unkeep"===r){const r=Ra(t.diceRectangle,a);C(e,r,Da(e,{dices:c,diceRolledIds:u})),x(e),l=!0,o=Sa(r,a)}l&&b({key:e.id,value:{from:{x:t.diceRectangle.left,y:t.diceRectangle.top},to:o,onfinish:()=>{setTimeout((()=>{b({key:e.id,value:null})}))}}})}),[L,d,P,a,n,g,E]),$=r.useCallback((()=>{o(null),s(null)}),[o,s]),B=i(i({key:k.id},D),{},{dice:k,diceAnimation:y[k.id],witchCardEffectUsed:p,disapear:I,appear:M,onDiceClick:q,onDiceDrag:T,onDiceDrop:j,onDiceDragEnd:$});return r.useMemo((()=>r.createElement(pa,B)),Object.keys(B).map((e=>B[e])))}))},Ea=(e,t)=>{let{currentCard:r,witchCardEffectUsed:n,diceIsInRolledArea:a,diceIsInCursedArea:l,chestSlots:o,hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i}=t;return a?Na(e,{hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i})?"keep":"none":Ca(e,o)?ka(e,{threeSkullsOrMore:c,scoreMarked:i})?"unkeep":"none":l&&xa(e,{currentCard:r,witchCardEffectUsed:n,scoreMarked:i,threeSkullsOrMore:c})?"uncurse":"none"},va=(e,t)=>{let{diceIsInRolledArea:r,chestSlots:n,dropTargetRef:a,rolledAreaDomNode:l,chestDomNode:o,hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i}=t;return r?a.current===l?"reposition-in-rolled-area":a.current===o&&Na(e,{hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i})?"keep":"back-to-rolled-area":Ca(e,n)?a.current===o?"reposition-in-chest":a.current===l&&ka(e,{scoreMarked:i,threeSkullsOrMore:c})?"unkeep":"back-to-chest":"none"},ya=e=>{let{dragDiceGesture:t,chestDomNode:r,rolledAreaDomNode:n}=e;if(Jr(r,t.diceRectangle))return r;return Jr(n,t.diceRectangle)?n:null},ba=(e,t)=>t.includes(e.id),Ca=(e,t)=>Object.keys(t).some((r=>{const n=t[r];return n&&"dice"===n.type&&n.value===e.id})),Na=(e,t)=>{let{hasDicesToCurse:r,threeSkullsOrMore:n,scoreMarked:a}=t;return!O(e)&&(!r&&(!n&&!a))},ka=(e,t)=>{let{scoreMarked:r,threeSkullsOrMore:n}=t;return!r&&!n},xa=(e,t)=>{let{currentCard:r,witchCardEffectUsed:n,scoreMarked:a,threeSkullsOrMore:l}=t;return!!ce(r)&&(!n&&(!a&&!l))},Sa=(e,t)=>{const r=((e,t)=>{const r=Xr(t),n=e.right-e.left,a=e.bottom-e.top;return{left:r.left+e.left,top:r.top+e.top,right:r.left+e.left+n,bottom:r.top+e.top+a}})({left:e.x,top:e.y,right:0,bottom:0},t);return{x:r.left,y:r.top}},wa=(e,t)=>{const r=Ma(e,t),n=Xr(r);return{x:n.left+5,y:n.top+5}},Ra=(e,t)=>{const r=((e,t)=>{const r=Xr(t),n=((e,t)=>{const r=e.left-t.left,n=r+(e.right-e.left),a=e.top-t.top;return{left:r,right:n,top:a,bottom:a+(e.bottom-e.top)}})(Zr(e,r),r);return n})(e,t);return{x:r.left,y:r.top}},Da=(e,t)=>{let{diceRolledIds:r,dices:n}=t;if(0===r.length)return 1;const a=r.slice(1).reduce(((e,t)=>{const r=n[t];return r.rolledAreaZIndex>e.rolledAreaZIndex?r:e}),n[r[0]]);return a===e?e.rolledAreaZIndex:a.rolledAreaZIndex+1},Aa=e=>Object.keys(e).find((t=>!e[t])),Ia=(e,t)=>{let{chestSlots:r,rectangle:n,chestDomNode:a}=t;const l=new Map,o=[];Object.keys(r).forEach((t=>{const n=r[t];if(!n||"dice"===n.type&&n.value===e.id){const e=Ma(t,a);l.set(e,t),o.push(e)}}));const s=Vr(o,n);return l.get(s)},Oa=(e,t)=>Object.keys(t).find((r=>{const n=t[r];return n&&"dice"===n.type&&n.value===e.id})),Ma=(e,t)=>t.querySelector(`[data-chest-slot="${e}"]`),La=(e,t)=>{let{chestSlots:r,diceRolledIds:n,diceCursedIds:a}=t;const l=Object.keys(r).find((t=>r[t]&&"dice"===r[t].type&&r[t].value===e.id));return l?{type:"chest-slot",value:l}:n.includes(e.id)?{type:"rolled-area",value:i(i({},e.rolledAreaPosition),{},{rotation:e.rotation,zIndex:e.rolledAreaZIndex})}:a.includes(e.id)?{type:"cursed-area",value:void 0}:{type:"offscreen-area"}},Pa=(e,t)=>{let{type:r,value:n}=e,{chestDomNode:a,rolledAreaDomNode:l,cursedAreaDomNode:o,offscreenDomNode:s}=t;return"chest-slot"===r?{parentNode:a.querySelector(`[data-chest-slot="${n}"]`),zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!0}:"rolled-area"===r?{parentNode:l,zIndex:n.zIndex,rotation:n.rotation,x:n.x,y:n.y,draggable:!0}:"cursed-area"===r?{parentNode:o,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}:{parentNode:s,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}},qa=e=>{let{dialogIsOpen:t,closeDialog:n,headerSmallCardRef:a}=e;const l=function(){let{cardIds:e=S()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.map((e=>k(e)))}(),o=L(),s=k(o)||null,c=r.useRef(),i=r.useRef(),d=r.useRef();return r.createElement(Mr,{className:"draw-card-dialog dialog-spacing-10 dialog-spacing-fluid",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!1},r.createElement("div",{className:"dialog-content"},r.createElement("div",{className:"dialog-body"},r.createElement("div",{className:"dialog-label"},0===l.length&&!s&&"Paquet de cartes épuisé. Mélangez-le pour pouvoir piocher à nouveau !",0!==l.length&&!s&&"Piochez une carte pour le tour suivant.",s&&r.createElement("span",{className:"card-name"},On[s.type].name)),r.createElement("div",{className:"card-area"},r.createElement("div",{style:{position:"relative"}},r.createElement(Ta,{backCardRef:c,currentCard:s,remainingCardCount:l.length}),r.createElement(ja,{topCardRef:i,smallCardRef:d,currentCard:s})))),r.createElement("div",{className:"dialog-actions"},r.createElement($a,{backCardRef:c,cardDeck:l,currentCard:s}),s?r.createElement(za,{headerSmallCardRef:a,smallCardRef:d,backCardRef:c,topCardRef:i,currentCard:s,closeDialog:n}):null)))},Ta=e=>{let{backCardRef:t,currentCard:n,remainingCardCount:a}=e;return r.createElement("div",{ref:t,className:"card default-card",style:{background:"none"}},r.createElement($e,{src:oe,width:"150"}),n?null:r.createElement("div",{className:"remaining-cards-number"},a))},ja=e=>{let{topCardRef:t,smallCardRef:n,currentCard:a}=e;return a?r.createElement(r.Fragment,null,r.createElement("div",{className:"card current-card",ref:t},r.createElement("div",{className:"flip-card"},r.createElement("div",{className:"flip-card-inner"},r.createElement("div",{className:"flip-card-front"},r.createElement($e,{className:"card default-card",src:oe})),r.createElement("div",{className:"flip-card-back"},r.createElement($e,{className:"card-img",src:ae(a),width:"150",alt:a.type}))))),r.createElement("div",{className:"small-card"},r.createElement(Pn,{card:a,ref:n}))):null},$a=e=>{let{backCardRef:t,cardDeck:n,currentCard:a}=e;return a?null:0===n.length?r.createElement(Fa,{backCardRef:t}):r.createElement(Ba,null)},Ba=()=>{const e=Pt();return r.createElement("button",{className:"button-card-main button-draw-card",onClick:e},"Piocher")},Fa=e=>{let{backCardRef:t}=e;const n=B(),a=jt(),[l,o]=r.useState(!1);return r.useEffect((()=>l?(a(),n?(o(!1),()=>{}):Ua({backCard:t.current,duration:1e3,onfinish:()=>{o(!1)}})):()=>{}),[l]),r.createElement("button",{className:"button-card-main button-shuffle-deck",onClick:()=>{o(!0)}},"Mélanger")},Ua=e=>{let{backCard:t,duration:r,onfinish:n}=e;t.setAttribute("shaking-deck","");const a=setTimeout((()=>{t.removeAttribute("shaking-deck",""),n()}),r);return()=>{t.removeAttribute("shaking-deck",""),clearTimeout(a)}},za=e=>{let{headerSmallCardRef:t,smallCardRef:n,backCardRef:a,topCardRef:l}=e;const o=B(),s=vt(),[c,i]=r.useState(!1);return r.useEffect((()=>c?o?(s(),()=>{}):Ga({headerSmallCard:t.current,smallCard:n.current,backCard:a.current,topCard:l.current,duration:500,onfinish:()=>{s()}}):()=>{}),[c]),r.createElement("button",{className:"button-card-main button-activate-card",onClick:()=>{c||i(!0)}},"Commencer")},Ga=e=>{let{headerSmallCard:t,topCard:r,backCard:n,smallCard:a,duration:l,onfinish:o}=e;n.style.opacity=0;const s=Xr(t),c=r.animate([{transform:"scale(1)",opacity:1},{transform:"scale(0)",opacity:0}],{duration:l,fill:"forwards"}),i=a.animate([{transform:"scale(0)",opacity:0,position:"fixed",top:`${s.top}.px`,left:`${s.left}.px`},{transform:"scale(1)",opacity:1,position:"fixed",top:`${s.top}.px`,left:`${s.left}.px`}],{duration:l,fill:"forwards"});return i.onfinish=o,()=>{c.cancel(),i.cancel()}},Wa=e=>{let{openScoreboard:t,onRoundStart:n,onRoundOver:a}=e;const l=z(),[o,s]=r.useState(!1);r.useEffect((()=>{n()}),[]);const[c,i]=Ut(),[d,u]=Ut(),m=r.useRef();return r.createElement("div",{className:"round-container"},r.createElement($t,null),r.createElement(Bn,{openScoreboard:t,headerSmallCardRef:m}),l?r.createElement(Ya,{diceOverRolledAreaListener:c,diceOverChestListener:d,openScoreboard:t,onRoundOver:a,onRoundMounted:e=>{s(e)}}):null,o?r.createElement(ga,{offscreenDomNode:o.offscreenDomNode,chestDomNode:o.chestDomNode,rolledAreaDomNode:o.rolledAreaDomNode,cursedAreaDomNode:o.cursedAreaDomNode,onDiceOverChestChange:u,onDiceOverRolledAreaChange:i}):null,r.createElement(qa,{dialogIsOpen:!l,headerSmallCardRef:m}))},Ya=e=>{let{diceOverRolledAreaListener:t,diceOverChestListener:n,onRoundMounted:a,onRoundOver:l}=e;const o=r.useRef(null),s=r.useRef(null),c=r.useRef(null),i=r.useRef(null);return r.useEffect((()=>{a({rolledAreaDomNode:o.current,chestDomNode:s.current,cursedAreaDomNode:c.current,offscreenDomNode:i.current})}),[]),r.createElement(r.Fragment,null,r.createElement(At,null),r.createElement("div",{className:"chest-and-skulls"},r.createElement(Dn,{chestRef:s,diceOverChestListener:n}),r.createElement(ra,{cursedAreaRef:c})),r.createElement(Gt,{rolledAreaRef:o,offscreenRef:i,diceOverRolledAreaListener:t}),r.createElement(_n,{onRoundOver:l,rolledAreaRef:o}))},Za=e=>{let{closeDialog:t,dialogIsOpen:n,player:a}=e;const l=gt();return r.createElement(Mr,{className:"score-board-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:n,onRequestClose:t,requestCloseOnClickOutside:!0},r.createElement("div",{className:"dialog-content"},r.createElement("div",{className:"dialog-close",onClick:t},r.createElement(Tr,null)),r.createElement("div",{className:"dialog-body"},r.createElement("div",null,"Au tour de",r.createElement("div",{className:"dialog-label"},a.character.name),r.createElement($e,{className:"player-img",src:a&&a.character.img,alt:"player",width:"40",height:"40",style:{boxShadow:`inset 0px 0px 0px 4px ${a&&a.character.color||"black"}`}})),r.createElement("div",{className:"dialog-actions"},r.createElement("button",{onClick:()=>{t(),l(a)}},"Jouer")))))},Ha=new URL(System.resolve("./assets/win-treasure.png",t.meta.url)),Ka=new URL(System.resolve("./assets/boat.png",t.meta.url)),Xa=6e3,Ja={path1:"M39.582,739.564c0-91.824,39.191-96.32,38.045-166.691s-30.042-70.37-47.326-161.729s38.128-86.388,31.276-186.42C55.405,134.602-3.014,89.176,8.812,129.825c5.333,18.333,30.77-21,30.77-129.825",path2:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0",path3:"M39.582,739.564c0-71.926-15.437-155.074-17.437-253.074s30-185,31.087-217s-31.087-46-31.087-26s33,10,31-32s-31-110-31-144S39.582,0,39.582,0",path4:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0"},Va=e=>{let{openedByUser:t,closeScoreboard:n,playerAnimation:a}=e;const l=N(),o=et(),s=pe(),[c,i]=r.useState(!1),d=()=>{i(!0)},u=_a();return r.createElement("div",{className:"score-board-container"},t&&r.createElement("div",{className:"cross",onClick:n},"X"),!s&&!o&&r.createElement("div",{className:"action-container"},r.createElement("button",{className:"score-board-action",onClick:()=>{d()}},"Commencer à jouer")),r.createElement($e,{className:"win-treasure-img",src:Ha,alt:"win-treasure",width:"230",height:"150"}),r.createElement("div",{className:"users-path"},l.map((e=>r.createElement(Qa,{key:e.id,player:e,openedByUser:t,pathCoordinates:Ja[`path${e.id}`],score:e.score,character:e.character,openStartPlayerRoundDialog:d,isCurrentPlayer:o&&e.id===o.id,playerAnimation:a})))),r.createElement(Za,{dialogIsOpen:c,closeDialog:()=>{i(!1)},player:u}))},_a=()=>{const e=et(),t=N();let r;if(e){const n=t.findIndex((t=>t.id===e.id));r=n===t.length-1?t[0]:t[n+1]}else r=t[0];return r},Qa=e=>{let{pathCoordinates:t,player:n,openedByUser:a,character:l,score:o,openStartPlayerRoundDialog:s,playerAnimation:c}=e;const i=r.useRef(null),d=r.useRef(null),u=r.useRef(null),m=r.useRef(null),f=_a(),[p,h]=r.useState(null),[g,E]=r.useState([]),[v,y]=r.useState(!1);return r.useEffect((()=>{c&&c.player===n?"user-collect"===c.roundOverReason?(h(c.score),E(c.symbolsInChest)):"3-skulls"===c.roundOverReason?y(!0):"chalenge-failed"===c.roundOverReason&&h(c.score):h(null)}),[c,n]),r.useEffect((()=>{if(!p)return;const{from:e,to:t}=p,r=d.current.animate([{offsetDistance:el(e/Xa)},{offsetDistance:el(t/Xa)}],{duration:1e3,fill:"forwards"}),n=m.current;let a=null;n&&(a=n.animate([{offsetDistance:el(e/Xa)},{offsetDistance:el(t/Xa)}],{duration:1e3,fill:"forwards"}));const l=i.current,o=l.getTotalLength();console.log("from",e),console.log("to",t);const s=l.animate([{strokeDashoffset:tl(e/Xa,o)},{strokeDashoffset:tl(t/Xa,o)}],{duration:1e3,fill:"forwards"});return s.onfinish=()=>{"finished"===r.playState&&h(null)},r.onfinish=()=>{"finished"===s.playState&&h(null)},()=>{s.cancel(),r.cancel(),a&&a.cancel()}}),[p]),r.useEffect((()=>{const e=i.current,t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=tl(o/Xa,t)}),[o]),r.createElement("div",{className:"user-path"},r.createElement("svg",{viewBox:"0 0 79.164 739.564",width:"50",height:"450",fill:"none",stroke:"none"},r.createElement("path",{d:t,className:"path-background"}),r.createElement("path",{ref:i,d:t,className:"path-foreground"}),r.createElement("g",{className:"score-indicator"},r.createElement("image",{ref:d,href:Ka,width:"26",height:"26",className:"boat",style:{offsetPath:`path('${t}')`,offsetDistance:el(o/Xa)}}),g&&g.length>0&&r.createElement("g",{className:"animation-symbols",ref:m,style:{offsetPath:`path('${t}')`,offsetDistance:el(o/Xa)}},g.map(((e,t)=>r.createElement("image",{key:t,width:"30",height:"30",className:`symbol symbol-${t+1}`,href:_(e)})))))),r.createElement("div",{className:"speech-bubble"},o),r.createElement("div",{className:"user-avatar "+(f.character.id!==l.id||a?"":"next-player"),onClick:()=>{f.character.id!==l.id||a||s()}},v&&r.createElement("div",{className:"animation-3skulls",ref:u},r.createElement(rl,null)),r.createElement(nl,{character:l})))},el=e=>100*e+"%",tl=(e,t)=>t-e*t,rl=()=>new Array(3).fill("").map(((e,t)=>r.createElement($e,{key:t,width:"30",height:"30",className:`skull skull-${t+1}`,src:se,animateLoaded:!1}))),nl=e=>{let{character:t}=e;return r.createElement($e,{className:"player-img",src:t.img,alt:"player",width:"40",height:"40",style:{boxShadow:`inset 0px 0px 0px 4px ${t.color||"black"}`}})},al=()=>{const e=ll();return r.createElement("div",{className:"game-configuration"},r.createElement("div",{className:"background-image"}),r.createElement("div",{className:"content"},r.createElement("div",{className:"title"},"A l’abordage !"),r.createElement("div",{className:"subtitle"},"Combien de joueurs participent à l’aventure ?"),r.createElement("div",{className:"buttons"},[1,2,3,4,5].map((t=>r.createElement("button",{key:t,onClick:()=>{e(t)}},t))))))},ll=c(((e,t)=>i(i({},e),{},{players:new Array(t).fill("").map(((e,t)=>({id:t+1,number:t+1,score:0})))}))),ol=[{id:1,name:"Luffy",color:"#ef9620",img:String(new URL(System.resolve("./assets/Luffy.png",t.meta.url)))},{id:2,name:"Miss Fortune",color:"#d90f1b",img:String(new URL(System.resolve("./assets/miss_fortune.png",t.meta.url)))},{id:3,name:"Jack Sparrow",color:"#007033",img:String(new URL(System.resolve("./assets/JackSparrow.png",t.meta.url)))},{id:4,name:"Barbe Rouge",color:"#7baac9",img:String(new URL(System.resolve("./assets/BarbeRouge.png",t.meta.url)))},{id:5,name:"Ginette Boulette",color:"#e2500c",img:String(new URL(System.resolve("./assets/GinetteBoulette.png",t.meta.url)))},{id:6,name:"Capitaine Crochet",color:"#952460",img:String(new URL(System.resolve("./assets/CapitaineCrochet.png",t.meta.url)))}],sl=e=>{let{players:t}=e;const n=ul(),a=il(),l=t.find((e=>!e.character));return ml(),r.useEffect((()=>{ml()}),[]),r.createElement("div",{className:"character-selection-page"},r.createElement(cl,null),l&&r.createElement(r.Fragment,null,r.createElement("p",null,"Joueur ",l.number," : quel pirate êtes vous ?"),r.createElement("div",{className:"characters-container",id:"menu-wrapper"},r.createElement("div",{className:"characters menu"},ol.map((e=>r.createElement("div",{className:"character item "+(dl(e,t)?"":"disabled"),key:e.id,onClick:r=>{dl(e,t)&&(r.target.animate([{transform:"scale(1)"},{transform:"scale(1.3)"},{transform:"scale(1)"}],{duration:400,fill:"forwards"}),n(l,e))}},r.createElement($e,{className:"character-img",width:"40",height:"40",src:e&&e.img,alt:"player",style:{border:`4px solid ${e&&e.color||"black"}`}}),r.createElement("span",null,e.name))))),r.createElement("div",{className:"paddles"},r.createElement("button",{className:"left-paddle paddle hidden"},"<"),r.createElement("button",{className:"right-paddle paddle",onClick:()=>{ml()}},">")))),!l&&r.createElement("div",{className:"crew-completed"},r.createElement("p",null,"L’équipage est au complet !"),r.createElement($e,{style:{opacity:.5},src:le({type:he})}),r.createElement("button",{onClick:()=>{a()}},"Démarrer la partie")))},cl=()=>{const e=N();return r.createElement("div",{className:"crew "+(e.length>3?"large-crew":"")},r.createElement("div",{className:"title"},"Votre equipage:"),r.createElement("ul",null,e.map((e=>r.createElement("li",{key:e.id},e.character?r.createElement($e,{className:"crew-member-img",width:"40px",height:"40px",src:e.character&&e.character.img,alt:"player",style:{border:`4px solid ${e.character&&e.character.color||"black"}`},loadWhenIntersecting:!1}):r.createElement("div",{className:"placeholder-img"}),r.createElement("span",null,e.character?e.character.name:`Joueur${e.number}`))))))},il=c((e=>{const{cardIds:t}=e;return i(i({},e),{},{gameStarted:!0,cardIds:U(t)})})),dl=(e,t)=>!t.some((t=>t.character&&t.character.name===e.name)),ul=c(((e,t,r)=>{const{players:n}=e;return t.character=r,i(i({},e),{},{players:[...n]})})),ml=()=>{var e=document.getElementsByClassName("item").length,t=function(){return document.getElementById("menu-wrapper")?document.getElementById("menu-wrapper").offsetWidth:null},r=t(),n=123*e;window.onresize=()=>{r=t()};var a=n-r,l=document.querySelector(".left-paddle"),o=document.querySelector(".right-paddle");document.querySelector(".menu")&&(document.querySelector(".menu").onscroll=()=>{a=n-r;var e=document.querySelector(".menu").scrollLeft,t=a;e<=0?(l.classList.add("hidden"),o.classList.remove("hidden")):e<t?(l.classList.remove("hidden"),o.classList.remove("hidden")):e>=t&&(l.classList.remove("hidden"),o.classList.add("hidden"))}),o&&(o.onclick=()=>{if(document.querySelector(".menu")){const e=document.querySelector(".menu").scrollLeft,t=e+r;Wt({duration:300,onProgress:r=>{let{progress:n}=r;document.querySelector(".menu").scrollLeft=e+(t-e)*n}})}}),l&&(l.onclick=()=>{if(document.querySelector(".menu")){const e=document.querySelector(".menu").scrollLeft,t=e-r;Wt({duration:300,onProgress:r=>{let{progress:n}=r;document.querySelector(".menu").scrollLeft=e+(t-e)*n}})}})},fl=e=>{let{playerAnimationListener:t}=e;const n=N(),a=C(),l=pe(),o=pl(),s=hl(),[c,i]=r.useState(!1),[d,u]=r.useState(null),[m,f]=r.useState(null),p=!l||c,h=n.find((e=>e.id===a)),g=r.useRef(null);return r.useEffect((()=>{f(d?{player:h,score:{from:g.current,to:h.score},roundOverReason:d.reason,symbolsInChest:d.symbolsInChest}:null)}),[d,a]),r.useEffect((()=>{if(t)return t(f)}),[t]),o?r.createElement(al,null):s?r.createElement(sl,{players:n}):p?r.createElement(Va,{openedByUser:c,closeScoreboard:()=>{i(!1)},playerAnimation:m}):r.createElement(Wa,{openScoreboard:()=>{i(!0)},onRoundStart:()=>{g.current=h.score,u(null)},onRoundOver:e=>{u(e)}})},pl=()=>0===N().length,hl=()=>!ge(),gl=c((e=>i(i({},e),{},{animationsDisabled:!0}))),El=c((e=>i(i({},e),{},{animationsDisabled:!1}))),vl=c((e=>i(i({},e),{},{soundDisabled:!0}))),yl=c((e=>i(i({},e),{},{soundDisabled:!1}))),bl=c((()=>Ee)),Cl=()=>{const[e,t]=r.useState();return r.useEffect((()=>ve.listenAvailabilityChange((()=>{t(ve.isAvailable())}))),[]),e},Nl=()=>r.useCallback(ve.prompt),kl=()=>Ce(),xl=()=>Ne,Sl=()=>ke,wl=e=>{let{settingsDialogIsOpen:t}=e;return kl()?r.createElement(Rl,{settingsDialogIsOpen:t}):null},Rl=e=>{let{checkOnOpen:t=!0,settingsDialogIsOpen:n}=e;const a=xl(),l=(()=>{const[e,t]=r.useState(ye());return r.useEffect((()=>be((()=>{t(ye())}))),[]),e})();return r.useEffect((()=>{t&&n&&a()}),[t,n]),r.createElement("fieldset",{style:{minHeight:"4em"}},r.createElement("legend",null,"Mise a jour"),l?r.createElement(Dl,{serviceWorkerUpdate:l}):r.createElement(Al,null))},Dl=e=>{let{serviceWorkerUpdate:t}=e;const{shouldBecomeNavigatorController:n,navigatorWillReload:a}=t,l=Sl(),[o,s]=r.useState("");return r.createElement(r.Fragment,null,r.createElement("p",null,""===o?"Mise a jour prête":null,"updating"===o||"activating"===o?"Mise a jour...":null,"activated"===o&&a?"Mise a jour activée, la page va se recharger":null,"activated"===o&&!a&&n?"Mise a jour activée, recharger la page pour installer":null,"activated"!==o||a||n?null:"Mise a jour activée"),r.createElement("button",{disabled:Boolean(o),onClick:async()=>{s("updating"),await l({onActivating:()=>s("activating"),onActivated:()=>s("activated"),onBecomesNavigatorController:()=>s("")})}},a?"Recharger pour mettre a jour":"Mettre a jour"))},Al=()=>{const e=xl(),[t,n]=r.useState("");return r.createElement(r.Fragment,null,r.createElement("p",null,"fetching"===t?"Recherche de mise a jour...":null,"notfound"===t?"Pas de mise a jour disponible.":null,"failed"===t?"Une erreur est survenue.":null),r.createElement("button",{disabled:"fetching"===t,onClick:async()=>{n("fetching");try{await e()||n("notfound")}catch(e){n("failed"),console.error(e)}}},"Chercher"))},Il=new URL(System.resolve("./assets/settings.css",t.meta.url)),Ol=()=>{const[e,t,n]=Lr();return r.createElement(r.Fragment,null,r.createElement(Jt,{href:Il}),r.createElement("div",{id:"settings",onClick:()=>{t()}},r.createElement("svg",{className:"settings-icon",width:"24px",height:"24px",viewBox:"0 0 24 24"},r.createElement("path",{fill:"currentColor",d:"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"}))),r.createElement(Ml,{settingsDialogIsOpen:e,closeSettingsDialog:n}))},Ml=e=>{let{settingsDialogIsOpen:t,closeSettingsDialog:n}=e;const a=B(),l=gl(),o=El(),s=xe(),c=vl(),i=yl(),d=bl(),[u,m]=r.useState(!1),f=()=>{m(!0)};return r.createElement(Mr,{className:"settings-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0},r.createElement("div",{className:"settings-dialog-content"},r.createElement("div",{className:"dialog-close",onClick:n},r.createElement(Tr,null)),r.createElement("div",{className:"dialog-simple-title"},"Settings"),r.createElement("div",{className:"setting-element"},r.createElement("label",null,r.createElement("input",{type:"checkbox",className:a?"checked":"unchecked",checked:a,onChange:e=>{e.target.checked?l():o()}}),a&&r.createElement(Pl,null),"Désactiver les animations")),r.createElement("div",{className:"setting-element"},r.createElement("label",null,r.createElement("input",{type:"checkbox",className:s?"checked":"unchecked",checked:s,onChange:e=>{e.target.checked?c():i()}}),s&&r.createElement(Pl,null),"Couper le son")),r.createElement("div",{className:"setting-element"},r.createElement("button",{onClick:()=>{f()}},"Annuler la partie")),r.createElement(Ll,null),r.createElement(wl,{settingsDialogIsOpen:t}),r.createElement(ql,{confirmCancelGameDialogIsOpen:u,closeConfirmCancelGameDialog:()=>{m(!1)},performCancelGame:()=>{d(),n()}})))},Ll=()=>{const[e,t]=[Cl(),Nl()];return e?r.createElement("button",{onClick:()=>{t()}},"Installer application"):null},Pl=()=>r.createElement("svg",{className:"check-icon",width:"20",height:"20",viewBox:"0 0 512 512"},r.createElement("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})),ql=e=>{let{confirmCancelGameDialogIsOpen:t,closeConfirmCancelGameDialog:n,performCancelGame:a}=e;return r.createElement(Mr,{className:"confirm-cancel-game-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0},r.createElement("div",{className:"settings-dialog-content"},r.createElement("div",{className:"dialog-close",onClick:n},r.createElement(Tr,null)),r.createElement("div",{className:"title-container"},r.createElement($e,{className:"illustration",src:Se,width:"40",height:"40"}),r.createElement("div",{className:"title"},"Êtes-vous certain de vouloir annuler la partie ?")),r.createElement("div",{className:"content"},"Cette action irréversible effacera la progression actuelle et remettra la partie à zéro !"),r.createElement("div",{className:"confirm-action"},r.createElement("button",{onClick:()=>{a(),n()}},"Confirmer"))))},Tl=new URL(System.resolve("./assets/app.css",t.meta.url)),jl=(e("App",(e=>r.createElement("div",{id:"main",ref:we()},r.createElement(Jt,{href:Tl}),r.createElement(Ol,null),r.createElement(jl,e)))),e=>Re()?r.createElement(fl,e):r.createElement(Ge,e))}}}));

//# sourceMappingURL=root-b9f73d6c.js.map