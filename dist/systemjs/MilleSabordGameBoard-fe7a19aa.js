System.register(["./index-c0f7af46.js","./DiceHelpers-4091a29e.js"],(function(e){"use strict";var t,n,r,a,c,l,o,i,u,d,s,f;return{setters:[function(e){t=e.a,n=e.u,r=e.r,a=e._},function(e){c=e._,l=e.S,o=e.a,i=e.b,u=e.c,d=e.d,s=e.e,f=e.s}],execute:function(){var m=function(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},p=function(e,t){return!(e.right<=t.left)&&(!(e.left>=t.right)&&(!(e.bottom<=t.top)&&!(e.top>=t.bottom)))},y=function(e){var t=e.dice,n=e.disabled,a=e.onClickAction,o=e.specificStyle;return r.createElement("button",{key:t.id,disabled:n,onClick:function(){return a(t)},className:"dice",style:c({width:50,height:50,padding:"0",boxShadow:"0px 1px 5px 0px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 3px 1px -2px rgba(0, 0, 0, 0.12)",background:t.symbol===l?"black":"#e6e6e6",color:t.symbol===l?"black":"#e6e6e6",borderRadius:"8px"},o)},r.createElement("img",{src:"src/Dice/assets/dice_".concat(t.symbol,".png"),style:{width:"100%",height:"100%"}}))},b=r.forwardRef((function(e,t){var n=e.diceArray,a=e.keepDiceAllowed,c=e.keepDice;return r.createElement("div",{className:"diceOnGoing",ref:t},r.createElement("div",{className:"area"},n.map((function(e){return r.createElement(y,{key:e.id,dice:e,disabled:!a,onClickAction:c,specificStyle:{left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),transform:"rotate(".concat(e.rotation,"deg)"),position:"absolute"}})}))))})),k=function(e){var t=e.rollDicePermission,n=e.onClick;return t.allowed?r.createElement("button",{onClick:n},"Roll!"):"3 skulls or more"===t.reaon?null:r.createElement(r.Fragment,null,r.createElement("button",{disabled:!0},"Roll!"),r.createElement("span",null,"(".concat(t.reason,")")))},E=function(e){var t=e.diceArray,n=e.unkeepDiceAllowed,a=e.unkeepDice;return r.createElement("div",{className:"diceKept"},r.createElement("div",{className:"area"},t.map((function(e){return r.createElement(y,{key:e.id,dice:e,disabled:!n,onClickAction:a,specificStyle:{margin:"5px"}})}))))},h=function(e){var t=e.onClick;return r.createElement("button",{onClick:t,style:{marginLeft:"20px"}},"Mark this score")},v=function(e){var t=e.rollIndex,n=e.isOnSkullIsland,a=e.roundScore,c=e.markScorePermission,l=e.markScore;return-1===t?null:r.createElement("div",null,r.createElement("span",{className:"subtitle"}," Round score: "),r.createElement(g,{isOnSkullIsland:n,markScorePermission:c,roundScore:a,markScore:l}))},g=function(e){var t=e.markScorePermission,n=e.isOnSkullIsland,a=e.roundScore,c=e.markScore;return n?r.createElement("span",null,"Skull Island!"):r.createElement(r.Fragment,null,r.createElement("span",null,a),r.createElement("div",null,t.allowed?r.createElement(h,{onClick:c}):null,r.createElement("div",null,"has-three-skulls-or-more"===t.reason?"Round over !":t.reason)))},x=function(e){var t=e.totalScore;return r.createElement("div",null,r.createElement("span",{className:"subtitle"}," Total score: "),r.createElement("span",{className:"totalScore"},t))},S=function(e){var t=e.cardDeck,n=e.cardDrawn,a=e.drawCard,c=e.card;return r.createElement("div",{className:"card-area"},r.createElement("div",{className:"remaining-cards-number"},t.length),c.label&&n&&r.createElement("div",{className:"card current-card"},r.createElement("img",{src:"src/Cards/assets/card_".concat(c.label,".png"),alt:c.label})),r.createElement("div",{className:"card default-card",style:{backgroundImage:"url('src/Cards/assets/card_default.png')"}},!n&&r.createElement("button",{className:"draw-card-btn",onClick:function(){return a()}},t.length>0?"Draw a card":"Shuffle the deck")))},w=function(e){var t=e.diceCursed,n=e.canRemoveSkull,a=e.removeSkull;return r.createElement("div",{className:"skullIsland"},r.createElement("div",{className:"map"},r.createElement("div",{className:"area"},t.map((function(e){return r.createElement(y,{key:e.id,dice:e,disabled:!n,onClickAction:a,specificStyle:{margin:"5px"}})})))))},C=function(e){var t=e.nextRoundPermission,n=e.nextRound;return t.allowed?r.createElement("button",{onClick:function(){return n()}},"Next round"):null},M=function(){return N(A())},A=function(){var e=[];return I.forEach((function(t){e=D(e,t)})),e},I=[{type:"pirate",cardQuantiy:4,label:"pirate"},{type:"witch",cardQuantiy:4,label:"witch"},{type:"chest",cardQuantiy:4,label:"chest"},{type:"animals",cardQuantiy:4,label:"animals"},{type:"diamond",cardQuantiy:4,label:"diamond"},{type:"coin",cardQuantiy:3,label:"coin"},{type:"skull",skullAmount:1,cardQuantiy:3,label:"1skull"},{type:"skull",skullAmount:2,cardQuantiy:2,label:"2skulls"},{type:"sword-challenge",goal:2,gamble:300,cardQuantiy:2,label:"2sword-challenge"},{type:"sword-challenge",goal:3,gamble:500,cardQuantiy:3,label:"3sword-challenge"},{type:"sword-challenge",goal:4,gamble:1e3,cardQuantiy:2,label:"4sword-challenge"}],D=function(e,t){for(var n=0;n<t.cardQuantiy;n++)e.push(t);return e},N=function(e){for(var t=0;t<100;t++)R(e);return e},R=function(e){var t=Q(e.length),n=Q(e.length),r=e[t];return e[t]=e[n],e[n]=r,e},Q=function(e){return Math.floor(Math.random()*e)},O=function(e){var t=e.dice,n=e.index,r=e.dices,a=e.xMin,c=e.xMax,l=e.yMin,o=e.yMax,i=P(r.slice(0,n),{xMin:a,xMax:c,yMin:l,yMax:o}),u=i.x,d=i.y;t.x=u,t.y=d,t.rotation=j(),t.symbol=F()},P=function(e,t){var n=t.xMin,r=t.xMax,a=t.yMin,c=t.yMax,l=0;return function t(){var o,i={x:K(n,r),y:K(a,c)};return o=i,e.some((function(e){return p({top:o.y-6.25,left:o.x-6.25,bottom:o.y+50+6.25,right:o.x+50+6.25},{top:e.y-6.25,left:e.x-6.25,bottom:e.y+50+6.25,right:e.x+50+6.25})}))?++l>50?i:t():i}()},j=function(){return K(-35,35)},_={1:o,2:i,3:u,4:d,5:s,6:l},F=function(){return _[G()]},G=function(){return K(1,6)},K=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},U=function(e){var t=e.card,n=e.diceCursed.length;return"skull"===t.type&&(n+=t.skullAmount),n},B=function(e){var t=e.card;return 0===e.rollIndex&&"sword-challenge"!==t.type},T=function(e){var t=e.card,n=e.diceCursed;return U({card:t,diceCursed:n})>=4},q=function(e){return e.map((function(e){return H(e)}))},H=function(e){return e.symbol},L=function(e,t){return e.filter((function(e){return e===t})).length},z=function(e,t){var n=t.perfectEnabled,r=0,a=0,c=J(e);return Object.values(c).forEach((function(e){3===e&&(r+=100),4===e&&(r+=200),5===e&&(r+=500),6===e&&(r+=1e3),7===e&&(r+=2e3),8===e&&(r+=4e3),e>2&&(a+=e)})),e.forEach((function(e){e===i&&(r+=100,c[i]<3&&(a+=1)),e===o&&(r+=100,c[o]<3&&(a+=1))})),n&&a>=e.length&&(r+=500),r},J=function(e){var t={};return e.forEach((function(e){t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},V=(e("MilleSabordGameBoard",(function(e){var t=e.diceArray,n=r.useState(t),c=a(n,2),o=c[0],i=c[1],p=r.useState([]),y=a(p,2),h=y[0],g=y[1],A=r.useState([]),I=a(A,2),D=I[0],N=I[1],R=r.useState([]),Q=a(R,2),P=Q[0],j=Q[1],_=r.useState(0),F=a(_,2),G=F[0],K=F[1],H=r.useState(M()),J=a(H,2),W=J[0],X=J[1],Y=r.useState({}),Z=a(Y,2),$=Z[0],ee=Z[1],te=r.useState(-1),ne=a(te,2),re=ne[0],ae=ne[1],ce=r.useState(!1),le=a(ce,2),oe=le[0],ie=le[1],ue=r.useState(!1),de=a(ue,2),se=de[0],fe=de[1],me=r.useState(!1),pe=a(me,2),ye=pe[0],be=pe[1],ke=r.useState(!1),Ee=a(ke,2),he=Ee[0],ve=Ee[1],ge=r.useState({}),xe=a(ge,2),Se=xe[0],we=xe[1],Ce=r.useState(!1),Me=a(Ce,2),Ae=Me[0],Ie=Me[1],De=r.useState(!1),Ne=a(De,2),Re=Ne[0],Qe=Ne[1],Oe=r.useState({}),Pe=a(Oe,2),je=Pe[0],_e=Pe[1],Fe=r.useState({}),Ge=a(Fe,2),Ke=Ge[0],Ue=Ge[1],Be=r.useState(!1),Te=a(Be,2),qe=Te[0],He=Te[1];r.useEffect((function(){U({card:$,diceCursed:P})>2||se?(Ie(!1),Qe(!1)):(Ie(!0),Qe(!0))}),[$,P,se]),r.useEffect((function(){be(function(e){var t=e.isOnSkullIsland,n=e.card,r=e.rollIndex,a=e.diceCursed;return!!t||!(!B({card:n,rollIndex:r})||!T({card:n,diceCursed:a}))}({isOnSkullIsland:ye,card:$,rollIndex:re,diceCursed:P}))}),[$,re,P]),r.useEffect((function(){we(function(e){var t=e.cardDrawn,n=e.scoreMarked,r=e.card,a=e.diceCursed,c=e.rollIndex,l=e.diceOnGoing;return t?n?{allowed:!1,reason:"round-not-started"}:U({card:r,diceCursed:a})>2?{allowed:!1,reason:"has-three-skulls-or-more"}:c>0&&l.length<2?{allowed:!1,reason:"not-enough-dice-to-roll"}:{allowed:!0,reason:""}:{allowed:!1,reason:"card-not-drawn"}}({cardDrawn:oe,scoreMarked:se,card:$,diceCursed:P}))}),[oe,se,$,P]),r.useEffect((function(){_e(function(e){var t=e.rollIndex,n=e.card,r=e.diceCursed;return e.scoreMarked?{allowed:!1}:U({card:n,diceCursed:r})>2?"chest"===n.type&&t>0?{allowed:!0}:{allowed:!1,reason:"has-three-skulls-or-more"}:{allowed:!0}}({rollIndex:re,card:$,diceCursed:P,scoreMarked:se}))}),[$,re,P,se]),r.useEffect((function(){ve(function(e){var t=e.card,n=e.diceKept;if(!e.markScoreAllowed)return"sword-challenge"===t.type?-t.gamble:0;var r=8===n.length,a=q(n);return"sword-challenge"===t.type?L(a,u)>=t.goal?z(a,{perfectEnabled:r})+t.gamble:-t.gamble:"diamond"===t.type||"coin"===t.type?z([].concat(m(a),[t.type]),{perfectEnabled:r}):"animals"===t.type?z(a.map((function(e){return e===d?s:e})),{perfectEnabled:r}):"pirate"===t.type?2*z(a,{perfectEnabled:r}):z(a,{perfectEnabled:r})}({card:$,diceKept:D,markScoreAllowed:je.allowed}))}),[$,D,je]),r.useEffect((function(){-1===re?Ue({allowed:!1}):Se.allowed||je.allowed||Ue({allowed:!0})}),[re,Se,je]),r.useEffect((function(){"witch"===$.type?P.length>2||$.effectUsed?He(!1):He(!0):He(!1)}),[$,P]);var Le=V(je);r.useEffect((function(){"sword-challenge"!==$.type||se||!Le.allowed||je.allowed||We()}),[$,se,Le,je]);var ze=r.createRef(),Je=function(e){var t=f(e),n=t.withoutSkulls,r=t.skulls;g(n),j([].concat(m(P),m(r)))},Ve=function(e){if(e.symbol===l){"witch"===$.type&&($.effectUsed=!0);var t=P.filter((function(t){return t!==e}));j(t)}else{var n=D.filter((function(t){return t!==e}));N(n)}var r=[].concat(m(h),[e]);g(r)},We=function(){K(Math.max(G+he,0)),fe(!0)};return r.createElement(r.Fragment,null,r.createElement(S,{cardDeck:W,cardDrawn:oe,drawCard:function(){W.length>0?(ee(W.pop()),X(W),ie(!0)):X(M())},card:$}),r.createElement("div",{className:"score-area"},r.createElement(x,{totalScore:G}),r.createElement(C,{nextRoundPermission:Ke,nextRound:function(){i(t),g([]),N([]),j([]),ae(-1),fe(!1),ie(!1),be(!1),ve(0)}}),r.createElement(v,{rollIndex:re,isOnSkullIsland:ye,roundScore:he,markScorePermission:je,markScore:We})),r.createElement(E,{diceArray:D,unkeepDiceAllowed:Re,unkeepDice:Ve}),r.createElement("div",null,r.createElement(k,{rollDicePermission:Se,onClick:function(){var e;-1===re?(e=o,g(m(o)),i([]),ae(0)):(e=h,ae(re+1)),function(e,t){var n=t.diceParentElement.getBoundingClientRect(),r=n.width-50,a=n.height-50;e.forEach((function(t,n){O({dice:t,index:n,dices:e,xMin:0,xMax:r,yMin:0,yMax:a})}))}(e,{diceParentElement:ze.current.querySelector(".area")}),Je(e)}})),r.createElement(b,{ref:ze,diceArray:h,keepDiceAllowed:Ae,keepDice:function(e){if(e.symbol===l){"witch"===$.type&&($.effectUsed=!1);var t=[].concat(m(P),[e]);j(t)}else{var n=[].concat(m(D),[e]);N(n)}var r=h.filter((function(t){return t!==e}));g(r)}}),r.createElement(w,{diceCursed:P,canRemoveSkull:qe,removeSkull:function(e){return Ve(e)}}))})),function(e){var t=r.useRef();return r.useEffect((function(){t.current=e})),t.current})}}}));
//# sourceMappingURL=MilleSabordGameBoard-fe7a19aa.js.map
