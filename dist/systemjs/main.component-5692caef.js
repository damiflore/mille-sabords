System.register(["./index.js"],(function(e,t){"use strict";var n,r,o,a,c,l,i,u,s,d,f,m,v,p,h,g,E,y,b,N,k,x,C,w,S,I,A,D,O,R,M,P,j,q,L,T,F,B,U,z,W,_,G,J,X,Y,Z,V,H,K,Q,$,ee,te,ne,re,oe,ae;return{setters:[function(e){n=e.r,r=e._,o=e.a,a=e.b,c=e.c,l=e.d,i=e.s,u=e.e,s=e.i,d=e.f,f=e.S,m=e.g,v=e.h,p=e.j,h=e.k,g=e.l,E=e.m,y=e.n,b=e.u,N=e.o,k=e.p,x=e.q,C=e.t,w=e.v,S=e.w,I=e.x,A=e.y,D=e.z,O=e.A,R=e.B,M=e.C,P=e.D,j=e.E,q=e.F,L=e.G,T=e.H,F=e.I,B=e.J,U=e.K,z=e.L,W=e.M,_=e.N,G=e.O,J=e.P,X=e.Q,Y=e.R,Z=e.T,V=e.U,H=e.V,K=e.W,Q=e.X,$=e.Y,ee=e.Z,te=e.$,ne=e.a0,re=e.a1,oe=e.a2,ae=e.a3}],execute:function(){var ce=System.resolve("./assets/card_default.png",t.meta.url),le=function(e,t,n,r){return e.addEventListener(t,n,r),function(){e.removeEventListener(t,n,r)}},ie=function(e){return e.window===e},ue=function(e){return 9===e.nodeType},se=function(e){if(1!==e.nodeType)return!1;var t=e.nodeName.toLowerCase();return"input"===t?"hidden"!==e.type&&de(e):["button","select","datalist","iframe","textarea"].indexOf(t)>-1||e.hasAttribute("tabindex")||e.hasAttribute("tabIndex")||e.hasAttribute("draggable")?de(e):["a","area"].indexOf(t)>-1?!1!==e.hasAttribute("href")&&de(e):["audio","video"].indexOf(t)>-1&&(!1!==e.hasAttribute("controls")&&de(e))},de=function(e){if(fe(e))return!0;if("hidden"===me(e,"visibility"))return!1;for(var t=e;t&&!fe(t);){if("none"===me(t,"display"))return!1;t=t.parentNode}return!0},fe=function(e){return e===e.ownerDocument.documentElement},me=function(e,t){return function(e){return ve(e).getComputedStyle(e)}(e).getPropertyValue(t)},ve=function(e){return ie(e)?e:ue(e)?e.defaultView:pe(e).defaultView},pe=function(e){return ie(e)?e.document:ue(e)?e:e.ownerDocument},he=n.createContext(),ge=function(e,t){return t(e)},Ee={},ye=function(e){var t=e.children;return n.createElement(he.Provider,{value:n.useReducer(ge,Ee)},t)},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Ce(),o=xe(e),a=t[e],c=n.useState(!1),l=r(c,2),i=l[0],u=l[1];return n.useEffect((function(){var e=window.requestIdleCallback(o);return function(){window.cancelIdleCallback(e)}}),[]),n.useEffect((function(){a&&"loaded"===a.status&&u(!0)})),i},Ne=function(){var e=Ce();return Object.keys(e).length},ke=function(){var e=Ce();return Object.keys(e).filter((function(t){return"loaded"===e[t].status})).length},xe=function(e){var t=n.useContext(he);if(!t)return function(){};var r=t[1];return n.useEffect((function(){r((function(t){return e in t?t:o(o({},t),{},a({},e,{status:"loading"}))}))}),[]),function(){r((function(t){return e in t&&"loaded"===t[e].status?t:o(o({},t),{},a({},e,{status:"loaded"}))}))}},Ce=function(){var e=n.useContext(he);return e?e[0]:null},we=function(e,t){var n=le(e,"load",(function(){r(),t()})),r=le(e,"error",(function(){n(),t()}));return function(){n(),r()}},Se=function(e){var t,r=e.href,o=(t=xe(r),function(e){e&&we(e,t)});return c.createPortal(n.createElement("link",{href:r,ref:o,rel:"stylesheet",type:"text/css"}),document.head)};var Ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ae=function(e,t){if(null===e)return{};var n,r,o=function(e,t){if(null===e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o},De=function(e,t){var n=new Image;return t&&(n.crossOrigin=t),new Promise((function(t,r){var o=function(e){Oe(n),r(e)};n.onload=function(e){Oe(n),t(e.target||e.srcElement)},n.onerror=o,n.onabort=o,n.src=e}))},Oe=function(e){e.onload=null,e.onerror=null,e.onabort=null;try{delete e.src}catch(e){}};var Re=new Map;var Me="loading",Pe="loaded",je="failed",qe=function(e){var t=Re.get(e),o=t?Pe:Me,a=n.useState(o),c=r(a,2),l=c[0],i=c[1],u=n.useRef(!1);return n.useEffect((function(){return e&&l!==Pe?(u.current=!0,(t=function(){return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return t=De(e),n=function(t){u.current&&(Re.set(e,t),i(Pe))},r?n?n(t):t:(t&&t.then||(t=Promise.resolve(t)),n?t.then(n):t);var t,n,r}),(function(){u.current&&(Re.delete(e),i(je))}))},function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return Promise.resolve(t.apply(this,e))}catch(e){return Promise.reject(e)}})(),function(){u.current=!1}):function(){};var t}),[e,l]),[l,t]},Le=function(e){var t=e.fallback,o=e.root,a=e.rootMargin,c=e.threshold,l=void 0===c?0:c,i=e.children,u=n.useState(!1),s=r(u,2),d=s[0],f=s[1],m=n.useState(null),v=r(m,2),p=v[0],h=v[1];return n.useEffect((function(){if(!p)return function(){};if(d)return function(){};var e=new window.IntersectionObserver((function(t){r(t,1)[0].isIntersecting?(e.unobserve(p),f(!0)):f(!1)}),{root:o,rootMargin:a,threshold:l});return e.observe(p),function(){e.disconnect()}}),[p,d]),d?n.createElement(n.Fragment,null,i):t({ref:h})},Te=function(e){var t=e.loadWhenIntersecting,o=void 0===t||t,a=e.usePlaceholderWhileLoading,c=void 0===a||a,l=e.animateLoaded,i=void 0===l||l,u=e.intersectionRoot,s=e.intersectionRootMargin,d=e.intersectionThreshold,f=e.FallbackWhileNotIntersecting,m=void 0===f?ze:f,v=e.FallbackWhileLoading,p=void 0===v?Ue:v,h=e.src,g=Ae(e,["loadWhenIntersecting","usePlaceholderWhileLoading","animateLoaded","intersectionRoot","intersectionRootMargin","intersectionThreshold","FallbackWhileNotIntersecting","FallbackWhileLoading","src"]),E=qe(h),y=r(E,1)[0],b=xe(h);n.useEffect((function(){"loaded"===y&&b()}),[y]);var N=n.createElement("img",Ie({},g,{src:h}));if(i&&(N=n.createElement(Fe,Ie({},g,{src:h}))),c){var k=N;N=n.createElement(Be,{src:h,fallback:n.createElement(p,g)},k)}if(o){var x=N;N=n.createElement(Le,{fallback:function(e){var t=e.ref;return n.createElement(m,Ie({ref:t},g))},root:u,rootMargin:s,threshold:d},x)}return N},Fe=function(e){var t=n.useRef();return n.useEffect((function(){t.current.animate([{transform:"scale(0)",opacity:0},{transform:"scale(1)",opacity:1}],{duration:300,fill:"forwards"})}),[t]),n.createElement("img",Ie({},e,{ref:t}))},Be=function(e){var t=e.fallback,n=e.src,o=e.children,a=qe(n);return"loaded"!==r(a,1)[0]?t:o},Ue=n.forwardRef((function(e,t){return n.createElement("img",Ie({src:We},e,{ref:t}))})),ze=n.forwardRef((function(e,t){return n.createElement("img",Ie({src:We},e,{ref:t}))})),We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==",_e=function(){return n.createElement(Ge,null)},Ge=function(){var e=Je();return n.createElement("div",{className:"new-game"},n.createElement(Te,{src:i}),n.createElement("button",{onClick:e},"Nouvelle partie"))},Je=l((function(e){return o(o({},e),{},{gameCreated:!0})})),Xe=function(e,t){var n=Ye(e,t);return Boolean(n)},Ye=function(e,t){var r=n.useRef(!1);n.useEffect((function(){!1===r.current&&(r.current=!0)}));var o=n.useRef(t);return n.useEffect((function(){o.current=t}),t),r.current&&e.apply(void 0,u(o.current))?{from:o.current,to:t}:null},Ze=function(e){var t=n.useRef(e);return n.useEffect((function(){t.current=e}),[e]),t.current},Ve=function(){var e=n.useState((function(){return e=[],{listen:function(t){var n=!1;return e=[].concat(u(e),[t]),function(){if(!n){n=!0;for(var r=[],o=e.length,a=!0;o--;){var c=e[o];a&&c===t?a=!1:r.push(c)}e=r}}},emit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.forEach((function(e){e.apply(void 0,n)}))}};var e}));return r(e,1)[0]},He=function(e){var t=n.useState(),o=r(t,2),a=o[0],c=o[1];return n.useEffect((function(){return e.listen(c)}),[]),a},Ke=function(e){var t=e.card,n=e.symbolsInChest,r=e.scoreMarked,o=e.markScoreAllowed;return s(t)?r||o?Qe(n,{goal:t.numberOfSwords,gamble:t.gambleAmount}):-t.gambleAmount:d(t)?et(n.map((function(e){return e===f?m:e}))):v(t)?2*et(n):p(t)||h(t)?et(n,9):et(n)},Qe=function(e,t){var n=t.goal,r=t.gamble;return $e(e,y)>=n?et(e)+r:-r},$e=function(e,t){return e.filter((function(e){return e===t})).length},et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=0,r=0,o=tt(e);return Object.values(o).forEach((function(e){3===e&&(n+=100),4===e&&(n+=200),5===e&&(n+=500),6===e&&(n+=1e3),7===e&&(n+=2e3),8===e&&(n+=4e3),e>2&&(r+=e)})),e.forEach((function(e){e===g&&(n+=100,o[g]<3&&(r+=1)),e===E&&(n+=100,o[E]<3&&(r+=1))})),r===t&&(n+=500),n},tt=function(e){var t={};return e.forEach((function(e){t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},nt=n.useMemo,rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentPlayerId,n=void 0===t?b():t,r=e.players,o=void 0===r?N():r;return o.find((function(e){return e.id===n}))},ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?w():t;return 0===n},at=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?w():t;return n>0},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,n=void 0===t?S():t,r=e.chestSlots,o=void 0===r?F():r;return Object.keys(o).reduce((function(e,t){var r=o[t];if(r&&"symbol"===r.type)return[].concat(u(e),[r.value]);if(r&&"dice"===r.type){var a=r.value,c=n[a];return[].concat(u(e),[T(c)])}return e}),[])},lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?ft():t;return 3-n},it=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dicesToCurse,n=void 0===t?ut():t;return n.length>0},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,n=void 0===t?S():t,r=e.diceRolledIds,o=void 0===r?I():r,a=e.witchUncursedDiceId,c=void 0===a?A():a,l=e.remainingSpotInCursedArea,i=void 0===l?lt():l,u=o.map((function(e){return n[e]})).filter((function(e){return!!D(e)&&e.id!==c})).slice(0,i);return u},st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?R():t,r=e.hasNeverRolled,o=void 0===r?ot():r,a=e.scoreMarked,c=void 0===a?q():a,l=e.threeSkullsOrMoreInCursedArea,i=void 0===l?dt():l,u=e.hasDicesToCurse,s=void 0===u?it():u;return!!n&&(!c&&(!!o||(i?!!L(k(n)):!s)))},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?ft():t;return n>2},ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.diceCursedIds,n=void 0===t?O():t,r=e.symbolsFromCard,o=void 0===r?mt():r;return n.length+o.filter((function(e){return x(e)})).length},mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?R():t;if(!n)return[];var r=k(n);return p(r)?[E]:h(r)?[g]:M(r)?[P]:j(r)?[P,P]:[]},vt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scoreMarked,n=void 0===t?q():t,r=e.currentCardId,o=void 0===r?R():r,a=e.threeSkullsOrMoreInCursedArea,c=void 0===a?dt():a,l=e.hasDicesToCurse,i=void 0===l?it():l;return!n&&(c?!!L(k(o)):!i&&!!o)},pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?R():t,r=e.symbolsInChest,o=void 0===r?ct():r,a=e.scoreMarked,c=void 0===a?q():a,l=e.markScoreAllowed,i=void 0===l?vt():l;return nt((function(){return Ke({card:k(n),symbolsInChest:o,scoreMarked:c,markScoreAllowed:i})}),[n,o,c,i])},ht=l((function(e,t){return o(o({},e),{},{currentPlayerId:t.id,currentCardId:null,currentCardActivated:!1,roundStarted:!0})})),gt=l((function(e){return o(o({},e),{},{currentCardActivated:!0},Nt)})),Et=l((function(e){return o(o({},e),{},{isOnSkullIsland:!0})})),yt=l((function(e,t){var n=e.players,r=e.currentPlayerId,a=n.find((function(e){return e.id===r})),c=a.score+t;return a.score=c<0?0:c,o(o({},e),{},{players:u(n),scoreMarked:!0})})),bt=(l((function(e){return o(o({},e),Nt)})),l((function(e){return o(o({},e),{},{roundStarted:!1})}))),Nt={witchUncursedDiceId:null,rollCount:0,diceRolledIds:[],diceCursedIds:[],chestSlots:{1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null},scoreMarked:!1,isOnSkullIsland:!1},kt=l((function(e,t,n,r){var a=n.x,c=n.y,l=e.dices;return t.rolledAreaPosition={x:a,y:c},t.rolledAreaZIndex=r,o(o({},e),{},{dices:o({},l)})})),xt=l((function(e,t,n){var r=e.chestSlots,c=Object.keys(r).find((function(e){var n=r[e];return n&&"dice"===n.type&&n.value===t.id}));return o(o({},e),{},{chestSlots:o(o(o({},r),c?a({},c,null):{}),{},a({},n,{type:"dice",value:t.id}))})})),Ct=l((function(e,t){var n=e.diceRolledIds,r=e.diceCursedIds;return o(o({},e),{},{diceRolledIds:n.filter((function(e){return e!==t.id})),diceCursedIds:[].concat(u(r),[t.id])})})),wt=l((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.diceRolledIds,a=e.diceCursedIds;return o(o(o({},e),n?{}:{witchUncursedDiceId:t.id}),{},{diceRolledIds:[].concat(u(r),[t.id]),diceCursedIds:a.filter((function(e){return e!==t.id}))})})),St=l((function(e,t){var n=e.diceRolledIds,r=e.chestSlots,c=Object.keys(r).find((function(e){var n=r[e];return n&&"dice"===n.type&&n.value===t.id}));return o(o({},e),{},{diceRolledIds:[].concat(u(n),[t.id]),chestSlots:o(o({},r),{},a({},c,null))})})),It=l((function(e,t,n){var r=e.diceRolledIds,c=e.chestSlots;return o(o({},e),{},{diceRolledIds:r.filter((function(e){return e!==t.id})),chestSlots:o(o({},c),{},a({},n,{type:"dice",value:t.id}))})})),At=n.useEffect,Dt=function(){return Ot(),null},Ot=function(){Rt(),Mt(),Pt()},Rt=function(){var e=ut(),t=Ct();At((function(){if(0===e.length)return function(){};var n=setTimeout((function(){e.forEach((function(e){t(e)}))}),1e3);return function(){clearTimeout(n)}}),[e])},Mt=function(){var e=k(R()),t=q(),n=yt(),r=dt(),o=Xe((function(e){return!e&&r}),[r]),a=pt(),c=s(e);At((function(){c&&!t&&o&&n(a)}),[c,t,o,a])},Pt=function(){var e=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rollCount;return 1===(void 0===e?w():e)}(),t=k(R()),n=B(),r=ft(),o=Et();At((function(){e&&(n||s(t)||r<4||o())}),[e,n,t,r])},jt=l((function(e){var t=e.cardIds,n=e.cardUsedIds,r=t[0];return o(o({},e),{},{cardIds:t.slice(1),cardUsedIds:[].concat(u(n),[r]),currentCardId:r})})),qt=l((function(e){var t=e.chestSlots;return o(o({},e),{},{chestSlots:o(o({},t),{},{1:{type:"symbol",value:E}})})})),Lt=l((function(e){var t=e.chestSlots;return o(o({},e),{},{chestSlots:o(o({},t),{},{1:{type:"symbol",value:g}})})})),Tt=l((function(e){var t=e.cardUsedIds;return o(o({},e),{},{cardIds:U(t),cardUsedIds:[]})})),Ft=(l((function(e){var t=e.currentCardId,n=e.cardIds,r=e.cardUsedIds;return o(o({},e),{},{currentCardId:null,cardIds:[t].concat(u(n)),cardUsedIds:r.slice(1)})})),function(){return Bt(),Ut(),null}),Bt=function(){var e=qt(),t=R(),r=Xe((function(e){return!e&&t&&p(k(t))}),[t]);n.useEffect((function(){r&&e()}),[r])},Ut=function(){var e=Lt(),t=R(),r=Xe((function(e){return!e&&t&&h(k(t))}),[t]);n.useEffect((function(){r&&e()}),[r])},zt=function(e){var t=e.rolledAreaRef,r=e.offscreenRef,a=e.diceOverRolledAreaSignal,c=He(a);return n.createElement("div",{className:"dice-ongoing"},n.createElement("div",{className:"map"}),n.createElement("div",{className:"area",ref:t,style:o({},c?{outline:"2px dotted"}:{})}),n.createElement("div",{className:"offscreen-area",ref:r}))},Wt=function(e,t){for(var n=Gt(e,e),r=n.next(),o=r.done,a=r.value;!1===o;){if(t(a))return a;var c=n.next();o=c.done,a=c.value}return null},_t=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r){var o=t.firstChild;if(o)return o}var a=t.nextSibling;if(a)return a;var c=t.parentNode;return c&&c!==n?e(c,n,!0):null},Gt=function(e,t){var n=e;return{next:function(){var e=_t(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},Jt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,o=!1,a=function(){var e=_t(r,t,n&&!1===o);return o=!0,r=e,{done:!1===Boolean(e),value:e}};return{next:a}},Xt=function(e){for(var t=e.lastChild;t;){var n=t.lastChild;if(!n)break;t=n}return t},Yt=function(e,t){var n=e;return{next:function(){var e=function(e,t){var n=e.previousSibling;if(n){return Xt(n)||n}if(e!==t){var r=e.parentNode;if(r&&r!==t)return r}return null}(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},Zt=function(e){var t=Wt(e,se);return t||(se(e)?e:null)},Vt=function(e){if(3===e.nodeType)return console.warn("cannot trap focus inside a text node"),function(){};if(Qt.find((function(t){return t.element===e})))return console.warn("focus already trapped inside this element"),function(){};var t=function(){return Wt(e,Ht)},n=function(){return function(e,t){var n=Xt(e);if(n)for(var r=Yt(n,e),o=r.next(),a=o.done,c=o.value;!1===a;){if(t(c))return c;var l=r.next();a=l.done,c=l.value}return null}(e,Ht)},r=function(){return function(e){for(var t=e.from,n=e.root,r=void 0===n?null:n,o=e.predicate,a=Yt(t,r),c=a.next(),l=c.done,i=c.value;!1===l;){if(o(i))return i;var u=a.next();l=u.done,i=u.value}return null}({from:document.activeElement,root:e,predicate:Ht})||n()},o=function(){return function(e){for(var t=e.from,n=e.root,r=void 0===n?null:n,o=e.predicate,a=e.skipChildren,c=Jt(t,r,void 0!==a&&a),l=c.next(),i=l.done,u=l.value;!1===i;){if(o(u))return u;var s=c.next();i=s.done,u=s.value}return null}({from:document.activeElement,root:e,predicate:Ht})||t()},a=$t({element:e,lock:function(){var a=function(t){(function(t){return t.target!==e&&!e.contains(t.target)})(t)&&(t.preventDefault(),t.stopImmediatePropagation())},c=function(e){Kt(e)&&(e.preventDefault(),function(e){var a=document.activeElement===document.body;if(e.shiftKey){var c=a?n():r();c&&c.focus()}else{var l=a?t():o();l&&l.focus()}}(e))};return document.addEventListener("mousedown",a,{capture:!0,passive:!1}),document.addEventListener("keydown",c,{capture:!0,passive:!1}),function(){document.removeEventListener("mousedown",a,{capture:!0,passive:!1}),document.removeEventListener("keydown",c,{capture:!0,passive:!1})}}});return function(){a()}},Ht=function(e){return!function(e){return e.hasAttribute&&e.hasAttribute("tabIndex")&&Number(e.getAttribute("tabindex"))<0}(e)&&se(e)},Kt=function(e){return"Tab"===e.key||9===e.keyCode},Qt=[],$t=function(e){var t,n=e.lock;Qt.length>0&&(t=Qt[Qt.length-1]).unlock();var r={lock:n,unlock:n()};return Qt.push(r),function(){if(0!==Qt.length){var e=Qt[Qt.length-1];r===e?(Qt.pop(),r.unlock(),t&&(t.unlock=t.lock())):console.warn("you must deactivate trap in the same order they were activated")}else console.warn("cannot deactivate an already deactivated trap")}},en=function(e){if("object"!==z(e)||1!==e.nodeType)throw new TypeError("getScrollableParent first argument must be DOM node");var t=e;return"fixed"===me(t,"position")?tn(t.ownerDocument):fn(t)||tn(t.ownerDocument)},tn=function(e){if("scrollingElement"in e)return e.scrollingElement;if(cn(e))return e.documentElement;var t=e.body,n=t&&!/body/i.test(t.tagName)?nn(t):t;return n&&on(n)?null:n},nn=function(e){for(var t=e;t=t.nextSibling;)if(1===t.nodeType&&rn(t))return t;return null},rn=function(e){return e.ownerDocument.body===e},on=function(e){if(!un(e))return!1;if(an(e))return!1;var t=e.ownerDocument.documentElement;return!!un(t)&&!an(t)},an=function(e){var t=me(e,"display");return"none"!==t&&("table-row"!==t&&"table-group"!==t&&"table-column"!==t||"collapsed"!==me(e,"visibility"))},cn=function(e){return!!/^CSS1/.test(e.compatMode)&&ln(e)},ln=function(e){var t=e.createElement("iframe");t.style.height="1px",(e.body||e.documentElement||e).appendChild(t);var n=t.contentWindow.document;n.write('<!DOCTYPE html><div style="height:9999em">x</div>'),n.close();var r=n.documentElement.scrollHeight>n.body.scrollHeight;return t.parentNode.removeChild(t),r},un=function(e){return!sn(e)||!dn(e)},sn=function(e){return"visible"===me(e,"overflow-x")||"visible"===me(e,"overflow")},dn=function(e){return"visible"===me(e,"overflow-y")||"visible"===me(e,"overflow")},fn=function(e){for(var t=me(e,"position"),n=e.parentNode;n;){if(fe(n))return null;if("absolute"!==t||"static"!==me(n,"position")){if(un(n))return n;n=n.parentNode}else n=n.parentNode}return null},mn=n.useEffect,vn={position:"absolute",top:"5%",left:"0",right:"0",width:"fit-content",height:"fit-content",margin:"auto",padding:"1em",overscrollBehavior:"contain",outline:"none",background:"white",color:"black",border:"solid"},pn={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.46)"},hn=function(e){var t=e.container,a=void 0===t?document.body:t,l=e.children,i=e.isOpen,u=e.closeMethod,s=void 0===u?"display-none":u,d=e.stealFocus,f=void 0===d||d,m=e.restoreStolenFocus,v=void 0===m||m,p=e.trapFocus,h=void 0===p||p,g=e.requestCloseOnEscape,E=void 0===g||g,y=e.requestCloseOnClickOutside,b=void 0!==y&&y,N=e.onAfterOpen,k=void 0===N?function(){}:N,x=e.onRequestClose,C=void 0===x?function(){}:x,w=e.onFocusIn,S=void 0===w?function(){}:w,I=e.onFocusOut,A=void 0===I?function(){}:I,D=e.backdropProps,O=void 0===D?{}:D,R=Ae(e,["container","children","isOpen","closeMethod","stealFocus","restoreStolenFocus","trapFocus","requestCloseOnEscape","requestCloseOnClickOutside","onAfterOpen","onRequestClose","onFocusIn","onFocusOut","backdropProps"]);if(!a)return null;var M=n.useState(null),P=r(M,2),j=P[0],q=P[1],L=Boolean(j);return Xe((function(e){return!e&&i}),[i])&&k(),mn((function(){if(!i||!L)return function(){};var e=yn(j),t=function(t){t.relatedTarget||e&&(e=!1,A(t))},n=function(t){S(t),e=!0},r=function(t){yn(j)?e=!0:(e=!1,A(t))};return j.addEventListener("focus",n,!0),document.addEventListener("focus",r,!0),document.addEventListener("blur",t,!0),function(){j.removeEventListener("focus",n,!0),document.removeEventListener("focus",r,!0),document.removeEventListener("blur",t,!0)}}),[i,L,S,A]),mn((function(){return i&&L?function(e){for(var t=[],n=e.previousSibling;n;)1===n.nodeType&&un(n)&&t.push(n),n=n.previousSibling;var r=en(e);t.push(r);var o=t.map((function(e){var t=e.style.overflow;return e.style.overflow="hidden",function(){t?e.style.overflow=t:delete e.style.overflow}}));return function(){o.forEach((function(e){e()}))}}(j):function(){}}),[i,L]),mn((function(){return i&&L&&h?Vt(j):function(){}}),[i,L,h]),mn((function(){if(!i||!L||!f)return function(){};var e=document.activeElement,t=Zt(j);return t&&t.focus(),function(){t&&("function"==typeof v?v(e):!0===v&&e.focus())}}),[i,L,f]),mn((function(){if(!i||!j||!j.parentNode)return function(){};var e=[];return Array.from(j.parentNode.children).forEach((function(t){t!==j&&e.push(t)})),e.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){e.forEach((function(e){e.removeAttribute("aria-hidden","true")}))}}),[i,j]),"dom-remove"!==s||i?c.createPortal(n.createElement(n.Fragment,null,i?n.createElement(gn,Ie({},O,{style:o(o({},pn),O.style),onMouseDownPassive:function(e){if(e.preventDefault(),!yn(j)){var t=Zt(j);t&&t.focus()}},onClick:function(e){if(b){var t=e.target;t===j||j.contains(t)||C(e)}O.onClick&&O.onClick(e)}})):null,n.createElement("div",Ie({},R,{style:o(o(o({},vn),R.style),i?{}:En(s)),ref:function(e){q(e),R.ref&&R.ref(e)},onKeyDown:function(e){E&&e.keyCode===bn&&C(e),R.onKeyDown&&R.onKeyDown(e)},hidden:"hidden-attribute"===s?i:void 0,tabIndex:"-1"}),l)),a):null},gn=function(e){var t=e.onMouseDownPassive,o=Ae(e,["onMouseDownPassive"]),a=n.useState(null),c=r(a,2),l=c[0],i=c[1];return mn((function(){return l?(l.addEventListener("mousedown",t,{passive:!1}),function(){l.removeEventListener("mousedown",t,{passive:!1})}):function(){}}),[l]),n.createElement("div",Ie({ref:function(e){i(e),o.ref&&o.ref(e)}},o))},En=function(e){return"display-none"===e?{display:"none"}:"visibility-hidden"===e?{visibility:"hidden"}:{}},yn=function(e){var t=document.activeElement;return e===t||e.contains(t)},bn=27,Nn=System.resolve("./assets/dialog.css",t.meta.url),kn=function(e){return n.createElement(n.Fragment,null,n.createElement(Se,{href:Nn}),n.createElement(hn,Ie({container:W(),backdropProps:{className:"dialog--backdrop"},style:{top:"10%",left:"6%",right:"6%",bottom:"8%",height:"auto",width:"auto",padding:"0",border:"none",background:"none",maxWidth:"620px",margin:"0 auto"},className:"dialog"},e)))},xn=System.resolve("./assets/swords-disabled.png",t.meta.url),Cn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?R():t,r=k(n);return s(r)?r.numberOfSwords:null},wn=function(){var e=R(),t=ct(),r=Cn();if(!e)return null;var o=k(e);if(!s(o))return null;var a=$e(t,y),c=new Array(r).fill("");return n.createElement("div",{className:"sword-challenge-indicators"},c.map((function(e,t){return a>=t+1?n.createElement(Sn,{key:t}):n.createElement(In,{key:t})})))},Sn=function(){return n.createElement("div",{className:"sword-icon"},n.createElement(Te,{src:i}))},In=function(){return n.createElement("div",{className:"sword-icon disabled"},n.createElement(Te,{src:xn}))},An=function(){return n.createElement("div",{className:"star-rain-container"},n.createElement("div",{className:"star",id:"star-01"},n.createElement(Dn,null)),n.createElement("div",{className:"star",id:"star-02"},n.createElement(Dn,null)),n.createElement("div",{className:"star",id:"star-03"},n.createElement(Dn,null)),n.createElement("div",{className:"star",id:"star-04"},n.createElement(Dn,null)),n.createElement("div",{className:"star",id:"star-05"},n.createElement(Dn,null)),n.createElement("div",{className:"star",id:"star-06"},n.createElement(Dn,null)))},Dn=function(){return n.createElement("svg",{viewBox:"0 0 217.791 210.633"},n.createElement("path",{fill:"#FFFFE6",d:"M94.15,77.97c0,0-2-54,10-73.5s23,28.5,25.5,72.5c0,0,69.197,4.589,86.5,21c13.637,12.934-61.5,31-87,33.5 c-2,14.5-1.831,60.464-16.5,75.5c-20,20.5-25.5-50.5-23-78c-19-1.5-81.5-3.5-89-17.5S52.15,85.97,94.15,77.97z"}))},On=n.useState,Rn=n.useEffect,Mn=function(){var e=k(R()),t=ct(),n=$e(t,y),r=Cn();return!!s(e)&&!(n>=r)},Pn=function(){var e=k(R());return n.createElement("div",{className:"score-area ".concat(Mn()?"animated":"")},e?n.createElement(jn,null):null)},jn=function(){var e=pt(),t=k(R()),o=q(),a=On(!1),c=r(a,2),l=c[0],i=c[1];return n.createElement(n.Fragment,null,v(t)?n.createElement(qn,null):null,o&&n.createElement(An,null),n.createElement("div",{className:"round-score ".concat(Mn()?"hidden":""),onClick:function(){i(!0)}},e),s(t)?n.createElement(Ln,null):null,n.createElement(Tn,{dialogIsOpen:l,closeDialog:function(){i(!1)}}))},qn=function(){return _()?n.createElement("div",{className:"pirate-hook"}):n.createElement("div",{style:{display:"none"},className:"pirate-hook"})},Ln=function(){var e=pt(),t=ct(),o=$e(t,y),a=Cn(),c=new Array(a).fill(""),l=o>=a,i=Xe((function(e){return e<o}),[o]),u=On(!1),s=r(u,2),d=s[0],f=s[1];return Rn((function(){i&&f(!0)}),[i]),Rn((function(){if(d){var e=setTimeout((function(){f(!1)}),300);return function(){clearTimeout(e)}}return function(){}}),[d]),n.createElement(n.Fragment,null,n.createElement("div",{className:"ropes ".concat(l?"challenge-won":"")},c.map((function(e,t){return o>=t+1?n.createElement("div",{key:t,className:"rope rope-".concat(t+1," cut-rope")}):n.createElement("div",{key:t,className:"rope rope-".concat(t+1)})}))),d&&o<=a?n.createElement("div",{className:"sword-slice"},n.createElement("div",{className:"triangle-left"}),n.createElement("div",{className:"triangle-right"})):null,n.createElement("div",{className:"negative-round-score rotate-".concat(o," ").concat(l?"removed":"")},e))},Tn=function(e){var t=e.dialogIsOpen,r=e.closeDialog;return n.createElement(kn,{isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0},n.createElement("div",{className:"border border-right"}),n.createElement("div",{className:"border border-left"}),n.createElement("div",{className:"border border-top"}),n.createElement("div",{className:"border border-bottom"}),n.createElement("div",{className:"dialog-title"},"Score"),n.createElement("div",{className:"dialog-content score-rules-dialog"},n.createElement("div",{className:"dialog-body"},n.createElement("div",{className:"dialog-box"},n.createElement("div",{className:"dialog-label"},"Combinaisons de dés"),n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Symbols identiques"),n.createElement("span",{className:"symbol-number"},"3"),n.createElement("span",{className:"symbol-number"},"4"),n.createElement("span",{className:"symbol-number"},"5"),n.createElement("span",{className:"symbol-number"},"6"),n.createElement("span",{className:"symbol-number"},"7"),n.createElement("span",{className:"symbol-number"},"8")),n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Points"),n.createElement("span",{className:"points"},"+100"),n.createElement("span",{className:"points"},"+200"),n.createElement("span",{className:"points"},"+500"),n.createElement("span",{className:"points"},"+1000"),n.createElement("span",{className:"points"},"+2000"),n.createElement("span",{className:"points"},"+4000")))),n.createElement("div",{className:"dialog-box"},n.createElement("div",{className:"dialog-label"},"Dés spéciaux"),n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Symbol"),n.createElement(Te,{src:G}),n.createElement(Te,{src:J})),n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Points"),n.createElement("span",{className:"points"},"+100"),n.createElement("span",{className:"points"},"+100")))),n.createElement("div",{className:"dialog-box last"},n.createElement("div",{className:"dialog-label"},"Bonus coffre plein"),n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Dés utilisés"),n.createElement("span",{className:"symbol-number"},"8")),n.createElement("div",{className:"column"},n.createElement("div",{className:"column-title"},"Points"),n.createElement("span",{className:"points"},"+500")))))))},Fn=50,Bn=System.resolve("./assets/cursed-grid.png",t.meta.url),Un=function(e){var t=e.chestRef,r=e.diceOverChestSignal,a=F(),c=dt(),l=He(r),i=k(R()),u=c&&L(i);return n.createElement("div",{className:"chest"},n.createElement("div",{ref:t,className:"dice-area ".concat(L(i)?"glow":""),style:o({},l?{outline:"2px dotted"}:{})},n.createElement("div",{className:"box"},Object.keys(a).map((function(e){return n.createElement("div",{className:"slot",key:e,"data-chest-slot":e},n.createElement(zn,{chestSlotContent:a[e]}))}))),n.createElement("div",{className:"top-left-corner"}),n.createElement("div",{className:"top-right-corner"}),n.createElement("div",{className:"bottom-left-corner"}),n.createElement("div",{className:"bottom-right-corner"}),c&&!u?n.createElement(Wn,null):null),n.createElement(Pn,null))},zn=function(e){var t=e.chestSlotContent,r=k(R());if(!t)return null;if("symbol"===t.type){var o=t.value;return n.createElement("button",{className:"dice",style:{width:Fn,height:Fn,color:"#fcfcfc",margin:"5px",backgroundColor:r.color1,borderColor:r.color2,borderWidth:"2px",borderStyle:"solid"}},n.createElement(Te,{src:X(o),draggable:"false",style:{width:"100%",height:"100%"}}))}return null},Wn=function(){return n.createElement("div",{className:"cursed-cover"},n.createElement(Te,{draggable:"false",src:Bn,alt:"cursed-cover"}))},_n={animals:{name:"Animaux",rule:"Les singes et les perroquest obtenus sur les dés comptent comme un même symbol dans une combinaison.",more:"Par exemple 2 perroquets et 3 singes forment une conbinaison de 5 dés identiques, soit 500 points."},chest:{name:"Coffre au trésor",rule:'Lorsque le joueur sauvegarde ses dés, grâce à la carte "Coffre au trésor" les dés sont protégés du mauvais sort.',more:"Ainsi même lorsque le joueur obtient 3 têtes de morts, son tour prends fin, mais il peut marquer les points totalisés grâce aux dés sauvegardés!"},coin:{name:"Pièce d'or",rule:"Le joueur commence son tour avec un symbol pièce d'or. Il rapporte des points aussi bien dans une combinaison de dés que comme simple pièce (+100)."},diamond:{name:"Diamant",rule:"Le joueur commence son tour avec un symbol diamant. Il rapporte des points aussi bien dans une combinaison de dés que comme simple diamant (+100)."},pirate:{name:"Capitaine des pirates",rule:"Grâce à l'aide du capitaine, tous les points comptabilisés pendant ce tour sont doublés !"},witch:{name:"Sorcière",rule:"Avec ses potions magiques, la sorcière permet exceptionnellement au joueur de relancer, une fois, un dé avec une tête de mort."},"1skull":{name:"Tête de mort",rule:"Le tour du joueur débute avec un symbole tête de mort."},"2skulls":{name:"2 têtes de mort",rule:"Le tour du joueur débute avec 2 symboles tête de mort."},"2sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 2 symbols sabres. Si il y parvient, il gagne +300 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -300 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"3sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 3 symbols sabres. Si il y parvient, il gagne +500 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -500 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"4sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 4 symbols sabres. Si il y parvient, il gagne +1000 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -1000 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."}},Gn=function(e){var t=e.dialogIsOpen,r=e.closeDialog,o=e.card,a=_n[o.type];return n.createElement(kn,{isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0},n.createElement("div",{className:"border border-right"}),n.createElement("div",{className:"border border-left"}),n.createElement("div",{className:"border border-top"}),n.createElement("div",{className:"border border-bottom"}),n.createElement("div",{className:"dialog-title"},"Carte"),n.createElement("div",{className:"dialog-content card-rules-dialog"},n.createElement("div",{className:"dialog-body"},a&&n.createElement(n.Fragment,null,n.createElement("div",{className:"dialog-label"},a.name),n.createElement(Te,{className:"current-card",src:Y(o),alt:o.type}),n.createElement("div",{className:"text-rule"},a.rule),a.more?n.createElement("div",{className:"text-rule"},a.more):null))))},Jn=function(e){var t=e.duration,n=void 0===t?300:t,r=e.timingFunction,o=void 0===r?function(e){return e}:r,a=e.onProgress,c=void 0===a?function(){}:a,l=e.onCancel,i=void 0===l?function(){}:l,u=e.onComplete,s=void 0===u?function(){}:u;if(isNaN(n))return console.warn("duration must be a number, received ".concat(n)),function(){};n=parseInt(n,10);var d,f=performance.now(),m=!1,v=0,p=0;!function e(){d=null;var t=performance.now();v=Math.min((t-f)/n,1),p=o(v),c({done:m=1===v,rawProgress:v,progress:p}),m?s():d=window.requestAnimationFrame(e)}();return function(){d&&(window.cancelAnimationFrame(d),d=null),m||(m=!0,i({rawProgress:v,progress:p}))}},Xn=function(e,t){var o=n.useState(null),a=r(o,2),c=a[0],l=a[1],i=Ze(e);n.useEffect((function(){i!==e&&l({from:i,to:e})}),[i,e]),n.useEffect((function(){return c?t(c.from,c.to):function(){}}),[c])},Yn=function(e){var t=e.openScoreboard,o=n.useState(!1),a=r(o,2),c=a[0],l=a[1],i=k(R()),u=_();return n.createElement("div",{className:"header"},n.createElement("div",{className:"card-container",onClick:function(){i&&l(!0)}},n.createElement("div",{className:"small-card"},n.createElement(Zn,null)),u&&n.createElement(wn,null)),n.createElement(Kn,{openScoreboard:t}),n.createElement(Qn,null),i?n.createElement(Gn,{card:i,dialogIsOpen:c,closeDialog:function(){l(!1)}}):null)},Zn=function(){var e=k(R()),t=_();return e&&t?n.createElement(Hn,{card:e}):n.createElement(Vn,null)},Vn=function(){return n.createElement("div",{className:"card default-card",style:{backgroundImage:"url(".concat(ce,")"),backgroundSize:"217px"}})},Hn=function(e){var t=e.card;return n.createElement("div",{className:"card current-card",id:"small-card",style:{backgroundColor:t.color1,borderColor:t.color2}},n.createElement(Te,{src:Z(t),alt:t.type}))},Kn=function(e){var t=e.openScoreboard,r=rt();return n.createElement(Te,{onClick:t,className:"avatar",src:r&&r.character.img,alt:"player",style:{borderColor:r&&r.character.color||"white"}})},Qn=function(){var e=rt(),t=e.score,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.duration,a=void 0===o?300:o,c=t.timingFunction,l=n.useState(null),i=r(l,2),u=i[0],s=i[1];return Xn(e,(function(e,t){return s({value:e}),Jn({duration:a,timingFunction:c,onProgress:function(n){var r=n.progress,o=Math.round(e+(t-e)*r);s({value:o})},onComplete:function(){s(null)}})})),u}(t,{duration:1200,timingFunction:function(e){return 1-Math.pow(1-e,5)}});return n.createElement("div",{className:"total-score"},n.createElement("span",{className:"score",style:{backgroundColor:e&&e.character.color||"white"}},o?o.value:t))},$n=function(e,t,n){var r=tr(n),o=Math.cos(r),a=Math.sin(r),c=t.x-e.x,l=t.y-e.y;return{x:Math.round(o*c+a*l+e.x),y:Math.round(o*l-a*c+e.y)}},er=function(e){var t=r(e,4),n=t[0],o=t[1],a=t[2],c=t[3];return{x:(n.x+o.x+a.x+c.x)/4,y:(n.y+o.y+a.y+c.y)/4}},tr=function(e){return e*Math.PI/180},nr=function(e,t){return!!rr(t,(function(t){return n=t,o=r(e,2),a=o[0],c=o[1],l=r(n,2),i=l[0],u=l[1],s=(u.x-i.x)*(a.y-i.y)-(u.y-i.y)*(a.x-i.x),d=(c.x-a.x)*(a.y-i.y)-(c.y-a.y)*(a.x-i.x),f=(u.y-i.y)*(c.x-a.x)-(u.x-i.x)*(c.y-a.y),(0!==s||0!==d||0!==f)&&0!==f&&(d/=f,(s/=f)>=0&&s<=1&&d>=0&&d<=1);var n,o,a,c,l,i,u,s,d,f}))},rr=function(e,t){var n=r(e,4),o=n[0],a=n[1],c=n[2],l=n[3];return!!t([o,a])||(!!t([a,c])||(!!t([c,l])||!!t([l,o])))},or=function(e,t){var n=e.left,r=e.right,o=r-n;n<t.left?r=(n=t.left)+o:r>t.right&&(r=(n=t.right-o)+o);var a=e.top,c=e.bottom,l=c-a;return a<t.top?c=(a=t.top)+l:c>t.bottom&&(c=(a=t.bottom-l)+l),{left:n,right:r,top:a,bottom:c}},ar=function(e){var t=e.left,n=e.right,r=e.top;return{x:t+(n-t)/2,y:r+(e.bottom-r)/2}},cr=function(e,t){var n,r,o,a,c=ar(e),l=ar(t);return r=l,o=(n=c).x-r.x,a=n.y-r.y,Math.sqrt(o*o+a*a)},lr=function(e){var t,n,r,o=e.getBoundingClientRect(),a=(n=ve(t=e),r=pe(t),{x:n.pageXOffset||r.documentElement.scrollLeft,y:n.pageYOffset||r.documentElement.scrollTop}),c=o.left+a.x,l=o.top+a.y,i=c+o.width,u=l+o.height;return{left:Math.floor(c),top:Math.floor(l),right:Math.floor(i),bottom:Math.floor(u)}},ir=function(e,t){var n,r,o=lr(e);return r=t,!((n=o).right<=r.left||n.left>=r.right||n.bottom<=r.top||n.top>=r.bottom)},ur=function(e,t){var n=e.map((function(e){return lr(e)})),r=function(e,t){var n=cr(t,e[0]);return e.reduce((function(e,r){var o=cr(t,r);return o<n?(n=o,r):e}))}(n,t);return e[n.indexOf(r)]},sr=function(e){var t=e.x,n=e.y,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.color,a=void 0===o?"yellow":o,c=r.autoRemoveAfter,l=void 0===c?2e3:c,i=document.createElement("div");i.style.position="absolute",i.style.zIndex="1000",i.style.left="".concat(t,"px"),i.style.top="".concat(n,"px"),i.style.width="5px",i.style.height="5px",i.style.background=a,i.style.border="1px solid red",document.body.appendChild(i);var u,s=function(){document.body.removeChild(i)};return l&&(u=setTimeout(s,l)),function(){s(),clearTimeout(u)}},dr=6.25,fr=function(e,t){var n=t.rolledAreaDomNode,r=lr(n),o=r.right-r.left,a=r.bottom-r.top,c={left:dr,right:o-56.25,top:dr,bottom:a-56.25},l=[],i=function(e){var t=0;return function n(){var r=mr(e,c),o=vr(),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:er(e);return e.map((function(e){return $n(n,e,t)}))}(r,o);return!l.some((function(e){return t=e,rr(a,(function(e){return nr(e,t)}));var t}))||t>50?{rectangle:r,rotation:o,rotatedRectangle:a}:(t++,n())}()};return e.forEach((function(e,t){e.visibleFaceIndex=pr(e);var n=i(e),r=n.rectangle,o=n.rotation,a=n.rotatedRectangle;l.push(a),e.rolledAreaZIndex=t+1,e.rolledAreaPosition=r[0],e.rotation=o})),e},mr=function(e,t){var n={x:hr(t.left,t.right),y:hr(t.top,t.bottom)};return[{x:n.x,y:n.y},{x:n.x+Fn,y:n.y},{x:n.x+Fn,y:n.y+Fn},{x:n.x,y:n.y+Fn}]},vr=function(){return hr(-35,35)},pr=function(e){return hr(0,e.faces.length-1)},hr=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},gr=function(e){var t=e.rolledAreaRef,r=st(),o=I(),a=ot(),c=Er(),l=k(R()),i=dt(),u=o.length<2&&!a,s=i&&L(l),d=u||s;return r?n.createElement("div",{className:"roll-action"},n.createElement("button",{onClick:function(){c(t.current)},disabled:d},"Lancer",u&&!s&&n.createElement("span",{className:"button-subtitle"},"(au moins 2 dés !)")),s&&n.createElement(Te,{src:V,className:"skull-symbol"})):null},Er=l((function(e,t){var n=e.dices,r=e.rollCount,a=e.diceRolledIds,c=(0===r?Object.keys(n):a).map((function(e){return n[e]}));return fr(c,{rolledAreaDomNode:t}),o(o({},e),{},{rollCount:r+1,witchUncursedDiceId:null,diceRolledIds:c.map((function(e){return e.id})),dices:o({},n)})})),yr=function(e){var t=e.onRoundOver,r=e.rolledAreaRef;return n.createElement("div",{className:"footer actions"},n.createElement(gr,{rolledAreaRef:r}),n.createElement(br,null),n.createElement(Nr,{onRoundOver:t}))},br=function(){var e=pt(),t=yt(),r=vt(),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hasRolledOnce,n=void 0===t?at():t,r=e.scoreMarked,o=void 0===r?q():r,a=e.currentCardId,c=void 0===a?R():a,l=e.hasDicesToCurse,i=void 0===l?it():l;return!(o||i||!c||!n)}(),a=e<0?"-":"+";return o?n.createElement("div",{className:"collect-action"},n.createElement("button",{onClick:function(){t(e)},disabled:!r},n.createElement("span",null,"Collecter"),n.createElement("span",{className:"score"},a," ",Math.abs(e))),!r&&n.createElement(Te,{src:V,className:"skull-symbol"})):null},Nr=function(e){var t=e.onRoundOver,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollDiceAllowed,n=void 0===t?st():t,r=e.markScoreAllowed,o=void 0===r?vt():r,a=e.hasDicesToCurse,c=void 0===a?it():a;return!n&&!o&&!c}(),o=bt(),a=pt();return r?n.createElement("div",{className:"next-round-action"},n.createElement("button",{onClick:function(){o(),t({reason:"score-marked",value:a})}},"Terminer mon tour")):null},kr=System.resolve("./assets/witch-label.png",t.meta.url),xr=function(e){var t=e.cursedAreaRef,r=k(R());return n.createElement("div",{className:"skull-island"},H(r)?n.createElement(wr,null):null,n.createElement("div",{className:"bottle"},n.createElement("div",{className:"area",ref:t},M(r)?n.createElement(Cr,{card:r}):null,j(r)?n.createElement(n.Fragment,null,n.createElement(Cr,{card:r}),n.createElement(Cr,{card:r})):null)))},Cr=function(e){var t=e.card;return n.createElement("button",{className:"dice",style:{width:Fn,height:Fn,color:"#fcfcfc",margin:"1px 5px",backgroundColor:t.color1,borderColor:t.color2,borderWidth:"2px"}},n.createElement(Te,{src:V,style:{width:"100%",height:"100%"}}))},wr=function(){return _()?n.createElement("div",{className:"witch-label"},n.createElement(Te,{src:kr}),n.createElement("svg",{x:"0px",y:"0px",width:"156.083px",height:"208.667px",viewBox:"0 0 156.083 208.667"},n.createElement("path",{id:"path_01",fill:"none",stroke:"#E4AD30",d:"M8.406,107.82 c2.541,2.178,2.375,2.875,14.25,3.5c14.782,0.778,19.26-11.965,19.26-11.965S47.918,88,40.251,72.917s-18.916,4.583-9.083,8.167 s27.759-1.338,35.142-12.417C74.75,56,77.583,45.333,79.25,37S78.477,15.833,66.31,3.833"}),n.createElement("path",{id:"path_02",fill:"none",stroke:"#E4AD30",d:"M44.031,110.094 c0,0,1,1.313-4.438,3.344s-14.244,7.281-32.125-2"}),n.createElement("path",{id:"path_03",fill:"none",stroke:"#E4AD30",d:"M42.125,103.688 c0,0,1.313,6.594-9.313,8.625S10.281,108.719,9.406,101"}),n.createElement("path",{id:"path_04",fill:"none",stroke:"#E4AD30",d:"M33.114,112.253c0,0,39.886-19.253,43.011,24.747 c0.372,0.447-0.959,1.208-2.542,1.625"}))):n.createElement(Te,{style:{display:"none"},src:kr})},Sr=function(e){var t=e.parent,r=e.children;return t?c.createPortal(n.createElement(n.Fragment,null,r),t):null},Ir=function(e){var t=e.rotate,n=e.scale,r=e.translate;return[].concat(u(t?["rotate(".concat(t,"deg)")]:[]),u(n&&1!==n?["scale(".concat(n,")")]:[]),u(r?["translate(".concat(r,")")]:[])).join("")},Ar=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=o.trailing,c=void 0!==a&&a,l=function o(){for(var a=arguments.length,l=new Array(a),i=0;i<a;i++)l[i]=arguments[i];clearTimeout(t);var u=Date.now();if(n){var s=u-n;if(s<r){if(c){var d=r-s;t=setTimeout((function(){return o.apply(void 0,l)}),d)}}else n=u,e.apply(void 0,l)}else n=u,e.apply(void 0,l)},i=function(){clearTimeout(t)};return l.cancel=i,l},Dr=function(e,t){var n,r,a=t.logLevel,c=void 0===a?"warn":a,l=t.onGrip,i=void 0===l?function(){}:l,u=t.onLongGrip,s=void 0===u?function(){}:u,d=t.onClick,f=void 0===d?function(){}:d,m=t.onDrag,v=void 0===m?function(){}:m,p=t.onRelease,h=void 0===p?function(){}:p,g=t.onCancel,E=void 0===g?function(){}:g,y=t.longGripMs,b=void 0===y?300:y,N=K({logLevel:c}),k=!1,x=function(){},C=function(){};N.debug("enable drag on",e);var w,S,I,A,D,O=le(e,"mousedown",(function(e){3===e.which?N.debug("ignore right click"):(P(Rr(e),e),x=le(document,"mousemove",Ar((function(e){q(Rr(e),e)}))),C=le(document,"mouseup",(function(e){C(),x(),L(Rr(e),e)})))}),{passive:!0}),R=le(e,"touchstart",(function(e){P(Mr(e),e),x=le(document,"touchmove",Ar((function(e){q(Mr(e),e)}))),C=le(document,"touchend",(function(e){C(),x(),L(Mr(e),e)}))}),{passive:!0}),M=le(e,"click",(function(e){k||"none"!==D||f(e)})),P=function(t,n){N.debug("gripping node at",t),r=!0,D="none",I=t,w=t,S=Or(e),i({x:S.x,y:S.y,event:n}),A=setTimeout(j,b)},j=function(){k=!0,s()},q=function(e,t){if(w.x!==e.x||w.y!==e.y){w=e;var n=I.x-S.x,r=I.y-S.y,a={x:e.x-n,y:e.y-r},c=e.x-I.x,l=e.y-I.y;N.debug("move node at",a),v(o(o({event:t},a),{},{relativeX:c,relativeY:l,setDropEffect:function(e){D=e}}))}else N.debug("no real move")},L=function(e,t){N.debug("releasing node"),r=!1,clearTimeout(A);var o=I.x-S.x,a=I.y-S.y;h({event:t,dropEffect:D,x:w.x-o,y:w.y-a}),n=setTimeout((function(){k=!1}))};return function(e){M(),O(),R(),x(),C(),clearTimeout(A),clearTimeout(n),function(e){r&&(N.debug("cancelling drag",e),r=!1,E({event:e}))}(e)}},Or=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top}},Rr=function(e){return{x:e.pageX,y:e.pageY}},Mr=function(e){var t=e.changedTouches[0];return{x:t.pageX,y:t.pageY}},Pr=n.useEffect,jr=n.useState,qr=function(e){var t=e.dice,o=e.diceAnimation,a=e.anmationDebug,c=void 0!==a&&a,l=e.parentNode,i=e.zIndex,u=e.x,s=e.y,d=e.rotation,f=e.draggable,m=e.onDiceClick,v=e.onDiceDrag,p=e.onDiceDrop,h=e.onDiceDragEnd,g=e.disapear,E=e.appear,y=W(),b=Q(t.id),N=$(t.id),k=jr(!1),x=r(k,2),C=x[0],w=x[1],S=jr(null),I=r(S,2),A=I[0],O=I[1],R=Ze(l),M=o?R:l;Pr((function(){if(!f||!b||!y)return function(){};var e=!1,n=Dr(b,{onGrip:function(){w(!0)},onClick:function(e){m(t,e)},onDrag:function(n){var r,o,a=n.x,c=n.y,l=n.relativeX,i=n.relativeY,u=n.setDropEffect,s=(r={left:a,right:a+Fn,top:c,bottom:c+Fn},o=lr(y),or(r,o));O({x:s.left,y:s.top}),(e=e||Math.abs(l)>10||Math.abs(i)>10)&&v(t,{relativeX:l,relativeY:i,setDropEffect:u,diceRectangle:s})},onRelease:function(e){var n=e.dropEffect,r=e.x,o=e.y;"none"!==n&&p(t,{diceRectangle:{left:r,right:r+Fn,top:o,bottom:o+Fn}});w(!1),O(null),h(t)},onCancel:function(){w(!1),O(null),h(t)}});return function(){n()}}),[f,b,y,m,v,p,h]),Pr((function(){if(!o||!b)return function(){};var e=o.from,t=o.to,n=o.onfinish;c&&(sr(e),sr(t));var r="translate(".concat(Math.floor(t.x-e.x),"px, ").concat(Math.floor(t.y-e.y),"px)"),a=b.parentNode.animate([{transform:r}],{duration:500,fill:"forwards",easing:"cubic-bezier(0, 0.55, 0.45, 1)"});return a.onfinish=n,function(){a.cancel()}}),[b,o]);var P=D(t),j=o&&o.from?o.from.x:A?A.x:u,q=o&&o.from?o.from.y:A?A.y:s,L=A||o?1e3:i;return n.createElement(Sr,{parent:M},n.createElement("svg",{"data-dice-id":t.id,className:"dice",onClick:f?void 0:function(e){m(t,e)},style:{width:Fn,height:Fn,left:"".concat(j,"px"),top:"".concat(q,"px"),zIndex:L,position:A||o?"fixed":void 0}},n.createElement("g",{ref:N,className:g?"dice-cursed-disapear":E?"dice-cursed-appear":"",style:{transform:Ir({rotate:d||0,scale:C?"1.1":"1"}),transitionProperty:"transform",transitionDuration:"500ms",transitionTimingFunction:"cubic-bezier(0, 0.55, 0.45, 1)",transformOrigin:"center center"}},n.createElement("rect",{className:"dice-background",width:"100%",height:"100%",rx:"5",ry:"5",fill:P?"black":"#fcfcfc",stroke:P?"black":"#b9b9b9",strokeWidth:"1"}),n.createElement("image",{xlinkHref:X(T(t)),draggable:"false",style:{width:"100%",height:"100%"}}))))},Lr=function(e){var t=e.offscreenDomNode,c=e.chestDomNode,l=e.rolledAreaDomNode,i=e.cursedAreaDomNode,u=e.onDiceOverChestChange,s=void 0===u?function(){}:u,d=e.onDiceOverRolledAreaChange,f=void 0===d?function(){}:d,m=S(),v=F(),p=I(),h=O(),g=A(),E=k(R()),y=q(),b=dt(),N=n.useReducer((function(e,t){return o(o({},e),{},a({},t.key,t.value))}),{}),x=r(N,2),C=x[0],w=x[1],M=kt(),P=It(),j=St(),L=wt(),T=xt(),B=n.useRef(null);return Object.keys(m).map((function(e){var r=m[e],a=eo(r,{chestSlots:v,diceRolledIds:p,diceCursedIds:h}),u=to(a,{chestDomNode:c,rolledAreaDomNode:l,cursedAreaDomNode:i,offscreenDomNode:t}),d=u.parentNode,N=r.id!==g&&d===l&&D(r),k=d===i,x=n.useCallback((function(e){var t=Tr(e,{diceRolledIds:p,chestSlots:v,diceCursedIds:h,scoreMarked:y,threeSkullsOrMoreInCursedArea:b,currentCard:E,witchUncursedDiceId:g});if("keep"===t){var n=Hr(v);P(e,n)}else"unkeep"===t?j(e):"uncurse"===t&&L(e)}),[p,v,h,y,b,E,g]),S=n.useCallback((function(e,t){B.current=Br({dragDiceGesture:t,chestDomNode:c,rolledAreaDomNode:l});var n=Fr(e,{diceRolledIds:p,chestSlots:v,dropTargetRef:B,rolledAreaDomNode:l,chestDomNode:c,scoreMarked:y,threeSkullsOrMoreInCursedArea:b});t.setDropEffect(n),s("keep"===n?e:null),f("unkeep"===n?e:null)}),[p,v,B,l,c,y,b,s,f]),I=n.useCallback((function(e,t){var n=Fr(e,{diceRolledIds:p,chestSlots:v,dropTargetRef:B,rolledAreaDomNode:l,chestDomNode:c,scoreMarked:y,threeSkullsOrMoreInCursedArea:b}),r=!1,o=null;if("reposition-in-rolled-area"===n){var a=Zr(t.diceRectangle,l),i=Vr(e,{dices:m,diceRolledIds:p});M(e,a,i)}else if("back-to-rolled-area"===n)r=!0,o=Xr(e.rolledAreaPosition,l);else if("keep"===n){var u=Kr(e,{chestSlots:v,rectangle:t.diceRectangle,chestDomNode:c});P(e,u),r=!0,o=Yr(u,c)}else if("reposition-in-chest"===n){var s=Kr(e,{chestSlots:v,rectangle:t.diceRectangle,chestDomNode:c});Qr(e,v)!==s&&(T(e,s),r=!0,o=Yr(s,c))}else if("back-to-chest"===n){var d=Qr(e,v);r=!0,o=Yr(d,c)}else if("unkeep"===n){var f=Zr(t.diceRectangle,l);M(e,f,Vr(e,{dices:m,diceRolledIds:p})),j(e),r=!0,o=Xr(f,l)}r&&w({key:e.id,value:{from:{x:t.diceRectangle.left,y:t.diceRectangle.top},to:o,onfinish:function(){setTimeout((function(){w({key:e.id,value:null})}))}}})}),[p,v,B,l,c,y,b]),A=n.useCallback((function(){s(null),f(null)}),[s,f]),O=o(o({key:r.id},u),{},{dice:r,diceAnimation:C[r.id],witchUncursedDiceId:g,disapear:N,appear:k,onDiceClick:x,onDiceDrag:S,onDiceDrop:I,onDiceDragEnd:A});return n.useMemo((function(){return n.createElement(qr,O)}),Object.keys(O).map((function(e){return O[e]})))}))},Tr=function(e,t){var n=t.diceRolledIds,r=t.chestSlots,o=t.diceCursedIds,a=t.scoreMarked,c=t.threeSkullsOrMoreInCursedArea,l=t.currentCard,i=t.witchUncursedDiceId;return Ur(e,n)?_r(e,{scoreMarked:a,threeSkullsOrMoreInCursedArea:c})?"keep":"none":zr(e,r)?Gr(e,{scoreMarked:a,threeSkullsOrMoreInCursedArea:c})?"unkeep":"none":Wr(e,o)&&Jr(e,{scoreMarked:a,threeSkullsOrMoreInCursedArea:c,currentCard:l,witchUncursedDiceId:i})?"uncurse":"none"},Fr=function(e,t){var n=t.diceRolledIds,r=t.chestSlots,o=t.dropTargetRef,a=t.rolledAreaDomNode,c=t.chestDomNode,l=t.scoreMarked,i=t.threeSkullsOrMoreInCursedArea;return Ur(e,n)?o.current===a?"reposition-in-rolled-area":o.current===c&&_r(e,{scoreMarked:l,threeSkullsOrMoreInCursedArea:i})?"keep":"back-to-rolled-area":zr(e,r)?o.current===c?"reposition-in-chest":o.current===a&&Gr(e,{scoreMarked:l,threeSkullsOrMoreInCursedArea:i})?"unkeep":"back-to-chest":"none"},Br=function(e){var t=e.dragDiceGesture,n=e.chestDomNode,r=e.rolledAreaDomNode;return ir(n,t.diceRectangle)?n:ir(r,t.diceRectangle)?r:null},Ur=function(e,t){return t.includes(e.id)},zr=function(e,t){return Object.keys(t).some((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},Wr=function(e,t){return t.includes(e.id)},_r=function(e,t){var n=t.scoreMarked,r=t.threeSkullsOrMoreInCursedArea;return!n&&!r},Gr=function(e,t){var n=t.scoreMarked,r=t.threeSkullsOrMoreInCursedArea;return!n&&!r},Jr=function(e,t){var n=t.scoreMarked,r=t.threeSkullsOrMoreInCursedArea,o=t.currentCard,a=t.witchUncursedDiceId;return!n&&(!r&&(!!H(o)&&a===e.id))},Xr=function(e,t){var n,r,o,a,c=(n={left:e.x,top:e.y,right:0,bottom:0},r=lr(t),o=n.right-n.left,a=n.bottom-n.top,{left:r.left+n.left,top:r.top+n.top,right:r.left+n.left+o,bottom:r.top+n.top+a});return{x:c.left,y:c.top}},Yr=function(e,t){var n=$r(e,t),r=lr(n);return{x:r.left+5,y:r.top+5}},Zr=function(e,t){var n=function(e,t){var n=lr(t);return function(e,t){var n=e.left-t.left,r=n+(e.right-e.left),o=e.top-t.top;return{left:n,right:r,top:o,bottom:o+(e.bottom-e.top)}}(or(e,n),n)}(e,t);return{x:n.left,y:n.top}},Vr=function(e,t){var n=t.diceRolledIds,r=t.dices;if(0===n.length)return 1;var o=n.slice(1).reduce((function(e,t){var n=r[t];return n.rolledAreaZIndex>e.rolledAreaZIndex?n:e}),r[n[0]]);return o===e?e.rolledAreaZIndex:o.rolledAreaZIndex+1},Hr=function(e){return Object.keys(e).find((function(t){return!e[t]}))},Kr=function(e,t){var n=t.chestSlots,r=t.rectangle,o=t.chestDomNode,a=new Map,c=[];Object.keys(n).forEach((function(t){var r=n[t];if(!r||"dice"===r.type&&r.value===e.id){var l=$r(t,o);a.set(l,t),c.push(l)}}));var l=ur(c,r);return a.get(l)},Qr=function(e,t){return Object.keys(t).find((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},$r=function(e,t){return t.querySelector('[data-chest-slot="'.concat(e,'"]'))},eo=function(e,t){var n=t.chestSlots,r=t.diceRolledIds,a=t.diceCursedIds,c=Object.keys(n).find((function(t){return n[t]&&"dice"===n[t].type&&n[t].value===e.id}));return c?{type:"chest-slot",value:c}:r.includes(e.id)?{type:"rolled-area",value:o(o({},e.rolledAreaPosition),{},{rotation:e.rotation,zIndex:e.rolledAreaZIndex})}:a.includes(e.id)?{type:"cursed-area",value:void 0}:{type:"offscreen-area"}},to=function(e,t){var n=e.type,r=e.value,o=t.chestDomNode,a=t.rolledAreaDomNode,c=t.cursedAreaDomNode,l=t.offscreenDomNode;return"chest-slot"===n?{parentNode:o.querySelector('[data-chest-slot="'.concat(r,'"]')),zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!0}:"rolled-area"===n?{parentNode:a,zIndex:r.zIndex,rotation:r.rotation,x:r.x,y:r.y,draggable:!0}:"cursed-area"===n?{parentNode:c,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}:{parentNode:l,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}},no=function(e){var t=e.dialogIsOpen,r=e.closeDialog,o=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cardIds;return(void 0===e?C():e).map((function(e){return k(e)}))}(),a=R(),c=k(a)||null;return n.createElement(kn,{isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!1},n.createElement("div",{className:"dialog-content draw-card-dialog"},n.createElement("div",{className:"dialog-body"},n.createElement("div",{className:"dialog-label"},0===o.length&&!c&&"Paquet de cartes épuisé. Mélangez-le pour pouvoir piocher à nouveau !",0!==o.length&&!c&&"Piochez une carte pour le tour suivant.",c&&n.createElement("span",{className:"card-name"},_n[c.type].name)),n.createElement("div",{className:"card-area"},n.createElement("div",{style:{position:"relative"}},n.createElement(oo,{currentCard:c,remainingCardCount:o.length}),n.createElement(ro,{currentCard:c})))),n.createElement("div",{className:"dialog-actions"},n.createElement(ao,{cardDeck:o,currentCard:c}),c?n.createElement(io,{currentCard:c,closeDialog:r}):null)))},ro=function(e){var t=e.currentCard;return t?n.createElement(n.Fragment,null,n.createElement("div",{className:"card current-card",id:"big-card"},n.createElement("div",{className:"flip-card"},n.createElement("div",{className:"flip-card-inner"},n.createElement("div",{className:"flip-card-front"},n.createElement(Te,{className:"card default-card",src:ce})),n.createElement("div",{className:"flip-card-back"},n.createElement(Te,{className:"card-img",src:Y(t),width:"150",alt:t.type}))))),n.createElement("div",{className:"small-card"},n.createElement(Hn,{card:t}))):null},oo=function(e){var t=e.currentCard,r=e.remainingCardCount;return n.createElement("div",{className:"card default-card",id:"back-deck-card",style:{background:"none"}},n.createElement(Te,{src:ce,width:"150"}),!t&&n.createElement("div",{className:"remaining-cards-number"},r))},ao=function(e){var t=e.cardDeck;return e.currentCard?null:0===t.length?n.createElement(lo,null):n.createElement(co,null)},co=function(){var e=jt();return n.createElement("button",{className:"draw-card-btn",onClick:e},"Piocher")},lo=function(){var e=Tt();return n.createElement("button",{className:"draw-card-btn",onClick:function(){document.getElementById("back-deck-card").setAttribute("shaking-deck",""),setTimeout((function(){document.getElementById("back-deck-card").removeAttribute("shaking-deck",""),e()}),1e3)}},"Mélanger")},io=function(){var e=gt(),t=function(){var t,n,r,o;t=500,n=document.querySelector("#big-card"),r=document.querySelector("#back-deck-card"),o=document.querySelector("#small-card"),r.style.opacity=0,n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(0)",opacity:0}],{duration:t,fill:"forwards"}),o.animate([{transform:"scale(0)",opacity:0,position:"fixed",top:"auto",left:"auto"},{transform:"scale(1)",opacity:1,position:"fixed",top:"15px",left:"15px"}],{duration:t,fill:"forwards"}),setTimeout((function(){e()}),500)};return n.createElement("button",{className:"draw-card-btn",onClick:function(){t()}},"Commencer")},uo=function(e){var t=e.openScoreboard,o=e.onRoundStart,a=e.onRoundOver,c=_(),l=n.useState(!1),i=r(l,2),u=i[0],s=i[1];n.useEffect((function(){o()}),[]);var d=Ve(),f=Ve();return n.createElement("div",{className:"round-container"},n.createElement(Ft,null),n.createElement(Yn,{openScoreboard:t}),c?n.createElement(so,{diceOverRolledAreaSignal:d,diceOverChestSignal:f,openScoreboard:t,onRoundOver:a,onRoundMounted:function(e){s(e)}}):null,u?n.createElement(Lr,{offscreenDomNode:u.offscreenDomNode,chestDomNode:u.chestDomNode,rolledAreaDomNode:u.rolledAreaDomNode,cursedAreaDomNode:u.cursedAreaDomNode,onDiceOverChestChange:f.emit,onDiceOverRolledAreaChange:d.emit}):null,n.createElement(no,{dialogIsOpen:!c}))},so=function(e){var t=e.diceOverRolledAreaSignal,r=e.diceOverChestSignal,o=e.onRoundMounted,a=e.onRoundOver,c=n.useRef(null),l=n.useRef(null),i=n.useRef(null),u=n.useRef(null);return n.useEffect((function(){o({rolledAreaDomNode:c.current,chestDomNode:l.current,cursedAreaDomNode:i.current,offscreenDomNode:u.current})}),[]),n.createElement(n.Fragment,null,n.createElement(Dt,null),n.createElement("div",{className:"chest-and-skulls"},n.createElement(Un,{chestRef:l,diceOverChestSignal:r}),n.createElement(xr,{cursedAreaRef:i})),n.createElement(zt,{rolledAreaRef:c,offscreenRef:u,diceOverRolledAreaSignal:t}),n.createElement(yr,{onRoundOver:a,rolledAreaRef:c}))},fo=function(e){var t=e.closeDialog,r=e.dialogIsOpen,o=e.player,a=ht();return n.createElement(kn,{isOpen:r,onRequestClose:t,requestCloseOnClickOutside:!0},n.createElement("div",{className:"dialog-content score-board-dialog"},n.createElement("div",{className:"cross",onClick:t},"X"),n.createElement("div",{className:"dialog-body"},n.createElement("div",null,"Au tour de",n.createElement("div",{className:"dialog-label"},o.character.name),n.createElement(Te,{className:"player-img",src:o&&o.character.img,alt:"player",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(o&&o.character.color||"black")}})),n.createElement("div",{className:"dialog-actions"},n.createElement("button",{onClick:function(){t(),a(o)}},"Jouer")))))},mo=System.resolve("./assets/win-treasure.png",t.meta.url),vo=6e3,po={path1:"M39.582,739.564c0-91.824,39.191-96.32,38.045-166.691s-30.042-70.37-47.326-161.729s38.128-86.388,31.276-186.42C55.405,134.602-3.014,89.176,8.812,129.825c5.333,18.333,30.77-21,30.77-129.825",path2:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0",path3:"M39.582,739.564c0-71.926-15.437-155.074-17.437-253.074s30-185,31.087-217s-31.087-46-31.087-26s33,10,31-32s-31-110-31-144S39.582,0,39.582,0",path4:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0"},ho=function(e){var t=e.openedByUser,o=e.closeScoreboard,a=e.playerAnimation,c=N(),l=rt(),i=ee(),u=n.useState(!1),s=r(u,2),d=s[0],f=s[1],m=function(){f(!0)},v=go();return n.createElement("div",{className:"score-board-container"},t&&n.createElement("div",{className:"cross",onClick:o},"X"),!i&&!l&&n.createElement("div",{className:"action-container"},n.createElement("button",{className:"score-board-action",onClick:function(){m()}},"Commencer à jouer")),n.createElement(Te,{className:"win-treasure-img",src:mo,alt:"win-treasure"}),n.createElement("div",{className:"users-path"},c.map((function(e){return n.createElement(Eo,{key:e.id,player:e,pathCoordinates:po["path".concat(e.id)],score:e.score,character:e.character,openStartPlayerRoundDialog:m,isCurrentPlayer:l&&e.id===l.id,playerAnimation:a})}))),n.createElement(fo,{dialogIsOpen:d,closeDialog:function(){f(!1)},player:v}))},go=function(){var e,t=rt(),n=N();if(t){var r=n.findIndex((function(e){return e.id===t.id}));e=r===n.length-1?n[0]:n[r+1]}else e=n[0];return e},Eo=function(e){var t=e.pathCoordinates,o=e.player,a=e.character,c=e.score,l=e.openStartPlayerRoundDialog,i=e.playerAnimation,u=n.useRef(null),s=n.useRef(null),d=go(),f=n.useState(),m=r(f,2),v=m[0],p=m[1];return n.useEffect((function(){i&&i.player===o?p(i.score):p(null)}),[i,o]),n.useEffect((function(){if(!v)return function(){};var e=v.from,t=v.to,n=u.current,r=n.getTotalLength(),o=n.animate([{strokeDashoffset:bo(e/vo,r)},{strokeDashoffset:bo(t/vo,r)}],{duration:1e3,fill:"forwards"}),a=s.current.animate([{offsetDistance:yo(e/vo)},{offsetDistance:yo(t/vo)}],{duration:1e3,fill:"forwards"});return o.onfinish=function(){"finished"===a.playState&&p(null)},a.onfinish=function(){"finished"===o.playState&&p(null)},function(){o.cancel(),a.cancel()}}),[v]),n.useEffect((function(){var e=u.current,t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=bo(c/vo,t)}),[c]),n.createElement("div",{className:"user-path"},n.createElement("svg",{viewBox:"0 0 79.164 739.564"},n.createElement("path",{d:t,className:"path-background"}),n.createElement("path",{ref:u,d:t,className:"path-foreground"}),n.createElement("circle",{ref:s,r:"13",fill:a.color||"white",className:"score-indicator",style:{offsetPath:"path('".concat(t,"')"),offsetDistance:yo(c/vo)}})),n.createElement("div",{className:"speech-bubble"},c),n.createElement("div",{className:"user-avatar ".concat(d.character.id===a.id?"next-player":""),onClick:function(){d.character.id===a.id&&l()}},n.createElement(No,{character:a})))},yo=function(e){return"".concat(100*e,"%")},bo=function(e,t){return t-e*t},No=function(e){var t=e.character;return n.createElement(Te,{className:"player-img",src:t.img,alt:"player",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(t.color||"black")}})},ko=function(){var e=xo();return n.createElement("div",null,n.createElement("p",null,"Combien de joueur?"),[1,2,3,4,5].map((function(t){return n.createElement("button",{key:t,onClick:function(){e(t)}},1===t?"1 joueur":"".concat(t," joueurs"))})))},xo=l((function(e,t){return o(o({},e),{},{players:new Array(t).fill("").map((function(e,t){return{id:t+1,number:t+1,score:0}}))})})),Co=[{id:1,name:"Luffy",color:"#ef9620",img:System.resolve("./assets/Luffy.png",t.meta.url)},{id:2,name:"Miss Fortune",color:"#d90f1b",img:System.resolve("./assets/MissFortune.png",t.meta.url)},{id:3,name:"Jack Sparrow",color:"#007033",img:System.resolve("./assets/JackSparrow.png",t.meta.url)},{id:4,name:"Barbe Rouge",color:"#7baac9",img:System.resolve("./assets/BarbeRouge.png",t.meta.url)},{id:5,name:"Ginette Boulette",color:"#e2500c",img:System.resolve("./assets/GinetteBoulette.png",t.meta.url)},{id:6,name:"Capitaine Crochet",color:"#952460",img:System.resolve("./assets/CapitaineCrochet.png",t.meta.url)}],wo=function(e){var t=e.players,r=Do(),o=Io(),a=t.find((function(e){return!e.character}));return Oo(),n.useEffect((function(){Oo()}),[]),n.createElement("div",{className:"character-selection-page"},n.createElement(So,null),a&&n.createElement(n.Fragment,null,n.createElement("p",null,"Joueur ",a.number," : quel pirate êtes vous ?"),n.createElement("div",{className:"characters-container",id:"menu-wrapper"},n.createElement("div",{className:"characters menu"},Co.map((function(e){return n.createElement("div",{className:"character item ".concat(Ao(e,t)?"":"disabled"),key:e.id,onClick:function(t){t.target.animate([{transform:"scale(1)"},{transform:"scale(1.3)"},{transform:"scale(1)"}],{duration:400,fill:"forwards"}),r(a,e)}},n.createElement(Te,{className:"character-img",src:e&&e.img,alt:"player",style:{border:"4px solid ".concat(e&&e.color||"black")}}),n.createElement("span",null,e.name))}))),n.createElement("div",{className:"paddles"},n.createElement("button",{className:"left-paddle paddle hidden"},"<"),n.createElement("button",{className:"right-paddle paddle",onClick:function(){Oo()}},">")))),!a&&n.createElement("div",{className:"crew-completed"},n.createElement("p",null,"L‘équipage est au complet !"),n.createElement(Te,{src:Z({type:te})}),n.createElement("button",{onClick:function(){o()}},"Démarrer la partie")))},So=function(){var e=N();return n.createElement("div",{className:"crew ".concat(e.length>3?"large-crew":"")},n.createElement("p",null,"Votre équipage:"),n.createElement("ul",null,e.map((function(e){return n.createElement("li",{key:e.id},e.character?n.createElement(Te,{className:"crew-member-img",src:e.character&&e.character.img,alt:"player",style:{border:"4px solid ".concat(e.character&&e.character.color||"black")}}):n.createElement("div",{className:"placeholder-img"}),n.createElement("span",null,e.character?e.character.name:"Joueur".concat(e.number)))}))))},Io=l((function(e){var t=e.cardIds;return o(o({},e),{},{gameStarted:!0,cardIds:U(t)})})),Ao=function(e,t){return!t.some((function(t){return t.character&&t.character.name===e.name}))},Do=l((function(e,t,n){var r=e.players;return t.character=n,o(o({},e),{},{players:u(r)})})),Oo=function(){var e=document.getElementsByClassName("item").length,t=function(){return document.getElementById("menu-wrapper")?document.getElementById("menu-wrapper").offsetWidth:null},n=t(),r=123*e;window.onresize=function(){n=t()};var o=r-n,a=document.querySelector(".left-paddle"),c=document.querySelector(".right-paddle");document.querySelector(".menu")&&(document.querySelector(".menu").onscroll=function(){o=r-n;var e=document.querySelector(".menu").scrollLeft,t=o;e<=0?(a.classList.add("hidden"),c.classList.remove("hidden")):e<t?(a.classList.remove("hidden"),c.classList.remove("hidden")):e>=t&&(a.classList.remove("hidden"),c.classList.add("hidden"))}),c&&(c.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e+n;Jn({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}}),a&&(a.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e-n;Jn({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}})},Ro=function(e){var t=e.playerAnimationSignal,o=N(),a=b(),c=ee(),l=Mo(),i=Po(),u=n.useState(!1),s=r(u,2),d=s[0],f=s[1],m=n.useState(null),v=r(m,2),p=v[0],h=v[1],g=n.useState(null),E=r(g,2),y=E[0],k=E[1],x=!c||d;return n.useEffect((function(){if(p&&"score-marked"===p.reason){var e=o.find((function(e){return e.id===a})),t=p.value,n=e.score-t;k({player:e,score:{from:n<0?0:n,to:e.score}})}else k(null)}),[p,a]),n.useEffect((function(){t&&t.listen(k)}),[t]),l?n.createElement(ko,null):i?n.createElement(wo,{players:o}):x?n.createElement(ho,{openedByUser:d,closeScoreboard:function(){f(!1)},playerAnimation:y}):n.createElement(uo,{openScoreboard:function(){f(!0)},onRoundStart:function(){h(null)},onRoundOver:function(e){h(e)}})},Mo=function(){return 0===N().length},Po=function(){return!ne()};function jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Lo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};var To=function(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t};function Fo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lo(e);if(t){var o=Lo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return To(this,n)}}var Bo=System.resolve("./assets/wood.jpg",t.meta.url),Uo=System.resolve("./assets/pirate-hook.png",t.meta.url),zo=System.resolve("./assets/pirate-hook-02.png",t.meta.url),Wo=System.resolve("./assets/wood-box.jpg",t.meta.url),_o=System.resolve("./assets/treasure-map.png",t.meta.url),Go=System.resolve("./assets/skull-bottle.png",t.meta.url);function Jo(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Xo(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function Yo(){}function Zo(e,t){if(!t)return e&&e.then?e.then(Yo):Promise.resolve()}function Vo(e){var t=e();if(t&&t.then)return t.then(Yo)}function Ho(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function Ko(e){if(e&&e.then)return e.then(Yo)}var Qo,$o,ea=Xo((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.chunkSize,r=void 0===n?7:n,o=t.msDelayBetweenChunks,a=void 0===o?2e3:o,c=0,l={},i={},u=Xo((function(e){return Jo(Promise.all(e.map(Xo((function(e){return Ko(Ho((function(){return Jo(De(e),(function(t){l[e]=t}))}),(function(){i[e]=!0})))})))),(function(){return Jo(new Promise((function(e){setTimeout(e,a)})),(function(){var e=s();return Vo((function(){if(e.length>0)return Zo(u(e))}))}))}))})),s=function(){for(var t=[],n=0;n<r&&c<e.length;)t.push(e[c]),n++,c++;return t};return Jo(u(s()),(function(){return{loaded:l,failed:i}}))})),ta=function(){var e=[Bo,Uo,zo,Wo,_o,kr,Go,ce].concat(u(Object.keys(re).map((function(e){return re[e]}))));return n.useEffect((function(){setTimeout((function(){return ea(e)}),2e3)}),[]),null},na=System.resolve("./assets/mille-sabord.css",t.meta.url),ra=System.resolve("./assets/loadscreen.css",t.meta.url),oa=function(e){var t=e.children,o=n.useRef(),a=function(e){var t=be(e),o=Ne(),a=ke(),c=n.useState(!1),l=r(c,2),i=l[0],u=l[1];return n.useEffect((function(){t&&a===o&&u(!0)}),[t,a,o]),i}("loadscreen"),c=n.useState(!1),l=r(c,2),i=l[0],u=l[1],s=n.useState(!1),d=r(s,2),f=d[0],m=d[1],v=Ne(),p=ke();return n.useEffect((function(){if(!a)return function(){};window.splashscreen.remove();var e=window.requestIdleCallback((function(){u(!0)}));return function(){window.cancelIdleCallback(e)}}),[a]),n.useEffect((function(){i&&p===v&&m(!0)}),[i,p,v]),n.useEffect((function(){f&&o&&(o.current.animate([{opacity:1},{opacity:0}],{duration:300,fill:"forwards"}).onfinish=function(){o.current.style.display="none"})}),[o,f]),n.createElement(n.Fragment,null,a?t:null,n.createElement("div",{id:"loadscreen",ref:o},n.createElement(Se,{href:ra}),n.createElement(Te,{src:V,animateLoaded:!1}),n.createElement("p",null,"Loading files (",p,"/",v,")")),f?n.createElement(ta,null):null)},aa=function(e){return ae()?n.createElement(Ro,e):n.createElement(_e,e)};e("Main",(Qo=function(e){return n.createElement(ye,null,n.createElement(oa,null,n.createElement("div",{id:"main-container"},n.createElement("div",{id:"main",ref:oe()},n.createElement(Se,{href:na}),n.createElement(aa,e)))))},$o=function(e){var t=e.error;return window.splashscreen.remove(),n.createElement("div",null,"An error occured",n.createElement("pre",null,"object"===z(t)?t.stack:t))},function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qo(e,t)}(c,e);var t,r,o,a=Fo(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=a.call(this,e)).state={hasError:!1,error:null},t}return t=c,o=[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}],(r=[{key:"render",value:function(){return this.state.hasError?n.createElement($o,{error:this.state.error}):n.createElement(Qo,this.props)}}])&&jo(t.prototype,r),o&&jo(t,o),c}(n.Component)))}}}));

//# sourceMappingURL=main.component-5692caef.js.map