System.register(["./index-345027eb.js"],(function(e){"use strict";var n,r,t,c,l,a,o,i,u,d,s,m,f,v,E,g,h,b,k,p,C,y,N,x,M,w,S,A,R,I,O,D,K,F,U,_,T,j,B,P,z,G,q;return{setters:[function(e){n=e.r,r=e._,t=e.i,c=e.T,l=e.a,a=e.b,o=e.c,i=e.F,u=e.d,d=e.S,s=e.e,m=e.f,f=e.g,v=e.h,E=e.j,g=e.k,h=e.l,b=e.m,k=e.s,p=e.u,C=e.n,y=e.o,N=e.p,x=e.q,M=e.t,w=e.v,S=e.w,A=e.x,R=e.y,I=e.z,O=e.A,D=e.B,K=e.C,F=e.D,U=e.E,_=e.G,T=e.H,j=e.I,B=e.J,P=e.K,z=e.L,G=e.M,q=e.N}],execute:function(){var H=n.useEffect,J=n.useRef,L=function(e){var n=e.card,h=e.symbolsFromDicesKept,b=e.scoreMarked,k=e.markScoreAllowed;return t(n)?b||k?Q(h,{goal:c.numberOfSwords,gamble:c.gambleAmount}):-c.gambleAmount:l(n)?b||k?Q(h,{goal:a.numberOfSwords,gamble:a.gambleAmount}):-a.gambleAmount:o(n)?b||k?Q(h,{goal:i.numberOfSwords,gamble:i.gambleAmount}):-i.gambleAmount:u(n)?W(h.map((function(e){return e===d?s:e}))):m(n)?2*W(h):f(n)?W([].concat(r(h),[v]),9):E(n)?W([].concat(r(h),[g]),9):W(h)},Q=function(e,n){var r=n.goal,t=n.gamble;return V(e,h)>=r?W(e)+t:-t},V=function(e,n){return e.filter((function(e){return e===n})).length},W=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=0,t=0,c=X(e);return Object.values(c).forEach((function(e){3===e&&(r+=100),4===e&&(r+=200),5===e&&(r+=500),6===e&&(r+=1e3),7===e&&(r+=2e3),8===e&&(r+=4e3),e>2&&(t+=e)})),e.forEach((function(e){e===g&&(r+=100,c[g]<3&&(t+=1)),e===v&&(r+=100,c[v]<3&&(t+=1))})),t===n&&(r+=500),r},X=function(e){var n={};return e.forEach((function(e){n.hasOwnProperty(e)?n[e]++:n[e]=1})),n},Y=n.useMemo,Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.rollCount,r=void 0===n?p():n;return 0===r},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.rollCount,r=void 0===n?p():n;return r>0},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.rollCount,r=void 0===n?p():n;return r>1},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.currentCard,r=void 0===n?x():n;return f(r)?[v]:E(r)?[g]:R(r)?[I]:O(r)?[I,I]:[]},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dicesKept,r=void 0===n?D():n;return r.map((function(e){return A(e)}))},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.skullCountInCursedArea,r=void 0===n?ie():n;return 3-r},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dicesToCurse,r=void 0===n?le():n;return r.length>0},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dicesRolled,r=void 0===n?C():n,t=e.witchUncursedDiceId,c=void 0===t?y():t,l=e.remainingSpotInCursedArea,a=void 0===l?te():l;return r.filter((function(e){return b(e)&&e.id!==c})).slice(0,a)},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.currentCard,r=void 0===n?x():n,t=e.hasNeverRolled,c=void 0===t?Z():t,l=e.dicesRolled,a=void 0===l?C():l,o=e.scoreMarked,i=void 0===o?w():o,u=e.threeSkullsOrMoreInCursedArea,d=void 0===u?oe():u,s=e.hasDicesToCurse,m=void 0===s?ce():s;return!!r&&(!i&&(!!c||!d&&(!m&&!(a.length<2))))},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.skullCountInCursedArea,r=void 0===n?ie():n;return r>2},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dicesCursed,r=void 0===n?N():n,t=e.symbolsFromCard,c=void 0===t?ne():t;return r.length+c.filter((function(e){return k(e)})).length},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.hasRolledMoreThanOnce,r=void 0===n?ee():n,t=e.scoreMarked,c=void 0===t?w():t,l=e.currentCard,a=void 0===l?x():l,o=e.threeSkullsOrMoreInCursedArea,i=void 0===o?oe():o,u=e.hasDicesToCurse,d=void 0===u?ce():u;return!c&&(i?!(!S(a)||!r):!d)},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.currentCard,r=void 0===n?x():n,t=e.symbolsFromDicesKept,c=void 0===t?re():t,l=e.scoreMarked,a=void 0===l?w():l,o=e.markScoreAllowed,i=void 0===o?ue():o;return Y((function(){return L({card:r,symbolsFromDicesKept:c,scoreMarked:a,markScoreAllowed:i})}),[r,c,a,i])},se=K((function(e,n){var r=e.totalScore;return F({},e,{totalScore:Math.max(r+n,0),scoreMarked:!0})})),me=K((function(e){return F({},e,{isOnSkullIsland:!0})})),fe=K((function(e,n){var t=e.dicesRolled,c=e.dicesCursed;return F({},e,{dicesRolled:t.filter((function(e){return e.id!==n.id})),dicesCursed:[].concat(r(c),[n])})})),ve=K((function(e,n){var t=e.dicesRolled,c=e.dicesCursed;return F({},e,{witchUncursedDiceId:n.id,dicesRolled:[].concat(r(t),[n]),dicesCursed:c.filter((function(e){return e.id!==n.id}))})})),Ee=K((function(e,n){var t=e.dicesRolled,c=e.dicesKept;return F({},e,{dicesRolled:[].concat(r(t),[n]),dicesKept:c.filter((function(e){return e.id!==n.id}))})})),ge=K((function(e,n){var t=e.dicesRolled,c=e.dicesKept;return F({},e,{dicesRolled:t.filter((function(e){return e.id!==n.id})),dicesKept:[].concat(r(c),[n])})})),he=n.useEffect,be=function(){return ke(),null},ke=function(){pe(),Ce(),ye()},pe=function(){var e=le(),n=fe();he((function(){if(0===e.length)return function(){};var r=setTimeout((function(){e.forEach((function(e){n(e)}))}),1e3);return function(){clearTimeout(r)}}),[e])},Ce=function(){var e=x(),n=w(),t=se(),c=oe(),l=function(e,n){var t=J(!1);H((function(){!1===t.current&&(t.current=!0)}));var c=J(n);return H((function(){c.current=n}),n),!!t.current&&Boolean(e.apply(void 0,r(c.current)))}((function(e){return!e&&c}),[c]),a=de(),o=_(e);he((function(){o&&!n&&l&&t(a)}),[o,n,l,a])},ye=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.rollCount,r=void 0===n?p():n;return 1===r}(),n=x(),r=U(),t=ie(),c=me();he((function(){e&&(r||_(n)||t<4||c())}),[e,r,n,t])},Ne=function(e,n){return!(e.right<=n.left)&&(!(e.left>=n.right)&&(!(e.bottom<=n.top)&&!(e.top>=n.bottom)))},xe=function(e){var r=e.dice,t=e.disabled,c=e.onClickAction,l=e.specificStyle,a=b(r);return n.createElement("button",{disabled:t,"data-dice-id":r.id,ref:T(r.id),onClick:function(){return c(r)},className:"dice",style:F({width:50,height:50,background:a?"black":"#fcfcfc",color:a?"black":"#fcfcfc",borderColor:a?"black":"#b9b9b9"},l)},n.createElement("img",{src:"src/dices/dice_".concat(A(r),".png"),style:{width:"100%",height:"100%"}}))},Me=function(){var e=C(),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.scoreMarked,r=void 0===n?w():n,t=e.threeSkullsOrMoreInCursedArea,c=void 0===t?oe():t;return!r&&!c}(),t=ge();return n.createElement("div",{className:"dice-ongoing"},n.createElement("div",{className:"map"}),n.createElement("div",{className:"area",ref:j()},e.map((function(e){return n.createElement(xe,{key:e.id,dice:e,disabled:!!b(e)||!r,onClickAction:function(e){t(e)},specificStyle:{left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),transform:"rotate(".concat(e.rotation,"deg)"),position:"absolute"}})}))))},we=function(){var e=$();return n.createElement("div",{className:"score-area"},e?n.createElement(Se,null):null)},Se=function(){var e=de();return n.createElement(n.Fragment,null,n.createElement("div",{className:"bonds"}),n.createElement("div",{className:"round-score"},e))},Ae=function(){var e=x(),r=D(),t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.scoreMarked,r=void 0===n?w():n,t=e.threeSkullsOrMoreInCursedArea,c=void 0===t?oe():t;return!r&&!c}(),c=Ee();return n.createElement("div",{className:"dice-kept"},n.createElement("div",{className:"dice-area"},n.createElement("div",{className:"box"},f(e)?n.createElement(Re,null):null,E(e)?n.createElement(Ie,null):null,r.map((function(e){return n.createElement(xe,{key:e.id,dice:e,disabled:!t,onClickAction:function(e){c(e)},specificStyle:{margin:"5px"}})}))),n.createElement("div",{className:"top-left-corner"}),n.createElement("div",{className:"top-right-corner"}),n.createElement("div",{className:"bottom-left-corner"}),n.createElement("div",{className:"bottom-right-corner"}),n.createElement(Oe,null)),n.createElement(we,null))},Re=function(){return n.createElement("img",{src:"src/dices/dice_coin.png",style:{width:"32",height:"32"}})},Ie=function(){return n.createElement("img",{src:"src/dices/dice_diamond.png",style:{width:"32",height:"32"}})},Oe=function(){return oe()?n.createElement("div",{className:"cursed-cover"},n.createElement("img",{src:"src/dice-kept/cursed-cover.png",alt:"cursed-cover"})):null},De=K((function(e){var n=e.cardDeck,t=e.cardsUsed,c=n[0];return F({},e,{cardDeck:n.slice(1),cardsUsed:[].concat(r(t),[c]),currentCard:c})})),Ke=K((function(e){var n=e.cardsUsed;return F({},e,{cardsUsed:[],cardDeck:B(n)})})),Fe=function(){var e=x(),r=re(),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.currentCard,r=void 0===n?x():n;return t(r)?c.numberOfSwords:l(r)?a.numberOfSwords:o(r)?i.numberOfSwords:null}();if(!e||!_(e))return null;var d=V(r,h),s=new Array(u).fill("");return n.createElement("div",{className:"sword-challenge-indicators"},s.map((function(e,r){return d>=r+1?n.createElement(Ue,{key:r}):n.createElement(_e,{key:r})})))},Ue=function(){return n.createElement("div",{className:"sword-icon"},n.createElement("img",{src:"src/dices/dice_sword.png"}))},_e=function(){return n.createElement("div",{className:"sword-icon disabled"},n.createElement("img",{src:"src/header/swords-disabled.png"}))},Te=function(){return n.createElement("div",{className:"header"},n.createElement("div",{className:"card-container"},n.createElement(je,null),n.createElement(Fe,null)),n.createElement(Je,null))},je=function(){return n.createElement("div",{className:"small-card"},n.createElement(Be,null),n.createElement(Ge,null))},Be=function(){var e=x();return e?n.createElement(ze,{card:e}):n.createElement(Pe,null)},Pe=function(){return n.createElement("div",{className:"card default-card",style:{backgroundImage:"url('src/cards/card_default.png')",backgroundSize:"217px"}})},ze=function(e){var r=e.card;return n.createElement("div",{className:"card current-card",style:{backgroundColor:P[r].color1,borderColor:P[r].color2}},n.createElement("img",{src:"src/cards/card_small-".concat(_(r)?"sword-challenge":r,".png"),alt:r}))},Ge=function(){var e=x(),r=z();return e?null:0===r.length?n.createElement(He,null):n.createElement(qe,null)},qe=function(){var e=De();return n.createElement("button",{className:"draw-card-btn",onClick:e},"Draw a card")},He=function(){var e=Ke();return n.createElement("button",{className:"draw-card-btn",onClick:e},"Shuffle deck")},Je=function(){var e=G();return n.createElement("div",{className:"total-score"},n.createElement("span",{className:"score"},e))},Le=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.rollDiceAllowed,r=void 0===n?ae():n,t=e.markScoreAllowed,c=void 0===t?ue():t;return!r&&!c}(),r=Qe();return e?n.createElement("div",{className:"next-round-action"},n.createElement("button",{onClick:r},"Next round")):null},Qe=K((function(e){return F({},e,{witchUncursedDiceId:null,rollCount:0,dicesRolled:[],dicesCursed:[],dicesKept:[],scoreMarked:!1,currentCard:null,isOnSkullIsland:!1})})),Ve=function(e,n){var r=n.diceParentElement.getBoundingClientRect(),t=r.width-50,c=r.height-50,l=[];return e.forEach((function(e){var n=We(e,{dicesRolled:l,xMin:0,xMax:t,yMin:0,yMax:c});l.push(n)})),l},We=function(e,n){var r=n.dicesRolled,t=n.xMin,c=n.xMax,l=n.yMin,a=n.yMax,o=Xe(r,{xMin:t,xMax:c,yMin:l,yMax:a}),i=o.x,u=o.y;return F({},e,{visibleFaceIndex:Ze(e),x:i,y:u,rotation:Ye()})},Xe=function(e,n){var r=n.xMin,t=n.xMax,c=n.yMin,l=n.yMax,a=0;return function n(){var o,i={x:$e(r,t),y:$e(c,l)};return o=i,e.some((function(e){return Ne({top:o.y-6.25,left:o.x-6.25,bottom:o.y+50+6.25,right:o.x+50+6.25},{top:e.y-6.25,left:e.x-6.25,bottom:e.y+50+6.25,right:e.x+50+6.25})}))?++a>50?i:n():i}()},Ye=function(){return $e(-35,35)},Ze=function(e){return $e(0,e.faces.length-1)},$e=function(e,n){return Math.floor(Math.random()*(n-e+1)+e)},en=function(){var e=ae(),r=q(),t=nn();return e?n.createElement("div",{className:"roll-action"},n.createElement("button",{onClick:function(){t(r)}},"Roll")):null},nn=K((function(e,n){var r=e.rollCount,t=e.dices,c=e.dicesRolled;return F({},e,{rollCount:r+1,dicesRolled:Ve(0===r?t:c,{diceParentElement:n})})})),rn=function(){var e=se(),r=de();return n.createElement("div",{className:"actions"},n.createElement(en,null),n.createElement(tn,{onClick:function(){e(r)}}),n.createElement(Le,null))},tn=function(e){var r=e.onClick,t=$(),c=ue(),l=de(),a=l<0?"-":"+";return c&&t?n.createElement("div",{className:"collect-action"},n.createElement("button",{onClick:r},n.createElement("span",null,"Collect"),n.createElement("span",{className:"score"},a," ",Math.abs(l)))):null},cn=function(){var e=x(),r=N(),t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.witchUncursedDiceId,r=void 0===n?y():n,t=e.currentCard,c=void 0===t?x():t,l=e.threeSkullsOrMoreInCursedArea,a=void 0===l?oe():l;return!!M(c)&&(!a&&!r)}(),c=ve();return n.createElement("div",{className:"skull-island"},n.createElement("div",{className:"bottle"},n.createElement("div",{className:"area"},R(e)?n.createElement(ln,null):null,O(e)?n.createElement(n.Fragment,null,n.createElement(ln,null),n.createElement(ln,null)):null,r.map((function(e){return n.createElement(xe,{key:e.id,dice:e,disabled:!t,onClickAction:function(e){c(e)},specificStyle:{margin:"1px 5px"}})})))))},ln=function(){return n.createElement("img",{src:"src/dices/dice_skull.png",style:{width:"32",height:"32"}})},an=n.useMemo;e("Game",(function(){return an((function(){return n.createElement("div",{id:"mille-sabord-container"},n.createElement(be,null),n.createElement(Te,null),n.createElement("div",{className:"dice-kept-and-skulls"},n.createElement(Ae,null),n.createElement(cn,null)),n.createElement(Me,null),n.createElement(rn,null))}))}))}}}));
//# sourceMappingURL=game.component-1756cc80.js.map
