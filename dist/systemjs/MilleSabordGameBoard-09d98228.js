System.register(["./index-0ad3f5e3.js","./DiceHelpers-40df2fbd.js"],(function(e){"use strict";var t,n,r,a,l,c,o,u,i;return{setters:[function(e){t=e.R,n=e._},function(e){r=e.S,a=e.a,l=e.b,c=e.c,o=e.d,u=e.e,i=e.s}],execute:function(){var d=function(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()},s=function(e,t){return!(e.right<=t.left)&&(!(e.left>=t.right)&&(!(e.bottom<=t.top)&&!(e.top>=t.bottom)))},f=t.forwardRef((function(e,n){var r=e.diceArray,a=e.keepDiceAllowed,l=e.keepDice;return t.createElement("div",{className:"diceOnGoing",ref:n},t.createElement("span",{className:"title"},"Dice on going"),t.createElement("div",{className:"area"},r.map((function(e){return t.createElement("button",{key:e.id,disabled:!a,onClick:function(){return l(e)},className:"dice",style:{width:40,height:40,left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),transform:"rotate(".concat(e.rotation,"deg)"),position:"absolute"}},e.symbol)}))))})),m=function(e){var n=e.rollDicePermission,r=e.onClick;return n.allowed?t.createElement("button",{onClick:r},"Roll!"):"3 skulls or more"===n.reaon?null:t.createElement(t.Fragment,null,t.createElement("button",{disabled:!0},"Roll!"),t.createElement("span",null,"(".concat(n.reason,")")))},y=function(e){var n=e.diceArray,r=e.unkeepDiceAllowed,a=e.unkeepDice;return t.createElement("div",{className:"diceKept"},t.createElement("span",{className:"title"},"Dice kept"),t.createElement("div",{className:"area"},n.map((function(e){return t.createElement("button",{key:e.id,disabled:!r,onClick:function(){return a(e)},className:"dice",style:{width:40,height:40}},e.symbol)}))))},p=function(e){var n=e.onClick;return t.createElement("button",{onClick:n,style:{marginLeft:"20px"}},"Mark this score")},h=function(e){var n=e.rollIndex,r=e.isOnSkullIsland,a=e.roundScore,l=e.markScorePermission,c=e.markScore;return-1===n?null:t.createElement("div",null,t.createElement("span",{className:"subtitle"}," Round score: "),t.createElement(k,{isOnSkullIsland:r,markScorePermission:l,roundScore:a,markScore:c}))},k=function(e){var n=e.markScorePermission,r=e.isOnSkullIsland,a=e.roundScore,l=e.markScore;return r?t.createElement("span",null,"XXX -Skull Island- XXX"):t.createElement(t.Fragment,null,t.createElement("span",null,a),n.allowed?t.createElement(p,{onClick:l}):null,t.createElement("div",null,"has-three-skulls-or-more"===n.reason?"Round over !":n.reason))},E=function(e){var n=e.totalScore;return t.createElement("div",null,t.createElement("span",{className:"subtitle"}," Total score: "),t.createElement("span",{className:"totalScore"},n))},v=function(e){var n=e.cardDeck,r=e.cardDrawn,a=e.drawCard,l=e.card;return t.createElement("div",null,!r&&t.createElement("button",{onClick:function(){return a()},style:{marginTop:"20px"}},n.length>0?"Draw a card":"Shuffle the deck"),t.createElement("div",{style:{marginTop:"10px"}},"Remaining cards: ",n.length),t.createElement("span",{className:"card"},l.label))},b=function(e){var n=e.diceCursed,r=e.canRemoveSkull,a=e.removeSkull;return t.createElement("div",{className:"skullIsland"},t.createElement("span",{className:"title"},"Skull Island"),t.createElement("div",{className:"area"},n.map((function(e){return t.createElement("button",{key:e.id,disabled:!r,onClick:function(){return a(e)},className:"dice",style:{width:40,height:40}},e.symbol)}))))},g=function(e){var n=e.nextRoundPermission,r=e.nextRound;return n.allowed?t.createElement("button",{onClick:function(){return r()}},"Start next round"):null},w=function(){return M(S())},S=function(){var e=[];return x.forEach((function(t){e=C(e,t)})),e},x=[{type:"pirate",cardQuantiy:4,label:"Pirate"},{type:"witch",cardQuantiy:4,label:"Witch"},{type:"chest",cardQuantiy:4,label:"Treasure chest"},{type:"animals",cardQuantiy:4,label:"Parrot = monkey"},{type:"diamond",cardQuantiy:4,label:"Diamond"},{type:"coin",cardQuantiy:3,label:"Coin"},{type:"skull",skullAmount:1,cardQuantiy:3,label:"1 skull"},{type:"skull",skullAmount:2,cardQuantiy:2,label:"2 skulls"},{type:"sword-challenge",goal:2,gamble:300,cardQuantiy:2,label:"2 sword challenge"},{type:"sword-challenge",goal:3,gamble:500,cardQuantiy:3,label:"3 sword challenge"},{type:"sword-challenge",goal:4,gamble:1e3,cardQuantiy:2,label:"4 sword challenge"}],C=function(e,t){for(var n=0;n<t.cardQuantiy;n++)e.push(t);return e},M=function(e){for(var t=0;t<100;t++)D(e);return e},D=function(e){var t=A(e.length),n=A(e.length),r=e[t];return e[t]=e[n],e[n]=r,e},A=function(e){return Math.floor(Math.random()*e)},I=function(e){var t=e.dice,n=e.index,r=e.dices,a=e.xMin,l=e.xMax,c=e.yMin,o=e.yMax,u=N(r.slice(0,n),{xMin:a,xMax:l,yMin:c,yMax:o}),i=u.x,d=u.y;t.x=i,t.y=d,t.rotation=R(),t.symbol=O()},N=function(e,t){var n=t.xMin,r=t.xMax,a=t.yMin,l=t.yMax,c=0;return function t(){var o,u={x:j(n,r),y:j(a,l)};return o=u,e.some((function(e){return s({top:o.y-5,left:o.x-5,bottom:o.y+40+5,right:o.x+40+5},{top:e.y-5,left:e.x-5,bottom:e.y+40+5,right:e.x+40+5})}))?++c>50?u:t():u}()},R=function(){return j(-35,35)},P={1:r,2:a,3:l,4:c,5:o,6:u},O=function(){return P[Q()]},Q=function(){return j(1,6)},j=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},X=function(e){var t=e.card,n=e.diceCursed.length;return"skull"===t.type&&(n+=t.skullAmount),n},T=function(e){var t=e.card;return 0===e.rollIndex&&"sword-challenge"!==t.type},F=function(e){var t=e.card,n=e.diceCursed;return X({card:t,diceCursed:n})>=4},G=function(e){return e.map((function(e){return K(e)}))},K=function(e){return e.symbol},U=function(e,t){return e.filter((function(e){return e===t})).length},B=function(e,t){var n=t.perfectEnabled,l=0,c=0,o=q(e);return Object.values(o).forEach((function(e){3===e&&(l+=100),4===e&&(l+=200),5===e&&(l+=500),6===e&&(l+=1e3),7===e&&(l+=2e3),8===e&&(l+=4e3),e>2&&(c+=e)})),e.forEach((function(e){e===a&&(l+=100,o[a]<3&&(c+=1)),e===r&&(l+=100,o[r]<3&&(c+=1))})),n&&c>=e.length&&(l+=500),l},q=function(e){var t={};return e.forEach((function(e){t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},H=(e("MilleSabordGameBoard",(function(e){var r=e.diceArray,a=t.useState(r),s=n(a,2),p=s[0],k=s[1],S=t.useState([]),x=n(S,2),C=x[0],M=x[1],D=t.useState([]),A=n(D,2),N=A[0],R=A[1],P=t.useState([]),O=n(P,2),Q=O[0],j=O[1],K=t.useState(0),q=n(K,2),L=q[0],W=q[1],_=t.useState(w()),z=n(_,2),J=z[0],V=z[1],Y=t.useState({}),Z=n(Y,2),$=Z[0],ee=Z[1],te=t.useState(-1),ne=n(te,2),re=ne[0],ae=ne[1],le=t.useState(!1),ce=n(le,2),oe=ce[0],ue=ce[1],ie=t.useState(!1),de=n(ie,2),se=de[0],fe=de[1],me=t.useState(!1),ye=n(me,2),pe=ye[0],he=ye[1],ke=t.useState(!1),Ee=n(ke,2),ve=Ee[0],be=Ee[1],ge=t.useState({}),we=n(ge,2),Se=we[0],xe=we[1],Ce=t.useState(!1),Me=n(Ce,2),De=Me[0],Ae=Me[1],Ie=t.useState(!1),Ne=n(Ie,2),Re=Ne[0],Pe=Ne[1],Oe=t.useState({}),Qe=n(Oe,2),je=Qe[0],Xe=Qe[1],Te=t.useState({}),Fe=n(Te,2),Ge=Fe[0],Ke=Fe[1],Ue=t.useState(!1),Be=n(Ue,2),qe=Be[0],He=Be[1];t.useEffect((function(){X({card:$,diceCursed:Q})>2||se?(Ae(!1),Pe(!1)):(Ae(!0),Pe(!0))}),[$,Q,se]),t.useEffect((function(){he(function(e){var t=e.isOnSkullIsland,n=e.card,r=e.rollIndex,a=e.diceCursed;return!!t||!(!T({card:n,rollIndex:r})||!F({card:n,diceCursed:a}))}({isOnSkullIsland:pe,card:$,rollIndex:re,diceCursed:Q}))}),[$,re,Q]),t.useEffect((function(){xe(function(e){var t=e.cardDrawn,n=e.scoreMarked,r=e.card,a=e.diceCursed,l=e.rollIndex,c=e.diceOnGoing;return t?n?{allowed:!1,reason:"round-not-started"}:X({card:r,diceCursed:a})>2?{allowed:!1,reason:"has-three-skulls-or-more"}:l>0&&c.length<2?{allowed:!1,reason:"not-enough-dice-to-roll"}:{allowed:!0,reason:""}:{allowed:!1,reason:"card-not-drawn"}}({cardDrawn:oe,scoreMarked:se,card:$,diceCursed:Q}))}),[oe,se,$,Q]),t.useEffect((function(){Xe(function(e){var t=e.rollIndex,n=e.card,r=e.diceCursed;return e.scoreMarked?{allowed:!1}:X({card:n,diceCursed:r})>2?"chest"===n.type&&t>0?{allowed:!0}:{allowed:!1,reason:"has-three-skulls-or-more"}:{allowed:!0}}({rollIndex:re,card:$,diceCursed:Q,scoreMarked:se}))}),[$,re,Q,se]),t.useEffect((function(){be(function(e){var t=e.card,n=e.diceKept;if(!e.markScoreAllowed)return"sword-challenge"===t.type?-t.gamble:0;var r=8===n.length,a=G(n);return"sword-challenge"===t.type?U(a,l)>=t.goal?B(a,{perfectEnabled:r})+t.gamble:-t.gamble:"diamond"===t.type||"coin"===t.type?B([].concat(d(a),[t.type]),{perfectEnabled:r}):"animals"===t.type?B(a.map((function(e){return e===c?o:e})),{perfectEnabled:r}):"pirate"===t.type?2*B(a,{perfectEnabled:r}):B(a,{perfectEnabled:r})}({card:$,diceKept:N,markScoreAllowed:je.allowed}))}),[$,N,je]),t.useEffect((function(){-1===re?Ke({allowed:!1}):Se.allowed||je.allowed||Ke({allowed:!0})}),[re,Se,je]),t.useEffect((function(){"witch"===$.type?Q.length>2?He(!1):$.effectUsed?He(!1):He(!0):He(!1)}),[$,Q]);var Le=H(je);t.useEffect((function(){"sword-challenge"!==$.type||se||!Le.allowed||je.allowed||Je()}),[$,se,Le,je]);var We=t.createRef(),_e=function(e){var t=i(e),n=t.withoutSkulls,r=t.skulls;M(n),j([].concat(d(Q),d(r)))},ze=function(e){if(e.symbol===u){"witch"===$.type&&($.effectUsed=!0);var t=Q.filter((function(t){return t!==e}));j(t)}else{var n=N.filter((function(t){return t!==e}));R(n)}var r=[].concat(d(C),[e]);M(r)},Je=function(){W(Math.max(L+ve,0)),fe(!0)};return t.createElement(t.Fragment,null,t.createElement(v,{cardDeck:J,cardDrawn:oe,drawCard:function(){J.length>0?(ee(J.pop()),V(J),ue(!0)):V(w())},card:$}),t.createElement("div",null,t.createElement(m,{rollDicePermission:Se,onClick:function(){var e;-1===re?(e=p,M(d(p)),k([]),ae(0)):(e=C,ae(re+1)),function(e,t){var n=t.diceParentElement.getBoundingClientRect(),r=n.width-40,a=n.height-40;e.forEach((function(t,n){I({dice:t,index:n,dices:e,xMin:0,xMax:r,yMin:0,yMax:a})}))}(e,{diceParentElement:We.current.querySelector(".area")}),_e(e)}}),t.createElement(g,{nextRoundPermission:Ge,nextRound:function(){k(r),M([]),R([]),j([]),ae(-1),fe(!1),ue(!1),he(!1),be(0)}})),t.createElement(f,{ref:We,diceArray:C,keepDiceAllowed:De,keepDice:function(e){if(e.symbol===u){"witch"===$.type&&($.effectUsed=!1);var t=[].concat(d(Q),[e]);j(t)}else{var n=[].concat(d(N),[e]);R(n)}var r=C.filter((function(t){return t!==e}));M(r)}}),t.createElement(y,{diceArray:N,unkeepDiceAllowed:Re,unkeepDice:ze}),t.createElement(b,{diceCursed:Q,canRemoveSkull:qe,removeSkull:function(e){return ze(e)}}),t.createElement(h,{rollIndex:re,isOnSkullIsland:pe,roundScore:ve,markScorePermission:je,markScore:Je}),t.createElement(E,{totalScore:L}))})),function(e){var n=t.useRef();return t.useEffect((function(){n.current=e})),n.current})}}}));
//# sourceMappingURL=MilleSabordGameBoard-09d98228.js.map
