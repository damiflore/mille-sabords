System.register(["./index.js","./main.component.js"],(function(e,t){"use strict";var n,r,o,a,c,l,i,u,s,d,f,m,v,p,h,g,E,y,b,N,C,k,x,S,D,w,R,I,A,O,M,L,q,P,T,j,F,B,z,U,G,X,Z,Y,J,W,_,K,H,V,Q,$,ee,te,ne,re,oe,ae,ce,le,ie,ue,se,de,fe,me,ve,pe,he,ge;return{setters:[function(e){n=e.g,r=e._,o=e.r,a=e.h,c=e.d,l=e.f,i=e.c,u=e.b,s=e.u,d=e.i,f=e.j,m=e.S,v=e.k,p=e.l,h=e.m,g=e.n,E=e.o,y=e.p,b=e.q,N=e.t,C=e.v,k=e.w,x=e.x,S=e.y,D=e.z,w=e.A,R=e.B,I=e.C,A=e.D,O=e.E,M=e.F,L=e.G,q=e.H,P=e.I,T=e.J,j=e.K,F=e.L,B=e.M,z=e.N,U=e.O,G=e.P,X=e.Q,Z=e.a,Y=e.R,J=e.T,W=e.U,_=e.V,K=e.W,H=e.s,V=e.X,Q=e.Y,$=e.Z,ee=e.$,te=e.a0,ne=e.a1,re=e.a2,oe=e.a3,ae=e.a4,ce=e.a5},function(e){le=e.I,ie=e.i,ue=e.g,se=e.a,de=e._,fe=e.b,me=e.S,ve=e.c,pe=e.d,he=e.w,ge=e.e}],execute:function(){var Ee=function(){return o.createElement(ye,null)},ye=function(){var e=be();return o.createElement("div",{className:"new-game"},o.createElement(le,{src:a}),o.createElement("button",{onClick:e},"Nouvelle partie"))},be=n((function(e){return r(r({},e),{},{gameCreated:!0})})),Ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.layout,a=void 0!==r&&r,c=o.useRef(!0);(a?o.useLayoutEffect:o.useEffect)((function(){if(!c.current)return e();c.current=!1}),t)},Ce=function(e,t){var n=ke(e,t);return Boolean(n)},ke=function(e,t){var n=o.useRef(!1);o.useEffect((function(){!1===n.current&&(n.current=!0)}));var r=o.useRef(t);return o.useEffect((function(){r.current=t}),t),n.current&&e.apply(void 0,c(r.current))?{from:r.current,to:t}:null},xe=function(e){var t=o.useRef(e);return o.useEffect((function(){t.current=e}),[e]),t.current},Se=function(){var e=o.useState((function(){return e=[],{listen:function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).once;if(void 0!==n&&n){var r=t;t=function(){a(),r.apply(void 0,arguments)}}e=[].concat(c(e),[t]);var o=!1,a=function(){if(!o){o=!0;for(var n=[],r=e.length,a=!0;r--;){var c=e[r];a&&c===t?a=!1:n.push(c)}e=n}};return a},emit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.forEach((function(e){e.apply(void 0,n)}))}};var e})),t=l(e,1)[0];return[t.listen,t.emit]},De=function(e){var t=o.useState(),n=l(t,2),r=n[0],a=n[1];return o.useEffect((function(){return e(a)}),[]),r},we=function(e){var t=e.duration,n=void 0===t?300:t,r=e.timingFunction,o=void 0===r?function(e){return e}:r,a=e.onProgress,c=void 0===a?function(){}:a,l=e.onCancel,i=void 0===l?function(){}:l,u=e.onComplete,s=void 0===u?function(){}:u;if(isNaN(n))return console.warn("duration must be a number, received ".concat(n)),function(){};n=parseInt(n,10);var d,f=performance.now(),m=!1,v=0,p=0;!function e(){d=null;var t=performance.now();v=Math.min((t-f)/n,1),p=o(v),c({done:m=1===v,rawProgress:v,progress:p}),m?s():d=window.requestAnimationFrame(e)}();return function(){d&&(window.cancelAnimationFrame(d),d=null),m||(m=!0,i({rawProgress:v,progress:p}))}},Re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.duration,r=void 0===n?300:n,a=t.timingFunction,c=t.condition,i=o.useState(null),u=l(i,2),s=u[0],d=u[1];return Ie(e,(function(e,t){return d({value:e}),we({duration:r,timingFunction:a,onProgress:function(n){var r=n.progress,o=Math.round(e+(t-e)*r);d({value:o})},onComplete:function(){d(null)}})}),{condition:c}),s},Ie=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.condition,a=void 0===r?function(){return!0}:r,c=o.useState(null),i=l(c,2),u=i[0],s=i[1],d=xe(e);o.useEffect((function(){d!==e&&a(e,d)&&s({from:d,to:e})}),[d,e]),o.useEffect((function(){return u?t(u.from,u.to):function(){}}),[u])},Ae=function(e){var t=e.value,n=e.duration,r=e.condition,o=Re(t,{duration:n,condition:r});return o?o.value:t},Oe=function(e,t){for(var n=Le(e,e),r=n.next(),o=r.done,a=r.value;!1===o;){if(t(a))return a;var c=n.next();o=c.done,a=c.value}return null},Me=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r){var o=t.firstChild;if(o)return o}var a=t.nextSibling;if(a)return a;var c=t.parentNode;return c&&c!==n?e(c,n,!0):null},Le=function(e,t){var n=e;return{next:function(){var e=Me(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},qe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,o=!1,a=function(){var e=Me(r,t,n&&!1===o);return o=!0,r=e,{done:!1===Boolean(e),value:e}};return{next:a}},Pe=function(e){for(var t=e.lastChild;t;){var n=t.lastChild;if(!n)break;t=n}return t},Te=function(e,t){var n=e;return{next:function(){var e=function(e,t){var n=e.previousSibling;if(n){return Pe(n)||n}if(e!==t){var r=e.parentNode;if(r&&r!==t)return r}return null}(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},je=function(e){var t=Oe(e,ie);return t||(ie(e)?e:null)},Fe=function(e){if(3===e.nodeType)return console.warn("cannot trap focus inside a text node"),function(){};if(Ue.find((function(t){return t.element===e})))return console.warn("focus already trapped inside this element"),function(){};var t=function(){return Oe(e,Be)},n=function(){return function(e,t){var n=Pe(e);if(n)for(var r=Te(n,e),o=r.next(),a=o.done,c=o.value;!1===a;){if(t(c))return c;var l=r.next();a=l.done,c=l.value}return null}(e,Be)},r=function(){return function(e){for(var t=e.from,n=e.root,r=void 0===n?null:n,o=e.predicate,a=Te(t,r),c=a.next(),l=c.done,i=c.value;!1===l;){if(o(i))return i;var u=a.next();l=u.done,i=u.value}return null}({from:document.activeElement,root:e,predicate:Be})||n()},o=function(){return function(e){for(var t=e.from,n=e.root,r=void 0===n?null:n,o=e.predicate,a=e.skipChildren,c=qe(t,r,void 0!==a&&a),l=c.next(),i=l.done,u=l.value;!1===i;){if(o(u))return u;var s=c.next();i=s.done,u=s.value}return null}({from:document.activeElement,root:e,predicate:Be})||t()},a=Ge({element:e,lock:function(){var a=function(t){(function(t){return t.target!==e&&!e.contains(t.target)})(t)&&(t.preventDefault(),t.stopImmediatePropagation())},c=function(e){ze(e)&&(e.preventDefault(),function(e){var a=document.activeElement===document.body;if(e.shiftKey){var c=a?n():r();c&&c.focus()}else{var l=a?t():o();l&&l.focus()}}(e))};return document.addEventListener("mousedown",a,{capture:!0,passive:!1}),document.addEventListener("keydown",c,{capture:!0,passive:!1}),function(){document.removeEventListener("mousedown",a,{capture:!0,passive:!1}),document.removeEventListener("keydown",c,{capture:!0,passive:!1})}}});return function(){a()}},Be=function(e){return!function(e){return e.hasAttribute&&e.hasAttribute("tabIndex")&&Number(e.getAttribute("tabindex"))<0}(e)&&ie(e)},ze=function(e){return"Tab"===e.key||9===e.keyCode},Ue=[],Ge=function(e){var t,n=e.lock;Ue.length>0&&(t=Ue[Ue.length-1]).unlock();var r={lock:n,unlock:n()};return Ue.push(r),function(){if(0!==Ue.length){var e=Ue[Ue.length-1];r===e?(Ue.pop(),r.unlock(),t&&(t.unlock=t.lock())):console.warn("you must deactivate trap in the same order they were activated")}else console.warn("cannot deactivate an already deactivated trap")}},Xe=function(e){var t=[];return function e(n){var r=Ze(n);if(r){if(t.push(r),r===document)return;e(r)}}(e),t},Ze=function(e){if("object"!==i(e)||1!==e.nodeType)throw new TypeError("getScrollableParent first argument must be DOM node");var t=e;return t===document.documentElement?null:"fixed"===ue(t,"position")?Ye(t.ownerDocument):tt(t)||Ye(t.ownerDocument)},Ye=function(e){if("scrollingElement"in e)return e.scrollingElement;if(He(e))return e.documentElement;var t=e.body,n=t&&!/body/i.test(t.tagName)?Je(t):t;return n&&_e(n)?null:n},Je=function(e){for(var t=e;t=t.nextSibling;)if(1===t.nodeType&&We(t))return t;return null},We=function(e){return e.ownerDocument.body===e},_e=function(e){if(!Qe(e))return!1;if(Ke(e))return!1;var t=e.ownerDocument.documentElement;return!!Qe(t)&&!Ke(t)},Ke=function(e){var t=ue(e,"display");return"none"!==t&&("table-row"!==t&&"table-group"!==t&&"table-column"!==t||"collapsed"!==ue(e,"visibility"))},He=function(e){return!!/^CSS1/.test(e.compatMode)&&Ve(e)},Ve=function(e){var t=e.createElement("iframe");t.style.height="1px",(e.body||e.documentElement||e).appendChild(t);var n=t.contentWindow.document;n.write('<!DOCTYPE html><div style="height:9999em">x</div>'),n.close();var r=n.documentElement.scrollHeight>n.body.scrollHeight;return t.parentNode.removeChild(t),r},Qe=function(e){return!$e(e)||!et(e)},$e=function(e){return"visible"===ue(e,"overflow-x")||"visible"===ue(e,"overflow")},et=function(e){return"visible"===ue(e,"overflow-y")||"visible"===ue(e,"overflow")},tt=function(e){if(e===document.documentElement)return null;for(var t=ue(e,"position"),n=e.parentNode;n;){if(se(n))return null;if("absolute"!==t||"static"!==ue(n,"position")){if(Qe(n))return n;n=n.parentNode}else n=n.parentNode}return null},nt=System.resolve("./assets/dialog.base.css",t.meta.url),rt=o.useEffect,ot=function(e){var t=e.container,n=void 0===t?document.body:t,a=e.insertTop,i=e.insertLeft,s=e.insertRight,d=e.insertBottom,f=e.children,m=e.isOpen,v=e.requestCloseOnEscape,p=void 0===v||v,h=e.requestCloseOnClickOutside,g=void 0!==h&&h,E=e.closeMethod,y=void 0===E?"display-none":E,b=e.stealFocus,N=void 0===b||b,C=e.restoreStolenFocus,k=void 0===C||C,x=e.trapFocus,S=void 0===x||x,D=e.onAfterOpen,w=void 0===D?function(){}:D,R=e.onRequestClose,I=void 0===R?function(){}:R,A=e.onFocusIn,O=void 0===A?function(){}:A,M=e.onFocusOut,L=void 0===M?function(){}:M,q=e.backdropProps,P=void 0===q?{}:q,T=de(e,["container","insertTop","insertLeft","insertRight","insertBottom","children","isOpen","requestCloseOnEscape","requestCloseOnClickOutside","closeMethod","stealFocus","restoreStolenFocus","trapFocus","onAfterOpen","onRequestClose","onFocusIn","onFocusOut","backdropProps"]);if(!n)return null;var j=o.useState(null),F=l(j,2),B=F[0],z=F[1],U=Boolean(B);return Ce((function(e){return!e&&m}),[m])&&w(),rt((function(){if(!m||!U)return function(){};var e=ct(B),t=function(t){t.relatedTarget||e&&(e=!1,L(t))},n=function(t){O(t),e=!0},r=function(t){ct(B)?e=!0:(e=!1,L(t))};return B.addEventListener("focus",n,!0),document.addEventListener("focus",r,!0),document.addEventListener("blur",t,!0),function(){B.removeEventListener("focus",n,!0),document.removeEventListener("focus",r,!0),document.removeEventListener("blur",t,!0)}}),[m,U,O,L]),rt((function(){return m&&U?function(e){for(var t=[],n=e.previousSibling;n;)1===n.nodeType&&Qe(n)&&t.push(n),n=n.previousSibling;var r=Xe(e);t.push.apply(t,c(r));var o=t.map((function(e){var t=e.style.overflow;return e.style.overflow="hidden",function(){t?e.style.overflow=t:e.style.removeProperty("overflow")}}));return function(){o.forEach((function(e){e()}))}}(B):function(){}}),[m,U]),rt((function(){return m&&U&&S?Fe(B):function(){}}),[m,U,S]),rt((function(){if(!m||!U||!N)return function(){};var e=document.activeElement,t=je(B);return t&&t.focus({preventScroll:!0}),function(){t&&("function"==typeof k?k(e):!0===k&&e.focus({preventScroll:!0}))}}),[m,U,N]),rt((function(){if(!m||!B||!B.parentNode)return function(){};var e=[];return Array.from(B.parentNode.children).forEach((function(t){t!==B&&e.push(t)})),e.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){e.forEach((function(e){e.removeAttribute("aria-hidden","true")}))}}),[m,B]),"dom-remove"!==y||m?u.createPortal(o.createElement("div",fe({},T,{role:"dialog",className:"dialog--root".concat(T.className?" ".concat(T.className):""),ref:function(e){z(e),T.ref&&T.ref(e)},onKeyDown:function(e){p&&e.keyCode===lt&&I(e),T.onKeyDown&&T.onKeyDown(e)},tabIndex:"-1",style:r(r({},"display-none"!==y||m?{}:{display:"none"}),"visibility-hidden"!==y||m?{}:{visibility:"hidden"}),hidden:"hidden-attribute"===y&&!m||void 0}),o.createElement(me,{href:nt}),m?o.createElement(at,fe({},P,{className:"dialog--backdrop",onMouseDownActive:function(e){if(e.preventDefault(),!ct(B)){var t=je(B);t&&t.focus({preventScroll:!0})}},onClick:function(e){g&&I(e),P.onClick&&P.onClick(e)}})):null,o.createElement("div",{className:"dialog--document"},o.createElement("div",{className:"dialog--insert-top"},a),o.createElement("div",{className:"dialog--main"},o.createElement("div",{className:"dialog--insert-left"},i),o.createElement("div",{className:"dialog--scrollable-content"},f),o.createElement("div",{className:"dialog--insert-right"},s)),o.createElement("div",{className:"dialog--insert-bottom"},d))),n):null},at=function(e){var t=e.onMouseDownActive,n=de(e,["onMouseDownActive"]),r=o.useState(null),a=l(r,2),c=a[0],i=a[1];return rt((function(){return c?(c.addEventListener("mousedown",t,{passive:!1}),function(){c.removeEventListener("mousedown",t,{passive:!1})}):function(){}}),[c]),o.createElement("div",fe({ref:function(e){i(e),n.ref&&n.ref(e)}},n))},ct=function(e){var t=document.activeElement;return e===t||e.contains(t)},lt=27,it=System.resolve("./assets/dialog.css",t.meta.url),ut=function(e){return o.createElement(o.Fragment,null,o.createElement(me,{href:it}),o.createElement(ot,fe({container:s()},e)))},st=function(e){var t=e.card,n=e.symbolsInChest,r=e.scoreMarked,o=e.markScoreAllowed;return d(t)?r||o?dt(n,{goal:t.numberOfSwords,gamble:t.gambleAmount}):-t.gambleAmount:f(t)?mt(n.map((function(e){return e===m?v:e}))):p(t)?2*mt(n):h(t)||g(t)?mt(n,9):mt(n)},dt=function(e,t){var n=t.goal,r=t.gamble;return ft(e,b)>=n?mt(e)+r:-r},ft=function(e,t){return e.filter((function(e){return e===t})).length},mt=function(e,t){var n=vt(e,t);return n.score+n.perfectBonus},vt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=0,r=0,o=pt(e);return Object.values(o).forEach((function(e){3===e&&(n+=100),4===e&&(n+=200),5===e&&(n+=500),6===e&&(n+=1e3),7===e&&(n+=2e3),8===e&&(n+=4e3),e>2&&(r+=e)})),e.forEach((function(e){e===E&&(n+=100,o[E]<3&&(r+=1)),e===y&&(n+=100,o[y]<3&&(r+=1))})),{score:n,perfectBonus:r===t?500:0}},pt=function(e){var t={};return e.forEach((function(e){t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},ht=System.resolve("./assets/swords-disabled.png",t.meta.url),gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?N():t,r=C(n);return d(r)?r.numberOfSwords:null},Et=function(){var e=N(),t=mn(),n=gt();if(!e)return null;var r=C(e);if(!d(r))return null;var a=ft(t,b),c=new Array(n).fill("");return o.createElement("div",{className:"sword-challenge-indicators"},c.map((function(e,t){return a>=t+1?o.createElement(yt,{key:t}):o.createElement(bt,{key:t})})))},yt=function(){return o.createElement("div",{className:"sword-icon"},o.createElement(le,{src:a}))},bt=function(){return o.createElement("div",{className:"sword-icon disabled"},o.createElement(le,{src:ht}))},Nt=function(){return o.createElement("div",{className:"star-rain-container"},o.createElement("div",{className:"star",id:"star-01"},o.createElement(Ct,null)),o.createElement("div",{className:"star",id:"star-02"},o.createElement(Ct,null)),o.createElement("div",{className:"star",id:"star-03"},o.createElement(Ct,null)),o.createElement("div",{className:"star",id:"star-04"},o.createElement(Ct,null)),o.createElement("div",{className:"star",id:"star-05"},o.createElement(Ct,null)),o.createElement("div",{className:"star",id:"star-06"},o.createElement(Ct,null)))},Ct=function(){return o.createElement("svg",{viewBox:"0 0 217.791 210.633"},o.createElement("path",{fill:"#FFFFE6",d:"M94.15,77.97c0,0-2-54,10-73.5s23,28.5,25.5,72.5c0,0,69.197,4.589,86.5,21c13.637,12.934-61.5,31-87,33.5 c-2,14.5-1.831,60.464-16.5,75.5c-20,20.5-25.5-50.5-23-78c-19-1.5-81.5-3.5-89-17.5S52.15,85.97,94.15,77.97z"}))},kt=function(e){var t=e.title,n=e.children,r=de(e,["title","children"]);return o.createElement(ut,fe({requestCloseOnClickOutside:!0,insertTop:o.createElement(o.Fragment,null,o.createElement("div",{className:"dialog-border-top"}),o.createElement("div",{className:"dialog-title"},t)),insertBottom:o.createElement("div",{className:"dialog-border-bottom"}),insertLeft:o.createElement("div",{className:"dialog-border-left"}),insertRight:o.createElement("div",{className:"dialog-border-right"})},r,{className:"dialog-theme-wood dialog-spacing-10 dialog-spacing-fluid dialog-spacing-top-fixed ".concat(r.className)}),n)},xt=function(e){var t=e.dialogIsOpen,n=e.closeDialog;return o.createElement(kt,{className:"score-rules-dialog",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0,title:"Score"},o.createElement(o.Fragment,null,o.createElement("div",{className:"dialog-box"},o.createElement("div",{className:"dialog-label"},"Combinaisons de dés"),o.createElement("div",{className:"columns"},o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Symbols identiques"),o.createElement("span",{className:"symbol-number"},"3"),o.createElement("span",{className:"symbol-number"},"4"),o.createElement("span",{className:"symbol-number"},"5"),o.createElement("span",{className:"symbol-number"},"6"),o.createElement("span",{className:"symbol-number"},"7"),o.createElement("span",{className:"symbol-number"},"8")),o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Points"),o.createElement("span",{className:"points"},"+100"),o.createElement("span",{className:"points"},"+200"),o.createElement("span",{className:"points"},"+500"),o.createElement("span",{className:"points"},"+1000"),o.createElement("span",{className:"points"},"+2000"),o.createElement("span",{className:"points"},"+4000")))),o.createElement("div",{className:"dialog-box"},o.createElement("div",{className:"dialog-label"},"Dés spéciaux"),o.createElement("div",{className:"columns"},o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Symbol"),o.createElement(le,{src:k}),o.createElement(le,{src:x})),o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Points"),o.createElement("span",{className:"points"},"+100"),o.createElement("span",{className:"points"},"+100")))),o.createElement("div",{className:"dialog-box last"},o.createElement("div",{className:"dialog-label"},"Bonus coffre plein"),o.createElement("div",{className:"columns"},o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Dés utilisés"),o.createElement("span",{className:"symbol-number"},"8")),o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Points"),o.createElement("span",{className:"points"},"+500"))))))},St=function(e,t,n){var r=wt(n),o=Math.cos(r),a=Math.sin(r),c=t.x-e.x,l=t.y-e.y;return{x:Math.round(o*c+a*l+e.x),y:Math.round(o*l-a*c+e.y)}},Dt=function(e){var t=l(e,4),n=t[0],r=t[1],o=t[2],a=t[3];return{x:(n.x+r.x+o.x+a.x)/4,y:(n.y+r.y+o.y+a.y)/4}},wt=function(e){return e*Math.PI/180},Rt=function(e,t){return!!It(t,(function(t){return n=t,r=l(e,2),o=r[0],a=r[1],c=l(n,2),i=c[0],u=c[1],s=(u.x-i.x)*(o.y-i.y)-(u.y-i.y)*(o.x-i.x),d=(a.x-o.x)*(o.y-i.y)-(a.y-o.y)*(o.x-i.x),f=(u.y-i.y)*(a.x-o.x)-(u.x-i.x)*(a.y-o.y),(0!==s||0!==d||0!==f)&&0!==f&&(d/=f,(s/=f)>=0&&s<=1&&d>=0&&d<=1);var n,r,o,a,c,i,u,s,d,f}))},It=function(e,t){var n=l(e,4),r=n[0],o=n[1],a=n[2],c=n[3];return!!t([r,o])||(!!t([o,a])||(!!t([a,c])||!!t([c,r])))},At=function(e,t){var n=e.left,r=e.right,o=r-n;n<t.left?r=(n=t.left)+o:r>t.right&&(r=(n=t.right-o)+o);var a=e.top,c=e.bottom,l=c-a;return a<t.top?c=(a=t.top)+l:c>t.bottom&&(c=(a=t.bottom-l)+l),{left:n,right:r,top:a,bottom:c}},Ot=function(e){var t=e.left,n=e.right,r=e.top;return{x:t+(n-t)/2,y:r+(e.bottom-r)/2}},Mt=function(e,t){var n,r,o,a,c=Ot(e),l=Ot(t);return r=l,o=(n=c).x-r.x,a=n.y-r.y,Math.sqrt(o*o+a*a)},Lt=function(e){var t=e.getBoundingClientRect(),n=ve(e),r=t.left+n.x,o=t.top+n.y,a=r+t.width,c=o+t.height;return{left:Math.floor(r),top:Math.floor(o),right:Math.floor(a),bottom:Math.floor(c)}},qt=function(e,t){var n,r,o=Lt(e);return r=t,!((n=o).right<=r.left||n.left>=r.right||n.bottom<=r.top||n.top>=r.bottom)},Pt=function(e,t){var n=e.map((function(e){return Lt(e)})),r=function(e,t){var n=Mt(t,e[0]);return e.reduce((function(e,r){var o=Mt(t,r);return o<n?(n=o,r):e}))}(n,t);return e[n.indexOf(r)]},Tt=function(e){var t=e.x,n=e.y,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.color,a=void 0===o?"yellow":o,c=r.autoRemove,l=void 0===c||c,i=r.autoRemoveAfter,u=void 0===i?2e3:i,s=document.createElement("div");s.style.position="absolute",s.style.zIndex="1000",s.style.left="".concat(t,"px"),s.style.top="".concat(n,"px"),s.style.width="5px",s.style.height="5px",s.style.background=a,s.style.border="1px solid red",document.body.appendChild(s);var d,f=function(){document.body.removeChild(s)};return l&&(d=setTimeout(f,u)),function(){f(),clearTimeout(d)}},jt=function(e,t){if(!e)return 0;var n=t-(Date.now()-e);return n<=0?0:n},Ft=function(e){var t=e.totalScoreDomNodeRef,n=e.scoreParticle,r=o.useRef();return o.useLayoutEffect((function(){var e=r.current,t=e.querySelector("text").getBBox();e.setAttribute("width",t.width),e.setAttribute("height",t.height)}),[]),o.useEffect((function(){var e=r.current,o=t.current;return Bt({particleDomNode:e,totalScoreDomNode:o,x:n.x,y:n.y,delay:n.animationDelay,oncancel:n.oncancel,onfinish:n.onfinish})}),[]),o.createElement("svg",{ref:r,className:"score-particle"},o.createElement("text",{x:"0",y:"0",dominantBaseline:"text-before-edge",className:"score-particle--value"},n.value))},Bt=function(e){var t=e.particleDomNode,n=e.totalScoreDomNode,r=e.x,o=e.y,a=e.duration,c=void 0===a?800:a,l=e.delay,i=void 0===l?0:l,u=e.oncancel,s=void 0===u?function(){}:u,d=e.onfinish,f=void 0===d?function(){}:d,m=Lt(t),v=Lt(n),p=m.right-m.left,h=m.bottom-m.top,g=r-p/2,E=o-h/2,y=g+5,b=E-1.5*h,N=v.left,C=v.top;t.style.left="".concat(g,"px"),t.style.top="".concat(E,"px");var k=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.4,opacity:1,transform:"translate(".concat(y-g,"px, ").concat(b-E,"px) scale(1.2)")},{transform:"translate(".concat(N-g,"px, ").concat(C-E,"px) scale(1.2)")}],{duration:c,delay:i,fill:"forwards"});return k.onfinish=function(){f()},function(){s(),k.cancel()}},zt=function(e){var t=e.symbol,n=e.symbolEffect,r=Xt(),a=S(),c=o.useMemo((function(){return r.filter((function(e){var n=e.chestSlotContent,r=on(n,a);return r&&r===t}))}),[t,r,a]);Ne((function(){var e=c.map((function(e){return n(e)}));return function(){e.forEach((function(e){"function"==typeof e&&e()}))}}),[c])},Ut=function(e){var t=e.addScoreParticle,n=D(),a=S(),c=o.useMemo((function(){var e={};return Object.keys(n).forEach((function(t){var r=n[t],o=on(r,a);o&&(o in e?e[o].push(t):e[o]=[t])})),e}),[n,a]),l=Xt(),i=o.useMemo((function(){var e=[];return Object.keys(c).forEach((function(t){var n=c[t],r=n.find((function(e){return l.some((function(t){return t.chestSlot===e}))}));r&&e.push({symbol:t,slotsParticipatingToCombo:n,chestSlot:r})})),e}),[c,l]);Ne((function(){var e=i.map((function(e){var n=e.symbol,o=e.slotsParticipatingToCombo,a=e.chestSlot,c=o.length,l=Gt[c];if(!l)return function(){};var i="".concat(c,"-").concat(n,"-combo");return t(r({id:i,value:l},Zt(document.querySelector('[data-chest-slot="'.concat(a,'"]')))))}));return function(){e.forEach((function(e){e()}))}}),[i])},Gt={3:100,4:200,5:500,6:1e3,7:2e3,8:4e3},Xt=function(){var e=D(),t=o.useRef(null);return o.useMemo((function(){var n=t.current;t.current=e;var r=[];return null===n||Object.keys(e).forEach((function(t){var o=e[t];if(!Object.keys(n).find((function(e){var t=n[e];return an(o,t)}))){var a=n[t];r.push({chestSlot:t,chestSlotContentPrevious:a,chestSlotContent:o})}})),r}),[e])},Zt=function(e){var t=Lt(e);return Ot(t)},Yt=function(e){var t=e.addScoreParticle,n=D(),a=S(),c=o.useMemo((function(){var e=[];Object.keys(n).forEach((function(t){var r=n[t];r&&("dice"===r.type&&e.push(on(r,a)))}));var t=vt(e).perfectBonus;return Boolean(t)}),[n,a]),l=Xt(),i=o.useMemo((function(){return 0===l.length?null:{perfect:c,chestSlot:l[0].chestSlot}}),[c,l]);Ne((function(){if(i&&i.perfect)return t(r({id:"perfect",value:500},Zt(document.querySelector('[data-chest-slot="'.concat(i.chestSlot,'"]')))))}),[i])},Jt=o.useState,Wt=o.useEffect,_t=function(){var e=C(N()),t=Kt();return o.createElement("div",{className:"score-area ".concat(t?"animated":"")},e?o.createElement(Ht,null):null)},Kt=function(){var e=C(N()),t=mn(),n=ft(t,b),r=gt();return!!d(e)&&!(n>=r)},Ht=function(){var e,t,n,a,i=Cn(),u=C(N()),s=w(),f=Kt(),m=o.useRef(),v=(e=o.useState(!1),t=l(e,2),n=t[0],a=t[1],[n,function(){a(!0)},function(){a(!1)}]),h=l(v,3),g=h[0],b=h[1],k=h[2],x=Se(),S=l(x,2),D=S[0],R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalScore,n=void 0===t?0:t,r=e.minDelayBetweenParticles,a=void 0===r?400:r,i=e.onScoreParticleAdded,u=void 0===i?function(){}:i,s=e.onScoreParticleRemoved,d=void 0===s?function(){}:s,f=e.onScoreParticleMerged,m=void 0===f?function(){}:f,v=o.useState(n),p=l(v,2),h=p[0],g=p[1],E=o.useState([]),y=l(E,2),b=y[0],N=y[1];o.useEffect((function(){g(n)}),[n]);var C=function(e){N((function(t){return[].concat(c(t),[e])})),u(e);var t=!1;return function(){t||(t=!0,N((function(t){return t.filter((function(t){return t!==e}))})),g((function(t){return t-e.value})),d(e))}},k=o.useRef(null),x=function(e){var t=e.id,n=e.value,r=e.x,o=e.y,c=k.current,l=jt(c,a);k.current=Date.now()+l;var i={id:t,value:n,x:r,y:o,animationDelay:l,oncancel:function(){u()},onfinish:function(){m(i),g((function(e){return e+i.value}))}},u=C(i);return u},S=b.reduce((function(e,t){return e+t.value}),0);return[b,x,h-S]}({totalScore:i,onScoreParticleMerged:S[1]}),I=l(R,3),A=I[0],O=I[1],M=I[2];return function(e){var t=e.addScoreParticle;zt({symbol:y,symbolEffect:function(e){var n=e.chestSlot;return t(r({id:"chest-slot-".concat(n,"-coin"),value:100},Zt(document.querySelector('[data-chest-slot="'.concat(n,'"]')))))}}),zt({symbol:E,symbolEffect:function(e){var n=e.chestSlot;return t(r({id:"chest-slot-".concat(n,"-diamond"),value:100},Zt(document.querySelector('[data-chest-slot="'.concat(n,'"]')))))}}),Ut({addScoreParticle:t}),Yt({addScoreParticle:t})}({addScoreParticle:O}),Vt({roundScoreDomNodeRef:m,scoreParticleMergedListener:D}),o.createElement(o.Fragment,null,p(u)?o.createElement($t,null):null,s?o.createElement(Nt,null):null,o.createElement("button",{className:"round-score ".concat(f?"hidden":""),onClick:b},o.createElement("span",{ref:m,className:"round-score--value"},o.createElement(Ae,{value:M,condition:function(e,t){return e>t},duration:600}))),d(u)?o.createElement(en,null):null,o.createElement(xt,{dialogIsOpen:g,closeDialog:k}),A.map((function(e){return o.createElement(Ft,{key:e.id,totalScoreDomNodeRef:m,scoreParticle:e})})))},Vt=function(e){var t=e.roundScoreDomNodeRef,n=e.scoreParticleMergedListener,r=De(n);o.useEffect((function(){if(r){var e=t.current;return Qt({roundScoreDomNode:e,duration:300})}}),[r])},Qt=function(e){var t=e.roundScoreDomNode,n=e.duration,r=t.animate([{transform:"scale(1.5)"}],{duration:n});return function(){r.cancel()}},$t=function(){return R()?o.createElement("div",{className:"pirate-hook"}):o.createElement("div",{style:{display:"none"},className:"pirate-hook"})},en=function(){var e=Cn(),t=mn(),n=ft(t,b),r=gt(),a=new Array(r).fill(""),c=n>=r,i=Ce((function(e){return e<n}),[n]),u=Jt(!1),s=l(u,2),d=s[0],f=s[1];return Wt((function(){i&&f(!0)}),[i]),Wt((function(){if(d){var e=setTimeout((function(){f(!1)}),300);return function(){clearTimeout(e)}}return function(){}}),[d]),o.createElement(o.Fragment,null,o.createElement("div",{className:"ropes ".concat(c?"challenge-won":"")},a.map((function(e,t){return n>=t+1?o.createElement("div",{key:t,className:"rope rope-".concat(t+1," cut-rope")}):o.createElement("div",{key:t,className:"rope rope-".concat(t+1)})}))),d&&n<=r?o.createElement("div",{className:"sword-slice"},o.createElement("div",{className:"triangle-left"}),o.createElement("div",{className:"triangle-right"})):null,o.createElement("div",{className:"negative-round-score rotate-".concat(n," ").concat(c?"removed":"")},e))},tn=50,nn=System.resolve("./assets/cursed-grid.png",t.meta.url),rn=function(e){var t=e.chestRef,n=e.diceOverChestListener,a=D(),c=En(),l=De(n),i=C(N()),u=c&&I(i);return o.createElement("div",{className:"chest"},o.createElement("div",{ref:t,className:"dice-area ".concat(I(i)?"glow":""),style:r({},l?{outline:"2px dotted"}:{})},o.createElement("div",{className:"box"},Object.keys(a).map((function(e){return o.createElement("div",{className:"slot",key:e,"data-chest-slot":e},o.createElement(cn,{chestSlotContent:a[e]}))}))),o.createElement("div",{className:"top-left-corner"}),o.createElement("div",{className:"top-right-corner"}),o.createElement("div",{className:"bottom-left-corner"}),o.createElement("div",{className:"bottom-right-corner"}),c&&!u?o.createElement(ln,null):null),o.createElement(_t,null))},on=function(e,t){if(e&&"symbol"===e.type)return e.value;if(e&&"dice"===e.type){var n=t[e.value];return O(n)}return null},an=function(e,t){var n=Boolean(e),r=Boolean(t);return!n&&!r||n===r&&(e.type===t.type&&e.value===t.value)},cn=function(e){var t=e.chestSlotContent,n=C(N());if(!t)return null;if("symbol"===t.type){var r=t.value;return o.createElement("button",{className:"dice",style:{width:tn,height:tn,color:"#fcfcfc",margin:"5px",backgroundColor:n.color1,borderColor:n.color2,borderWidth:"2px",borderStyle:"solid"}},o.createElement(le,{src:A(r),draggable:"false",style:{width:"100%",height:"100%"}}))}return null},ln=function(){return o.createElement("div",{className:"cursed-cover"},o.createElement(le,{draggable:"false",src:nn,alt:"cursed-cover"}))},un=o.useMemo,sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentPlayerId,n=void 0===t?M():t,r=e.players,o=void 0===r?L():r;return o.find((function(e){return e.id===n}))},dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?z():t;return 0===n},fn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?z():t;return n>0},mn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,n=void 0===t?S():t,r=e.chestSlots,o=void 0===r?D():r;return Object.keys(o).reduce((function(e,t){var r=on(o[t],n);return r?[].concat(c(e),[r]):e}),[])},vn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?yn():t;return 3-n},pn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dicesToCurse,n=void 0===t?hn():t;return n.length>0},hn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,n=void 0===t?S():t,r=e.diceRolledIds,o=void 0===r?U():r,a=e.witchUncursedDiceId,c=void 0===a?G():a,l=e.remainingSpotInCursedArea,i=void 0===l?vn():l,u=o.map((function(e){return n[e]})).filter((function(e){return!!X(e)&&e.id!==c})).slice(0,i);return u},gn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?N():t,r=e.hasNeverRolled,o=void 0===r?dn():r,a=e.scoreMarked,c=void 0===a?w():a,l=e.threeSkullsOrMoreInCursedArea,i=void 0===l?En():l,u=e.hasDicesToCurse,s=void 0===u?pn():u;return!!n&&(!c&&(!!o||(i?!!I(C(n)):!s)))},En=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?yn():t;return n>2},yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.diceCursedIds,n=void 0===t?P():t,r=e.symbolsFromCard,o=void 0===r?bn():r;return n.length+o.filter((function(e){return q(e)})).length},bn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?N():t;if(!n)return[];var r=C(n);return h(r)?[y]:g(r)?[E]:T(r)?[j]:F(r)?[j,j]:[]},Nn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scoreMarked,n=void 0===t?w():t,r=e.currentCardId,o=void 0===r?N():r,a=e.threeSkullsOrMoreInCursedArea,c=void 0===a?En():a,l=e.hasDicesToCurse,i=void 0===l?pn():l;return!n&&(c?!!I(C(o)):!i&&!!o)},Cn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?N():t,r=e.symbolsInChest,o=void 0===r?mn():r,a=e.scoreMarked,c=void 0===a?w():a,l=e.markScoreAllowed,i=void 0===l?Nn():l;return un((function(){return st({card:C(n),symbolsInChest:o,scoreMarked:c,markScoreAllowed:i})}),[n,o,c,i])},kn=n((function(e,t){return r(r({},e),{},{currentPlayerId:t.id,currentCardId:null,currentCardActivated:!1,roundStarted:!0},Rn)})),xn=n((function(e){return r(r({},e),{},{currentCardId:null,currentCardActivated:!1,roundStarted:!1})})),Sn=n((function(e){return r(r({},e),{},{currentCardActivated:!0})})),Dn=n((function(e){return r(r({},e),{},{isOnSkullIsland:!0})})),wn=n((function(e,t){var n=e.players,o=e.currentPlayerId,a=n.find((function(e){return e.id===o})),l=a.score+t;return a.score=l<0?0:l,r(r({},e),{},{players:c(n),scoreMarked:!0})})),Rn=(n((function(e){return r(r({},e),Rn)})),{witchUncursedDiceId:null,witchCardEffectUsed:!1,rollCount:0,diceRolledIds:[],diceCursedIds:[],chestSlots:{1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null},scoreMarked:!1,isOnSkullIsland:!1}),In=n((function(e,t,n,o){var a=n.x,c=n.y,l=e.dices;return t.rolledAreaPosition={x:a,y:c},t.rolledAreaZIndex=o,r(r({},e),{},{dices:r({},l)})})),An=n((function(e,t,n){var o=e.chestSlots,a=Object.keys(o).find((function(e){var n=o[e];return n&&"dice"===n.type&&n.value===t.id}));return r(r({},e),{},{chestSlots:r(r(r({},o),a?Z({},a,null):{}),{},Z({},n,{type:"dice",value:t.id}))})})),On=n((function(e,t){var n=e.diceRolledIds,o=e.diceCursedIds;return r(r({},e),{},{diceRolledIds:n.filter((function(e){return e!==t.id})),diceCursedIds:[].concat(c(o),[t.id])})})),Mn=n((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.diceRolledIds,a=e.diceCursedIds;return r(r(r({},e),n?{}:{witchUncursedDiceId:t.id,witchCardEffectUsed:!0}),{},{diceRolledIds:[].concat(c(o),[t.id]),diceCursedIds:a.filter((function(e){return e!==t.id}))})})),Ln=n((function(e,t){var n=e.diceRolledIds,o=e.chestSlots,a=Object.keys(o).find((function(e){var n=o[e];return n&&"dice"===n.type&&n.value===t.id}));return r(r({},e),{},{diceRolledIds:[].concat(c(n),[t.id]),chestSlots:r(r({},o),{},Z({},a,null))})})),qn=n((function(e,t,n){var o=e.diceRolledIds,a=e.chestSlots;return r(r({},e),{},{diceRolledIds:o.filter((function(e){return e!==t.id})),chestSlots:r(r({},a),{},Z({},n,{type:"dice",value:t.id}))})})),Pn=o.useEffect,Tn=function(){return jn(),null},jn=function(){Fn(),Bn(),zn()},Fn=function(){var e=Y(),t=hn(),n=On();Pn((function(){if(0===t.length)return function(){};if(e)return t.forEach((function(e){n(e)})),function(){};var r=setTimeout((function(){t.forEach((function(e){n(e)}))}),1e3);return function(){clearTimeout(r)}}),[t])},Bn=function(){var e=C(N()),t=w(),n=wn(),r=En(),o=Ce((function(e){return!e&&r}),[r]),a=Cn(),c=d(e);Pn((function(){c&&!t&&o&&n(a)}),[c,t,o,a])},zn=function(){var e=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rollCount;return 1===(void 0===e?z():e)}(),t=C(N()),n=J(),r=yn(),o=Dn();Pn((function(){e&&(n||d(t)||r<4||o())}),[e,n,t,r])},Un=n((function(e){var t=e.cardIds,n=e.cardUsedIds,o=t[0];return r(r({},e),{},{cardIds:t.slice(1),cardUsedIds:[].concat(c(n),[o]),currentCardId:o})})),Gn=n((function(e){var t=e.chestSlots;return r(r({},e),{},{chestSlots:r(r({},t),{},{1:{type:"symbol",value:y}})})})),Xn=n((function(e){var t=e.chestSlots;return r(r({},e),{},{chestSlots:r(r({},t),{},{1:{type:"symbol",value:E}})})})),Zn=n((function(e){var t=e.cardIds,n=e.cardUsedIds;return r(r({},e),{},{cardIds:W([].concat(c(t),c(n))),cardUsedIds:[]})})),Yn=(n((function(e){var t=e.currentCardId,n=e.cardIds,o=e.cardUsedIds;return r(r({},e),{},{currentCardId:null,cardIds:[t].concat(c(n)),cardUsedIds:o.slice(1)})})),function(){return Jn(),Wn(),null}),Jn=function(){var e=Gn(),t=N(),n=R(),r=Ce((function(e){return!e===n}),[n]),a=t&&h(C(t));o.useEffect((function(){a&&e()}),[]),o.useEffect((function(){r&&a&&e()}),[r,a])},Wn=function(){var e=Xn(),t=N(),n=R(),r=Ce((function(e){return!e===n}),[n]),a=t&&g(C(t));o.useEffect((function(){a&&e()}),[]),o.useEffect((function(){r&&a&&e()}),[r,a])},_n=function(e){var t=e.rolledAreaRef,n=e.offscreenRef,a=e.diceOverRolledAreaListener,c=De(a);return o.createElement("div",{className:"dice-ongoing"},o.createElement("div",{className:"map"}),o.createElement("div",{className:"area",ref:t,style:r({},c?{outline:"2px dotted"}:{})}),o.createElement("div",{className:"offscreen-area",ref:n}))},Kn={animals:{name:"Animaux",rule:"Les singes et les perroquest obtenus sur les dés comptent comme un même symbol dans une combinaison.",more:"Par exemple 2 perroquets et 3 singes forment une conbinaison de 5 dés identiques, soit 500 points."},chest:{name:"Coffre au trésor",rule:'Lorsque le joueur sauvegarde ses dés, grâce à la carte "Coffre au trésor" les dés sont protégés du mauvais sort.',more:"Ainsi même lorsque le joueur obtient 3 têtes de morts, son tour prends fin, mais il peut marquer les points totalisés grâce aux dés sauvegardés!"},coin:{name:"Pièce d'or",rule:"Le joueur commence son tour avec un symbol pièce d'or. Il rapporte des points aussi bien dans une combinaison de dés que comme simple pièce (+100)."},diamond:{name:"Diamant",rule:"Le joueur commence son tour avec un symbol diamant. Il rapporte des points aussi bien dans une combinaison de dés que comme simple diamant (+100)."},pirate:{name:"Capitaine des pirates",rule:"Grâce à l'aide du capitaine, tous les points comptabilisés pendant ce tour sont doublés !"},witch:{name:"Sorcière",rule:"Avec ses potions magiques, la sorcière permet exceptionnellement au joueur de relancer, une fois, un dé avec une tête de mort."},"1skull":{name:"Tête de mort",rule:"Le tour du joueur débute avec un symbole tête de mort."},"2skulls":{name:"2 têtes de mort",rule:"Le tour du joueur débute avec 2 symboles tête de mort."},"2sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 2 symbols sabres. Si il y parvient, il gagne +300 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -300 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"3sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 3 symbols sabres. Si il y parvient, il gagne +500 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -500 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"4sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 4 symbols sabres. Si il y parvient, il gagne +1000 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -1000 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."}},Hn=function(e){var t=e.dialogIsOpen,n=e.closeDialog,r=e.card,a=Kn[r.type];return o.createElement(kt,{className:"card-rules-dialog",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0,title:"Carte"},a?o.createElement(o.Fragment,null,o.createElement("div",{className:"dialog-label"},a.name),o.createElement("div",{style:{textAlign:"center"}},o.createElement(le,{className:"current-card",src:_(r),width:"150",alt:r.type})),o.createElement("div",{className:"text-rule"},a.rule),a.more?o.createElement("div",{className:"text-rule"},a.more):null):"No rule")},Vn=o.forwardRef((function(e,t){var n=e.card,r=de(e,["card"]);return o.createElement("div",fe({className:"card current-card",ref:t,style:{backgroundColor:n.color1,borderColor:n.color2}},r),o.createElement(le,{src:K(n),alt:n.type}))})),Qn=function(e){var t=e.openScoreboard,n=e.headerSmallCardRef,r=C(N()),a=R();return o.createElement("div",{className:"header"},o.createElement("div",{className:"card-container"},o.createElement("div",{className:"small-card"},r?o.createElement($n,{headerSmallCardRef:n,currentCard:r}):o.createElement(er,null)),a&&o.createElement(Et,null)),o.createElement(tr,{openScoreboard:t}),o.createElement(nr,null))},$n=function(e){var t=e.headerSmallCardRef,n=e.currentCard,r=o.useState(!1),a=l(r,2),c=a[0],i=a[1];return o.createElement(o.Fragment,null,o.createElement(Vn,{onClick:function(){i(!0)},card:n,ref:t}),o.createElement(Hn,{card:n,dialogIsOpen:c,closeDialog:function(){i(!1)}}))},er=function(){return o.createElement("div",{className:"card default-card",style:{backgroundImage:"url(".concat(pe,")"),backgroundSize:"217px"}})},tr=function(e){var t=e.openScoreboard,n=sn();return o.createElement(le,{onClick:t,className:"avatar",src:n&&n.character.img,alt:"player",style:{borderColor:n&&n.character.color||"white"}})},nr=function(){var e=sn(),t=e.score,n=Re(t,{duration:1200,timingFunction:function(e){return 1-Math.pow(1-e,5)}});return o.createElement("div",{className:"total-score"},o.createElement("span",{className:"score",style:{backgroundColor:e&&e.character.color||"white"}},n?n.value:t))},rr=6.25,or=function(e,t){var n=t.rolledAreaDomNode,r=Lt(n),o=r.right-r.left,a=r.bottom-r.top,c={left:rr,right:o-56.25,top:rr,bottom:a-56.25},l=[],i=function(e){var t=0;return function n(){var r=ar(e,c),o=cr(),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dt(e);return e.map((function(e){return St(n,e,t)}))}(r,o);return!l.some((function(e){return t=e,It(a,(function(e){return Rt(e,t)}));var t}))||t>50?{rectangle:r,rotation:o,rotatedRectangle:a}:(t++,n())}()};return e.forEach((function(e,t){e.visibleFaceIndex=lr(e);var n=i(e),r=n.rectangle,o=n.rotation,a=n.rotatedRectangle;l.push(a),e.rolledAreaZIndex=t+1,e.rolledAreaPosition=r[0],e.rotation=o})),e},ar=function(e,t){var n={x:ir(t.left,t.right),y:ir(t.top,t.bottom)};return[{x:n.x,y:n.y},{x:n.x+tn,y:n.y},{x:n.x+tn,y:n.y+tn},{x:n.x,y:n.y+tn}]},cr=function(){return ir(-35,35)},lr=function(e){return ir(0,e.faces.length-1)},ir=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},ur=function(e){var t=e.rolledAreaRef,n=gn(),r=U(),a=dn(),c=sr(),l=C(N()),i=En(),u=r.length<2&&!a,s=i&&I(l),d=u||s;return n?o.createElement("div",{className:"roll-action"},o.createElement("button",{onClick:function(){c(t.current)},disabled:d},"Lancer",u&&!s&&o.createElement("span",{className:"button-subtitle"},"(au moins 2 dés !)")),s&&o.createElement(le,{src:H,className:"skull-symbol"})):null},sr=n((function(e,t){var n=e.dices,o=e.rollCount,a=e.diceRolledIds,c=(0===o?Object.keys(n):a).map((function(e){return n[e]}));return or(c,{rolledAreaDomNode:t}),r(r({},e),{},{rollCount:o+1,witchUncursedDiceId:null,diceRolledIds:c.map((function(e){return e.id})),dices:r({},n)})})),dr=function(e){var t=e.onRoundOver,n=e.rolledAreaRef;return o.createElement("div",{className:"footer actions"},o.createElement(ur,{rolledAreaRef:n}),o.createElement(fr,null),o.createElement(mr,{onRoundOver:t}))},fr=function(){var e=Cn(),t=wn(),n=Nn(),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hasRolledOnce,n=void 0===t?fn():t,r=e.scoreMarked,o=void 0===r?w():r,a=e.currentCardId,c=void 0===a?N():a,l=e.hasDicesToCurse,i=void 0===l?pn():l;return!(o||i||!c||!n)}(),a=e<0?"-":"+";return r?o.createElement("div",{className:"collect-action"},o.createElement("button",{onClick:function(){t(e)},disabled:!n},o.createElement("span",null,"Collecter"),o.createElement("span",{className:"score"},a," ",Math.abs(e))),!n&&o.createElement(le,{src:H,className:"skull-symbol"})):null},mr=function(e){var t=e.onRoundOver,n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollDiceAllowed,n=void 0===t?gn():t,r=e.markScoreAllowed,o=void 0===r?Nn():r,a=e.hasDicesToCurse,c=void 0===a?pn():a;return!n&&!o&&!c}(),r=xn(),a=Cn();return n?o.createElement("div",{className:"next-round-action"},o.createElement("button",{onClick:function(){r(),t({reason:"score-marked",value:a})}},"Terminer mon tour")):null},vr=function(e){var t=e.cursedAreaRef,n=C(N());return o.createElement("div",{className:"skull-island"},V(n)?o.createElement(hr,null):null,o.createElement("div",{className:"bottle"},o.createElement("div",{className:"area",ref:t},T(n)?o.createElement(pr,{card:n}):null,F(n)?o.createElement(o.Fragment,null,o.createElement(pr,{card:n}),o.createElement(pr,{card:n})):null)))},pr=function(e){var t=e.card;return o.createElement("button",{className:"dice",style:{width:tn,height:tn,color:"#fcfcfc",margin:"1px 5px",backgroundColor:t.color1,borderColor:t.color2,borderWidth:"2px"}},o.createElement(le,{src:H,style:{width:"100%",height:"100%"}}))},hr=function(){return R()?o.createElement("div",{className:"witch-label"},o.createElement(le,{src:he}),o.createElement("svg",{x:"0px",y:"0px",width:"156.083px",height:"208.667px",viewBox:"0 0 156.083 208.667"},o.createElement("path",{id:"path_01",fill:"none",stroke:"#E4AD30",d:"M8.406,107.82 c2.541,2.178,2.375,2.875,14.25,3.5c14.782,0.778,19.26-11.965,19.26-11.965S47.918,88,40.251,72.917s-18.916,4.583-9.083,8.167 s27.759-1.338,35.142-12.417C74.75,56,77.583,45.333,79.25,37S78.477,15.833,66.31,3.833"}),o.createElement("path",{id:"path_02",fill:"none",stroke:"#E4AD30",d:"M44.031,110.094 c0,0,1,1.313-4.438,3.344s-14.244,7.281-32.125-2"}),o.createElement("path",{id:"path_03",fill:"none",stroke:"#E4AD30",d:"M42.125,103.688 c0,0,1.313,6.594-9.313,8.625S10.281,108.719,9.406,101"}),o.createElement("path",{id:"path_04",fill:"none",stroke:"#E4AD30",d:"M33.114,112.253c0,0,39.886-19.253,43.011,24.747 c0.372,0.447-0.959,1.208-2.542,1.625"}))):o.createElement(le,{style:{display:"none"},src:he})},gr=function(e){var t=e.parent,n=e.children;return t?u.createPortal(o.createElement(o.Fragment,null,n),t):null},Er=function(e){var t=e.rotate,n=e.scale,r=e.translate;return[].concat(c(t?["rotate(".concat(t,"deg)")]:[]),c(n&&1!==n?["scale(".concat(n,")")]:[]),c(r?["translate(".concat(r,")")]:[])).join("")},yr=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=o.trailing,c=void 0!==a&&a,l=function o(){for(var a=arguments.length,l=new Array(a),i=0;i<a;i++)l[i]=arguments[i];clearTimeout(t);var u=Date.now();if(n){var s=u-n;if(s<r){if(c){var d=r-s;t=setTimeout((function(){return o.apply(void 0,l)}),d)}}else n=u,e.apply(void 0,l)}else n=u,e.apply(void 0,l)},i=function(){clearTimeout(t)};return l.cancel=i,l},br=function(e,t){var n,o,a=t.logLevel,c=void 0===a?"warn":a,l=t.onGrip,i=void 0===l?function(){}:l,u=t.onLongGrip,s=void 0===u?function(){}:u,d=t.onClick,f=void 0===d?function(){}:d,m=t.onDrag,v=void 0===m?function(){}:m,p=t.onRelease,h=void 0===p?function(){}:p,g=t.onCancel,E=void 0===g?function(){}:g,y=t.longGripMs,b=void 0===y?300:y,N=Q({logLevel:c}),C=!1,k=function(){},x=function(){},S=function(){};N.debug("enable drag on",e);var D,w,R,I,A,O=ge(e,"dragstart",(function(e){e.preventDefault()})),M=ge(e,"mousedown",(function(e){if(3===e.which)N.debug("ignore right click");else{P(Cr(e),e);var t=yr((function(e){j(Cr(e),e)}));S=function(){return t.cancel()},k=ge(document,"mousemove",t),x=ge(document,"mouseup",(function(e){x(),k(),F(Cr(e),e)}))}}),{passive:!0}),L=ge(e,"touchstart",(function(e){P(kr(e),e);var t=yr((function(e){j(kr(e),e)}));S=function(){return t.cancel()},k=ge(document,"touchmove",t),x=ge(document,"touchend",(function(e){x(),k(),F(kr(e),e)}))}),{passive:!0}),q=ge(e,"click",(function(e){C||"none"!==A||f(e)})),P=function(t,n){N.debug("gripping node at",t),o=!0,A="none",R=t,D=t,w=Nr(e),i({x:w.x,y:w.y,event:n}),I=setTimeout(T,b)},T=function(){C=!0,s()},j=function(e,t){if(D.x!==e.x||D.y!==e.y){D=e;var n=R.x-w.x,o=R.y-w.y,a={x:e.x-n,y:e.y-o},c=e.x-R.x,l=e.y-R.y;N.debug("move node at",a),v(r(r({event:t},a),{},{relativeX:c,relativeY:l,setDropEffect:function(e){A=e}}))}else N.debug("no real move")},F=function(e,t){N.debug("releasing node"),o=!1,clearTimeout(I);var r=R.x-w.x,a=R.y-w.y;h({event:t,dropEffect:A,x:D.x-r,y:D.y-a}),n=setTimeout((function(){C=!1}))};return function(e){O(),q(),M(),L(),k(),x(),clearTimeout(I),clearTimeout(n),S(),function(e){o&&(N.debug("cancelling drag",e),o=!1,E({event:e}))}(e)}},Nr=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top}},Cr=function(e){return{x:e.pageX,y:e.pageY}},kr=function(e){var t=e.changedTouches[0];return{x:t.pageX,y:t.pageY}},xr=o.useEffect,Sr=o.useState,Dr=function(e){var t=e.dice,n=e.diceAnimation,r=e.anmationDebug,a=void 0!==r&&r,c=e.parentNode,i=e.zIndex,u=e.x,d=e.y,f=e.rotation,m=e.draggable,v=e.onDiceClick,p=e.onDiceDrag,h=e.onDiceDrop,g=e.onDiceDragEnd,E=e.disapear,y=e.appear,b=s(),N=$(t.id),C=ee(t.id),k=Sr(!1),x=l(k,2),S=x[0],D=x[1],w=Sr(null),R=l(w,2),I=R[0],M=R[1],L=xe(c),q=n?L:c;xr((function(){if(!m||!N||!b)return function(){};var e=!1,n=br(N,{onGrip:function(){D(!0)},onClick:function(e){v(t,e)},onDrag:function(n){var r,o,a=n.x,c=n.y,l=n.relativeX,i=n.relativeY,u=n.setDropEffect,s=(r={left:a,right:a+tn,top:c,bottom:c+tn},o=Lt(b),At(r,o));M({x:s.left,y:s.top}),(e=e||Math.abs(l)>10||Math.abs(i)>10)&&p(t,{relativeX:l,relativeY:i,setDropEffect:u,diceRectangle:s})},onRelease:function(e){var n=e.dropEffect,r=e.x,o=e.y;"none"!==n&&h(t,{diceRectangle:{left:r,right:r+tn,top:o,bottom:o+tn}});D(!1),M(null),g(t)},onCancel:function(){D(!1),M(null),g(t)}});return function(){n()}}),[m,N,b,v,p,h,g]),xr((function(){if(!n||!N)return function(){};var e=n.from,t=n.to,r=n.onfinish;a&&(Tt(e),Tt(t));var o="translate(".concat(Math.floor(t.x-e.x),"px, ").concat(Math.floor(t.y-e.y),"px)"),c=N.parentNode.animate([{transform:o}],{duration:500,fill:"forwards",easing:"cubic-bezier(0, 0.55, 0.45, 1)"});return c.onfinish=r,function(){c.cancel()}}),[N,n]);var P=X(t),T=n&&n.from?n.from.x:I?I.x:u,j=n&&n.from?n.from.y:I?I.y:d,F=I||n?1e3:i;return o.createElement(gr,{parent:q},o.createElement("svg",{"data-dice-id":t.id,className:"dice",onClick:m?void 0:function(e){v(t,e)},style:{width:tn,height:tn,left:"".concat(T,"px"),top:"".concat(j,"px"),zIndex:F,cursor:m?S?"grabbing":"grab":void 0,position:I||n?"fixed":void 0}},o.createElement("g",{ref:C,className:E?"dice-cursed-disapear":y?"dice-cursed-appear":"",style:{transform:Er({rotate:f||0,scale:S?"1.1":"1"}),transitionProperty:"transform",transitionDuration:"500ms",transitionTimingFunction:"cubic-bezier(0, 0.55, 0.45, 1)",transformOrigin:"center center"}},o.createElement("rect",{className:"dice-background",width:"100%",height:"100%",rx:"5",ry:"5",fill:P?"black":"#fcfcfc",stroke:P?"black":"#b9b9b9",strokeWidth:"1"}),o.createElement("image",{xlinkHref:A(O(t)),draggable:"false",style:{width:"100%",height:"100%"}}))))},wr=function(e){var t=e.offscreenDomNode,n=e.chestDomNode,a=e.rolledAreaDomNode,c=e.cursedAreaDomNode,i=e.onDiceOverChestChange,u=void 0===i?function(){}:i,s=e.onDiceOverRolledAreaChange,d=void 0===s?function(){}:s,f=S(),m=D(),v=U(),p=P(),h=G(),g=te(),E=C(N()),y=w(),b=En(),k=pn(),x=o.useReducer((function(e,t){return r(r({},e),{},Z({},t.key,t.value))}),{}),R=l(x,2),I=R[0],A=R[1],O=In(),M=qn(),L=Ln(),q=Mn(),T=An(),j=o.useRef(null);return Object.keys(f).map((function(e){var l=f[e],i=Yr(l,{chestSlots:m,diceRolledIds:v,diceCursedIds:p}),s=Jr(i,{chestDomNode:n,rolledAreaDomNode:a,cursedAreaDomNode:c,offscreenDomNode:t}),N=s.parentNode,C=l.id!==h&&N===a&&X(l),x=N===c,S=o.useCallback((function(e){var t=Rr(e,{currentCard:E,witchCardEffectUsed:g,diceRolledIds:v,chestSlots:m,diceCursedIds:p,hasDicesToCurse:k,threeSkullsOrMoreInCursedArea:b,scoreMarked:y});if("keep"===t){var n=Ur(m);M(e,n)}else"unkeep"===t?L(e):"uncurse"===t&&q(e)}),[v,m,p,y,b,E,g]),D=o.useCallback((function(e,t){j.current=Ar({dragDiceGesture:t,chestDomNode:n,rolledAreaDomNode:a});var r=Ir(e,{diceRolledIds:v,chestSlots:m,dropTargetRef:j,rolledAreaDomNode:a,chestDomNode:n,hasDicesToCurse:k,threeSkullsOrMoreInCursedArea:b,scoreMarked:y});t.setDropEffect(r),u("keep"===r?e:null),d("unkeep"===r?e:null)}),[v,m,j,a,n,y,b,u,d]),w=o.useCallback((function(e,t){var r=Ir(e,{diceRolledIds:v,chestSlots:m,dropTargetRef:j,rolledAreaDomNode:a,chestDomNode:n,scoreMarked:y,threeSkullsOrMoreInCursedArea:b}),o=!1,c=null;if("reposition-in-rolled-area"===r){var l=Br(t.diceRectangle,a),i=zr(e,{dices:f,diceRolledIds:v});O(e,l,i)}else if("back-to-rolled-area"===r)o=!0,c=jr(e.rolledAreaPosition,a);else if("keep"===r){var u=Gr(e,{chestSlots:m,rectangle:t.diceRectangle,chestDomNode:n});M(e,u),o=!0,c=Fr(u,n)}else if("reposition-in-chest"===r){var s=Gr(e,{chestSlots:m,rectangle:t.diceRectangle,chestDomNode:n});Xr(e,m)!==s&&(T(e,s),o=!0,c=Fr(s,n))}else if("back-to-chest"===r){var d=Xr(e,m);o=!0,c=Fr(d,n)}else if("unkeep"===r){var p=Br(t.diceRectangle,a);O(e,p,zr(e,{dices:f,diceRolledIds:v})),L(e),o=!0,c=jr(p,a)}o&&A({key:e.id,value:{from:{x:t.diceRectangle.left,y:t.diceRectangle.top},to:c,onfinish:function(){setTimeout((function(){A({key:e.id,value:null})}))}}})}),[v,m,j,a,n,y,b]),R=o.useCallback((function(){u(null),d(null)}),[u,d]),P=r(r({key:l.id},s),{},{dice:l,diceAnimation:I[l.id],witchCardEffectUsed:g,disapear:C,appear:x,onDiceClick:S,onDiceDrag:D,onDiceDrop:w,onDiceDragEnd:R});return o.useMemo((function(){return o.createElement(Dr,P)}),Object.keys(P).map((function(e){return P[e]})))}))},Rr=function(e,t){var n=t.currentCard,r=t.witchCardEffectUsed,o=t.diceRolledIds,a=t.chestSlots,c=t.diceCursedIds,l=t.hasDicesToCurse,i=t.threeSkullsOrMoreInCursedArea,u=t.scoreMarked;return Or(e,o)?qr(e,{hasDicesToCurse:l,threeSkullsOrMoreInCursedArea:i,scoreMarked:u})?"keep":"none":Mr(e,a)?Pr(e,{threeSkullsOrMoreInCursedArea:i,scoreMarked:u})?"unkeep":"none":Lr(e,c)&&Tr(e,{currentCard:n,witchCardEffectUsed:r,scoreMarked:u,threeSkullsOrMoreInCursedArea:i})?"uncurse":"none"},Ir=function(e,t){var n=t.diceRolledIds,r=t.chestSlots,o=t.dropTargetRef,a=t.rolledAreaDomNode,c=t.chestDomNode,l=t.hasDicesToCurse,i=t.threeSkullsOrMoreInCursedArea,u=t.scoreMarked;return Or(e,n)?o.current===a?"reposition-in-rolled-area":o.current===c&&qr(e,{hasDicesToCurse:l,threeSkullsOrMoreInCursedArea:i,scoreMarked:u})?"keep":"back-to-rolled-area":Mr(e,r)?o.current===c?"reposition-in-chest":o.current===a&&Pr(e,{scoreMarked:u,threeSkullsOrMoreInCursedArea:i})?"unkeep":"back-to-chest":"none"},Ar=function(e){var t=e.dragDiceGesture,n=e.chestDomNode,r=e.rolledAreaDomNode;return qt(n,t.diceRectangle)?n:qt(r,t.diceRectangle)?r:null},Or=function(e,t){return t.includes(e.id)},Mr=function(e,t){return Object.keys(t).some((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},Lr=function(e,t){return t.includes(e.id)},qr=function(e,t){var n=t.hasDicesToCurse,r=t.threeSkullsOrMoreInCursedArea,o=t.scoreMarked;return!X(e)&&(!n&&(!r&&!o))},Pr=function(e,t){var n=t.scoreMarked,r=t.threeSkullsOrMoreInCursedArea;return!n&&!r},Tr=function(e,t){var n=t.currentCard,r=t.witchCardEffectUsed,o=t.scoreMarked,a=t.threeSkullsOrMoreInCursedArea;return!!V(n)&&(!r&&(!o&&!a))},jr=function(e,t){var n,r,o,a,c=(n={left:e.x,top:e.y,right:0,bottom:0},r=Lt(t),o=n.right-n.left,a=n.bottom-n.top,{left:r.left+n.left,top:r.top+n.top,right:r.left+n.left+o,bottom:r.top+n.top+a});return{x:c.left,y:c.top}},Fr=function(e,t){var n=Zr(e,t),r=Lt(n);return{x:r.left+5,y:r.top+5}},Br=function(e,t){var n=function(e,t){var n=Lt(t);return function(e,t){var n=e.left-t.left,r=n+(e.right-e.left),o=e.top-t.top;return{left:n,right:r,top:o,bottom:o+(e.bottom-e.top)}}(At(e,n),n)}(e,t);return{x:n.left,y:n.top}},zr=function(e,t){var n=t.diceRolledIds,r=t.dices;if(0===n.length)return 1;var o=n.slice(1).reduce((function(e,t){var n=r[t];return n.rolledAreaZIndex>e.rolledAreaZIndex?n:e}),r[n[0]]);return o===e?e.rolledAreaZIndex:o.rolledAreaZIndex+1},Ur=function(e){return Object.keys(e).find((function(t){return!e[t]}))},Gr=function(e,t){var n=t.chestSlots,r=t.rectangle,o=t.chestDomNode,a=new Map,c=[];Object.keys(n).forEach((function(t){var r=n[t];if(!r||"dice"===r.type&&r.value===e.id){var l=Zr(t,o);a.set(l,t),c.push(l)}}));var l=Pt(c,r);return a.get(l)},Xr=function(e,t){return Object.keys(t).find((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},Zr=function(e,t){return t.querySelector('[data-chest-slot="'.concat(e,'"]'))},Yr=function(e,t){var n=t.chestSlots,o=t.diceRolledIds,a=t.diceCursedIds,c=Object.keys(n).find((function(t){return n[t]&&"dice"===n[t].type&&n[t].value===e.id}));return c?{type:"chest-slot",value:c}:o.includes(e.id)?{type:"rolled-area",value:r(r({},e.rolledAreaPosition),{},{rotation:e.rotation,zIndex:e.rolledAreaZIndex})}:a.includes(e.id)?{type:"cursed-area",value:void 0}:{type:"offscreen-area"}},Jr=function(e,t){var n=e.type,r=e.value,o=t.chestDomNode,a=t.rolledAreaDomNode,c=t.cursedAreaDomNode,l=t.offscreenDomNode;return"chest-slot"===n?{parentNode:o.querySelector('[data-chest-slot="'.concat(r,'"]')),zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!0}:"rolled-area"===n?{parentNode:a,zIndex:r.zIndex,rotation:r.rotation,x:r.x,y:r.y,draggable:!0}:"cursed-area"===n?{parentNode:c,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}:{parentNode:l,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}},Wr=function(e){var t=e.dialogIsOpen,n=e.closeDialog,r=e.headerSmallCardRef,a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cardIds;return(void 0===e?B():e).map((function(e){return C(e)}))}(),c=N(),l=C(c)||null,i=o.useRef(),u=o.useRef(),s=o.useRef();return o.createElement(ut,{className:"draw-card-dialog dialog-spacing-10 dialog-spacing-fluid",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!1},o.createElement("div",{className:"dialog-content"},o.createElement("div",{className:"dialog-body"},o.createElement("div",{className:"dialog-label"},0===a.length&&!l&&"Paquet de cartes épuisé. Mélangez-le pour pouvoir piocher à nouveau !",0!==a.length&&!l&&"Piochez une carte pour le tour suivant.",l&&o.createElement("span",{className:"card-name"},Kn[l.type].name)),o.createElement("div",{className:"card-area"},o.createElement("div",{style:{position:"relative"}},o.createElement(_r,{backCardRef:i,currentCard:l,remainingCardCount:a.length}),o.createElement(Kr,{topCardRef:u,smallCardRef:s,currentCard:l})))),o.createElement("div",{className:"dialog-actions"},o.createElement(Hr,{backCardRef:i,cardDeck:a,currentCard:l}),l?o.createElement(eo,{headerSmallCardRef:r,smallCardRef:s,backCardRef:i,topCardRef:u,currentCard:l,closeDialog:n}):null)))},_r=function(e){var t=e.backCardRef,n=e.currentCard,r=e.remainingCardCount;return o.createElement("div",{ref:t,className:"card default-card",style:{background:"none"}},o.createElement(le,{src:pe,width:"150"}),n?null:o.createElement("div",{className:"remaining-cards-number"},r))},Kr=function(e){var t=e.topCardRef,n=e.smallCardRef,r=e.currentCard;return r?o.createElement(o.Fragment,null,o.createElement("div",{className:"card current-card",ref:t},o.createElement("div",{className:"flip-card"},o.createElement("div",{className:"flip-card-inner"},o.createElement("div",{className:"flip-card-front"},o.createElement(le,{className:"card default-card",src:pe})),o.createElement("div",{className:"flip-card-back"},o.createElement(le,{className:"card-img",src:_(r),width:"150",alt:r.type}))))),o.createElement("div",{className:"small-card"},o.createElement(Vn,{card:r,ref:n}))):null},Hr=function(e){var t=e.backCardRef,n=e.cardDeck;return e.currentCard?null:0===n.length?o.createElement(Qr,{backCardRef:t}):o.createElement(Vr,null)},Vr=function(){var e=Un();return o.createElement("button",{className:"button-card-main button-draw-card",onClick:e},"Piocher")},Qr=function(e){var t=e.backCardRef,n=Y(),r=Zn(),a=o.useState(!1),c=l(a,2),i=c[0],u=c[1];return o.useEffect((function(){return i?(r(),n?(u(!1),function(){}):$r({backCard:t.current,duration:1e3,onfinish:function(){u(!1)}})):function(){}}),[i]),o.createElement("button",{className:"button-card-main button-shuffle-deck",onClick:function(){u(!0)}},"Mélanger")},$r=function(e){var t=e.backCard,n=e.duration,r=e.onfinish;t.setAttribute("shaking-deck","");var o=setTimeout((function(){t.removeAttribute("shaking-deck",""),r()}),n);return function(){t.removeAttribute("shaking-deck",""),clearTimeout(o)}},eo=function(e){var t=e.headerSmallCardRef,n=e.smallCardRef,r=e.backCardRef,a=e.topCardRef,c=Y(),i=Sn(),u=o.useState(!1),s=l(u,2),d=s[0],f=s[1];return o.useEffect((function(){return d?c?(i(),function(){}):to({headerSmallCard:t.current,smallCard:n.current,backCard:r.current,topCard:a.current,duration:500,onfinish:function(){i()}}):function(){}}),[d]),o.createElement("button",{className:"button-card-main button-activate-card",onClick:function(){d||f(!0)}},"Commencer")},to=function(e){var t=e.headerSmallCard,n=e.topCard,r=e.backCard,o=e.smallCard,a=e.duration,c=e.onfinish;r.style.opacity=0;var l=Lt(t),i=n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(0)",opacity:0}],{duration:a,fill:"forwards"}),u=o.animate([{transform:"scale(0)",opacity:0,position:"fixed",top:"auto",left:"auto"},{transform:"scale(1)",opacity:1,position:"fixed",top:"".concat(l.top,".px"),left:"".concat(l.left,".px")}],{duration:a,fill:"forwards"});return u.onfinish=c,function(){i.cancel(),u.cancel()}},no=function(e){var t=e.openScoreboard,n=e.onRoundStart,r=e.onRoundOver,a=R(),c=o.useState(!1),i=l(c,2),u=i[0],s=i[1];o.useEffect((function(){n()}),[]);var d=Se(),f=l(d,2),m=f[0],v=f[1],p=Se(),h=l(p,2),g=h[0],E=h[1],y=o.useRef();return o.createElement("div",{className:"round-container"},o.createElement(Yn,null),o.createElement(Qn,{openScoreboard:t,headerSmallCardRef:y}),a?o.createElement(ro,{diceOverRolledAreaListener:m,diceOverChestListener:g,openScoreboard:t,onRoundOver:r,onRoundMounted:function(e){s(e)}}):null,u?o.createElement(wr,{offscreenDomNode:u.offscreenDomNode,chestDomNode:u.chestDomNode,rolledAreaDomNode:u.rolledAreaDomNode,cursedAreaDomNode:u.cursedAreaDomNode,onDiceOverChestChange:E,onDiceOverRolledAreaChange:v}):null,o.createElement(Wr,{dialogIsOpen:!a,headerSmallCardRef:y}))},ro=function(e){var t=e.diceOverRolledAreaListener,n=e.diceOverChestListener,r=e.onRoundMounted,a=e.onRoundOver,c=o.useRef(null),l=o.useRef(null),i=o.useRef(null),u=o.useRef(null);return o.useEffect((function(){r({rolledAreaDomNode:c.current,chestDomNode:l.current,cursedAreaDomNode:i.current,offscreenDomNode:u.current})}),[]),o.createElement(o.Fragment,null,o.createElement(Tn,null),o.createElement("div",{className:"chest-and-skulls"},o.createElement(rn,{chestRef:l,diceOverChestListener:n}),o.createElement(vr,{cursedAreaRef:i})),o.createElement(_n,{rolledAreaRef:c,offscreenRef:u,diceOverRolledAreaListener:t}),o.createElement(dr,{onRoundOver:a,rolledAreaRef:c}))},oo=function(e){var t=e.closeDialog,n=e.dialogIsOpen,r=e.player,a=kn();return o.createElement(ut,{className:"score-board-dialog dialog-spacing-10 dialog-spacing-fluid",isOpen:n,onRequestClose:t,requestCloseOnClickOutside:!0},o.createElement("div",{className:"dialog-content"},o.createElement("div",{className:"cross",onClick:t},"X"),o.createElement("div",{className:"dialog-body"},o.createElement("div",null,"Au tour de",o.createElement("div",{className:"dialog-label"},r.character.name),o.createElement(le,{className:"player-img",src:r&&r.character.img,alt:"player",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(r&&r.character.color||"black")}})),o.createElement("div",{className:"dialog-actions"},o.createElement("button",{onClick:function(){t(),a(r)}},"Jouer")))))},ao=System.resolve("./assets/win-treasure.png",t.meta.url),co=6e3,lo={path1:"M39.582,739.564c0-91.824,39.191-96.32,38.045-166.691s-30.042-70.37-47.326-161.729s38.128-86.388,31.276-186.42C55.405,134.602-3.014,89.176,8.812,129.825c5.333,18.333,30.77-21,30.77-129.825",path2:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0",path3:"M39.582,739.564c0-71.926-15.437-155.074-17.437-253.074s30-185,31.087-217s-31.087-46-31.087-26s33,10,31-32s-31-110-31-144S39.582,0,39.582,0",path4:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0"},io=function(e){var t=e.openedByUser,n=e.closeScoreboard,r=e.playerAnimation,a=L(),c=sn(),i=ne(),u=o.useState(!1),s=l(u,2),d=s[0],f=s[1],m=function(){f(!0)},v=uo();return o.createElement("div",{className:"score-board-container"},t&&o.createElement("div",{className:"cross",onClick:n},"X"),!i&&!c&&o.createElement("div",{className:"action-container"},o.createElement("button",{className:"score-board-action",onClick:function(){m()}},"Commencer à jouer")),o.createElement(le,{className:"win-treasure-img",src:ao,alt:"win-treasure"}),o.createElement("div",{className:"users-path"},a.map((function(e){return o.createElement(so,{key:e.id,player:e,pathCoordinates:lo["path".concat(e.id)],score:e.score,character:e.character,openStartPlayerRoundDialog:m,isCurrentPlayer:c&&e.id===c.id,playerAnimation:r})}))),o.createElement(oo,{dialogIsOpen:d,closeDialog:function(){f(!1)},player:v}))},uo=function(){var e,t=sn(),n=L();if(t){var r=n.findIndex((function(e){return e.id===t.id}));e=r===n.length-1?n[0]:n[r+1]}else e=n[0];return e},so=function(e){var t=e.pathCoordinates,n=e.player,r=e.character,a=e.score,c=e.openStartPlayerRoundDialog,i=e.playerAnimation,u=o.useRef(null),s=o.useRef(null),d=uo(),f=o.useState(),m=l(f,2),v=m[0],p=m[1];return o.useEffect((function(){i&&i.player===n?p(i.score):p(null)}),[i,n]),o.useEffect((function(){if(!v)return function(){};var e=v.from,t=v.to,n=u.current,r=n.getTotalLength(),o=n.animate([{strokeDashoffset:mo(e/co,r)},{strokeDashoffset:mo(t/co,r)}],{duration:1e3,fill:"forwards"}),a=s.current.animate([{offsetDistance:fo(e/co)},{offsetDistance:fo(t/co)}],{duration:1e3,fill:"forwards"});return o.onfinish=function(){"finished"===a.playState&&p(null)},a.onfinish=function(){"finished"===o.playState&&p(null)},function(){o.cancel(),a.cancel()}}),[v]),o.useEffect((function(){var e=u.current,t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=mo(a/co,t)}),[a]),o.createElement("div",{className:"user-path"},o.createElement("svg",{viewBox:"0 0 79.164 739.564"},o.createElement("path",{d:t,className:"path-background"}),o.createElement("path",{ref:u,d:t,className:"path-foreground"}),o.createElement("circle",{ref:s,r:"13",fill:r.color||"white",className:"score-indicator",style:{offsetPath:"path('".concat(t,"')"),offsetDistance:fo(a/co)}})),o.createElement("div",{className:"speech-bubble"},a),o.createElement("div",{className:"user-avatar ".concat(d.character.id===r.id?"next-player":""),onClick:function(){d.character.id===r.id&&c()}},o.createElement(vo,{character:r})))},fo=function(e){return"".concat(100*e,"%")},mo=function(e,t){return t-e*t},vo=function(e){var t=e.character;return o.createElement(le,{className:"player-img",src:t.img,alt:"player",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(t.color||"black")}})},po=function(){var e=ho();return o.createElement("div",null,o.createElement("p",null,"Combien de joueur?"),[1,2,3,4,5].map((function(t){return o.createElement("button",{key:t,onClick:function(){e(t)}},1===t?"1 joueur":"".concat(t," joueurs"))})))},ho=n((function(e,t){return r(r({},e),{},{players:new Array(t).fill("").map((function(e,t){return{id:t+1,number:t+1,score:0}}))})})),go=[{id:1,name:"Luffy",color:"#ef9620",img:System.resolve("./assets/Luffy.png",t.meta.url)},{id:2,name:"Miss Fortune",color:"#d90f1b",img:System.resolve("./assets/MissFortune.png",t.meta.url)},{id:3,name:"Jack Sparrow",color:"#007033",img:System.resolve("./assets/JackSparrow.png",t.meta.url)},{id:4,name:"Barbe Rouge",color:"#7baac9",img:System.resolve("./assets/BarbeRouge.png",t.meta.url)},{id:5,name:"Ginette Boulette",color:"#e2500c",img:System.resolve("./assets/GinetteBoulette.png",t.meta.url)},{id:6,name:"Capitaine Crochet",color:"#952460",img:System.resolve("./assets/CapitaineCrochet.png",t.meta.url)}],Eo=function(e){var t=e.players,n=Co(),r=bo(),a=t.find((function(e){return!e.character}));return ko(),o.useEffect((function(){ko()}),[]),o.createElement("div",{className:"character-selection-page"},o.createElement(yo,null),a&&o.createElement(o.Fragment,null,o.createElement("p",null,"Joueur ",a.number," : quel pirate êtes vous ?"),o.createElement("div",{className:"characters-container",id:"menu-wrapper"},o.createElement("div",{className:"characters menu"},go.map((function(e){return o.createElement("div",{className:"character item ".concat(No(e,t)?"":"disabled"),key:e.id,onClick:function(t){t.target.animate([{transform:"scale(1)"},{transform:"scale(1.3)"},{transform:"scale(1)"}],{duration:400,fill:"forwards"}),n(a,e)}},o.createElement(le,{className:"character-img",src:e&&e.img,alt:"player",style:{border:"4px solid ".concat(e&&e.color||"black")}}),o.createElement("span",null,e.name))}))),o.createElement("div",{className:"paddles"},o.createElement("button",{className:"left-paddle paddle hidden"},"<"),o.createElement("button",{className:"right-paddle paddle",onClick:function(){ko()}},">")))),!a&&o.createElement("div",{className:"crew-completed"},o.createElement("p",null,"L‘équipage est au complet !"),o.createElement(le,{src:K({type:re})}),o.createElement("button",{onClick:function(){r()}},"Démarrer la partie")))},yo=function(){var e=L();return o.createElement("div",{className:"crew ".concat(e.length>3?"large-crew":"")},o.createElement("p",null,"Votre équipage:"),o.createElement("ul",null,e.map((function(e){return o.createElement("li",{key:e.id},e.character?o.createElement(le,{className:"crew-member-img",src:e.character&&e.character.img,alt:"player",style:{border:"4px solid ".concat(e.character&&e.character.color||"black")}}):o.createElement("div",{className:"placeholder-img"}),o.createElement("span",null,e.character?e.character.name:"Joueur".concat(e.number)))}))))},bo=n((function(e){var t=e.cardIds;return r(r({},e),{},{gameStarted:!0,cardIds:W(t)})})),No=function(e,t){return!t.some((function(t){return t.character&&t.character.name===e.name}))},Co=n((function(e,t,n){var o=e.players;return t.character=n,r(r({},e),{},{players:c(o)})})),ko=function(){var e=document.getElementsByClassName("item").length,t=function(){return document.getElementById("menu-wrapper")?document.getElementById("menu-wrapper").offsetWidth:null},n=t(),r=123*e;window.onresize=function(){n=t()};var o=r-n,a=document.querySelector(".left-paddle"),c=document.querySelector(".right-paddle");document.querySelector(".menu")&&(document.querySelector(".menu").onscroll=function(){o=r-n;var e=document.querySelector(".menu").scrollLeft,t=o;e<=0?(a.classList.add("hidden"),c.classList.remove("hidden")):e<t?(a.classList.remove("hidden"),c.classList.remove("hidden")):e>=t&&(a.classList.remove("hidden"),c.classList.add("hidden"))}),c&&(c.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e+n;we({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}}),a&&(a.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e-n;we({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}})},xo=function(e){var t=e.playerAnimationListener,n=L(),r=M(),a=ne(),c=So(),i=Do(),u=o.useState(!1),s=l(u,2),d=s[0],f=s[1],m=o.useState(null),v=l(m,2),p=v[0],h=v[1],g=o.useState(null),E=l(g,2),y=E[0],b=E[1],N=!a||d;return o.useEffect((function(){if(p&&"score-marked"===p.reason){var e=n.find((function(e){return e.id===r})),t=p.value,o=e.score-t;b({player:e,score:{from:o<0?0:o,to:e.score}})}else b(null)}),[p,r]),o.useEffect((function(){if(t)return t(b)}),[t]),c?o.createElement(po,null):i?o.createElement(Eo,{players:n}):N?o.createElement(io,{openedByUser:d,closeScoreboard:function(){f(!1)},playerAnimation:y}):o.createElement(no,{openScoreboard:function(){f(!0)},onRoundStart:function(){h(null)},onRoundOver:function(e){h(e)}})},So=function(){return 0===L().length},Do=function(){return!oe()},wo=n((function(e){return r(r({},e),{},{animationsDisabled:!0})})),Ro=n((function(e){return r(r({},e),{},{animationsDisabled:!1})})),Io=System.resolve("./assets/settings.css",t.meta.url),Ao=function(){var e=o.useState(!1),t=l(e,2),n=t[0],r=t[1];return o.createElement(o.Fragment,null,o.createElement(me,{href:Io}),o.createElement("div",{id:"settings",onClick:function(){r(!0)}},o.createElement("svg",{className:"settings-icon",viewBox:"0 0 24 24"},o.createElement("path",{d:"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"}))),o.createElement(Oo,{settingsDialogIsOpen:n,closeSettingsDialog:function(){r(!1)}}))},Oo=function(e){var t=e.settingsDialogIsOpen,n=e.closeSettingsDialog,r=Y(),a=wo(),c=Ro();return o.createElement(ut,{className:"dialog-spacing-10 dialog-spacing-fluid dialog-spacing-top-fixed",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0},o.createElement("div",{className:"settings-dialog-content"},o.createElement("label",null,o.createElement("input",{type:"checkbox",checked:r,onChange:function(e){e.target.checked?a():c()}}),"Désactiver les animations")))},Mo=System.resolve("./assets/mille-sabord.css",t.meta.url),Lo=(e("App",(function(e){return o.createElement("div",{id:"main-container"},o.createElement("div",{id:"main",ref:ae()},o.createElement(me,{href:Mo}),o.createElement(Ao,null),o.createElement(Lo,e)))})),function(e){return ce()?o.createElement(xo,e):o.createElement(Ee,e)})}}}));

//# sourceMappingURL=App-daf8f18b.js.map