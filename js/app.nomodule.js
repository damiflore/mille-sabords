System.register([__v__("/mille-sabords/js/vendors.nomodule.js")],(function(e,r){"use strict";var t,o,a,l,n,s,d,i,u,c,m,h,p,g,y,w,b,f,S,C,L,R,U,v,k,_,I,E,O,D,P,A,x,j,K,M,N,B,F,T,W,Y,q,$,G,V,z,J,H,X,Q,Z,ee,re,te,oe,ae,le,ne,se,de,ie,ue,ce,me,he,pe,ge,ye,we,be,fe,Se,Ce,Le,Re,Ue,ve,ke,_e,Ie,Ee,Oe,De,Pe,Ae,xe,je,Ke,Me,Ne,Be,Fe,Te,We,Ye,qe,$e,Ge,Ve,ze,Je,He,Xe,Qe,Ze,er,rr,tr,or,ar,lr,nr,sr,dr,ir,ur,cr,mr,hr,pr,gr,yr,wr,br,fr,Sr;return{setters:[function(e){t=e.__jsenv_default_import__,o=e._objectSpread2,a=e.jsx,l=e.createLogger,n=e.createServiceWorkerFacade,s=e._objectWithoutProperties,d=e.jsxs,i=e.Fragment,u=e.createRoot}],execute:function(){({createContext:c,useContext:m,useReducer:h,useEffect:p}=t),g=function(e,r){let{name:t="global",effect:l=(()=>{})}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n={},s=Object.keys(e);s.forEach((r=>{const o=c(e[r]);n[r]=o,o.Provider.displayName=`${t}.state.${r}.Provider`}));const d=c(null),i=(e,r)=>r(e);let u=()=>e;const g=()=>u(),y=()=>m(d);return{Provider:c=>{let{initialState:m,children:g}=c;const[y,w]=h(i,e,r);u=()=>y,p((()=>{m&&w((e=>o(o({},e),m)))}),[m]),p((()=>{l&&l(y)}),[y]);const b=d.Provider;b.displayName=`${t}.dispatch.Provider`;const f=a(b,{value:w,children:g});return s.reduce(((e,r)=>{const t=n[r].Provider;return a(t,{value:y[r],children:e})}),f)},useKeyedState:e=>m(n[e]),useDispatch:y,createAction:e=>()=>{const r=y();return function(){for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];r((r=>e(r,...o)))}},useState:()=>g(),getState:g}},y=new URL(__v__("/mille-sabords/other/card_small-1skull.png"),r.meta.url),w=new URL(__v__("/mille-sabords/other/card_small-2skulls.png"),r.meta.url),b=new URL(__v__("/mille-sabords/other/card_small-sword-challenge.png"),r.meta.url),f=new URL(__v__("/mille-sabords/other/card_small-animals.png"),r.meta.url),S=new URL(__v__("/mille-sabords/other/card_small-chest.png"),r.meta.url),C=new URL(__v__("/mille-sabords/other/card_small-coin.png"),r.meta.url),L=new URL(__v__("/mille-sabords/other/card_small-diamond.png"),r.meta.url),R=new URL(__v__("/mille-sabords/other/card_small-pirate.png"),r.meta.url),U=new URL(__v__("/mille-sabords/other/card_small-witch.png"),r.meta.url),v=new URL(__v__("/mille-sabords/other/card_1skull.png"),r.meta.url),k=new URL(__v__("/mille-sabords/other/card_2skulls.png"),r.meta.url),_=new URL(__v__("/mille-sabords/other/card_2sword-challenge.png"),r.meta.url),I=new URL(__v__("/mille-sabords/other/card_3sword-challenge.png"),r.meta.url),E=new URL(__v__("/mille-sabords/other/card_4sword-challenge.png"),r.meta.url),O=new URL(__v__("/mille-sabords/other/card_animals.png"),r.meta.url),D=new URL(__v__("/mille-sabords/other/card_chest.png"),r.meta.url),P=new URL(__v__("/mille-sabords/other/card_coin.png"),r.meta.url),e("cardDefaultUrl",A=new URL(__v__("/mille-sabords/other/card_default.png"),r.meta.url)),x=new URL(__v__("/mille-sabords/other/card_diamond.png"),r.meta.url),j=new URL(__v__("/mille-sabords/other/card_pirate.png"),r.meta.url),K=new URL(__v__("/mille-sabords/other/card_witch.png"),r.meta.url),M="animals",N="chest",B="coin",F="diamond",T="pirate",W="witch",Y="1skull",q="2skulls",e("CARD_TWO_SWORDS_CHALLENGE",$="2sword-challenge"),z={[Y]:v,[q]:k,[$]:_,[G="3sword-challenge"]:I,[V="4sword-challenge"]:E,[M]:O,[N]:D,[B]:P,[F]:x,[T]:j,[W]:K},e("cardToImageUrl",(e=>z[e.type])),J={[Y]:y,[q]:w,[$]:b,[G]:b,[V]:b,[M]:f,[N]:S,[B]:C,[F]:L,[T]:R,[W]:U},e("cardToSmallImageUrl",(e=>J[e.type])),H={[M]:{type:M,color1:"#99D380",color2:"#39B100"},[N]:{type:N,color1:"#C69C6D",color2:"#8C6239"},[B]:{type:B,color1:"#FFF5BB",color2:"#CE9109"},[F]:{type:F,color1:"#95C1E5",color2:"#3E57A6"},[T]:{type:T,color1:"#E6A9AB",color2:"#C1272D"},[W]:{type:W,color1:"#757092",color2:"#482399"},[Y]:{type:Y,color1:"#666666",color2:"#000000"},[q]:{type:q,color1:"#666666",color2:"#000000"},[$]:{type:$,color1:"#F4B392",color2:"#CB6828",numberOfSwords:2,gambleAmount:300},[G]:{type:G,color1:"#F4B392",color2:"#CB6828",numberOfSwords:3,gambleAmount:500},[V]:{type:V,color1:"#F4B392",color2:"#CB6828",numberOfSwords:4,gambleAmount:1e3}},X=(e=>{const r=[];return Object.keys(e).forEach((t=>{const a=e[t];for(var l=0;l<a;l++){const e=o({id:r.length+1},H[t]);r.push(e)}})),r})({[T]:4,[W]:4,[N]:4,[M]:4,[F]:4,[B]:3,[Y]:3,[q]:2,[$]:2,[G]:3,[V]:4}),e("mixDeck",(e=>{const r=[...e];for(var t=0;t<100;t++)Q(r);return r})),Q=e=>{const r=Z(e.length),t=Z(e.length),o=e[r];return e[r]=e[t],e[t]=o,e},Z=e=>Math.floor(Math.random()*e),ee=X.map((e=>e.id)),e("cardIdToCard",(e=>X.find((r=>r.id===e)))),e("isPirateCard",(e=>e.type===T)),e("isWitchCard",(e=>e.type===W)),e("isChestCard",(e=>e.type===N)),e("isAnimalsCard",(e=>e.type===M)),e("isDiamondCard",(e=>e.type===F)),e("isCoinCard",(e=>e.type===B)),e("isOneSkullCard",(e=>e.type===Y)),e("isTwoSkullsCard",(e=>e.type===q)),re=e=>e.type===$,te=e=>e.type===G,oe=e=>e.type===V,e("isSwordChallengeCard",(e=>re(e)||te(e)||oe(e))),e("symbolCoinUrl",ae=new URL(__v__("/mille-sabords/other/dice_coin.png"),r.meta.url)),e("symbolDiamondUrl",le=new URL(__v__("/mille-sabords/other/dice_diamond.png"),r.meta.url)),e("symbolMonkeyUrl",ne=new URL(__v__("/mille-sabords/other/dice_monkey.png"),r.meta.url)),se=new URL(__v__("/mille-sabords/other/dice_parrot.png"),r.meta.url),e("symbolSkullUrl",de=new URL(__v__("/mille-sabords/other/dice_skull.png"),r.meta.url)),e("symbolSwordUrl",ie=new URL(__v__("/mille-sabords/other/dice_sword.png"),r.meta.url)),e("SYMBOL_COIN",ue="coin"),e("SYMBOL_DIAMOND",ce="diamond"),e("SYMBOL_MONKEY",me="monkey"),e("SYMBOL_PARROT",he="parrot"),e("SYMBOL_SKULL",pe="skull"),e("SYMBOL_SWORD",ge="sword"),e("symbolIsSkull",(e=>e===pe)),e("symbolIsCoin",(e=>e===ue)),e("symbolIsDiamond",(e=>e===ce)),e("symbolIsMonkey",(e=>e===me)),e("symbolIsParrot",(e=>e===he)),e("SYMBOLS",[ue,ce,me,he,pe,ge]),ye={[ue]:ae,[ce]:le,[me]:ne,[he]:se,[pe]:de,[ge]:ie},e("symbolToImageUrl",(e=>ye[e])),we=[ue,ce,me,he,pe,ge],be=1,fe=e=>o({faces:we,visibleFaceIndex:0,id:be++},e),Se={},new Array(8).fill("").forEach((()=>{const e=fe();Se[e.id]=e})),e("diceIsOnSkull",(e=>Ce(e)===pe)),e("diceToVisibleSymbol",Ce=e=>{let{faces:r,visibleFaceIndex:t}=e;return r[t]}),e("defaultState",Le={animationsDisabled:!1,soundDisabled:!1,gameCreated:!1,gameStarted:!1,players:[],currentPlayerId:null,cardIds:ee,cardUsedIds:[],dices:Se,roundStarted:!1,currentCardId:null,currentCardActivated:!1,rollCount:0,scoreMarked:!1,isOnSkullIsland:!1,witchUncursedDiceId:null,witchCardEffectUsed:!1,diceRolledIds:[],diceCursedIds:[],chestSlots:{1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null}}),Re=l({logLevel:"warn"}),Ue="game",(ve=g(Le,(()=>{if(localStorage.hasOwnProperty(Ue)){const e=JSON.parse(localStorage.getItem(Ue)),r=Object.keys(Le).find((r=>r in e==!1));if(r)return Re.warn(`stored game state is missing a property (${r}) -> use initial game state instead`),Le;const t=Object.keys(e).find((e=>e in Le==!1));return t?(Re.warn(`stored game state contains an unknown property (${t}) -> use initial game state instead`),Le):(Re.info(`read storage ${Ue} = `,e),e)}return Re.debug("no game state stored -> use initial game state"),Le}),{effect:e=>{Re.debug(`store ${Ue} = `,e),localStorage.setItem(Ue,JSON.stringify(e))}})).Provider.displayName="storeProvider",e("createAction",ve.createAction),e("useGameCreated",(()=>ve.useKeyedState("gameCreated"))),e("useGameStarted",(()=>ve.useKeyedState("gameStarted"))),e("usePlayers",(()=>ve.useKeyedState("players"))),e("useCurrentPlayerId",(()=>ve.useKeyedState("currentPlayerId"))),e("useCardIds",(()=>ve.useKeyedState("cardIds"))),e("useDices",(()=>ve.useKeyedState("dices"))),e("useRoundStarted",(()=>ve.useKeyedState("roundStarted"))),e("useCurrentCardId",(()=>ve.useKeyedState("currentCardId"))),e("useCurrentCardActivated",(()=>ve.useKeyedState("currentCardActivated"))),e("useRollCount",(()=>ve.useKeyedState("rollCount"))),e("useScoreMarked",(()=>ve.useKeyedState("scoreMarked"))),e("useIsOnSkullIsland",(()=>ve.useKeyedState("isOnSkullIsland"))),e("useWitchUncursedDiceId",(()=>ve.useKeyedState("witchUncursedDiceId"))),e("useWitchCardEffectUsed",(()=>ve.useKeyedState("witchCardEffectUsed"))),e("useDiceRolledIds",(()=>ve.useKeyedState("diceRolledIds"))),e("useDiceCursedIds",(()=>ve.useKeyedState("diceCursedIds"))),e("useChestSlots",(()=>ve.useKeyedState("chestSlots"))),e("useAnimationsDisabled",(()=>ve.useKeyedState("animationsDisabled"))),e("useSoundDisabled",(()=>ve.useKeyedState("soundDisabled"))),({createContext:ke,useContext:_e,useState:Ie}=t),Ee=ke(),e("useMainDomNode",(()=>_e(Ee)[0])),e("useMainDomNodeSetter",(()=>_e(Ee)[1])),Oe={},Object.keys(Se).forEach((e=>{Oe[e]=ke()})),De=Object.keys(Oe).map((e=>Oe[e].Provider)),Pe=e=>{let{children:r}=e;return De.reduceRight(((e,r)=>a(r,{value:Ie(),children:e})),r)},e("useDiceDomNode",(e=>_e(Oe[e])[0])),e("useDiceDomNodeSetter",(e=>_e(Oe[e])[1])),Ae=e=>{let{children:r}=e;return a(Ee.Provider,{value:Ie(),children:a(Pe,{children:r})})},xe=e=>{let{initialState:r,children:t}=e;return a(ve.Provider,{initialState:r,children:a(Ae,{children:t})})},je=window.requestIdleCallback?e=>{const r=window.requestIdleCallback(e,{timeout:400});return()=>{window.cancelIdleCallback(r)}}:e=>{const r=window.requestAnimationFrame(e);return()=>{window.cancelAnimationFrame(r)}},Ke=window.requestIdleCallback?function(){let{timeout:e=60}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((r=>{window.requestIdleCallback(r,{timeout:e})}))}:()=>new Promise((e=>{window.requestAnimationFrame(e)})),Me=e=>{class r extends t.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}render(){return this.state.hasError?a(e,o(o({},this.props),{},{error:this.state.error})):a(e,o({},this.props))}}return r},e("addDomEventListener",Ne=(e,r,t,o)=>(e.addEventListener(r,t,o),()=>{e.removeEventListener(r,t,o)})),Be=e=>e.window===e,Fe=e=>9===e.nodeType,e("isFocusable",(e=>{if(1!==e.nodeType)return!1;const r=e.nodeName.toLowerCase();return"input"===r?"hidden"!==e.type&&Te(e):["button","select","datalist","iframe","textarea"].indexOf(r)>-1||e.hasAttribute("tabindex")||e.hasAttribute("tabIndex")||e.hasAttribute("draggable")?Te(e):["a","area"].indexOf(r)>-1?!1!==e.hasAttribute("href")&&Te(e):["audio","video"].indexOf(r)>-1&&(!1!==e.hasAttribute("controls")&&Te(e))})),Te=e=>{if(We(e))return!0;if("hidden"===qe(e,"visibility"))return!1;let r=e;for(;r&&!We(r);){if("none"===qe(r,"display"))return!1;r=r.parentNode}return!0},e("isDocumentElement",We=e=>e===e.ownerDocument.documentElement),Ye=e=>$e(e).getComputedStyle(e),e("getStyleValue",qe=(e,r)=>Ye(e).getPropertyValue(r)),$e=e=>Be(e)?e:Fe(e)?e.defaultView:Ge(e).defaultView,Ge=e=>Be(e)?e.document:Fe(e)?e:e.ownerDocument,e("getDocumentScroll",(e=>{const r=$e(e),t=Ge(e);return{x:r.pageXOffset||t.documentElement.scrollLeft,y:r.pageYOffset||t.documentElement.scrollTop}})),Ve=t.createContext(),ze=(e,r)=>r(e),Je={},He=e=>{let{children:r}=e;return a(Ve.Provider,{value:t.useReducer(ze,Je),children:r})},Xe=()=>{const e=Ze();return Object.keys(e).length},Qe=()=>{const e=Ze();return Object.keys(e).filter((r=>"loaded"===e[r].status)).length},e("useUrlLoadingNotifier",(e=>{e=String(e);const r=t.useContext(Ve),a=r?r[1]:void 0;t.useEffect((()=>a?l:null),[]);const l=()=>{a((r=>{if(!r.hasOwnProperty(e))return r;if("loading"!==r[e].status)return r;const t={};return Object.keys(r).forEach((o=>{o!==e&&(t[o]=r[o])})),t}))};return r?[()=>{a((r=>e in r?r:o(o({},r),{},{[e]:{status:"loading"}})))},()=>{a((r=>e in r&&"loaded"===r[e].status?r:o(o({},r),{},{[e]:{status:"loaded"}})))},l]:[()=>{},()=>{},()=>{}]})),Ze=()=>{const e=t.useContext(Ve);return e?e[0]:null},e("addLoadedListener",((e,r)=>{const t=Ne(e,"load",(()=>{o(),r()})),o=Ne(e,"error",(()=>{t(),r()}));return()=>{t(),o()}})),er=()=>{const[e,r]=t.useState(!1);return t.useEffect((()=>je((()=>{r(!0)}))),[]),e},e("swFacade",rr=n()),e("loadImage",tr=(e,r)=>{const t=new Image;return r&&(t.crossOrigin=r),new Promise(((r,o)=>{const a=e=>{or(t),o(e)};t.onload=e=>{or(t),r(e.target||e.srcElement)},t.onerror=a,t.onabort=a,t.src=e}))}),or=e=>{e.onload=null,e.onerror=null,e.onabort=null;try{delete e.src}catch(e){}},ar=async function(e){let{chunkSize:r=7,msDelayBetweenChunks:t=2e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=0;const a={},l={},n=async e=>{await Promise.all(e.map((async e=>{try{const r=await tr(e);a[e]=r}catch(r){l[e]=!0}}))),await new Promise((e=>{setTimeout(e,t)}));const r=s();r.length>0&&await n(r)},s=()=>{const t=[];let a=0;for(;a<r&&o<e.length;)t.push(e[o]),a++,o++;return t};return await n(s()),{loaded:a,failed:l}},lr=new URL(__v__("/mille-sabords/other/wood.jpg"),r.meta.url),nr=new URL(__v__("/mille-sabords/other/pirate-hook.png"),r.meta.url),sr=new URL(__v__("/mille-sabords/other/pirate-hook-02.png"),r.meta.url),dr=new URL(__v__("/mille-sabords/other/wood-box.jpg"),r.meta.url),ir=new URL(__v__("/mille-sabords/other/treasure-map.png"),r.meta.url),ur=new URL(__v__("/mille-sabords/other/witch-label.png"),r.meta.url),cr=new URL(__v__("/mille-sabords/other/skull-bottle.png"),r.meta.url),mr=()=>{const e=er();return t.useEffect((()=>{e&&rr&&rr.setRegistrationPromise(window.navigator.serviceWorker.register(new URL("/mille-sabords/service_worker.js",r.meta.url)))}),[e]),e?a(hr,{}):null},hr=()=>{const e=[lr,nr,sr,dr,ir,ur,cr,A,...Object.keys(z).map((e=>z[e]))];return t.useEffect((()=>{const r=setTimeout((()=>ar(e)),2e3);return()=>{clearTimeout(r)}}),[]),null},pr=["error","onError"],gr=["rootNode","onLoadProgress","onReady"],yr=e=>{let{error:r,onError:t}=e,l=s(e,pr);return r?a(wr,{error:r,onError:t}):a(He,{children:a(br,o({},l))})},wr=e=>{let{error:r,onError:o}=e;return t.useEffect((()=>{o(r)}),[]),d("div",{style:{maxWidth:"100vw"},children:[a("div",{style:{margin:"10px 15px"},children:"An error occured"}),a("pre",{style:{overflow:"auto",margin:"10px 15px"},children:"object"==typeof r?r.stack:r})]})},br=e=>{let{rootNode:l,onLoadProgress:n,onReady:u}=e,c=s(e,gr);const m=er(),[h,p]=t.useState(!1),[g,y]=t.useState(null),[w,b]=t.useState(!1),[f,S]=t.useState(!1),[,C]=t.useState(),L=Xe(),R=Qe();return t.useEffect((()=>{w&&n({loadedCount:R,total:L})}),[w,R,L]),t.useEffect((()=>{performance.measure("loading screen displayed"),l.querySelector("#main-container").setAttribute("data-loading","")}),[]),t.useEffect((()=>{f&&l.querySelector("#main-container").removeAttribute("data-loading")}),[f]),t.useEffect((()=>{m&&R===L&&p(!0)}),[m,R,L]),t.useEffect((()=>{h&&(async()=>{try{const e=await r.import(__v__("/mille-sabords/js/root.nomodule.js"));y(e),await Ke(),b(!0)}catch(e){C((()=>{throw e}))}})()}),[h]),t.useEffect((()=>{w&&R===L&&S(!0)}),[w,R,L]),t.useEffect((()=>{f&&u()}),[f]),d(i,{children:[a("div",{id:"main-container",children:g?a(g.App,o({},c)):null}),f?a(mr,{}):null]})},fr=Me(yr),e("createMilleSabordGame",Sr=e=>{let{into:r,onLoadProgress:t}=e;return new Promise(((e,o)=>{u(r).render(a(xe,{children:a(fr,{rootNode:r,onLoadProgress:t,onError:o,onReady:e})}))}))}),e("app",Object.freeze(Object.defineProperty({__proto__:null,createMilleSabordGame:Sr},Symbol.toStringTag,{value:"Module"})))}}}));