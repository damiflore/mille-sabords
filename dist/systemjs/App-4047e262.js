System.register(["./main.js","./main.component.js"],(function(e,t){"use strict";var n,r,a,o,c,i,l,u,s,d,f,m,v,p,h,g,E,y,b,C,N,k,x,w,S,D,R,I,A,O,M,L,P,q,j,B,T,F,U,z,G,W,Z,X,Y,J,_,H,K,V,Q,$,ee,te,ne,re,ae,oe,ce,ie,le,ue,se,de,fe,me,ve,pe,he,ge,Ee,ye,be,Ce,Ne,ke,xe,we;return{setters:[function(e){n=e.d,r=e.f,a=e._,o=e.r,c=e.g,i=e.b,l=e.c,u=e.h,s=e.u,d=e.i,f=e.j,m=e.S,v=e.k,p=e.l,h=e.m,g=e.n,E=e.o,y=e.p,b=e.q,C=e.t,N=e.v,k=e.w,x=e.x,w=e.y,S=e.z,D=e.A,R=e.B,I=e.C,A=e.D,O=e.E,M=e.F,L=e.G,P=e.H,q=e.I,j=e.J,B=e.K,T=e.L,F=e.M,U=e.N,z=e.O,G=e.P,W=e.Q,Z=e.R,X=e.T,Y=e.U,J=e.V,_=e.W,H=e.X,K=e.a,V=e.Y,Q=e.Z,$=e.$,ee=e.a0,te=e.s,ne=e.a1,re=e.a2,ae=e.a3,oe=e.a4,ce=e.a5,ie=e.a6,le=e.a7,ue=e.a8,se=e.a9,de=e.aa,fe=e.ab,me=e.ac,ve=e.ad},function(e){pe=e.I,he=e.i,ge=e.g,Ee=e.a,ye=e._,be=e.b,Ce=e.S,Ne=e.c,ke=e.d,xe=e.w,we=e.e}],execute:function(){var Se=function(e,t,n){return e.addEventListener(t,n),function(){e.removeEventListener(t,n)}},De=function(){return window.navigator.standalone||window.matchMedia("(display-mode: standalone)").matches},Re=function(e){var t=window.matchMedia("(display-mode: standalone)");return t.addListener(e),function(){t.removeListener(e)}};var Ie,Ae=function(e){var t,n=!1,r=function(r){var a=r.beforeinstallpromptEventAvailableOnWindow,o=r.displayModeIsStandalone,c=Le({beforeinstallpromptEventAvailableOnWindow:a,displayModeIsStandalone:o,appInstalledEvent:n});c!==t&&(t=c,e(c))};r({beforeinstallpromptEventAvailableOnWindow:Me(),displayModeIsStandalone:De()});var a=Pe((function(e){window.beforeinstallpromptEvent=e,r({beforeinstallpromptEventAvailableOnWindow:!0,displayModeIsStandalone:De()})})),o=Re((function(){r({beforeinstallpromptEventAvailableOnWindow:Me(),displayModeIsStandalone:De()})})),c=function(e){return window.addEventListener("appinstalled",e),function(){window.removeEventListener("appinstalled",e)}}((function(){n=!0,r({beforeinstallpromptEventAvailableOnWindow:Me(),displayModeIsStandalone:De()})}));return function(){a(),o(),c()}},Oe=(Ie=function(){return window.beforeinstallpromptEvent?(window.beforeinstallpromptEvent.prompt(),e=window.beforeinstallpromptEvent.userChoice,t=function(e){return"accepted"===e.outcome},n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)):(console.warn("cannot promptAddToHomescreen: window.beforeinstallpromptEvent is missing"),!1);var e,t,n},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(Ie.apply(this,e))}catch(e){return Promise.reject(e)}}),Me=function(){return Boolean(window.beforeinstallpromptEvent)},Le=function(e){var t=e.beforeinstallpromptEventAvailableOnWindow,n=e.displayModeIsStandalone,r=e.appInstalledEvent;return!!t&&(!n&&!r)},Pe=function(e){return Se(window,"beforeinstallprompt",e)};function qe(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var je=window.navigator.serviceWorker;function Be(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function Te(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}function Fe(e,t){var n=e();return n&&n.then?n.then(t):t(n)}var Ue,ze=Boolean(je),Ge=null,We=null,Ze=(Ue=[],{listen:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.once,a=void 0!==r&&r;if(a){var o=e;e=function(){i(),o.apply(void 0,arguments)}}Ue=[].concat(n(Ue),[e]);var c=!1,i=function(){if(!c){c=!0;for(var t=[],n=Ue.length,r=!0;n--;){var a=Ue[n];r&&a===e?r=!1:t.push(a)}Ue=t}};return i},emit:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Ue.forEach((function(e){e.apply(void 0,t)}))}}),Xe=function(e){We&&We===e?console.log("we already know this worker is updating"):(e?console.log("found a worker updating (worker state is: ".concat(e.state,")")):console.log("worker update is done"),We=e,Ze.emit())},Ye=function(){return We?{shouldBecomeNavigatorController:Boolean(je.controller),navigatorWillReload:Ve}:null},Je=Be((function(){return Ge?qe(Ge,(function(e){return qe(e.update(),(function(e){var t=e.installing;if(t)return console.log("installing worker found after calling update()"),Xe(t),!0;var n=e.waiting;return n?(console.log("waiting worker found after calling update()"),Xe(n),!0):(console.log("no worker found after calling update()"),!1)}))})):(console.warn("registerServiceWorker must be called before checkServiceWorkerUpdate can be used"),!1)})),_e=function(e){if(We)return function(e,t){var n=new MessageChannel,r=n.port1,a=n.port2;return new Promise((function(n,o){r.onmessage=function(e){"rejected"===e.data.status?o(e.data.value):n(e.data.value)},e.postMessage(t,[a])}))}(We,e);console.warn("no service worker updating to send message to")},He=Be((function(e){if(!We)throw new Error("no service worker update to activate");return Ke(We,e)})),Ke=Be((function(e){var t=!1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.onActivating,a=void 0===r?function(){}:r,o=n.onActivated,c=void 0===o?function(){}:o,i=n.onBecomesNavigatorController,l=void 0===i?function(){}:i,u=e.state,s=function(){return new Promise((function(t){var n=Se(e,"statechange",(function(){"activating"===e.state&&a(),"activated"===e.state&&(c(),n(),t())}))}))};return Fe((function(){if("installed"===u||"activating"===u)return"installed"===u&&_e({action:"skipWaiting"}),Te(s,(function(){if(je.controller)var e=Se(je,"controllerchange",(function(){e(),l(),Xe(null),$e()}));else Xe(null),$e();t=!0}))}),(function(e){if(t)return e;l(),Xe(null),$e()}))})),Ve=!0,Qe=!1,$e=function(){Qe||(Qe=!0,window.location.reload())};if(ze)Se(je,"controllerchange",$e);var et=function(){return o.createElement(tt,null)},tt=function(){var e=nt();return o.createElement("div",{className:"new-game"},o.createElement(pe,{src:c}),o.createElement("button",{onClick:e},"Nouvelle partie"))},nt=r((function(e){return a(a({},e),{},{gameCreated:!0})})),rt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.layout,a=void 0!==r&&r,c=o.useRef(!0);(a?o.useLayoutEffect:o.useEffect)((function(){if(!c.current)return e();c.current=!1}),t)},at=function(e,t){var n=ot(e,t);return Boolean(n)},ot=function(e,t){var r=o.useRef(!1);o.useEffect((function(){!1===r.current&&(r.current=!0)}));var a=o.useRef(t);return o.useEffect((function(){a.current=t}),t),r.current&&e.apply(void 0,n(a.current))?{from:a.current,to:t}:null},ct=function(e){var t=o.useRef(e);return o.useEffect((function(){t.current=e}),[e]),t.current},it=function(){var e=o.useState((function(){return function(){var e=[];return{listen:function(t){var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).once;if(void 0!==r&&r){var a=t;t=function(){c(),a.apply(void 0,arguments)}}e=[].concat(n(e),[t]);var o=!1,c=function(){if(!o){o=!0;for(var n=[],r=e.length,a=!0;r--;){var c=e[r];a&&c===t?a=!1:n.push(c)}e=n}};return c},emit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.forEach((function(e){e.apply(void 0,n)}))}}}()})),t=i(e,1)[0];return[t.listen,t.emit]},lt=function(e){var t=o.useState(),n=i(t,2),r=n[0],a=n[1];return o.useEffect((function(){return e(a)}),[]),r},ut=function(e){var t=e.duration,n=void 0===t?300:t,r=e.timingFunction,a=void 0===r?function(e){return e}:r,o=e.onProgress,c=void 0===o?function(){}:o,i=e.onCancel,l=void 0===i?function(){}:i,u=e.onComplete,s=void 0===u?function(){}:u;if(isNaN(n))return console.warn("duration must be a number, received ".concat(n)),function(){};n=parseInt(n,10);var d,f=performance.now(),m=!1,v=0,p=0;!function e(){d=null;var t=performance.now();v=Math.min((t-f)/n,1),p=a(v),c({done:m=1===v,rawProgress:v,progress:p}),m?s():d=window.requestAnimationFrame(e)}();return function(){d&&(window.cancelAnimationFrame(d),d=null),m||(m=!0,l({rawProgress:v,progress:p}))}},st=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.duration,r=void 0===n?300:n,a=t.timingFunction,c=t.condition,l=o.useState(null),u=i(l,2),s=u[0],d=u[1];return dt(e,(function(e,t){return d({value:e}),ut({duration:r,timingFunction:a,onProgress:function(n){var r=n.progress,a=Math.round(e+(t-e)*r);d({value:a})},onComplete:function(){d(null)}})}),{condition:c}),s},dt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.condition,a=void 0===r?function(){return!0}:r,c=o.useState(null),l=i(c,2),u=l[0],s=l[1],d=ct(e);o.useEffect((function(){d!==e&&a(e,d)&&s({from:d,to:e})}),[d,e]),o.useEffect((function(){return u?t(u.from,u.to):function(){}}),[u])},ft=function(e){var t=e.value,n=e.duration,r=e.condition,a=st(t,{duration:n,condition:r});return a?a.value:t},mt=function(e,t){for(var n=pt(e,e),r=n.next(),a=r.done,o=r.value;!1===a;){if(t(o))return o;var c=n.next();a=c.done,o=c.value}return null},vt=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r){var a=t.firstChild;if(a)return a}var o=t.nextSibling;if(o)return o;var c=t.parentNode;return c&&c!==n?e(c,n,!0):null},pt=function(e,t){var n=e;return{next:function(){var e=vt(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},ht=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,a=!1,o=function(){var e=vt(r,t,n&&!1===a);return a=!0,r=e,{done:!1===Boolean(e),value:e}};return{next:o}},gt=function(e){for(var t=e.lastChild;t;){var n=t.lastChild;if(!n)break;t=n}return t},Et=function(e,t){var n=e;return{next:function(){var e=function(e,t){var n=e.previousSibling;if(n){return gt(n)||n}if(e!==t){var r=e.parentNode;if(r&&r!==t)return r}return null}(n,t);return n=e,{done:!1===Boolean(e),value:e}}}},yt=function(e){var t=mt(e,he);return t||(he(e)?e:null)},bt=function(e){if(3===e.nodeType)return console.warn("cannot trap focus inside a text node"),function(){};if(kt.find((function(t){return t.element===e})))return console.warn("focus already trapped inside this element"),function(){};var t=function(){return mt(e,Ct)},n=function(){return function(e,t){var n=gt(e);if(n)for(var r=Et(n,e),a=r.next(),o=a.done,c=a.value;!1===o;){if(t(c))return c;var i=r.next();o=i.done,c=i.value}return null}(e,Ct)},r=function(){return function(e){for(var t=e.from,n=e.root,r=void 0===n?null:n,a=e.predicate,o=Et(t,r),c=o.next(),i=c.done,l=c.value;!1===i;){if(a(l))return l;var u=o.next();i=u.done,l=u.value}return null}({from:document.activeElement,root:e,predicate:Ct})||n()},a=function(){return function(e){for(var t=e.from,n=e.root,r=void 0===n?null:n,a=e.predicate,o=e.skipChildren,c=ht(t,r,void 0!==o&&o),i=c.next(),l=i.done,u=i.value;!1===l;){if(a(u))return u;var s=c.next();l=s.done,u=s.value}return null}({from:document.activeElement,root:e,predicate:Ct})||t()},o=xt({element:e,lock:function(){var o=function(t){(function(t){return t.target!==e&&!e.contains(t.target)})(t)&&(t.preventDefault(),t.stopImmediatePropagation())},c=function(e){Nt(e)&&(e.preventDefault(),function(e){var o=document.activeElement===document.body;if(e.shiftKey){var c=o?n():r();c&&c.focus()}else{var i=o?t():a();i&&i.focus()}}(e))};return document.addEventListener("mousedown",o,{capture:!0,passive:!1}),document.addEventListener("keydown",c,{capture:!0,passive:!1}),function(){document.removeEventListener("mousedown",o,{capture:!0,passive:!1}),document.removeEventListener("keydown",c,{capture:!0,passive:!1})}}});return function(){o()}},Ct=function(e){return!function(e){return e.hasAttribute&&e.hasAttribute("tabIndex")&&Number(e.getAttribute("tabindex"))<0}(e)&&he(e)},Nt=function(e){return"Tab"===e.key||9===e.keyCode},kt=[],xt=function(e){var t,n=e.lock;kt.length>0&&(t=kt[kt.length-1]).unlock();var r={lock:n,unlock:n()};return kt.push(r),function(){if(0!==kt.length){var e=kt[kt.length-1];r===e?(kt.pop(),r.unlock(),t&&(t.unlock=t.lock())):console.warn("you must deactivate trap in the same order they were activated")}else console.warn("cannot deactivate an already deactivated trap")}},wt=function(e){var t=[];return function e(n){var r=St(n);if(r){if(t.push(r),r===document)return;e(r)}}(e),t},St=function(e){if("object"!==l(e)||1!==e.nodeType)throw new TypeError("getScrollableParent first argument must be DOM node");var t=e;return t===document.documentElement?null:"fixed"===ge(t,"position")?Dt(t.ownerDocument):Bt(t)||Dt(t.ownerDocument)},Dt=function(e){if("scrollingElement"in e)return e.scrollingElement;if(Mt(e))return e.documentElement;var t=e.body,n=t&&!/body/i.test(t.tagName)?Rt(t):t;return n&&At(n)?null:n},Rt=function(e){for(var t=e;t=t.nextSibling;)if(1===t.nodeType&&It(t))return t;return null},It=function(e){return e.ownerDocument.body===e},At=function(e){if(!Pt(e))return!1;if(Ot(e))return!1;var t=e.ownerDocument.documentElement;return!!Pt(t)&&!Ot(t)},Ot=function(e){var t=ge(e,"display");return"none"!==t&&("table-row"!==t&&"table-group"!==t&&"table-column"!==t||"collapsed"!==ge(e,"visibility"))},Mt=function(e){return!!/^CSS1/.test(e.compatMode)&&Lt(e)},Lt=function(e){var t=e.createElement("iframe");t.style.height="1px",(e.body||e.documentElement||e).appendChild(t);var n=t.contentWindow.document;n.write('<!DOCTYPE html><div style="height:9999em">x</div>'),n.close();var r=n.documentElement.scrollHeight>n.body.scrollHeight;return t.parentNode.removeChild(t),r},Pt=function(e){return!qt(e)||!jt(e)},qt=function(e){return"visible"===ge(e,"overflow-x")||"visible"===ge(e,"overflow")},jt=function(e){return"visible"===ge(e,"overflow-y")||"visible"===ge(e,"overflow")},Bt=function(e){if(e===document.documentElement)return null;for(var t=ge(e,"position"),n=e.parentNode;n;){if(Ee(n))return null;if("absolute"!==t||"static"!==ge(n,"position")){if(Pt(n))return n;n=n.parentNode}else n=n.parentNode}return null},Tt=System.resolve("./assets/dialog.base.css",t.meta.url),Ft=o.useEffect,Ut=function(e){var t=e.container,r=void 0===t?document.body:t,c=e.insertTop,l=e.insertLeft,s=e.insertRight,d=e.insertBottom,f=e.children,m=e.isOpen,v=e.requestCloseOnEscape,p=void 0===v||v,h=e.requestCloseOnClickOutside,g=void 0!==h&&h,E=e.closeMethod,y=void 0===E?"display-none":E,b=e.stealFocus,C=void 0===b||b,N=e.restoreStolenFocus,k=void 0===N||N,x=e.trapFocus,w=void 0===x||x,S=e.onAfterOpen,D=void 0===S?function(){}:S,R=e.onRequestClose,I=void 0===R?function(){}:R,A=e.onFocusIn,O=void 0===A?function(){}:A,M=e.onFocusOut,L=void 0===M?function(){}:M,P=e.backdropProps,q=void 0===P?{}:P,j=ye(e,["container","insertTop","insertLeft","insertRight","insertBottom","children","isOpen","requestCloseOnEscape","requestCloseOnClickOutside","closeMethod","stealFocus","restoreStolenFocus","trapFocus","onAfterOpen","onRequestClose","onFocusIn","onFocusOut","backdropProps"]);if(!r)return null;var B=o.useState(null),T=i(B,2),F=T[0],U=T[1],z=Boolean(F);return at((function(e){return!e&&m}),[m])&&D(),Ft((function(){if(!m||!z)return function(){};var e=Gt(F),t=function(t){t.relatedTarget||e&&(e=!1,L(t))},n=function(t){O(t),e=!0},r=function(t){Gt(F)?e=!0:(e=!1,L(t))};return F.addEventListener("focus",n,!0),document.addEventListener("focus",r,!0),document.addEventListener("blur",t,!0),function(){F.removeEventListener("focus",n,!0),document.removeEventListener("focus",r,!0),document.removeEventListener("blur",t,!0)}}),[m,z,O,L]),Ft((function(){return m&&z?function(e){for(var t=[],r=e.previousSibling;r;)1===r.nodeType&&Pt(r)&&t.push(r),r=r.previousSibling;var a=wt(e);t.push.apply(t,n(a));var o=t.map((function(e){var t=e.style.overflow;return e.style.overflow="hidden",function(){t?e.style.overflow=t:e.style.removeProperty("overflow")}}));return function(){o.forEach((function(e){e()}))}}(F):function(){}}),[m,z]),Ft((function(){return m&&z&&w?bt(F):function(){}}),[m,z,w]),Ft((function(){if(!m||!z||!C)return function(){};var e=document.activeElement,t=yt(F);return t&&t.focus({preventScroll:!0}),function(){t&&("function"==typeof k?k(e):!0===k&&e.focus({preventScroll:!0}))}}),[m,z,C]),Ft((function(){if(!m||!F||!F.parentNode)return function(){};var e=[];return Array.from(F.parentNode.children).forEach((function(t){t!==F&&e.push(t)})),e.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){e.forEach((function(e){e.removeAttribute("aria-hidden","true")}))}}),[m,F]),"dom-remove"!==y||m?u.createPortal(o.createElement("div",be({},j,{role:"dialog",className:"dialog--root".concat(j.className?" ".concat(j.className):""),ref:function(e){U(e),j.ref&&j.ref(e)},onKeyDown:function(e){p&&e.keyCode===Wt&&I(e),j.onKeyDown&&j.onKeyDown(e)},tabIndex:"-1",style:a(a({},"display-none"!==y||m?{}:{display:"none"}),"visibility-hidden"!==y||m?{}:{visibility:"hidden"}),hidden:"hidden-attribute"===y&&!m||void 0}),o.createElement(Ce,{href:Tt}),m?o.createElement(zt,be({},q,{className:"dialog--backdrop",onMouseDownActive:function(e){if(e.preventDefault(),!Gt(F)){var t=yt(F);t&&t.focus({preventScroll:!0})}},onClick:function(e){g&&I(e),q.onClick&&q.onClick(e)}})):null,o.createElement("div",{className:"dialog--document"},o.createElement("div",{className:"dialog--insert-top"},c),o.createElement("div",{className:"dialog--main"},o.createElement("div",{className:"dialog--insert-left"},l),o.createElement("div",{className:"dialog--scrollable-content"},f),o.createElement("div",{className:"dialog--insert-right"},s)),o.createElement("div",{className:"dialog--insert-bottom"},d))),r):null},zt=function(e){var t=e.onMouseDownActive,n=ye(e,["onMouseDownActive"]),r=o.useState(null),a=i(r,2),c=a[0],l=a[1];return Ft((function(){return c?(c.addEventListener("mousedown",t,{passive:!1}),function(){c.removeEventListener("mousedown",t,{passive:!1})}):function(){}}),[c]),o.createElement("div",be({ref:function(e){l(e),n.ref&&n.ref(e)}},n))},Gt=function(e){var t=document.activeElement;return e===t||e.contains(t)},Wt=27,Zt=System.resolve("./assets/dialog.css",t.meta.url),Xt=function(e){return o.createElement(o.Fragment,null,o.createElement(Ce,{href:Zt}),o.createElement(Ut,be({container:s()},e)))},Yt=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=o.useState(e),n=i(t,2),r=n[0],a=n[1],c=function(){a(!0)},l=function(){a(!1)};return[r,c,l]},Jt=function(e){var t=e.card,n=e.symbolsInChest,r=e.scoreMarked,a=e.markScoreAllowed;return d(t)?r||a?_t(n,{goal:t.numberOfSwords,gamble:t.gambleAmount}):-t.gambleAmount:f(t)?Kt(n.map((function(e){return e===m?v:e}))):p(t)?2*Kt(n):h(t)||g(t)?Kt(n,9):Kt(n)},_t=function(e,t){var n=t.goal,r=t.gamble;return Ht(e,b)>=n?Kt(e)+r:-r},Ht=function(e,t){return e.filter((function(e){return e===t})).length},Kt=function(e,t){var n=Vt(e,t);return n.score+n.perfectBonus},Vt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=0,r=0,a=Qt(e);return Object.values(a).forEach((function(e){3===e&&(n+=100),4===e&&(n+=200),5===e&&(n+=500),6===e&&(n+=1e3),7===e&&(n+=2e3),8===e&&(n+=4e3),e>2&&(r+=e)})),e.forEach((function(e){e===E&&(n+=100,a[E]<3&&(r+=1)),e===y&&(n+=100,a[y]<3&&(r+=1))})),{score:n,perfectBonus:r===t?500:0}},Qt=function(e){var t={};return e.forEach((function(e){t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},$t=function(){return o.createElement("div",{className:"star-rain-container"},o.createElement("div",{className:"star",id:"star-01"},o.createElement(en,null)),o.createElement("div",{className:"star",id:"star-02"},o.createElement(en,null)),o.createElement("div",{className:"star",id:"star-03"},o.createElement(en,null)),o.createElement("div",{className:"star",id:"star-04"},o.createElement(en,null)),o.createElement("div",{className:"star",id:"star-05"},o.createElement(en,null)),o.createElement("div",{className:"star",id:"star-06"},o.createElement(en,null)))},en=function(){return o.createElement("svg",{viewBox:"0 0 217.791 210.633"},o.createElement("path",{fill:"#FFFFE6",d:"M94.15,77.97c0,0-2-54,10-73.5s23,28.5,25.5,72.5c0,0,69.197,4.589,86.5,21c13.637,12.934-61.5,31-87,33.5 c-2,14.5-1.831,60.464-16.5,75.5c-20,20.5-25.5-50.5-23-78c-19-1.5-81.5-3.5-89-17.5S52.15,85.97,94.15,77.97z"}))},tn=function(){return o.createElement("svg",{viewBox:"0 0 320 512",width:"32",heiht:"32"},o.createElement("path",{fill:"currentColor",d:"M207.6 256l107.72-107.72c6.23-6.23 6.23-16.34 0-22.58l-25.03-25.03c-6.23-6.23-16.34-6.23-22.58 0L160 208.4 52.28 100.68c-6.23-6.23-16.34-6.23-22.58 0L4.68 125.7c-6.23 6.23-6.23 16.34 0 22.58L112.4 256 4.68 363.72c-6.23 6.23-6.23 16.34 0 22.58l25.03 25.03c6.23 6.23 16.34 6.23 22.58 0L160 303.6l107.72 107.72c6.23 6.23 16.34 6.23 22.58 0l25.03-25.03c6.23-6.23 6.23-16.34 0-22.58L207.6 256z"}))},nn=function(e){var t=e.title,n=e.spacingClasses,r=e.children,a=ye(e,["title","spacingClasses","children"]);return o.createElement(Xt,be({requestCloseOnClickOutside:!0,insertTop:o.createElement(o.Fragment,null,o.createElement("div",{className:"dialog-border-top"}),o.createElement("div",{className:"dialog-title"},o.createElement("div",{className:"dialog-title-text"},t)),o.createElement("div",{className:"dialog-close",onClick:a.onRequestClose},o.createElement(tn,null))),insertBottom:o.createElement("div",{className:"dialog-border-bottom"}),insertLeft:o.createElement("div",{className:"dialog-border-left"}),insertRight:o.createElement("div",{className:"dialog-border-right"})},a,{className:"dialog-theme-wood ".concat(n||"dialog-spacing-10 dialog-spacing-fluid dialog-spacing-top-fixed"," ").concat(a.className)}),r)},rn=function(e){var t=e.dialogIsOpen,n=e.closeDialog;return o.createElement(nn,{className:"score-rules-dialog",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0,title:"Score",spacingClasses:"dialog-spacing-10 dialog-spacing-fixed"},o.createElement(o.Fragment,null,o.createElement("div",{className:"dialog-box"},o.createElement("div",{className:"dialog-label"},"Combinaisons de dés"),o.createElement("div",{className:"columns"},o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Symbols identiques"),o.createElement("span",{className:"symbol-number"},"Combo 3"),o.createElement("span",{className:"symbol-number"},"Combo 4"),o.createElement("span",{className:"symbol-number"},"Combo 5"),o.createElement("span",{className:"symbol-number"},"Combo 6"),o.createElement("span",{className:"symbol-number"},"Combo 7"),o.createElement("span",{className:"symbol-number"},"Combo 8")),o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Points"),o.createElement("span",{className:"points"},"100"),o.createElement("span",{className:"points"},"200"),o.createElement("span",{className:"points"},"500"),o.createElement("span",{className:"points"},"1000"),o.createElement("span",{className:"points"},"2000"),o.createElement("span",{className:"points"},"4000")))),o.createElement("div",{className:"dialog-box"},o.createElement("div",{className:"dialog-label"},"Dés spéciaux"),o.createElement("div",{className:"columns"},o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Symbol"),o.createElement(pe,{src:C}),o.createElement(pe,{src:N})),o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Points"),o.createElement("span",{className:"points"},"100"),o.createElement("span",{className:"points"},"100")))),o.createElement("div",{className:"dialog-box last"},o.createElement("div",{className:"dialog-label"},"Bonus coffre parfait"),o.createElement("div",{className:"columns"},o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Dés utilisés"),o.createElement("span",{className:"symbol-number"},"8")),o.createElement("div",{className:"column"},o.createElement("div",{className:"column-title"},"Points"),o.createElement("span",{className:"points"},"500"))))))},an=function(e,t,n){var r=cn(n),a=Math.cos(r),o=Math.sin(r),c=t.x-e.x,i=t.y-e.y;return{x:Math.round(a*c+o*i+e.x),y:Math.round(a*i-o*c+e.y)}},on=function(e){var t=i(e,4),n=t[0],r=t[1],a=t[2],o=t[3];return{x:(n.x+r.x+a.x+o.x)/4,y:(n.y+r.y+a.y+o.y)/4}},cn=function(e){return e*Math.PI/180},ln=function(e,t){return!!un(t,(function(t){return n=t,r=i(e,2),a=r[0],o=r[1],c=i(n,2),l=c[0],u=c[1],s=(u.x-l.x)*(a.y-l.y)-(u.y-l.y)*(a.x-l.x),d=(o.x-a.x)*(a.y-l.y)-(o.y-a.y)*(a.x-l.x),f=(u.y-l.y)*(o.x-a.x)-(u.x-l.x)*(o.y-a.y),(0!==s||0!==d||0!==f)&&0!==f&&(d/=f,(s/=f)>=0&&s<=1&&d>=0&&d<=1);var n,r,a,o,c,l,u,s,d,f}))},un=function(e,t){var n=i(e,4),r=n[0],a=n[1],o=n[2],c=n[3];return!!t([r,a])||(!!t([a,o])||(!!t([o,c])||!!t([c,r])))},sn=function(e,t){var n=e.left,r=e.right,a=r-n;n<t.left?r=(n=t.left)+a:r>t.right&&(r=(n=t.right-a)+a);var o=e.top,c=e.bottom,i=c-o;return o<t.top?c=(o=t.top)+i:c>t.bottom&&(c=(o=t.bottom-i)+i),{left:n,right:r,top:o,bottom:c}},dn=function(e){var t=e.left,n=e.right,r=e.top;return{x:t+(n-t)/2,y:r+(e.bottom-r)/2}},fn=function(e,t){var n,r,a,o,c=dn(e),i=dn(t);return r=i,a=(n=c).x-r.x,o=n.y-r.y,Math.sqrt(a*a+o*o)},mn=function(e){var t=e.getBoundingClientRect(),n=Ne(e),r=t.left+n.x,a=t.top+n.y,o=r+t.width,c=a+t.height;return{left:Math.floor(r),top:Math.floor(a),right:Math.floor(o),bottom:Math.floor(c)}},vn=function(e,t){var n,r,a=mn(e);return r=t,!((n=a).right<=r.left||n.left>=r.right||n.bottom<=r.top||n.top>=r.bottom)},pn=function(e,t){var n=e.map((function(e){return mn(e)})),r=function(e,t){var n=fn(t,e[0]);return e.reduce((function(e,r){var a=fn(t,r);return a<n?(n=a,r):e}))}(n,t);return e[n.indexOf(r)]},hn=function(e){var t=e.x,n=e.y,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.color,o=void 0===a?"yellow":a,c=r.autoRemove,i=void 0===c||c,l=r.autoRemoveAfter,u=void 0===l?2e3:l,s=document.createElement("div");s.style.position="absolute",s.style.zIndex="1000",s.style.left="".concat(t,"px"),s.style.top="".concat(n,"px"),s.style.width="5px",s.style.height="5px",s.style.background=o,s.style.border="1px solid red",document.body.appendChild(s);var d,f=function(){document.body.removeChild(s)};return i&&(d=setTimeout(f,u)),function(){f(),clearTimeout(d)}},gn=function(e){var t=e.totalScoreDomNodeRef,n=e.scoreParticle,r=e.animationDelayGetter,a=void 0===r?function(){return 0}:r;return"bonus"===n.type?o.createElement(En,{totalScoreDomNodeRef:t,scoreParticle:n,animationDelayGetter:a}):"combo"===n.type?o.createElement(yn,{scoreParticle:n,animationDelayGetter:a}):o.createElement(bn,{scoreParticle:n,animationDelayGetter:a})},En=function(e){var t=e.totalScoreDomNodeRef,n=e.scoreParticle,r=e.animationDuration,a=void 0===r?800:r,c=e.animationDelayGetter,i=k(n.symbol),l=o.useRef();return o.useEffect((function(){var e=l.current,r=t.current,o=xn(document.querySelector('[data-chest-slot="'.concat(n.chestSlot,'"]')));return Cn({particleDomNode:e,totalScoreDomNode:r,x:o.x,y:o.y,duration:a,delay:c(),onfinish:n.onfinish,oncancel:n.oncancel})}),[]),o.createElement("svg",{ref:l,width:"32",height:"32",className:"score-particle--symbol"},o.createElement("image",{href:i,width:"32",height:"32"}),",")},yn=function(e){var t=e.scoreParticle,n=e.animationDuration,r=void 0===n?800:n,a=e.animationDelayGetter,c=kn(),l=i(c,2),u=l[0],s=l[1];return o.useEffect((function(){var e=u.current,n=xn(document.querySelector(".chest .box"));return Nn({particleDomNode:e,x:n.x,y:n.y,duration:r,delay:a(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),o.createElement("svg",{ref:u,className:"score-particle--perfect"},o.createElement("g",{ref:s},o.createElement("text",{x:"0",y:"0",dominantBaseline:"text-before-edge"},"Combo ",t.symbolCount)))},bn=function(e){var t=e.scoreParticle,n=e.animationDuration,r=void 0===n?800:n,a=e.animationDelayGetter,c=kn(),l=i(c,2),u=l[0],s=l[1];return o.useEffect((function(){var e=u.current,n=xn(document.querySelector(".chest .box"));return Nn({particleDomNode:e,x:n.x,y:n.y,duration:r,delay:a(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),o.createElement("svg",{ref:u,className:"score-particle--combo"},o.createElement("g",{ref:s},o.createElement("text",{x:"0",y:"0",dominantBaseline:"text-before-edge"},"Coffre parfait")))},Cn=function(e){var t=e.particleDomNode,n=e.totalScoreDomNode,r=e.x,a=e.y,o=e.duration,c=e.delay,i=e.onfinish,l=void 0===i?function(){}:i,u=e.oncancel,s=void 0===u?function(){}:u,d=mn(t),f=mn(n),m=d.right-d.left,v=d.bottom-d.top,p=r-m/2,h=a-v/2,g=p,E=h-1.1*v,y=f.left,b=f.top;t.style.left="".concat(p,"px"),t.style.top="".concat(h,"px");var C=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.6,opacity:1,transform:"translate(".concat(g-p,"px, ").concat(E-h,"px)")},{transform:"translate(".concat(y-p,"px, ").concat(b-h,"px)")}],{duration:o,delay:c,fill:"forwards"});return C.onfinish=function(){l()},function(){s(),C.cancel()}},Nn=function(e){var t=e.particleDomNode,n=e.x,r=e.y,a=e.duration,o=e.delay,c=e.onfinish,i=void 0===c?function(){}:c,l=e.oncancel,u=void 0===l?function(){}:l,s=mn(t),d=n-(s.right-s.left)/2,f=r-(s.bottom-s.top)/2;t.style.left="".concat(d,"px"),t.style.top="".concat(f,"px");var m=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.4,opacity:1,transform:"scale(1.2)"},{}],{duration:a,delay:o,fill:"forwards"});return m.onfinish=function(){i()},function(){u(),m.cancel()}},kn=function(){var e=o.useRef(),t=o.useRef();return o.useLayoutEffect((function(){var n=e.current,r=t.current.getBBox();n.setAttribute("width",Math.ceil(r.width)),n.setAttribute("height",Math.ceil(r.height))}),[]),[e,t]},xn=function(e){var t=mn(e);return dn(t)},wn=function(e){var t=e.addScoreParticle,n=x(),r=w(),a=ur();Object.keys(n).forEach((function(e){var o=n[e],c=Yn(o,r),i=c&&O(c);rt((function(){if(!a&&i)return t({id:"chest-slot-".concat(e,"-coin"),type:"bonus",value:100,symbol:y,chestSlot:e})}),[a,i])}))},Sn=function(e){var t=e.addScoreParticle,n=x(),r=w(),a=ur();Object.keys(n).forEach((function(e){var o=n[e],c=Yn(o,r),i=c&&M(c);rt((function(){if(!a&&i)return t({id:"chest-slot-".concat(e,"-diamond"),type:"bonus",value:100,symbol:E,chestSlot:e})}),[a,i])}))},Dn=function(e){var t=e.addScoreParticle,n=x(),r=w(),a=ur(),c=o.useMemo((function(){var e=[];Object.keys(n).forEach((function(t){var a=n[t];a&&("dice"===a.type&&e.push(Yn(a,r)))}));var t=Vt(e).perfectBonus;return Boolean(t)}),[n,r]);rt((function(){if(!a&&c)return t({id:"perfect",type:"perfect",value:500})}),[a,c])},Rn=function(e){var t=e.addScoreParticle,n=x(),r=w(),a=S(),c=D(a),i=ur();R.forEach((function(e){var a=[];Object.keys(n).forEach((function(t){var o=n[t],i=Yn(o,r);i&&In(i,e,c)&&a.push(t)}));var l=a.length,u=An[l]||0,s=o.useRef(u),d=o.useRef((function(){}));rt((function(){var n=s.current,r=Boolean(n&&u&&n<u),o=Boolean(n&&u&&n>u);if(s.current=u,(!f(c)||!A(e))&&!i&&u){if(!o){r&&d.current();var m="".concat(l,"-").concat(e,"-combo"),v=t({id:m,type:"combo",value:u-n,symbol:e,symbolCount:l});d.current=v;var p=a.map((function(e){var t=(document.querySelector('[data-chest-slot="'.concat(e,'"] image'))||document.querySelector('[data-chest-slot="'.concat(e,'"] img'))).animate([{transform:"scale(1)",transformOrigin:"center center"},{transform:"scale(1.2)",transformOrigin:"center center"},{transform:"scale(1)",transformOrigin:"center center"}],{duration:400});return function(){t.cancel()}}));return function(){v(),p.forEach((function(e){e()}))}}d.current()}}),[i,c,u])}))},In=function(e,t,n){if(e===t)return!0;if(f(n)){if(I(e)&&A(t))return!0;if(A(e)&&I(t))return!0}return!1},An={3:100,4:200,5:500,6:1e3,7:2e3,8:4e3},On=o.useState,Mn=o.useEffect,Ln=function(){var e=D(S()),t=Pn();return o.createElement("div",{className:"score-area ".concat(t?"animated":"")},e?o.createElement(qn,null):null)},Pn=function(){var e=D(S()),t=$n(),n=Ht(t,b),r=sr();return!!d(e)&&!(n>=r)},qn=function(){var e=D(S()),t=L(),n=Pn(),r=Yt(),a=i(r,3),c=a[0],l=a[1],u=a[2],s=P();return o.createElement(o.Fragment,null,p(e)?o.createElement(zn,null):null,t?o.createElement($t,null):null,o.createElement("button",{className:"round-score ".concat(n?"hidden":""),onClick:l},s?o.createElement(Tn,null):o.createElement(jn,null)),d(e)?o.createElement(Gn,null):null,o.createElement(rn,{dialogIsOpen:c,closeDialog:u}))},jn=function(){var e=lr(),t=o.useRef(),r=it(),c=i(r,2),l=c[0],u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalScore,r=void 0===t?0:t,c=e.onScoreParticleAdded,l=void 0===c?function(){}:c,u=e.onScoreParticleRemoved,s=void 0===u?function(){}:u,d=e.onScoreParticleMerged,f=void 0===d?function(){}:d,m=o.useState(r),v=i(m,2),p=v[0],h=v[1],g=o.useState([]),E=i(g,2),y=E[0],b=E[1];o.useEffect((function(){h(r)}),[r]);var C=function(e){b((function(t){return[].concat(n(t),[e])})),l(e);var t=!1;return function(){t||(t=!0,b((function(t){return t.filter((function(t){return t!==e}))})),h((function(t){return t-e.value})),s(e))}},N=function(e){var t=e.id,n=e.value,r=ye(e,["id","value"]),o=a(a({id:t,value:n},r),{},{oncancel:function(){c()},onfinish:function(){c(),f(o),h((function(e){return e+n}))}}),c=C(o);return c},k=y.reduce((function(e,t){return e+t.value}),0);return[y,N,p-k]}({totalScore:e,onScoreParticleMerged:c[1]}),s=i(u,3),d=s[0],f=s[1],m=s[2];!function(e){var t=e.addScoreParticle;wn({addScoreParticle:t}),Sn({addScoreParticle:t}),Rn({addScoreParticle:t}),Dn({addScoreParticle:t})}({addScoreParticle:f}),Fn({roundScoreDomNodeRef:t,scoreParticleMergedListener:l});var v=o.useRef(null),p=function(){var e=v.current,t=Bn(e,600);return v.current=Date.now()+t,t};return o.createElement(o.Fragment,null,o.createElement("span",{ref:t,className:"round-score--value"},o.createElement(ft,{value:m,condition:function(e,t){return e>t},duration:600})),d.map((function(e){return o.createElement(gn,{key:e.id,totalScoreDomNodeRef:t,scoreParticle:e,animationDelayGetter:p})})))},Bn=function(e,t){if(!e)return 0;var n=t-(Date.now()-e);return n<=0?0:n},Tn=function(){var e=lr();return o.createElement("span",{className:"round-score--value"},e)},Fn=function(e){var t=e.roundScoreDomNodeRef,n=e.scoreParticleMergedListener,r=lt(n);o.useEffect((function(){if(r){var e=t.current;return Un({roundScoreDomNode:e})}}),[r])},Un=function(e){var t=e.roundScoreDomNode,n=e.duration,r=void 0===n?500:n,a=e.easing,o=void 0===a?"ease-in-out":a,c=t.animate([{transform:"scale(1.8)"}],{duration:r,easing:o});return function(){c.cancel()}},zn=function(){return q()?o.createElement("div",{className:"pirate-hook"}):o.createElement("div",{style:{display:"none"},className:"pirate-hook"})},Gn=function(){var e=lr(),t=$n(),n=Ht(t,b),r=sr(),a=new Array(r).fill(""),c=n>=r,l=at((function(e){return e<n}),[n]),u=On(!1),s=i(u,2),d=s[0],f=s[1];return Mn((function(){l&&f(!0)}),[l]),Mn((function(){if(d){var e=setTimeout((function(){f(!1)}),300);return function(){clearTimeout(e)}}return function(){}}),[d]),o.createElement(o.Fragment,null,o.createElement("div",{className:"ropes ".concat(c?"challenge-won":"")},a.map((function(e,t){return n>=t+1?o.createElement("div",{key:t,className:"rope rope-".concat(t+1," cut-rope")}):o.createElement("div",{key:t,className:"rope rope-".concat(t+1)})}))),d&&n<=r?o.createElement("div",{className:"sword-slice"},o.createElement("div",{className:"triangle-left"}),o.createElement("div",{className:"triangle-right"})):null,o.createElement("div",{className:"negative-round-score rotate-".concat(n," ").concat(c?"removed":"")},e))},Wn=50,Zn=System.resolve("./assets/cursed-grid.png",t.meta.url),Xn=function(e){var t=e.chestRef,n=e.diceOverChestListener,r=x(),c=ar(),i=lt(n),l=D(S()),u=c&&j(l);return o.createElement("div",{className:"chest"},o.createElement("div",{ref:t,className:"dice-area ".concat(j(l)?"glow":""),style:a({},i?{outline:"2px dotted"}:{})},o.createElement("div",{className:"box"},Object.keys(r).map((function(e){return o.createElement("div",{className:"slot",key:e,"data-chest-slot":e},o.createElement(Jn,{chestSlotContent:r[e]}))}))),o.createElement("div",{className:"top-left-corner"}),o.createElement("div",{className:"top-right-corner"}),o.createElement("div",{className:"bottom-left-corner"}),o.createElement("div",{className:"bottom-right-corner"}),c&&!u?o.createElement(_n,null):null),o.createElement(Ln,null))},Yn=function(e,t){if(e&&"symbol"===e.type)return e.value;if(e&&"dice"===e.type){var n=t[e.value];return B(n)}return null},Jn=function(e){var t=e.chestSlotContent,n=D(S());if(!t)return null;if("symbol"===t.type){var r=t.value;return o.createElement("button",{className:"dice",style:{width:Wn,height:Wn,color:"#eaeaea",margin:"5px",backgroundColor:n.color1,borderColor:n.color2,borderWidth:"2px",borderStyle:"solid"}},o.createElement(pe,{src:k(r),draggable:"false",style:{width:"100%",height:"100%"}}))}return null},_n=function(){return o.createElement("div",{className:"cursed-cover"},o.createElement(pe,{draggable:"false",src:Zn,alt:"cursed-cover"}))},Hn=o.useMemo,Kn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentPlayerId,n=void 0===t?T():t,r=e.players,a=void 0===r?F():r;return a.find((function(e){return e.id===n}))},Vn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?Y():t;return 0===n},Qn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollCount,n=void 0===t?Y():t;return n>0},$n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,r=void 0===t?w():t,a=e.chestSlots,o=void 0===a?x():a;return Object.keys(o).reduce((function(e,t){var a=Yn(o[t],r);return a?[].concat(n(e),[a]):e}),[])},er=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?or():t;return 3-n},tr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dicesToCurse,n=void 0===t?nr():t;return n.length>0},nr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dices,n=void 0===t?w():t,r=e.diceRolledIds,a=void 0===r?J():r,o=e.witchUncursedDiceId,c=void 0===o?_():o,i=e.remainingSpotInCursedArea,l=void 0===i?er():i,u=a.map((function(e){return n[e]})).filter((function(e){return!!H(e)&&e.id!==c})).slice(0,l);return u},rr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?S():t,r=e.hasNeverRolled,a=void 0===r?Vn():r,o=e.scoreMarked,c=void 0===o?L():o,i=e.threeSkullsOrMoreInCursedArea,l=void 0===i?ar():i,u=e.hasDicesToCurse,s=void 0===u?tr():u;return!!n&&(!c&&(!!a||(l?!!j(D(n)):!s)))},ar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skullCountInCursedArea,n=void 0===t?or():t;return n>2},or=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.diceCursedIds,n=void 0===t?z():t,r=e.symbolsFromCard,a=void 0===r?cr():r;return n.length+a.filter((function(e){return U(e)})).length},cr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?S():t;if(!n)return[];var r=D(n);return h(r)?[y]:g(r)?[E]:G(r)?[W]:Z(r)?[W,W]:[]},ir=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scoreMarked,n=void 0===t?L():t,r=e.currentCardId,a=void 0===r?S():r,o=e.threeSkullsOrMoreInCursedArea,c=void 0===o?ar():o,i=e.hasDicesToCurse,l=void 0===i?tr():i;return!n&&(c?!!j(D(a)):!l&&!!a)},lr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?S():t,r=e.symbolsInChest,a=void 0===r?$n():r,o=e.scoreMarked,c=void 0===o?L():o,i=e.markScoreAllowed,l=void 0===i?ir():i;return Hn((function(){return Jt({card:D(n),symbolsInChest:a,scoreMarked:c,markScoreAllowed:l})}),[n,a,c,l])},ur=function(){var e=S(),t=D(e),n=$n(),r=Ht(n,b),a=sr();return!!d(t)&&r<a},sr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currentCardId,n=void 0===t?S():t,r=D(n);return d(r)?r.numberOfSwords:null},dr=r((function(e,t){return a(a({},e),{},{currentPlayerId:t.id,currentCardId:null,currentCardActivated:!1,roundStarted:!0},hr)})),fr=r((function(e){return a(a({},e),{},{currentCardId:null,currentCardActivated:!1,roundStarted:!1})})),mr=r((function(e){return a(a({},e),{},{currentCardActivated:!0})})),vr=r((function(e){return a(a({},e),{},{isOnSkullIsland:!0})})),pr=r((function(e,t){var r=e.players,o=e.currentPlayerId,c=r.find((function(e){return e.id===o})),i=c.score+t;return c.score=i<0?0:i,a(a({},e),{},{players:n(r),scoreMarked:!0})})),hr=(r((function(e){return a(a({},e),hr)})),{witchUncursedDiceId:null,witchCardEffectUsed:!1,rollCount:0,diceRolledIds:[],diceCursedIds:[],chestSlots:{1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null},scoreMarked:!1,isOnSkullIsland:!1}),gr=r((function(e,t,n,r){var o=n.x,c=n.y,i=e.dices;return t.rolledAreaPosition={x:o,y:c},t.rolledAreaZIndex=r,a(a({},e),{},{dices:a({},i)})})),Er=r((function(e,t,n){var r=e.chestSlots,o=Object.keys(r).find((function(e){var n=r[e];return n&&"dice"===n.type&&n.value===t.id}));return a(a({},e),{},{chestSlots:a(a(a({},r),o?K({},o,null):{}),{},K({},n,{type:"dice",value:t.id}))})})),yr=r((function(e,t){var r=e.diceRolledIds,o=e.diceCursedIds;return a(a({},e),{},{diceRolledIds:r.filter((function(e){return e!==t.id})),diceCursedIds:[].concat(n(o),[t.id])})})),br=r((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.diceRolledIds,c=e.diceCursedIds;return a(a(a({},e),r?{}:{witchUncursedDiceId:t.id,witchCardEffectUsed:!0}),{},{diceRolledIds:[].concat(n(o),[t.id]),diceCursedIds:c.filter((function(e){return e!==t.id}))})})),Cr=r((function(e,t){var r=e.diceRolledIds,o=e.chestSlots,c=Object.keys(o).find((function(e){var n=o[e];return n&&"dice"===n.type&&n.value===t.id}));return a(a({},e),{},{diceRolledIds:[].concat(n(r),[t.id]),chestSlots:a(a({},o),{},K({},c,null))})})),Nr=r((function(e,t,n){var r=e.diceRolledIds,o=e.chestSlots;return a(a({},e),{},{diceRolledIds:r.filter((function(e){return e!==t.id})),chestSlots:a(a({},o),{},K({},n,{type:"dice",value:t.id}))})})),kr=o.useEffect,xr=function(){return wr(),null},wr=function(){Sr(),Dr(),Rr()},Sr=function(){var e=P(),t=nr(),n=yr();kr((function(){if(0===t.length)return function(){};if(e)return t.forEach((function(e){n(e)})),function(){};var r=setTimeout((function(){t.forEach((function(e){n(e)}))}),1e3);return function(){clearTimeout(r)}}),[t])},Dr=function(){var e=D(S()),t=L(),n=pr(),r=ar(),a=at((function(e){return!e&&r}),[r]),o=lr(),c=d(e);kr((function(){c&&!t&&a&&n(o)}),[c,t,a,o])},Rr=function(){var e=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rollCount;return 1===(void 0===e?Y():e)}(),t=D(S()),n=V(),r=or(),a=vr();kr((function(){e&&(n||d(t)||r<4||a())}),[e,n,t,r])},Ir=r((function(e){var t=e.cardIds,r=e.cardUsedIds,o=t[0];return a(a({},e),{},{cardIds:t.slice(1),cardUsedIds:[].concat(n(r),[o]),currentCardId:o})})),Ar=r((function(e){var t=e.chestSlots;return a(a({},e),{},{chestSlots:a(a({},t),{},{1:{type:"symbol",value:y}})})})),Or=r((function(e){var t=e.chestSlots;return a(a({},e),{},{chestSlots:a(a({},t),{},{1:{type:"symbol",value:E}})})})),Mr=r((function(e){var t=e.cardIds,r=e.cardUsedIds;return a(a({},e),{},{cardIds:Q([].concat(n(t),n(r))),cardUsedIds:[]})})),Lr=(r((function(e){var t=e.currentCardId,r=e.cardIds,o=e.cardUsedIds;return a(a({},e),{},{currentCardId:null,cardIds:[t].concat(n(r)),cardUsedIds:o.slice(1)})})),function(){return Pr(),qr(),null}),Pr=function(){var e=Ar(),t=S(),n=q(),r=at((function(e){return!e===n}),[n]),a=t&&h(D(t));o.useEffect((function(){a&&e()}),[]),o.useEffect((function(){r&&a&&e()}),[r,a])},qr=function(){var e=Or(),t=S(),n=q(),r=at((function(e){return!e===n}),[n]),a=t&&g(D(t));o.useEffect((function(){a&&e()}),[]),o.useEffect((function(){r&&a&&e()}),[r,a])},jr=function(e){var t=e.rolledAreaRef,n=e.offscreenRef,r=e.diceOverRolledAreaListener,c=lt(r);return o.createElement("div",{className:"dice-ongoing"},o.createElement("div",{className:"map"}),o.createElement("div",{className:"area",ref:t,style:a({},c?{outline:"2px dotted"}:{})}),o.createElement("div",{className:"offscreen-area",ref:n}))},Br={animals:{name:"Animaux",rule:"Les singes et les perroquest obtenus sur les dés comptent comme un même symbol dans une combinaison.",more:"Par exemple 2 perroquets et 3 singes forment une conbinaison de 5 dés identiques, soit 500 points."},chest:{name:"Coffre au trésor",rule:'Lorsque le joueur sauvegarde ses dés, grâce à la carte "Coffre au trésor" les dés sont protégés du mauvais sort.',more:"Ainsi même lorsque le joueur obtient 3 têtes de morts, son tour prends fin, mais il peut marquer les points totalisés grâce aux dés sauvegardés!"},coin:{name:"Pièce d'or",rule:"Le joueur commence son tour avec un symbol pièce d'or. Il rapporte des points aussi bien dans une combinaison de dés que comme simple pièce (+100)."},diamond:{name:"Diamant",rule:"Le joueur commence son tour avec un symbol diamant. Il rapporte des points aussi bien dans une combinaison de dés que comme simple diamant (+100)."},pirate:{name:"Capitaine des pirates",rule:"Grâce à l'aide du capitaine, tous les points comptabilisés pendant ce tour sont doublés !"},witch:{name:"Sorcière",rule:"Avec ses potions magiques, la sorcière permet exceptionnellement au joueur de relancer, une fois, un dé avec une tête de mort."},"1skull":{name:"Tête de mort",rule:"Le tour du joueur débute avec un symbole tête de mort."},"2skulls":{name:"2 têtes de mort",rule:"Le tour du joueur débute avec 2 symboles tête de mort."},"2sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 2 symbols sabres. Si il y parvient, il gagne +300 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -300 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"3sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 3 symbols sabres. Si il y parvient, il gagne +500 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -500 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"4sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 4 symbols sabres. Si il y parvient, il gagne +1000 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -1000 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."}},Tr=function(e){var t=e.dialogIsOpen,n=e.closeDialog,r=e.card,a=Br[r.type];return o.createElement(nn,{className:"card-rules-dialog",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0,title:"Carte"},a?o.createElement(o.Fragment,null,o.createElement("div",{className:"dialog-label"},a.name),o.createElement("div",{style:{textAlign:"center"}},o.createElement(pe,{className:"current-card",src:$(r),width:"150",alt:r.type})),o.createElement("div",{className:"text-rule"},a.rule),a.more?o.createElement("div",{className:"text-rule"},a.more):null):"No rule")},Fr=o.forwardRef((function(e,t){var n=e.card,r=ye(e,["card"]);return o.createElement("div",be({className:"card current-card",ref:t,width:"55",height:"55",style:{backgroundColor:n.color1,borderColor:n.color2}},r),o.createElement(pe,{src:ee(n),alt:n.type,width:"55",height:"55"}))})),Ur=System.resolve("./assets/swords-disabled.png",t.meta.url),zr=function(){var e=S(),t=$n(),n=sr();if(!e)return null;var r=D(e);if(!d(r))return null;var a=Ht(t,b),c=new Array(n).fill("");return o.createElement("div",{className:"sword-challenge-indicators"},c.map((function(e,t){return a>=t+1?o.createElement(Gr,{key:t}):o.createElement(Wr,{key:t})})))},Gr=function(){return o.createElement("div",{className:"sword-icon"},o.createElement(pe,{src:c}))},Wr=function(){return o.createElement("div",{className:"sword-icon disabled"},o.createElement(pe,{src:Ur}))},Zr=function(e){var t=e.openScoreboard,n=e.headerSmallCardRef,r=D(S()),a=q();return o.createElement("div",{className:"header"},o.createElement("div",{className:"card-container",style:{opacity:a?"1":"0"}},o.createElement("div",{className:"small-card"},r?o.createElement(Xr,{headerSmallCardRef:n,currentCard:r}):o.createElement(Yr,null)),a&&o.createElement(zr,null)),o.createElement(Jr,{openScoreboard:t}),o.createElement(_r,null))},Xr=function(e){var t=e.headerSmallCardRef,n=e.currentCard,r=o.useState(!1),a=i(r,2),c=a[0],l=a[1];return o.createElement(o.Fragment,null,o.createElement(Fr,{onClick:function(){l(!0)},card:n,ref:t}),o.createElement(Tr,{card:n,dialogIsOpen:c,closeDialog:function(){l(!1)}}))},Yr=function(){return o.createElement("div",{className:"card default-card",style:{backgroundImage:"url(".concat(ke,")"),backgroundSize:"217px"}})},Jr=function(e){var t=e.openScoreboard,n=Kn();return o.createElement(pe,{onClick:t,className:"avatar",src:n&&n.character.img,alt:"player",style:{borderColor:n&&n.character.color||"white"},width:"55",height:"55"})},_r=function(){var e=Kn(),t=e.score,n=st(t,{duration:1200,timingFunction:function(e){return 1-Math.pow(1-e,5)}});return o.createElement("div",{className:"total-score"},o.createElement("span",{className:"score",style:{backgroundColor:e&&e.character.color||"white"}},n?n.value:t))},Hr=6.25,Kr=function(e,t){var n=t.rolledAreaDomNode,r=mn(n),a=r.right-r.left,o=r.bottom-r.top,c={left:Hr,right:a-56.25,top:Hr,bottom:o-56.25},i=[],l=function(e){var t=0;return function n(){var r=Vr(e,c),a=Qr(),o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:on(e);return e.map((function(e){return an(n,e,t)}))}(r,a);return!i.some((function(e){return t=e,un(o,(function(e){return ln(e,t)}));var t}))||t>50?{rectangle:r,rotation:a,rotatedRectangle:o}:(t++,n())}()};return e.forEach((function(e,t){e.visibleFaceIndex=$r(e);var n=l(e),r=n.rectangle,a=n.rotation,o=n.rotatedRectangle;i.push(o),e.rolledAreaZIndex=t+1,e.rolledAreaPosition=r[0],e.rotation=a})),e},Vr=function(e,t){var n={x:ea(t.left,t.right),y:ea(t.top,t.bottom)};return[{x:n.x,y:n.y},{x:n.x+Wn,y:n.y},{x:n.x+Wn,y:n.y+Wn},{x:n.x,y:n.y+Wn}]},Qr=function(){return ea(-35,35)},$r=function(e){return ea(0,e.faces.length-1)},ea=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},ta=function(e){var t=e.rolledAreaRef,n=rr(),r=J(),a=Vn(),c=na(),i=D(S()),l=ar(),u=r.length<2&&!a,s=l&&j(i),d=u||s;return n?o.createElement("div",{className:"roll-action"},o.createElement("button",{onClick:function(){c(t.current)},disabled:d},"Lancer",u&&!s&&o.createElement("span",{className:"button-subtitle"},"(au moins 2 dés !)")),s&&o.createElement(pe,{src:te,className:"skull-symbol"})):null},na=r((function(e,t){var n=e.dices,r=e.rollCount,o=e.diceRolledIds,c=(0===r?Object.keys(n):o).map((function(e){return n[e]}));return Kr(c,{rolledAreaDomNode:t}),a(a({},e),{},{rollCount:r+1,witchUncursedDiceId:null,diceRolledIds:c.map((function(e){return e.id})),dices:a({},n)})})),ra=function(e){var t=e.onRoundOver,n=e.rolledAreaRef;return o.createElement("div",{className:"footer actions"},o.createElement(ta,{rolledAreaRef:n}),o.createElement(aa,null),o.createElement(oa,{onRoundOver:t}))},aa=function(){var e=lr(),t=pr(),n=ir(),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hasRolledOnce,n=void 0===t?Qn():t,r=e.scoreMarked,a=void 0===r?L():r,o=e.currentCardId,c=void 0===o?S():o,i=e.hasDicesToCurse,l=void 0===i?tr():i;return!(a||l||!c||!n)}(),a=e<0?"-":"+";return r?o.createElement("div",{className:"collect-action"},o.createElement("button",{onClick:function(){t(e)},disabled:!n},o.createElement("span",null,"Collecter"),o.createElement("span",{className:"score"},a," ",Math.abs(e))),!n&&o.createElement(pe,{src:te,className:"skull-symbol"})):null},oa=function(e){var t=e.onRoundOver,n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rollDiceAllowed,n=void 0===t?rr():t,r=e.markScoreAllowed,a=void 0===r?ir():r,o=e.hasDicesToCurse,c=void 0===o?tr():o;return!n&&!a&&!c}(),r=fr(),a=lr(),c=ar(),i=ur(),l=$n();return n?o.createElement("div",{className:"next-round-action"},o.createElement("button",{onClick:function(){r(),t({reason:c?"3-skulls":i?"chalenge-failed":"user-collect",value:a,symbolsInChest:l})}},"Terminer mon tour")):null},ca=function(e){var t=e.cursedAreaRef,n=D(S());return o.createElement("div",{className:"skull-island"},ne(n)?o.createElement(la,null):null,o.createElement("div",{className:"bottle"},o.createElement("div",{className:"area",ref:t},G(n)?o.createElement(ia,{card:n}):null,Z(n)?o.createElement(o.Fragment,null,o.createElement(ia,{card:n}),o.createElement(ia,{card:n})):null)))},ia=function(e){var t=e.card;return o.createElement("button",{className:"dice",style:{width:Wn,height:Wn,color:"#eaeaea",margin:"1px 5px",backgroundColor:t.color1,borderColor:t.color2,borderWidth:"2px"}},o.createElement(pe,{src:te,style:{width:"100%",height:"100%"}}))},la=function(){return q()?o.createElement("div",{className:"witch-label"},o.createElement(pe,{src:xe}),o.createElement("svg",{x:"0px",y:"0px",width:"156.083px",height:"208.667px",viewBox:"0 0 156.083 208.667"},o.createElement("path",{id:"path_01",fill:"none",stroke:"#E4AD30",d:"M8.406,107.82 c2.541,2.178,2.375,2.875,14.25,3.5c14.782,0.778,19.26-11.965,19.26-11.965S47.918,88,40.251,72.917s-18.916,4.583-9.083,8.167 s27.759-1.338,35.142-12.417C74.75,56,77.583,45.333,79.25,37S78.477,15.833,66.31,3.833"}),o.createElement("path",{id:"path_02",fill:"none",stroke:"#E4AD30",d:"M44.031,110.094 c0,0,1,1.313-4.438,3.344s-14.244,7.281-32.125-2"}),o.createElement("path",{id:"path_03",fill:"none",stroke:"#E4AD30",d:"M42.125,103.688 c0,0,1.313,6.594-9.313,8.625S10.281,108.719,9.406,101"}),o.createElement("path",{id:"path_04",fill:"none",stroke:"#E4AD30",d:"M33.114,112.253c0,0,39.886-19.253,43.011,24.747 c0.372,0.447-0.959,1.208-2.542,1.625"}))):o.createElement(pe,{style:{display:"none"},src:xe})},ua=function(e){var t=e.parent,n=e.children;return t?u.createPortal(o.createElement(o.Fragment,null,n),t):null},sa=function(e){var t=e.rotate,r=e.scale,a=e.translate;return[].concat(n(t?["rotate(".concat(t,"deg)")]:[]),n(r&&1!==r?["scale(".concat(r,")")]:[]),n(a?["translate(".concat(a,")")]:[])).join("")},da=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.trailing,c=void 0!==o&&o,i=function a(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];clearTimeout(t);var u=Date.now();if(n){var s=u-n;if(s<r){if(c){var d=r-s;t=setTimeout((function(){return a.apply(void 0,i)}),d)}}else n=u,e.apply(void 0,i)}else n=u,e.apply(void 0,i)},l=function(){clearTimeout(t)};return i.cancel=l,i},fa=function(e,t){var n,r,o=t.logLevel,c=void 0===o?"warn":o,i=t.onGrip,l=void 0===i?function(){}:i,u=t.onLongGrip,s=void 0===u?function(){}:u,d=t.onClick,f=void 0===d?function(){}:d,m=t.onDrag,v=void 0===m?function(){}:m,p=t.onRelease,h=void 0===p?function(){}:p,g=t.onCancel,E=void 0===g?function(){}:g,y=t.longGripMs,b=void 0===y?300:y,C=re({logLevel:c}),N=!1,k=function(){},x=function(){},w=function(){};C.debug("enable drag on",e);var S,D,R,I,A,O=we(e,"dragstart",(function(e){e.preventDefault()})),M=we(e,"mousedown",(function(e){if(3===e.which)C.debug("ignore right click");else{q(va(e),e);var t=da((function(e){B(va(e),e)}));w=function(){return t.cancel()},k=we(document,"mousemove",t),x=we(document,"mouseup",(function(e){x(),k(),T(va(e),e)}))}}),{passive:!0}),L=we(e,"touchstart",(function(e){q(pa(e),e);var t=da((function(e){B(pa(e),e)}));w=function(){return t.cancel()},k=we(document,"touchmove",t),x=we(document,"touchend",(function(e){x(),k(),T(pa(e),e)}))}),{passive:!0}),P=we(e,"click",(function(e){N||"none"!==A||f(e)})),q=function(t,n){C.debug("gripping node at",t),r=!0,A="none",R=t,S=t,D=ma(e),l({x:D.x,y:D.y,event:n}),I=setTimeout(j,b)},j=function(){N=!0,s()},B=function(e,t){if(S.x!==e.x||S.y!==e.y){S=e;var n=R.x-D.x,r=R.y-D.y,o={x:e.x-n,y:e.y-r},c=e.x-R.x,i=e.y-R.y;C.debug("move node at",o),v(a(a({event:t},o),{},{relativeX:c,relativeY:i,setDropEffect:function(e){A=e}}))}else C.debug("no real move")},T=function(e,t){C.debug("releasing node"),r=!1,clearTimeout(I);var a=R.x-D.x,o=R.y-D.y;h({event:t,dropEffect:A,x:S.x-a,y:S.y-o}),n=setTimeout((function(){N=!1}))};return function(e){O(),P(),M(),L(),k(),x(),clearTimeout(I),clearTimeout(n),w(),function(e){r&&(C.debug("cancelling drag",e),r=!1,E({event:e}))}(e)}},ma=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top}},va=function(e){return{x:e.pageX,y:e.pageY}},pa=function(e){var t=e.changedTouches[0];return{x:t.pageX,y:t.pageY}},ha=o.useEffect,ga=o.useState,Ea=function(e){var t=e.dice,r=e.diceAnimation,a=e.anmationDebug,c=void 0!==a&&a,l=e.parentNode,u=e.zIndex,d=e.x,f=e.y,m=e.rotation,v=e.draggable,p=e.onDiceClick,h=e.onDiceDrag,g=e.onDiceDrop,E=e.onDiceDragEnd,y=e.disapear,b=e.appear,C=s(),N=ae(t.id),w=oe(t.id),S=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chestSlots,t=void 0===e?x():e;return Object.keys(t).reduce((function(e,r){var a=t[r];return a&&"dice"===a.type?[].concat(n(e),[a.value]):e}),[])}().includes(t.id),D=ga(!1),R=i(D,2),I=R[0],A=R[1],O=ga(null),M=i(O,2),L=M[0],P=M[1],q=ct(l),j=r?q:l;ha((function(){if(!v||!N||!C)return function(){};var e=!1,n=fa(N,{onGrip:function(){A(!0)},onClick:function(e){p(t,e)},onDrag:function(n){var r,a,o=n.x,c=n.y,i=n.relativeX,l=n.relativeY,u=n.setDropEffect,s=(r={left:o,right:o+Wn,top:c,bottom:c+Wn},a=mn(C),sn(r,a));P({x:s.left,y:s.top}),(e=e||Math.abs(i)>10||Math.abs(l)>10)&&h(t,{relativeX:i,relativeY:l,setDropEffect:u,diceRectangle:s})},onRelease:function(e){var n=e.dropEffect,r=e.x,a=e.y;"none"!==n&&g(t,{diceRectangle:{left:r,right:r+Wn,top:a,bottom:a+Wn}});A(!1),P(null),E(t)},onCancel:function(){A(!1),P(null),E(t)}});return function(){n()}}),[v,N,C,p,h,g,E]),ha((function(){if(!r||!N)return function(){};var e=r.from,t=r.to,n=r.onfinish;c&&(hn(e),hn(t));var a="translate(".concat(Math.floor(t.x-e.x),"px, ").concat(Math.floor(t.y-e.y),"px)"),o=N.parentNode.animate([{transform:a}],{duration:500,fill:"forwards",easing:"cubic-bezier(0, 0.55, 0.45, 1)"});return o.onfinish=n,function(){o.cancel()}}),[N,r]);var T=H(t),F=r&&r.from?r.from.x:L?L.x:d,U=r&&r.from?r.from.y:L?L.y:f,z=L||r?1e3:u;return o.createElement(ua,{parent:j},o.createElement("svg",{"data-dice-id":t.id,className:"dice",onClick:v?void 0:function(e){p(t,e)},style:{width:Wn,height:Wn,left:"".concat(F,"px"),top:"".concat(U,"px"),zIndex:z,cursor:v?I?"grabbing":"grab":void 0,position:L||r?"fixed":void 0}},o.createElement("g",{ref:w,className:y?"dice-cursed-disapear":b?"dice-cursed-appear":"",style:{transform:sa({rotate:m||0,scale:I?"1.1":"1"}),transitionProperty:"transform",transitionDuration:"500ms",transitionTimingFunction:"cubic-bezier(0, 0.55, 0.45, 1)",transformOrigin:"center center"}},o.createElement("rect",{className:"dice-background",width:"100%",height:"100%",rx:"5",ry:"5",fill:ya(T,S).fill,stroke:ya(T,S).stroke,strokeWidth:"1"}),o.createElement("image",{href:k(B(t)),draggable:"false",style:{width:"100%",height:"100%"}}))))},ya=function(e,t){return e?{fill:"black",stroke:"black"}:t?{fill:"none",stroke:"none"}:{fill:"#eaeaea",stroke:"#b9b9b9"}},ba=function(e){var t=e.offscreenDomNode,n=e.chestDomNode,r=e.rolledAreaDomNode,c=e.cursedAreaDomNode,l=e.onDiceOverChestChange,u=void 0===l?function(){}:l,s=e.onDiceOverRolledAreaChange,d=void 0===s?function(){}:s,f=w(),m=x(),v=J(),p=z(),h=_(),g=ce(),E=D(S()),y=L(),b=ar(),C=tr(),N=o.useReducer((function(e,t){return a(a({},e),{},K({},t.key,t.value))}),{}),k=i(N,2),R=k[0],I=k[1],A=gr(),O=Nr(),M=Cr(),P=br(),q=Er(),j=o.useRef(null);return Object.keys(f).map((function(e){var i=f[e],l=Ta(i,{chestSlots:m,diceRolledIds:v,diceCursedIds:p}),s=Fa(l,{chestDomNode:n,rolledAreaDomNode:r,cursedAreaDomNode:c,offscreenDomNode:t}),N=s.parentNode,k=i.id!==h&&N===r&&H(i),x=N===c,w=o.useCallback((function(e){var t=Ca(e,{currentCard:E,witchCardEffectUsed:g,diceRolledIds:v,chestSlots:m,diceCursedIds:p,hasDicesToCurse:C,threeSkullsOrMoreInCursedArea:b,scoreMarked:y});if("keep"===t){var n=Pa(m);O(e,n)}else"unkeep"===t?M(e):"uncurse"===t&&P(e)}),[v,m,p,y,b,E,g]),S=o.useCallback((function(e,t){j.current=ka({dragDiceGesture:t,chestDomNode:n,rolledAreaDomNode:r});var a=Na(e,{diceRolledIds:v,chestSlots:m,dropTargetRef:j,rolledAreaDomNode:r,chestDomNode:n,hasDicesToCurse:C,threeSkullsOrMoreInCursedArea:b,scoreMarked:y});t.setDropEffect(a),u("keep"===a?e:null),d("unkeep"===a?e:null)}),[v,m,j,r,n,y,b,u,d]),D=o.useCallback((function(e,t){var a=Na(e,{diceRolledIds:v,chestSlots:m,dropTargetRef:j,rolledAreaDomNode:r,chestDomNode:n,scoreMarked:y,threeSkullsOrMoreInCursedArea:b}),o=!1,c=null;if("reposition-in-rolled-area"===a){var i=Ma(t.diceRectangle,r),l=La(e,{dices:f,diceRolledIds:v});A(e,i,l)}else if("back-to-rolled-area"===a)o=!0,c=Aa(e.rolledAreaPosition,r);else if("keep"===a){var u=qa(e,{chestSlots:m,rectangle:t.diceRectangle,chestDomNode:n});O(e,u),o=!0,c=Oa(u,n)}else if("reposition-in-chest"===a){var s=qa(e,{chestSlots:m,rectangle:t.diceRectangle,chestDomNode:n});ja(e,m)!==s&&(q(e,s),o=!0,c=Oa(s,n))}else if("back-to-chest"===a){var d=ja(e,m);o=!0,c=Oa(d,n)}else if("unkeep"===a){var p=Ma(t.diceRectangle,r);A(e,p,La(e,{dices:f,diceRolledIds:v})),M(e),o=!0,c=Aa(p,r)}o&&I({key:e.id,value:{from:{x:t.diceRectangle.left,y:t.diceRectangle.top},to:c,onfinish:function(){setTimeout((function(){I({key:e.id,value:null})}))}}})}),[v,m,j,r,n,y,b]),L=o.useCallback((function(){u(null),d(null)}),[u,d]),B=a(a({key:i.id},s),{},{dice:i,diceAnimation:R[i.id],witchCardEffectUsed:g,disapear:k,appear:x,onDiceClick:w,onDiceDrag:S,onDiceDrop:D,onDiceDragEnd:L});return o.useMemo((function(){return o.createElement(Ea,B)}),Object.keys(B).map((function(e){return B[e]})))}))},Ca=function(e,t){var n=t.currentCard,r=t.witchCardEffectUsed,a=t.diceRolledIds,o=t.chestSlots,c=t.diceCursedIds,i=t.hasDicesToCurse,l=t.threeSkullsOrMoreInCursedArea,u=t.scoreMarked;return xa(e,a)?Da(e,{hasDicesToCurse:i,threeSkullsOrMoreInCursedArea:l,scoreMarked:u})?"keep":"none":wa(e,o)?Ra(e,{threeSkullsOrMoreInCursedArea:l,scoreMarked:u})?"unkeep":"none":Sa(e,c)&&Ia(e,{currentCard:n,witchCardEffectUsed:r,scoreMarked:u,threeSkullsOrMoreInCursedArea:l})?"uncurse":"none"},Na=function(e,t){var n=t.diceRolledIds,r=t.chestSlots,a=t.dropTargetRef,o=t.rolledAreaDomNode,c=t.chestDomNode,i=t.hasDicesToCurse,l=t.threeSkullsOrMoreInCursedArea,u=t.scoreMarked;return xa(e,n)?a.current===o?"reposition-in-rolled-area":a.current===c&&Da(e,{hasDicesToCurse:i,threeSkullsOrMoreInCursedArea:l,scoreMarked:u})?"keep":"back-to-rolled-area":wa(e,r)?a.current===c?"reposition-in-chest":a.current===o&&Ra(e,{scoreMarked:u,threeSkullsOrMoreInCursedArea:l})?"unkeep":"back-to-chest":"none"},ka=function(e){var t=e.dragDiceGesture,n=e.chestDomNode,r=e.rolledAreaDomNode;return vn(n,t.diceRectangle)?n:vn(r,t.diceRectangle)?r:null},xa=function(e,t){return t.includes(e.id)},wa=function(e,t){return Object.keys(t).some((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},Sa=function(e,t){return t.includes(e.id)},Da=function(e,t){var n=t.hasDicesToCurse,r=t.threeSkullsOrMoreInCursedArea,a=t.scoreMarked;return!H(e)&&(!n&&(!r&&!a))},Ra=function(e,t){var n=t.scoreMarked,r=t.threeSkullsOrMoreInCursedArea;return!n&&!r},Ia=function(e,t){var n=t.currentCard,r=t.witchCardEffectUsed,a=t.scoreMarked,o=t.threeSkullsOrMoreInCursedArea;return!!ne(n)&&(!r&&(!a&&!o))},Aa=function(e,t){var n,r,a,o,c=(n={left:e.x,top:e.y,right:0,bottom:0},r=mn(t),a=n.right-n.left,o=n.bottom-n.top,{left:r.left+n.left,top:r.top+n.top,right:r.left+n.left+a,bottom:r.top+n.top+o});return{x:c.left,y:c.top}},Oa=function(e,t){var n=Ba(e,t),r=mn(n);return{x:r.left+5,y:r.top+5}},Ma=function(e,t){var n=function(e,t){var n=mn(t);return function(e,t){var n=e.left-t.left,r=n+(e.right-e.left),a=e.top-t.top;return{left:n,right:r,top:a,bottom:a+(e.bottom-e.top)}}(sn(e,n),n)}(e,t);return{x:n.left,y:n.top}},La=function(e,t){var n=t.diceRolledIds,r=t.dices;if(0===n.length)return 1;var a=n.slice(1).reduce((function(e,t){var n=r[t];return n.rolledAreaZIndex>e.rolledAreaZIndex?n:e}),r[n[0]]);return a===e?e.rolledAreaZIndex:a.rolledAreaZIndex+1},Pa=function(e){return Object.keys(e).find((function(t){return!e[t]}))},qa=function(e,t){var n=t.chestSlots,r=t.rectangle,a=t.chestDomNode,o=new Map,c=[];Object.keys(n).forEach((function(t){var r=n[t];if(!r||"dice"===r.type&&r.value===e.id){var i=Ba(t,a);o.set(i,t),c.push(i)}}));var i=pn(c,r);return o.get(i)},ja=function(e,t){return Object.keys(t).find((function(n){var r=t[n];return r&&"dice"===r.type&&r.value===e.id}))},Ba=function(e,t){return t.querySelector('[data-chest-slot="'.concat(e,'"]'))},Ta=function(e,t){var n=t.chestSlots,r=t.diceRolledIds,o=t.diceCursedIds,c=Object.keys(n).find((function(t){return n[t]&&"dice"===n[t].type&&n[t].value===e.id}));return c?{type:"chest-slot",value:c}:r.includes(e.id)?{type:"rolled-area",value:a(a({},e.rolledAreaPosition),{},{rotation:e.rotation,zIndex:e.rolledAreaZIndex})}:o.includes(e.id)?{type:"cursed-area",value:void 0}:{type:"offscreen-area"}},Fa=function(e,t){var n=e.type,r=e.value,a=t.chestDomNode,o=t.rolledAreaDomNode,c=t.cursedAreaDomNode,i=t.offscreenDomNode;return"chest-slot"===n?{parentNode:a.querySelector('[data-chest-slot="'.concat(r,'"]')),zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!0}:"rolled-area"===n?{parentNode:o,zIndex:r.zIndex,rotation:r.rotation,x:r.x,y:r.y,draggable:!0}:"cursed-area"===n?{parentNode:c,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}:{parentNode:i,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}},Ua=function(e){var t=e.dialogIsOpen,n=e.closeDialog,r=e.headerSmallCardRef,a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cardIds;return(void 0===e?X():e).map((function(e){return D(e)}))}(),c=S(),i=D(c)||null,l=o.useRef(),u=o.useRef(),s=o.useRef();return o.createElement(Xt,{className:"draw-card-dialog dialog-spacing-10 dialog-spacing-fluid",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!1},o.createElement("div",{className:"dialog-content"},o.createElement("div",{className:"dialog-body"},o.createElement("div",{className:"dialog-label"},0===a.length&&!i&&"Paquet de cartes épuisé. Mélangez-le pour pouvoir piocher à nouveau !",0!==a.length&&!i&&"Piochez une carte pour le tour suivant.",i&&o.createElement("span",{className:"card-name"},Br[i.type].name)),o.createElement("div",{className:"card-area"},o.createElement("div",{style:{position:"relative"}},o.createElement(za,{backCardRef:l,currentCard:i,remainingCardCount:a.length}),o.createElement(Ga,{topCardRef:u,smallCardRef:s,currentCard:i})))),o.createElement("div",{className:"dialog-actions"},o.createElement(Wa,{backCardRef:l,cardDeck:a,currentCard:i}),i?o.createElement(Ja,{headerSmallCardRef:r,smallCardRef:s,backCardRef:l,topCardRef:u,currentCard:i,closeDialog:n}):null)))},za=function(e){var t=e.backCardRef,n=e.currentCard,r=e.remainingCardCount;return o.createElement("div",{ref:t,className:"card default-card",style:{background:"none"}},o.createElement(pe,{src:ke,width:"150"}),n?null:o.createElement("div",{className:"remaining-cards-number"},r))},Ga=function(e){var t=e.topCardRef,n=e.smallCardRef,r=e.currentCard;return r?o.createElement(o.Fragment,null,o.createElement("div",{className:"card current-card",ref:t},o.createElement("div",{className:"flip-card"},o.createElement("div",{className:"flip-card-inner"},o.createElement("div",{className:"flip-card-front"},o.createElement(pe,{className:"card default-card",src:ke})),o.createElement("div",{className:"flip-card-back"},o.createElement(pe,{className:"card-img",src:$(r),width:"150",alt:r.type}))))),o.createElement("div",{className:"small-card"},o.createElement(Fr,{card:r,ref:n}))):null},Wa=function(e){var t=e.backCardRef,n=e.cardDeck;return e.currentCard?null:0===n.length?o.createElement(Xa,{backCardRef:t}):o.createElement(Za,null)},Za=function(){var e=Ir();return o.createElement("button",{className:"button-card-main button-draw-card",onClick:e},"Piocher")},Xa=function(e){var t=e.backCardRef,n=P(),r=Mr(),a=o.useState(!1),c=i(a,2),l=c[0],u=c[1];return o.useEffect((function(){return l?(r(),n?(u(!1),function(){}):Ya({backCard:t.current,duration:1e3,onfinish:function(){u(!1)}})):function(){}}),[l]),o.createElement("button",{className:"button-card-main button-shuffle-deck",onClick:function(){u(!0)}},"Mélanger")},Ya=function(e){var t=e.backCard,n=e.duration,r=e.onfinish;t.setAttribute("shaking-deck","");var a=setTimeout((function(){t.removeAttribute("shaking-deck",""),r()}),n);return function(){t.removeAttribute("shaking-deck",""),clearTimeout(a)}},Ja=function(e){var t=e.headerSmallCardRef,n=e.smallCardRef,r=e.backCardRef,a=e.topCardRef,c=P(),l=mr(),u=o.useState(!1),s=i(u,2),d=s[0],f=s[1];return o.useEffect((function(){return d?c?(l(),function(){}):_a({headerSmallCard:t.current,smallCard:n.current,backCard:r.current,topCard:a.current,duration:500,onfinish:function(){l()}}):function(){}}),[d]),o.createElement("button",{className:"button-card-main button-activate-card",onClick:function(){d||f(!0)}},"Commencer")},_a=function(e){var t=e.headerSmallCard,n=e.topCard,r=e.backCard,a=e.smallCard,o=e.duration,c=e.onfinish;r.style.opacity=0;var i=mn(t),l=n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(0)",opacity:0}],{duration:o,fill:"forwards"}),u=a.animate([{transform:"scale(0)",opacity:0,position:"fixed",top:"".concat(i.top,".px"),left:"".concat(i.left,".px")},{transform:"scale(1)",opacity:1,position:"fixed",top:"".concat(i.top,".px"),left:"".concat(i.left,".px")}],{duration:o,fill:"forwards"});return u.onfinish=c,function(){l.cancel(),u.cancel()}},Ha=function(e){var t=e.openScoreboard,n=e.onRoundStart,r=e.onRoundOver,a=q(),c=o.useState(!1),l=i(c,2),u=l[0],s=l[1];o.useEffect((function(){n()}),[]);var d=it(),f=i(d,2),m=f[0],v=f[1],p=it(),h=i(p,2),g=h[0],E=h[1],y=o.useRef();return o.createElement("div",{className:"round-container"},o.createElement(Lr,null),o.createElement(Zr,{openScoreboard:t,headerSmallCardRef:y}),a?o.createElement(Ka,{diceOverRolledAreaListener:m,diceOverChestListener:g,openScoreboard:t,onRoundOver:r,onRoundMounted:function(e){s(e)}}):null,u?o.createElement(ba,{offscreenDomNode:u.offscreenDomNode,chestDomNode:u.chestDomNode,rolledAreaDomNode:u.rolledAreaDomNode,cursedAreaDomNode:u.cursedAreaDomNode,onDiceOverChestChange:E,onDiceOverRolledAreaChange:v}):null,o.createElement(Ua,{dialogIsOpen:!a,headerSmallCardRef:y}))},Ka=function(e){var t=e.diceOverRolledAreaListener,n=e.diceOverChestListener,r=e.onRoundMounted,a=e.onRoundOver,c=o.useRef(null),i=o.useRef(null),l=o.useRef(null),u=o.useRef(null);return o.useEffect((function(){r({rolledAreaDomNode:c.current,chestDomNode:i.current,cursedAreaDomNode:l.current,offscreenDomNode:u.current})}),[]),o.createElement(o.Fragment,null,o.createElement(xr,null),o.createElement("div",{className:"chest-and-skulls"},o.createElement(Xn,{chestRef:i,diceOverChestListener:n}),o.createElement(ca,{cursedAreaRef:l})),o.createElement(jr,{rolledAreaRef:c,offscreenRef:u,diceOverRolledAreaListener:t}),o.createElement(ra,{onRoundOver:a,rolledAreaRef:c}))},Va=function(e){var t=e.closeDialog,n=e.dialogIsOpen,r=e.player,a=dr();return o.createElement(Xt,{className:"score-board-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:n,onRequestClose:t,requestCloseOnClickOutside:!0},o.createElement("div",{className:"dialog-content"},o.createElement("div",{className:"dialog-close",onClick:t},o.createElement(tn,null)),o.createElement("div",{className:"dialog-body"},o.createElement("div",null,"Au tour de",o.createElement("div",{className:"dialog-label"},r.character.name),o.createElement(pe,{className:"player-img",src:r&&r.character.img,alt:"player",width:"40",height:"40",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(r&&r.character.color||"black")}})),o.createElement("div",{className:"dialog-actions"},o.createElement("button",{onClick:function(){t(),a(r)}},"Jouer")))))},Qa=System.resolve("./assets/win-treasure.png",t.meta.url),$a=System.resolve("./assets/boat.png",t.meta.url),eo=6e3,to={path1:"M39.582,739.564c0-91.824,39.191-96.32,38.045-166.691s-30.042-70.37-47.326-161.729s38.128-86.388,31.276-186.42C55.405,134.602-3.014,89.176,8.812,129.825c5.333,18.333,30.77-21,30.77-129.825",path2:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0",path3:"M39.582,739.564c0-71.926-15.437-155.074-17.437-253.074s30-185,31.087-217s-31.087-46-31.087-26s33,10,31-32s-31-110-31-144S39.582,0,39.582,0",path4:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0"},no=function(e){var t=e.openedByUser,n=e.closeScoreboard,r=e.playerAnimation,a=F(),c=Kn(),l=ie(),u=o.useState(!1),s=i(u,2),d=s[0],f=s[1],m=function(){f(!0)},v=ro();return o.createElement("div",{className:"score-board-container"},t&&o.createElement("div",{className:"cross",onClick:n},"X"),!l&&!c&&o.createElement("div",{className:"action-container"},o.createElement("button",{className:"score-board-action",onClick:function(){m()}},"Commencer à jouer")),o.createElement(pe,{className:"win-treasure-img",src:Qa,alt:"win-treasure",width:"230",height:"150"}),o.createElement("div",{className:"users-path"},a.map((function(e){return o.createElement(ao,{key:e.id,player:e,openedByUser:t,pathCoordinates:to["path".concat(e.id)],score:e.score,character:e.character,openStartPlayerRoundDialog:m,isCurrentPlayer:c&&e.id===c.id,playerAnimation:r})}))),o.createElement(Va,{dialogIsOpen:d,closeDialog:function(){f(!1)},player:v}))},ro=function(){var e,t=Kn(),n=F();if(t){var r=n.findIndex((function(e){return e.id===t.id}));e=r===n.length-1?n[0]:n[r+1]}else e=n[0];return e},ao=function(e){var t=e.pathCoordinates,n=e.player,r=e.openedByUser,a=e.character,c=e.score,l=e.openStartPlayerRoundDialog,u=e.playerAnimation,s=o.useRef(null),d=o.useRef(null),f=o.useRef(null),m=o.useRef(null),v=ro(),p=o.useState(null),h=i(p,2),g=h[0],E=h[1],y=o.useState([]),b=i(y,2),C=b[0],N=b[1],x=o.useState(!1),w=i(x,2),S=w[0],D=w[1];return o.useEffect((function(){u&&u.player===n?"user-collect"===u.roundOverReason?(E(u.score),N(u.symbolsInChest)):"3-skulls"===u.roundOverReason?D(!0):"chalenge-failed"===u.roundOverReason&&E(u.score):E(null)}),[u,n]),o.useEffect((function(){if(g){var e=g.from,t=g.to,n=d.current.animate([{offsetDistance:oo(e/eo)},{offsetDistance:oo(t/eo)}],{duration:1e3,fill:"forwards"}),r=m.current,a=null;r&&(a=r.animate([{offsetDistance:oo(e/eo)},{offsetDistance:oo(t/eo)}],{duration:1e3,fill:"forwards"}));var o=s.current,c=o.getTotalLength();console.log("from",e),console.log("to",t);var i=o.animate([{strokeDashoffset:co(e/eo,c)},{strokeDashoffset:co(t/eo,c)}],{duration:1e3,fill:"forwards"});return i.onfinish=function(){"finished"===n.playState&&E(null)},n.onfinish=function(){"finished"===i.playState&&E(null)},function(){i.cancel(),n.cancel(),a&&a.cancel()}}}),[g]),o.useEffect((function(){var e=s.current,t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=co(c/eo,t)}),[c]),o.createElement("div",{className:"user-path"},o.createElement("svg",{viewBox:"0 0 79.164 739.564",width:"50",height:"450",fill:"none",stroke:"none"},o.createElement("path",{d:t,className:"path-background"}),o.createElement("path",{ref:s,d:t,className:"path-foreground"}),o.createElement("g",{className:"score-indicator"},o.createElement("image",{ref:d,href:$a,width:"26",height:"26",className:"boat",style:{offsetPath:"path('".concat(t,"')"),offsetDistance:oo(c/eo)}}),C&&C.length>0&&o.createElement("g",{className:"animation-symbols",ref:m,style:{offsetPath:"path('".concat(t,"')"),offsetDistance:oo(c/eo)}},C.map((function(e,t){return o.createElement("image",{key:t,width:"30",height:"30",className:"symbol symbol-".concat(t+1),href:k(e)})}))))),o.createElement("div",{className:"speech-bubble"},c),o.createElement("div",{className:"user-avatar ".concat(v.character.id!==a.id||r?"":"next-player"),onClick:function(){v.character.id!==a.id||r||l()}},S&&o.createElement("div",{className:"animation-3skulls",ref:f},o.createElement(io,null)),o.createElement(lo,{character:a})))},oo=function(e){return"".concat(100*e,"%")},co=function(e,t){return t-e*t},io=function(){return new Array(3).fill("").map((function(e,t){return o.createElement(pe,{key:t,width:"30",height:"30",className:"skull skull-".concat(t+1),src:te,animateLoaded:!1})}))},lo=function(e){var t=e.character;return o.createElement(pe,{className:"player-img",src:t.img,alt:"player",width:"40",height:"40",style:{boxShadow:"inset 0px 0px 0px 4px ".concat(t.color||"black")}})},uo=function(){var e=so();return o.createElement("div",{className:"game-configuration"},o.createElement("div",{className:"background-image"}),o.createElement("div",{className:"content"},o.createElement("div",{className:"title"},"A l’abordage !"),o.createElement("div",{className:"subtitle"},"Combien de joueurs participent à l’aventure ?"),o.createElement("div",{className:"buttons"},[1,2,3,4,5].map((function(t){return o.createElement("button",{key:t,onClick:function(){e(t)}},t)})))))},so=r((function(e,t){return a(a({},e),{},{players:new Array(t).fill("").map((function(e,t){return{id:t+1,number:t+1,score:0}}))})})),fo=[{id:1,name:"Luffy",color:"#ef9620",img:System.resolve("./assets/Luffy.png",t.meta.url)},{id:2,name:"Miss Fortune",color:"#d90f1b",img:System.resolve("./assets/MissFortune.png",t.meta.url)},{id:3,name:"Jack Sparrow",color:"#007033",img:System.resolve("./assets/JackSparrow.png",t.meta.url)},{id:4,name:"Barbe Rouge",color:"#7baac9",img:System.resolve("./assets/BarbeRouge.png",t.meta.url)},{id:5,name:"Ginette Boulette",color:"#e2500c",img:System.resolve("./assets/GinetteBoulette.png",t.meta.url)},{id:6,name:"Capitaine Crochet",color:"#952460",img:System.resolve("./assets/CapitaineCrochet.png",t.meta.url)}],mo=function(e){var t=e.players,n=go(),r=po(),a=t.find((function(e){return!e.character}));return Eo(),o.useEffect((function(){Eo()}),[]),o.createElement("div",{className:"character-selection-page"},o.createElement(vo,null),a&&o.createElement(o.Fragment,null,o.createElement("p",null,"Joueur ",a.number," : quel pirate êtes vous ?"),o.createElement("div",{className:"characters-container",id:"menu-wrapper"},o.createElement("div",{className:"characters menu"},fo.map((function(e){return o.createElement("div",{className:"character item ".concat(ho(e,t)?"":"disabled"),key:e.id,onClick:function(r){ho(e,t)&&(r.target.animate([{transform:"scale(1)"},{transform:"scale(1.3)"},{transform:"scale(1)"}],{duration:400,fill:"forwards"}),n(a,e))}},o.createElement(pe,{className:"character-img",width:"40",height:"40",src:e&&e.img,alt:"player",style:{border:"4px solid ".concat(e&&e.color||"black")}}),o.createElement("span",null,e.name))}))),o.createElement("div",{className:"paddles"},o.createElement("button",{className:"left-paddle paddle hidden"},"<"),o.createElement("button",{className:"right-paddle paddle",onClick:function(){Eo()}},">")))),!a&&o.createElement("div",{className:"crew-completed"},o.createElement("p",null,"L’équipage est au complet !"),o.createElement(pe,{style:{opacity:.5},src:ee({type:le})}),o.createElement("button",{onClick:function(){r()}},"Démarrer la partie")))},vo=function(){var e=F();return o.createElement("div",{className:"crew ".concat(e.length>3?"large-crew":"")},o.createElement("div",{className:"title"},"Votre equipage:"),o.createElement("ul",null,e.map((function(e){return o.createElement("li",{key:e.id},e.character?o.createElement(pe,{className:"crew-member-img",width:"40px",height:"40px",src:e.character&&e.character.img,alt:"player",style:{border:"4px solid ".concat(e.character&&e.character.color||"black")},loadWhenIntersecting:!1}):o.createElement("div",{className:"placeholder-img"}),o.createElement("span",null,e.character?e.character.name:"Joueur".concat(e.number)))}))))},po=r((function(e){var t=e.cardIds;return a(a({},e),{},{gameStarted:!0,cardIds:Q(t)})})),ho=function(e,t){return!t.some((function(t){return t.character&&t.character.name===e.name}))},go=r((function(e,t,r){var o=e.players;return t.character=r,a(a({},e),{},{players:n(o)})})),Eo=function(){var e=document.getElementsByClassName("item").length,t=function(){return document.getElementById("menu-wrapper")?document.getElementById("menu-wrapper").offsetWidth:null},n=t(),r=123*e;window.onresize=function(){n=t()};var a=r-n,o=document.querySelector(".left-paddle"),c=document.querySelector(".right-paddle");document.querySelector(".menu")&&(document.querySelector(".menu").onscroll=function(){a=r-n;var e=document.querySelector(".menu").scrollLeft,t=a;e<=0?(o.classList.add("hidden"),c.classList.remove("hidden")):e<t?(o.classList.remove("hidden"),c.classList.remove("hidden")):e>=t&&(o.classList.remove("hidden"),c.classList.add("hidden"))}),c&&(c.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e+n;ut({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}}),o&&(o.onclick=function(){if(document.querySelector(".menu")){var e=document.querySelector(".menu").scrollLeft,t=e-n;ut({duration:300,onProgress:function(n){var r=n.progress;document.querySelector(".menu").scrollLeft=e+(t-e)*r}})}})},yo=function(e){var t=e.playerAnimationListener,n=F(),r=T(),a=ie(),c=bo(),l=Co(),u=o.useState(!1),s=i(u,2),d=s[0],f=s[1],m=o.useState(null),v=i(m,2),p=v[0],h=v[1],g=o.useState(null),E=i(g,2),y=E[0],b=E[1],C=!a||d,N=n.find((function(e){return e.id===r})),k=o.useRef(null);return o.useEffect((function(){b(p?{player:N,score:{from:k.current,to:N.score},roundOverReason:p.reason,symbolsInChest:p.symbolsInChest}:null)}),[p,r]),o.useEffect((function(){if(t)return t(b)}),[t]),c?o.createElement(uo,null):l?o.createElement(mo,{players:n}):C?o.createElement(no,{openedByUser:d,closeScoreboard:function(){f(!1)},playerAnimation:y}):o.createElement(Ha,{openScoreboard:function(){f(!0)},onRoundStart:function(){k.current=N.score,h(null)},onRoundOver:function(e){h(e)}})},bo=function(){return 0===F().length},Co=function(){return!ue()},No=r((function(e){return a(a({},e),{},{animationsDisabled:!0})})),ko=r((function(e){return a(a({},e),{},{animationsDisabled:!1})})),xo=r((function(e){return a(a({},e),{},{soundDisabled:!0})})),wo=r((function(e){return a(a({},e),{},{soundDisabled:!1})})),So=r((function(){return se})),Do=function(){var e=o.useState(),t=i(e,2),n=t[0],r=t[1];return o.useEffect((function(){return Ae(r)}),[]),n},Ro=function(){return o.useCallback(Oe)},Io=function(){return Boolean(Ge)},Ao=function(){var e=o.useState(Ye()),t=i(e,2),n=t[0],r=t[1];return o.useEffect((function(){return e=function(){r(Ye())},Ze.listen(e);var e}),[]),n},Oo=function(){return Je},Mo=function(){return He};function Lo(){}function Po(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var qo=function(e){var t=e.settingsDialogIsOpen;return Io()?o.createElement(jo,{settingsDialogIsOpen:t}):null},jo=function(e){var t=e.checkOnOpen,n=void 0===t||t,r=e.settingsDialogIsOpen,a=Oo(),c=Ao();return o.useEffect((function(){n&&r&&a()}),[n,r]),o.createElement("fieldset",{style:{minHeight:"4em"}},o.createElement("legend",null,"Mise a jour"),c?o.createElement(Bo,{serviceWorkerUpdate:c}):o.createElement(To,null))},Bo=function(e){var t=e.serviceWorkerUpdate,n=t.shouldBecomeNavigatorController,r=t.navigatorWillReload,a=Mo(),c=o.useState(""),l=i(c,2),u=l[0],s=l[1],d=Po((function(){return s("updating"),function(e,t){if(!t)return e&&e.then?e.then(Lo):Promise.resolve()}(a({onActivating:function(){return s("activating")},onActivated:function(){return s("activated")},onBecomesNavigatorController:function(){return s("")}}))}));return o.createElement(o.Fragment,null,o.createElement("p",null,""===u?"Mise a jour prête":null,"updating"===u||"activating"===u?"Mise a jour...":null,"activated"===u&&r?"Mise a jour activée, la page va se recharger":null,"activated"===u&&!r&&n?"Mise a jour activée, recharger la page pour installer":null,"activated"!==u||r||n?null:"Mise a jour activée"),o.createElement("button",{disabled:Boolean(u),onClick:d},r?"Recharger pour mettre a jour":"Mettre a jour"))},To=function(){var e=Oo(),t=o.useState(""),n=i(t,2),r=n[0],a=n[1],c=Po((function(){return a("fetching"),function(e){if(e&&e.then)return e.then(Lo)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return function(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}(e,(function(e){e||a("notfound")}))}),(function(e){a("failed"),console.error(e)})))}));return o.createElement(o.Fragment,null,o.createElement("p",null,"fetching"===r?"Recherche de mise a jour...":null,"notfound"===r?"Pas de mise a jour disponible.":null,"failed"===r?"Une erreur est survenue.":null),o.createElement("button",{disabled:"fetching"===r,onClick:c},"Chercher"))},Fo=System.resolve("./assets/settings.css",t.meta.url),Uo=function(){var e=Yt(),t=i(e,3),n=t[0],r=t[1],a=t[2];return o.createElement(o.Fragment,null,o.createElement(Ce,{href:Fo}),o.createElement("div",{id:"settings",onClick:function(){r()}},o.createElement("svg",{className:"settings-icon",width:"24px",height:"24px",viewBox:"0 0 24 24"},o.createElement("path",{fill:"currentColor",d:"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"}))),o.createElement(zo,{settingsDialogIsOpen:n,closeSettingsDialog:a}))},zo=function(e){var t=e.settingsDialogIsOpen,n=e.closeSettingsDialog,r=P(),a=No(),c=ko(),l=de(),u=xo(),s=wo(),d=So(),f=o.useState(!1),m=i(f,2),v=m[0],p=m[1],h=function(){p(!0)};return o.createElement(Xt,{className:"settings-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0},o.createElement("div",{className:"settings-dialog-content"},o.createElement("div",{className:"dialog-close",onClick:n},o.createElement(tn,null)),o.createElement("div",{className:"dialog-simple-title"},"Settings"),o.createElement("div",{className:"setting-element"},o.createElement("label",null,o.createElement("input",{type:"checkbox",className:r?"checked":"unchecked",checked:r,onChange:function(e){e.target.checked?a():c()}}),r&&o.createElement(Wo,null),"Désactiver les animations")),o.createElement("div",{className:"setting-element"},o.createElement("label",null,o.createElement("input",{type:"checkbox",className:l?"checked":"unchecked",checked:l,onChange:function(e){e.target.checked?u():s()}}),l&&o.createElement(Wo,null),"Couper le son")),o.createElement("div",{className:"setting-element"},o.createElement("button",{onClick:function(){h()}},"Annuler la partie")),o.createElement(Go,null),o.createElement(qo,{settingsDialogIsOpen:t}),o.createElement(Zo,{confirmCancelGameDialogIsOpen:v,closeConfirmCancelGameDialog:function(){p(!1)},performCancelGame:function(){d(),n()}})))},Go=function(){var e=[Do(),Ro()],t=i(e,2),n=t[0],r=t[1];return n?o.createElement("button",{onClick:function(){r()}},"Installer application"):null},Wo=function(){return o.createElement("svg",{className:"check-icon",width:"20",height:"20",viewBox:"0 0 512 512"},o.createElement("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"}))},Zo=function(e){var t=e.confirmCancelGameDialogIsOpen,n=e.closeConfirmCancelGameDialog,r=e.performCancelGame;return o.createElement(Xt,{className:"confirm-cancel-game-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0},o.createElement("div",{className:"settings-dialog-content"},o.createElement("div",{className:"dialog-close",onClick:n},o.createElement(tn,null)),o.createElement("div",{className:"title-container"},o.createElement(pe,{className:"illustration",src:fe,width:"40",height:"40"}),o.createElement("div",{className:"title"},"Êtes-vous certain de vouloir annuler la partie ?")),o.createElement("div",{className:"content"},"Cette action irréversible effacera la progression actuelle et remettra la partie à zéro !"),o.createElement("div",{className:"confirm-action"},o.createElement("button",{onClick:function(){r(),n()}},"Confirmer"))))},Xo=System.resolve("./assets/mille-sabord.css",t.meta.url),Yo=(e("App",(function(e){return o.useEffect((function(){!function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).scope;if(!ze)return function(){};var n=!1,r=function(){},a=function(){};qe(Ge=je.register(e,{scope:t}),(function(e){if(r=function(){e.unregister()},n)r();else{var t=e.installing;e.waiting,e.active,a=Se(e,"updatefound",(function(){console.log("browser notifies use an worker is installing"),e.installing!==t?Xe(e.installing):console.log("it's not an worker update, it's first time worker registers")}))}}))}("/service-worker.js")}),[]),o.createElement("div",{id:"main-container"},o.createElement("div",{id:"main",ref:me()},o.createElement(Ce,{href:Xo}),o.createElement(Uo,null),o.createElement(Yo,e)))})),function(e){return ve()?o.createElement(yo,e):o.createElement(et,e)})}}}));

//# sourceMappingURL=App-4047e262.js.map