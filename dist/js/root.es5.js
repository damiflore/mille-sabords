System.register([__v__("/js/app.es5.js")],(function(e,t){"use strict";var r,n,o,l,a,s,c,i,d,u,m,h,f,p,g,v,y,b,C,N,k,x,S,w,D,R,A,I,O,E,M,L,P,q,j,T,$,B,U,F,z,G,W,Y,Z,H,K,X,J,V,_,Q,ee,te,re,ne,oe,le,ae,se,ce,ie,de,ue,me,he,fe,pe,ge,ve,ye,be,Ce,Ne,ke,xe,Se,we,De,Re,Ae,Ie,Oe,Ee,Me,Le,Pe,qe,je,Te,$e,Be,Ue,Fe,ze,Ge,We,Ye,Ze,He,Ke,Xe,Je,Ve,_e,Qe,et,tt,rt,nt,ot,lt,at,st,ct,it,dt,ut,mt,ht,ft,pt,gt,vt,yt,bt,Ct,Nt,kt,xt,St,wt,Dt,Rt,At,It,Ot,Et,Mt,Lt,Pt,qt,jt,Tt,$t,Bt,Ut,Ft,zt,Gt,Wt,Yt,Zt,Ht,Kt,Xt,Jt,Vt,_t,Qt,er,tr,rr,nr,or,lr,ar,sr,cr,ir,dr,ur,mr,hr,fr,pr,gr,vr,yr,br,Cr,Nr,kr,xr,Sr,wr,Dr,Rr,Ar,Ir,Or,Er,Mr,Lr,Pr,qr,jr,Tr,$r,Br,Ur,Fr,zr,Gr,Wr,Yr,Zr,Hr,Kr,Xr,Jr,Vr,_r,Qr,en,tn,rn,nn,on,ln,an,sn,cn,dn,un,mn,hn,fn,pn,gn,vn,yn,bn,Cn,Nn,kn,xn,Sn,wn,Dn,Rn,An,In,On,En,Mn,Ln,Pn,qn,jn,Tn,$n,Bn,Un,Fn,zn,Gn,Wn,Yn,Zn,Hn,Kn,Xn,Jn,Vn,_n,Qn,eo,to,ro,no,oo,lo,ao,so,co,io,uo,mo,ho,fo,po,go,vo,yo,bo,Co,No,ko,xo,So,wo,Do,Ro,Ao,Io,Oo,Eo,Mo,Lo,Po,qo,jo,To,$o,Bo,Uo,Fo,zo,Go,Wo,Yo,Zo,Ho,Ko,Xo,Jo,Vo,_o,Qo,el,tl,rl,nl,ol,ll,al,sl,cl,il,dl,ul,ml,hl,fl,pl,gl,vl,yl,bl,Cl,Nl,kl,xl,Sl,wl,Dl,Rl,Al,Il,Ol,El,Ml,Ll,Pl,ql,jl,Tl,$l,Bl,Ul,Fl,zl,Gl,Wl,Yl,Zl,Hl,Kl,Xl,Jl,Vl,_l,Ql,ea,ta,ra,na,oa,la,aa,sa,ca,ia,da,ua;function ma(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function ha(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function fa(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function pa(){}return{setters:[function(e){r=e.a,n=e.l,o=e.j,l=e._,a=e.b,s=e.u,c=e.c,i=e.s,d=e.d,u=e.e,m=e.i,h=e.f,f=e.S,p=e.g,g=e.h,v=e.k,y=e.m,b=e.n,C=e.o,N=e.p,k=e.q,x=e.r,S=e.t,w=e.v,D=e.w,R=e.x,A=e.y,I=e.z,O=e.A,E=e.B,M=e.C,L=e.D,P=e.E,q=e.F,j=e.G,T=e.H,$=e.I,B=e.J,U=e.K,F=e.L,z=e.M,G=e.N,W=e.O,Y=e.P,Z=e.Q,H=e.R,K=e.T,X=e.U,J=e.V,V=e.W,_=e.X,Q=e.Y,ee=e.Z,te=e.$,re=e.a0,ne=e.a1,oe=e.a2,le=e.a3,ae=e.a4,se=e.a5,ce=e.a6,ie=e.a7,de=e.a8,ue=e.a9,me=e.aa,he=e.ab,fe=e.ac,pe=e.ad,ge=e.ae,ve=e.af,ye=e.ag,be=e.ah,Ce=e.ai,Ne=e.aj,ke=e.ak,xe=e.al,Se=e.am,we=e.an}],execute:function(){De=new Map,Re={LOADING:"loading",LOADED:"loaded",FAILED:"failed"},Ae=function(e){let{lazy:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=De.get(e),l=o?Re.LOADED:Re.LOADING,[a,s]=r.useState(l),c=r.useRef(!1);r.useEffect((()=>(c.current=!0,()=>{c.current=!1})),[]);const i=r.useCallback(fa((function(){if(a!==Re.LOADED)return ha((function(){return ma(n(e),(function(t){c.current?(De.set(e,t),s(Re.LOADED)):console.log("image unmounted")}))}),(function(){c.current&&(De.delete(e),s(Re.FAILED))}))})),[s,e]);return r.useEffect((()=>{t||i()}),[t]),[a,i]},Ie=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],{layout:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=r.useRef(!0);(n?r.useLayoutEffect:r.useEffect)((()=>{if(!o.current)return e();o.current=!1}),t)},Oe=(e,t)=>{const r=Ee(e,t);return Boolean(r)},Ee=(e,t)=>{const n=r.useRef(!1);r.useEffect((()=>{!1===n.current&&(n.current=!0)}));const o=r.useRef(t);return r.useEffect((()=>{o.current=t}),t),n.current&&e(...o.current)?{from:o.current,to:t}:null},Me=e=>{const t=r.useRef(e);return r.useEffect((()=>{t.current=e}),[e]),t.current},Le=e=>{let{root:t,rootMargin:n,threshold:o=0}=e;const[l,a]=r.useState(!1),s=r.useRef();return r.useEffect((()=>{const e=s.current;if(!e)return null;if(l)return null;const r=new window.IntersectionObserver((t=>{let[n]=t;n.isIntersecting?(r.unobserve(e),a(!0)):a(!1)}),{root:t,rootMargin:n,threshold:o});return r.observe(e),()=>{r.disconnect()}}),[l]),[s,l]},Pe=["loadWhenIntersecting","usePlaceholderWhileLoading","animateLoaded","intersectionRoot","intersectionRootMargin","intersectionThreshold","FallbackWhileNotIntersecting","FallbackWhileLoading","useImageStatusHook","src"],qe=e=>{let{loadWhenIntersecting:t=!0,usePlaceholderWhileLoading:n=!0,animateLoaded:c=!0,intersectionRoot:i,intersectionRootMargin:d,intersectionThreshold:u,FallbackWhileNotIntersecting:m=$e,FallbackWhileLoading:h=Te,useImageStatusHook:f=Ae,src:p}=e,g=a(e,Pe);const[v,y]=f(p,{lazy:t}),b=Me(v),[C,N]=s(p);r.useEffect((()=>{"loading"!==b&&"loading"===v&&C(),"loaded"!==b&&"loaded"===v&&N()}),[b,v]);const[k,x]=Le({root:i,rootMargin:d,threshold:u}),S=Me(x);r.useEffect((()=>{t&&!S&&x&&y()}),[t,S,x]);const[w,D]=je();return r.useLayoutEffect((()=>{c&&"loaded"!==b&&"loaded"===v&&D()}),[c,b,v]),t&&"loaded"!==v&&!x?o(m,{ref:k}):n&&"loaded"!==v?o(h,{}):o("img",l({src:p,ref:w},g))},je=()=>{const e=r.useRef(),t=r.useCallback((()=>{const t=e.current,r=window.getComputedStyle(t).getPropertyValue("opacity");t.animate([{opacity:0},{opacity:r}],{duration:300})}));return[e,t]},Te=r.forwardRef(((e,t)=>o("img",l({src:Be,ref:t},e)))),$e=r.forwardRef(((e,t)=>o("img",l({src:Be,ref:t},e)))),Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",Ue=()=>o(Fe,{}),Fe=()=>{const e=ze();return c("div",{className:"new-game",children:[o(qe,{src:i}),o("button",{onClick:e,children:"Nouvelle partie"})]})},ze=d((e=>l(l({},e),{},{gameCreated:!0}))),Ge=(e,t)=>{if(e&&"symbol"===e.type)return e.value;if(e&&"dice"===e.type){const r=t[e.value];return u(r)}return null},We=e=>{let{card:t,symbolsInChest:r,scoreMarked:n,markScoreAllowed:o}=e;return m(t)?n||o?Ye(r,{goal:t.numberOfSwords,gamble:t.gambleAmount}):-t.gambleAmount:h(t)?He(r.map((e=>e===f?p:e))):g(t)?2*He(r):v(t)||y(t)?He(r,9):He(r)},Ye=(e,t)=>{let{goal:r,gamble:n}=t;return Ze(e,N)>=r?He(e)+n:-n},Ze=(e,t)=>e.filter((e=>e===t)).length,He=(e,t)=>{const{score:r,perfectBonus:n}=Ke(e,t);return r+n},Ke=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=0,n=0;const o=Xe(e);return Object.values(o).forEach((e=>{3===e&&(r+=100),4===e&&(r+=200),5===e&&(r+=500),6===e&&(r+=1e3),7===e&&(r+=2e3),8===e&&(r+=4e3),e>2&&(n+=e)})),e.forEach((e=>{e===b&&(r+=100,o[b]<3&&(n+=1)),e===C&&(r+=100,o[C]<3&&(n+=1))})),{score:r,perfectBonus:n===t?500:0}},Xe=e=>{const t={};return e.forEach((e=>{t.hasOwnProperty(e)?t[e]++:t[e]=1})),t},({useMemo:Je}=r),Ve=function(){let{cardIds:e=D()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.map((e=>S(e)))},_e=function(){let{currentPlayerId:e=k(),players:t=x()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.find((t=>t.id===e))},Qe=function(){let{rollCount:e=R()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===e},et=function(){let{rollCount:e=R()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>0},tt=function(){let{rollCount:e=R()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1===e},rt=function(){let{dices:e=A(),chestSlots:t=I()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).reduce(((r,n)=>{const o=Ge(t[n],e);return o?[...r,o]:r}),[])},nt=function(){let{skullCountInCursedArea:e=ut()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 3-e},ot=function(){let{dicesToCurse:e=at()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.length>0},lt=function(){let{chestSlots:e=I()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce(((t,r)=>{const n=e[r];return n&&"dice"===n.type?[...t,n.value]:t}),[])},at=function(){let{dices:e=A(),diceRolledIds:t=O(),witchUncursedDiceId:r=E(),remainingSpotInCursedArea:n=nt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=t.map((t=>e[t])).filter((e=>!!M(e)&&e.id!==r)).slice(0,n);return o},st=function(){let{currentCardId:e=P(),hasNeverRolled:t=Qe(),scoreMarked:r=$(),threeSkullsOrMoreInCursedArea:n=dt(),hasDicesToCurse:o=ot()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!e&&(!r&&(!!t||(n?!!B(S(e)):!o)))},ct=function(){let{dicesToCurse:e=at(),skullCountInCursedArea:t=ut()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=e.length,n=r+t;return n},it=function(){let{cursedCount:e=ct()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>2},dt=function(){let{skullCountInCursedArea:e=ut()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>2},ut=function(){let{diceCursedIds:e=L(),symbolsFromCard:t=mt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.length+t.filter((e=>w(e))).length},mt=function(){let{currentCardId:e=P()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)return[];const t=S(e);return v(t)?[C]:y(t)?[b]:q(t)?[j]:T(t)?[j,j]:[]},ht=function(){let{hasRolledOnce:e=et(),scoreMarked:t=$(),currentCardId:r=P(),hasDicesToCurse:n=ot()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!t&&(!n&&(!!r&&!!e))},ft=function(){let{scoreMarked:e=$(),currentCardId:t=P(),threeSkullsOrMoreInCursedArea:r=dt(),hasDicesToCurse:n=ot()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e&&(r?!!B(S(t)):!n&&!!t)},pt=function(){let{rollDiceAllowed:e=st(),markScoreAllowed:t=ft(),hasDicesToCurse:r=ot()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e&&(!t&&!r)},gt=function(){let{currentCardId:e=P(),symbolsInChest:t=rt(),scoreMarked:r=$(),markScoreAllowed:n=ft()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Je((()=>We({card:S(e),symbolsInChest:t,scoreMarked:r,markScoreAllowed:n})),[e,t,r,n])},vt=()=>{const e=P(),t=S(e),r=rt(),n=Ze(r,N),o=yt();return!!m(t)&&n<o},yt=function(){let{currentCardId:e=P()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=S(e);return m(t)?t.numberOfSwords:null},bt=d(((e,t)=>l(l({},e),{},{currentPlayerId:t.id,currentCardId:null,currentCardActivated:!1,roundStarted:!0},St))),Ct=d((e=>l(l({},e),{},{currentCardId:null,currentCardActivated:!1,roundStarted:!1}))),Nt=d((e=>l(l({},e),{},{currentCardActivated:!0}))),kt=d((e=>l(l({},e),{},{isOnSkullIsland:!0}))),xt=d(((e,t)=>{const{players:r,currentPlayerId:n}=e,o=r.find((e=>{let{id:t}=e;return t===n})),a=o.score+t;return o.score=a<0?0:a,l(l({},e),{},{players:[...r],scoreMarked:!0})})),St={witchUncursedDiceId:null,witchCardEffectUsed:!1,rollCount:0,diceRolledIds:[],diceCursedIds:[],chestSlots:{1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null},scoreMarked:!1,isOnSkullIsland:!1},wt=d(((e,t,r,n)=>{let{x:o,y:a}=r;const{dices:s}=e;return t.rolledAreaPosition={x:o,y:a},t.rolledAreaZIndex=n,l(l({},e),{},{dices:l({},s)})})),Dt=d(((e,t,r)=>{const{chestSlots:n}=e,o=Object.keys(n).find((e=>{const r=n[e];return r&&"dice"===r.type&&r.value===t.id}));return l(l({},e),{},{chestSlots:l(l(l({},n),o?{[o]:null}:{}),{},{[r]:{type:"dice",value:t.id}})})})),Rt=d(((e,t)=>{const{diceRolledIds:r,diceCursedIds:n}=e;return l(l({},e),{},{diceRolledIds:r.filter((e=>e!==t.id)),diceCursedIds:[...n,t.id]})})),At=d((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{diceRolledIds:n,diceCursedIds:o}=e;return l(l(l({},e),r?{}:{witchUncursedDiceId:t.id,witchCardEffectUsed:!0}),{},{diceRolledIds:[...n,t.id],diceCursedIds:o.filter((e=>e!==t.id))})})),It=d(((e,t)=>{const{diceRolledIds:r,chestSlots:n}=e,o=Object.keys(n).find((e=>{const r=n[e];return r&&"dice"===r.type&&r.value===t.id}));return l(l({},e),{},{diceRolledIds:[...r,t.id],chestSlots:l(l({},n),{},{[o]:null})})})),Ot=d(((e,t,r)=>{const{diceRolledIds:n,chestSlots:o}=e;return l(l({},e),{},{diceRolledIds:n.filter((e=>e!==t.id)),chestSlots:l(l({},o),{},{[r]:{type:"dice",value:t.id}})})})),({useEffect:Et}=r),Mt=()=>(Lt(),null),Lt=()=>{Pt(),qt(),jt()},Pt=()=>{const e=U(),t=at(),r=Rt();Et((()=>{if(0===t.length)return()=>{};if(e)return t.forEach((e=>{r(e)})),()=>{};const n=setTimeout((()=>{t.forEach((e=>{r(e)}))}),1e3);return()=>{clearTimeout(n)}}),[t])},qt=()=>{const e=S(P()),t=$(),r=xt(),n=dt(),o=Oe((e=>!e&&n),[n]),l=gt(),a=m(e);Et((()=>{a&&!t&&o&&r(l)}),[a,t,o,l])},jt=()=>{const e=tt(),t=S(P()),r=F(),n=ut(),o=kt();Et((()=>{e&&(r||m(t)||n<4||o())}),[e,r,t,n])},Tt=d((e=>{const{cardIds:t,cardUsedIds:r}=e,n=t[0];return l(l({},e),{},{cardIds:t.slice(1),cardUsedIds:[...r,n],currentCardId:n})})),$t=d((e=>{const{chestSlots:t}=e;return l(l({},e),{},{chestSlots:l(l({},t),{},{1:{type:"symbol",value:C}})})})),Bt=d((e=>{const{chestSlots:t}=e;return l(l({},e),{},{chestSlots:l(l({},t),{},{1:{type:"symbol",value:b}})})})),Ut=d((e=>{const{cardIds:t,cardUsedIds:r}=e;return l(l({},e),{},{cardIds:z([...t,...r]),cardUsedIds:[]})})),Ft=()=>(zt(),Gt(),null),zt=()=>{const e=$t(),t=P(),n=G(),o=Oe((e=>!e===n),[n]),l=t&&v(S(t));r.useEffect((()=>{l&&e()}),[]),r.useEffect((()=>{o&&l&&e()}),[o,l])},Gt=()=>{const e=Bt(),t=P(),n=G(),o=Oe((e=>!e===n),[n]),l=t&&y(S(t));r.useEffect((()=>{l&&e()}),[]),r.useEffect((()=>{o&&l&&e()}),[o,l])},Wt=()=>{let e=[];return{listen:function(t){let{once:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r){const e=t;t=function(){o(),e(...arguments)}}e=[...e,t];let n=!1;const o=()=>{if(n)return;n=!0;const r=[];let o=e.length,l=!0;for(;o--;){const n=e[o];l&&n===t?l=!1:r.push(n)}e=r};return o},emit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e.forEach((e=>{e(...r)}))}}},Yt=()=>{const[e]=r.useState((()=>Wt()));return[e.listen,e.emit]},Zt=e=>{const[t,n]=r.useState();return r.useEffect((()=>e(n)),[]),t},Ht=e=>{let{rolledAreaRef:t,offscreenRef:r,diceOverRolledAreaListener:n}=e;const a=Zt(n);return c("div",{className:"dice-ongoing",children:[o("div",{className:"map"}),o("div",{className:"area",ref:t,style:l({},a?{outline:"2px dotted"}:{})}),o("div",{className:"offscreen-area",ref:r})]})},Kt=e=>{let{duration:t=300,timingFunction:r=(e=>e),onProgress:n=(()=>{}),onCancel:o=(()=>{}),onComplete:l=(()=>{})}=e;if(isNaN(t))return console.warn(`duration must be a number, received ${t}`),()=>{};t=parseInt(t,10);const a=performance.now();let s,c=!1,i=0,d=0;const u=()=>{s=null;const e=performance.now();i=Math.min((e-a)/t,1),d=r(i),c=1===i,n({done:c,rawProgress:i,progress:d}),c?l():s=window.requestAnimationFrame(u)};u();return()=>{s&&(window.cancelAnimationFrame(s),s=null),c||(c=!0,o({rawProgress:i,progress:d}))}},Xt=function(e){let{duration:t=300,timingFunction:n,condition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[l,a]=r.useState(null);return Jt(e,((e,r)=>(a({value:e}),Kt({duration:t,timingFunction:n,onProgress:t=>{let{progress:n}=t;const o=Math.round(e+(r-e)*n);a({value:o})},onComplete:()=>{a(null)}}))),{condition:o}),l},Jt=function(e,t){let{condition:n=(()=>!0)}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[o,l]=r.useState(null),a=Me(e);r.useEffect((()=>{a!==e&&n(e,a)&&l({from:a,to:e})}),[a,e]),r.useEffect((()=>o?t(o.from,o.to):()=>{}),[o])},Vt=e=>{let{value:t,duration:r,condition:n}=e;const o=Xt(t,{duration:r,condition:n});return o?o.value:t},_t=["useCount"],Qt=["useCount"],er=e=>{let{href:t,onLoad:n=(()=>{})}=e;const[o,l]=s(t);return r.useEffect((()=>(o(),rr(t,{onload:()=>{l(),n()}}))),[t]),null},tr=e=>{const t=new Map,r=e=>{if(!t.has(e))return;const r=t.get(e),{useCount:n}=r,o=a(r,_t);n>1?t.set(e,l({useCount:n-1},o)):(t.delete(e),o.linkCleanup())};return function(n){if(t.has(n)){const e=t.get(n),{useCount:o}=e,s=a(e,Qt);return t.set(n,l({useCount:o+1},s)),r}for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];const i=e(n,...s);return t.set(n,{useCount:1,linkCleanup:i}),r}},rr=tr((function(e){let{onload:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=document.createElement("link");r.rel="stylesheet",r.type="text/css";const n=W(r,t);return r.href=e,document.head.appendChild(r),()=>{n(),document.head.removeChild(r)}})),nr=(e,t)=>{const r=cr(e,e);let{done:n,value:o}=r.next();for(;!1===n;){if(t(o))return o;({done:n,value:o}=r.next())}return null},or=(e,t)=>{const r=dr(e);if(r){const n=mr(r,e);let{done:o,value:l}=n.next();for(;!1===o;){if(t(l))return l;({done:o,value:l}=n.next())}}return null},lr=e=>{let{from:t,root:r=null,predicate:n,skipChildren:o=!1}=e;const l=ir(t,r,o);let{done:a,value:s}=l.next();for(;!1===a;){if(n(s))return s;({done:a,value:s}=l.next())}return null},ar=e=>{let{from:t,root:r=null,predicate:n}=e;const o=mr(t,r);let{done:l,value:a}=o.next();for(;!1===l;){if(n(a))return a;({done:l,value:a}=o.next())}return null},sr=function e(t,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n){const e=t.firstChild;if(e)return e}const o=t.nextSibling;if(o)return o;const l=t.parentNode;return l&&l!==r?e(l,r,!0):null},cr=(e,t)=>{let r=e;return{next:()=>{const e=sr(r,t);return r=e,{done:!1===Boolean(e),value:e}}}},ir=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,o=!1;const l=()=>{const e=sr(n,t,r&&!1===o);return o=!0,n=e,{done:!1===Boolean(e),value:e}};return{next:l}},dr=e=>{let t=e.lastChild;for(;t;){const e=t.lastChild;if(!e)break;t=e}return t},ur=(e,t)=>{const r=e.previousSibling;if(r){const e=dr(r);return e||r}if(e!==t){const r=e.parentNode;if(r&&r!==t)return r}return null},mr=(e,t)=>{let r=e;return{next:()=>{const e=ur(r,t);return r=e,{done:!1===Boolean(e),value:e}}}},hr=e=>{const t=nr(e,Y);return t||(Y(e)?e:null)},fr=e=>{if(3===e.nodeType)return console.warn("cannot trap focus inside a text node"),()=>{};if(yr.find((t=>t.element===e)))return console.warn("focus already trapped inside this element"),()=>{};const t=()=>nr(e,gr),r=()=>or(e,gr),n=n=>{const o=document.activeElement===document.body;if(n.shiftKey){const t=o?r():ar({from:document.activeElement,root:e,predicate:gr})||r();t&&t.focus()}else{const r=o?t():lr({from:document.activeElement,root:e,predicate:gr})||t();r&&r.focus()}},o=br({element:e,lock:()=>{const t=t=>{(t=>t.target!==e&&!e.contains(t.target))(t)&&(t.preventDefault(),t.stopImmediatePropagation())},r=e=>{vr(e)&&(e.preventDefault(),n(e))};return document.addEventListener("mousedown",t,{capture:!0,passive:!1}),document.addEventListener("keydown",r,{capture:!0,passive:!1}),()=>{document.removeEventListener("mousedown",t,{capture:!0,passive:!1}),document.removeEventListener("keydown",r,{capture:!0,passive:!1})}}});return()=>{o()}},pr=e=>e.hasAttribute&&e.hasAttribute("tabIndex")&&Number(e.getAttribute("tabindex"))<0,gr=e=>!pr(e)&&Y(e),vr=e=>"Tab"===e.key||9===e.keyCode,yr=[],br=e=>{let t,{lock:r}=e;yr.length>0&&(t=yr[yr.length-1],t.unlock());const n={lock:r,unlock:r()};return yr.push(n),()=>{if(0===yr.length)return void console.warn("cannot deactivate an already deactivated trap");const e=yr[yr.length-1];n===e?(yr.pop(),n.unlock(),t&&(t.unlock=t.lock())):console.warn("you must deactivate trap in the same order they were activated")}},Cr=e=>{const t=[];let r=e.previousSibling;for(;r;)1===r.nodeType&&Or(r)&&t.push(r),r=r.previousSibling;const n=Nr(e);t.push(...n);const o=t.map((e=>{const t=e.style.overflow;return e.style.overflow="hidden",()=>{t?e.style.overflow=t:e.style.removeProperty("overflow")}}));return()=>{o.forEach((e=>{e()}))}},Nr=e=>{const t=[],r=e=>{const n=kr(e);if(n){if(t.push(n),n===document)return;r(n)}};return r(e),t},kr=e=>{if("object"!=typeof e||1!==e.nodeType)throw new TypeError("getScrollableParent first argument must be DOM node");const t=e;if(t===document.documentElement)return null;return"fixed"===Z(t,"position")?xr(t.ownerDocument):Lr(t)||xr(t.ownerDocument)},xr=e=>{if("scrollingElement"in e)return e.scrollingElement;if(Ar(e))return e.documentElement;const t=e.body,r=t&&!/body/i.test(t.tagName)?Sr(t):t;return r&&Dr(r)?null:r},Sr=e=>{let t=e;for(;t=t.nextSibling;)if(1===t.nodeType&&wr(t))return t;return null},wr=e=>e.ownerDocument.body===e,Dr=e=>{if(!Or(e))return!1;if(Rr(e))return!1;const t=e.ownerDocument.documentElement;return!!Or(t)&&!Rr(t)},Rr=e=>{const t=Z(e,"display");return"none"!==t&&("table-row"!==t&&"table-group"!==t&&"table-column"!==t||"collapsed"!==Z(e,"visibility"))},Ar=e=>!!/^CSS1/.test(e.compatMode)&&Ir(e),Ir=e=>{const t=e.createElement("iframe");t.style.height="1px";(e.body||e.documentElement||e).appendChild(t);const r=t.contentWindow.document;r.write('<!DOCTYPE html><div style="height:9999em">x</div>'),r.close();const n=r.documentElement.scrollHeight>r.body.scrollHeight;return t.parentNode.removeChild(t),n},Or=e=>!Er(e)||!Mr(e),Er=e=>{if("visible"===Z(e,"overflow-x"))return!0;return"visible"===Z(e,"overflow")},Mr=e=>{if("visible"===Z(e,"overflow-y"))return!0;return"visible"===Z(e,"overflow")},Lr=e=>{if(e===document.documentElement)return null;const t=Z(e,"position");let r=e.parentNode;for(;r;){if(H(r))return null;if("absolute"!==t||"static"!==Z(r,"position")){if(Or(r))return r;r=r.parentNode}else r=r.parentNode}return null},Pr=["container","insertTop","insertLeft","insertRight","insertBottom","children","isOpen","requestCloseOnEscape","requestCloseOnClickOutside","closeMethod","stealFocus","restoreStolenFocus","trapFocus","onAfterOpen","onRequestClose","onFocusIn","onFocusOut","backdropProps"],qr=["onMouseDownActive"],jr=new URL(__v__("/css/dialog.base.css"),t.meta.url),({useEffect:Tr}=r),$r=e=>{let{container:t=document.body,insertTop:n,insertLeft:s,insertRight:i,insertBottom:d,children:u,isOpen:m,requestCloseOnEscape:h=!0,requestCloseOnClickOutside:f=!1,closeMethod:p="display-none",stealFocus:g=!0,restoreStolenFocus:v=!0,trapFocus:y=!0,onAfterOpen:b=(()=>{}),onRequestClose:C=(()=>{}),onFocusIn:N=(()=>{}),onFocusOut:k=(()=>{}),backdropProps:x={}}=e,S=a(e,Pr);if(!t)return null;const[w,D]=r.useState(null),R=Boolean(w);return Oe((e=>!e&&m),[m])&&b(),Tr((()=>{if(!m||!R)return()=>{};let e=Ur(w);const t=t=>{t.relatedTarget||e&&(e=!1,k(t))},r=t=>{N(t),e=!0},n=t=>{Ur(w)?e=!0:(e=!1,k(t))};return w.addEventListener("focus",r,!0),document.addEventListener("focus",n,!0),document.addEventListener("blur",t,!0),()=>{w.removeEventListener("focus",r,!0),document.removeEventListener("focus",n,!0),document.removeEventListener("blur",t,!0)}}),[m,R,N,k]),Tr((()=>m&&R?Cr(w):()=>{}),[m,R]),Tr((()=>m&&R&&y?fr(w):()=>{}),[m,R,y]),Tr((()=>{if(!m||!R||!g)return()=>{};const e=document.activeElement,t=hr(w);return t&&t.focus({preventScroll:!0}),()=>{t&&("function"==typeof v?v(e):!0===v&&e.focus({preventScroll:!0}))}}),[m,R,g]),Tr((()=>{if(!m||!w||!w.parentNode)return()=>{};const e=[];return Array.from(w.parentNode.children).forEach((t=>{t!==w&&e.push(t)})),e.forEach((e=>{e.setAttribute("aria-hidden","true")})),()=>{e.forEach((e=>{e.removeAttribute("aria-hidden","true")}))}}),[m,w]),"dom-remove"!==p||m?K.createPortal(c("div",l(l({},S),{},{role:"dialog",className:"dialog--root"+(S.className?` ${S.className}`:""),ref:e=>{D(e),S.ref&&S.ref(e)},onKeyDown:e=>{h&&e.keyCode===Fr&&C(e),S.onKeyDown&&S.onKeyDown(e)},tabIndex:"-1",style:l(l({},"display-none"!==p||m?{}:{display:"none"}),"visibility-hidden"!==p||m?{}:{visibility:"hidden"}),hidden:"hidden-attribute"===p&&!m||void 0,children:[o(er,{href:jr}),m?o(Br,l(l({},x),{},{className:"dialog--backdrop",onMouseDownActive:e=>{if(e.preventDefault(),!Ur(w)){const e=hr(w);e&&e.focus({preventScroll:!0})}},onClick:e=>{f&&C(e),x.onClick&&x.onClick(e)}})):null,c("div",{className:"dialog--document",children:[o("div",{className:"dialog--insert-top",children:n}),c("div",{className:"dialog--main",children:[o("div",{className:"dialog--insert-left",children:s}),o("div",{className:"dialog--scrollable-content",children:u}),o("div",{className:"dialog--insert-right",children:i})]}),o("div",{className:"dialog--insert-bottom",children:d})]})]})),t):null},Br=e=>{let{onMouseDownActive:t}=e,n=a(e,qr);const[s,c]=r.useState(null);return Tr((()=>s?(s.addEventListener("mousedown",t,{passive:!1}),()=>{s.removeEventListener("mousedown",t,{passive:!1})}):()=>{}),[s]),o("div",l({ref:e=>{c(e),n.ref&&n.ref(e)}},n))},Ur=e=>{const{activeElement:t}=document;return e===t||e.contains(t)},Fr=27,zr=new URL(__v__("/css/dialog.css"),t.meta.url),Gr=e=>c(X,{children:[o(er,{href:zr}),o($r,l({container:J()},e))]}),Wr=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const[t,n]=r.useState(e),o=()=>{n(!0)},l=()=>{n(!1)};return[t,o,l]},Yr=()=>c("div",{className:"star-rain-container",children:[o("div",{className:"star",id:"star-01",children:o(Zr,{})}),o("div",{className:"star",id:"star-02",children:o(Zr,{})}),o("div",{className:"star",id:"star-03",children:o(Zr,{})}),o("div",{className:"star",id:"star-04",children:o(Zr,{})}),o("div",{className:"star",id:"star-05",children:o(Zr,{})}),o("div",{className:"star",id:"star-06",children:o(Zr,{})})]}),Zr=()=>o("svg",{viewBox:"0 0 217.791 210.633",children:o("path",{fill:"#FFFFE6",d:"M94.15,77.97c0,0-2-54,10-73.5s23,28.5,25.5,72.5c0,0,69.197,4.589,86.5,21c13.637,12.934-61.5,31-87,33.5 c-2,14.5-1.831,60.464-16.5,75.5c-20,20.5-25.5-50.5-23-78c-19-1.5-81.5-3.5-89-17.5S52.15,85.97,94.15,77.97z"})}),Hr=()=>o("svg",{viewBox:"0 0 320 512",width:"32",heiht:"32",children:o("path",{fill:"currentColor",d:"M207.6 256l107.72-107.72c6.23-6.23 6.23-16.34 0-22.58l-25.03-25.03c-6.23-6.23-16.34-6.23-22.58 0L160 208.4 52.28 100.68c-6.23-6.23-16.34-6.23-22.58 0L4.68 125.7c-6.23 6.23-6.23 16.34 0 22.58L112.4 256 4.68 363.72c-6.23 6.23-6.23 16.34 0 22.58l25.03 25.03c6.23 6.23 16.34 6.23 22.58 0L160 303.6l107.72 107.72c6.23 6.23 16.34 6.23 22.58 0l25.03-25.03c6.23-6.23 6.23-16.34 0-22.58L207.6 256z"})}),Kr=["title","spacingClasses","children"],Xr=e=>{let{title:t,spacingClasses:r,children:n}=e,s=a(e,Kr);return o(Gr,l(l({requestCloseOnClickOutside:!0,insertTop:c(X,{children:[o("div",{className:"dialog-border-top"}),o("div",{className:"dialog-title",children:o("div",{className:"dialog-title-text",children:t})}),o("div",{className:"dialog-close",onClick:s.onRequestClose,children:o(Hr,{})})]}),insertBottom:o("div",{className:"dialog-border-bottom"}),insertLeft:o("div",{className:"dialog-border-left"}),insertRight:o("div",{className:"dialog-border-right"})},s),{},{className:`dialog-theme-wood ${r||"dialog-spacing-10 dialog-spacing-fluid dialog-spacing-top-fixed"} ${s.className}`,children:n}))},Jr=e=>{let{dialogIsOpen:t,closeDialog:r}=e;return o(Xr,{className:"score-rules-dialog",isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0,title:"Score",spacingClasses:"dialog-spacing-10 dialog-spacing-fixed",children:c(X,{children:[c("div",{className:"dialog-box",children:[o("div",{className:"dialog-label",children:"Combinaisons de dés"}),c("div",{className:"columns",children:[c("div",{className:"column",children:[o("div",{className:"column-title",children:"Symbols identiques"}),o("span",{className:"symbol-number",children:"Combo 3"}),o("span",{className:"symbol-number",children:"Combo 4"}),o("span",{className:"symbol-number",children:"Combo 5"}),o("span",{className:"symbol-number",children:"Combo 6"}),o("span",{className:"symbol-number",children:"Combo 7"}),o("span",{className:"symbol-number",children:"Combo 8"})]}),c("div",{className:"column",children:[o("div",{className:"column-title",children:"Points"}),o("span",{className:"points",children:"100"}),o("span",{className:"points",children:"200"}),o("span",{className:"points",children:"500"}),o("span",{className:"points",children:"1000"}),o("span",{className:"points",children:"2000"}),o("span",{className:"points",children:"4000"})]})]})]}),c("div",{className:"dialog-box",children:[o("div",{className:"dialog-label",children:"Dés spéciaux"}),c("div",{className:"columns",children:[c("div",{className:"column",children:[o("div",{className:"column-title",children:"Symbol"}),o(qe,{src:V}),o(qe,{src:_})]}),c("div",{className:"column",children:[o("div",{className:"column-title",children:"Points"}),o("span",{className:"points",children:"100"}),o("span",{className:"points",children:"100"})]})]})]}),c("div",{className:"dialog-box last",children:[o("div",{className:"dialog-label",children:"Bonus coffre parfait"}),c("div",{className:"columns",children:[c("div",{className:"column",children:[o("div",{className:"column-title",children:"Dés utilisés"}),o("span",{className:"symbol-number",children:"8"})]}),c("div",{className:"column",children:[o("div",{className:"column-title",children:"Points"}),o("span",{className:"points",children:"500"})]})]})]})]})})},Vr=["id","value"],_r=function(){let{totalScore:e=0,onScoreParticleAdded:t=(()=>{}),onScoreParticleRemoved:n=(()=>{}),onScoreParticleMerged:o=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[s,c]=r.useState(e),[i,d]=r.useState([]);r.useEffect((()=>{c(e)}),[e]);const u=e=>{d((t=>[...t,e])),t(e);let r=!1;return()=>{r||(r=!0,d((t=>t.filter((t=>t!==e)))),c((t=>t-e.value)),n(e))}},m=e=>{let{id:t,value:r}=e,n=a(e,Vr);const s=l(l({id:t,value:r},n),{},{oncancel:()=>{i()},onfinish:()=>{i(),o(s),c((e=>e+r))}}),i=u(s);return i},h=i.reduce(((e,t)=>e+t.value),0),f=s-h;return[i,m,f]},Qr=(e,t,r)=>{const n=nn(r),o=Math.cos(n),l=Math.sin(n),a=t.x-e.x,s=t.y-e.y;return{x:Math.round(o*a+l*s+e.x),y:Math.round(o*s-l*a+e.y)}},en=(e,t)=>{const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)},tn=e=>{let[t,r,n,o]=e;return{x:(t.x+r.x+n.x+o.x)/4,y:(t.y+r.y+n.y+o.y)/4}},rn=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tn(e);return e.map((e=>Qr(r,e,t)))},nn=e=>e*Math.PI/180,on=(e,t)=>{let[r,n]=e,[o,l]=t,a=(l.x-o.x)*(r.y-o.y)-(l.y-o.y)*(r.x-o.x),s=(n.x-r.x)*(r.y-o.y)-(n.y-r.y)*(r.x-o.x);const c=(l.y-o.y)*(n.x-r.x)-(l.x-o.x)*(n.y-r.y);if(0===a&&0===s&&0===c)return!1;if(0===c)return!1;a/=c,s/=c;return a>=0&&a<=1&&s>=0&&s<=1},ln=(e,t)=>sn(e,(e=>an(e,t))),an=(e,t)=>!!sn(t,(t=>on(e,t))),sn=(e,t)=>{let[r,n,o,l]=e;if(t([r,n]))return!0;if(t([n,o]))return!0;if(t([o,l]))return!0;return!!t([l,r])},cn=(e,t)=>!(e.right<=t.left)&&(!(e.left>=t.right)&&(!(e.bottom<=t.top)&&!(e.top>=t.bottom))),dn=(e,t)=>{let r=e.left,n=e.right;const o=n-r;r<t.left?(r=t.left,n=r+o):n>t.right&&(r=t.right-o,n=r+o);let l=e.top,a=e.bottom;const s=a-l;return l<t.top?(l=t.top,a=l+s):a>t.bottom&&(l=t.bottom-s,a=l+s),{left:r,right:n,top:l,bottom:a}},un=(e,t)=>{const r=e.left-t.left,n=r+(e.right-e.left),o=e.top-t.top;return{left:r,right:n,top:o,bottom:o+(e.bottom-e.top)}},mn=(e,t)=>{let r=fn(t,e[0]);return e.reduce(((e,n)=>{const o=fn(t,n);return o<r?(r=o,n):e}))},hn=e=>{let{left:t,right:r,top:n,bottom:o}=e;return{x:t+(r-t)/2,y:n+(o-n)/2}},fn=(e,t)=>{const r=hn(e),n=hn(t);return en(r,n)},pn=e=>{const t=e.getBoundingClientRect(),r=Q(e),n=t.left+r.x,o=t.top+r.y,l=n+t.width,a=o+t.height;return{left:Math.floor(n),top:Math.floor(o),right:Math.floor(l),bottom:Math.floor(a)}},gn=(e,t)=>{const r=pn(t);return dn(e,r)},vn=(e,t)=>{const r=pn(t),n=dn(e,r);return un(n,r)},yn=(e,t)=>{const r=pn(t),n=e.right-e.left,o=e.bottom-e.top;return{left:r.left+e.left,top:r.top+e.top,right:r.left+e.left+n,bottom:r.top+e.top+o}},bn=(e,t)=>{const r=pn(e);return cn(r,t)},Cn=(e,t)=>{const r=e.map((e=>pn(e))),n=mn(r,t);return e[r.indexOf(n)]},Nn=function(e){let{x:t,y:r}=e,{color:n="yellow",autoRemove:o=!0,autoRemoveAfter:l=2e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=document.createElement("div");a.style.position="absolute",a.style.zIndex="1000",a.style.left=`${t}px`,a.style.top=`${r}px`,a.style.width="5px",a.style.height="5px",a.style.background=n,a.style.border="1px solid red",document.body.appendChild(a);const s=()=>{document.body.removeChild(a)};let c;return o&&(c=setTimeout(s,l)),()=>{s(),clearTimeout(c)}},kn=e=>{let{totalScoreDomNodeRef:t,scoreParticle:r,animationDelayGetter:n=(()=>0)}=e;return"bonus"===r.type?o(xn,{totalScoreDomNodeRef:t,scoreParticle:r,animationDelayGetter:n}):"combo"===r.type?o(Sn,{scoreParticle:r,animationDelayGetter:n}):o(wn,{scoreParticle:r,animationDelayGetter:n})},xn=e=>{let{totalScoreDomNodeRef:t,scoreParticle:n,animationDuration:l=800,animationDelayGetter:a}=e;const s=ee(n.symbol),i=r.useRef();return r.useEffect((()=>{const e=i.current,r=t.current,o=In(document.querySelector(`[data-chest-slot="${n.chestSlot}"]`));return Dn({particleDomNode:e,totalScoreDomNode:r,x:o.x,y:o.y,duration:l,delay:a(),onfinish:n.onfinish,oncancel:n.oncancel})}),[]),c("svg",{ref:i,width:"32",height:"32",className:"score-particle--symbol",children:[o("image",{href:s,width:"32",height:"32"}),","]})},Sn=e=>{let{scoreParticle:t,animationDuration:n=800,animationDelayGetter:l}=e;const[a,s]=An();return r.useEffect((()=>{const e=a.current,r=In(document.querySelector(".chest .box"));return Rn({particleDomNode:e,x:r.x,y:r.y,duration:n,delay:l(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),o("svg",{ref:a,className:"score-particle--perfect",children:o("g",{ref:s,children:c("text",{x:"0",y:"0",dominantBaseline:"text-before-edge",children:["Combo ",t.symbolCount]})})})},wn=e=>{let{scoreParticle:t,animationDuration:n=800,animationDelayGetter:l}=e;const[a,s]=An();return r.useEffect((()=>{const e=a.current,r=In(document.querySelector(".chest .box"));return Rn({particleDomNode:e,x:r.x,y:r.y,duration:n,delay:l(),onfinish:t.onfinish,oncancel:t.oncancel})}),[]),o("svg",{ref:a,className:"score-particle--combo",children:o("g",{ref:s,children:o("text",{x:"0",y:"0",dominantBaseline:"text-before-edge",children:"Coffre parfait"})})})},Dn=e=>{let{particleDomNode:t,totalScoreDomNode:r,x:n,y:o,duration:l,delay:a,onfinish:s=(()=>{}),oncancel:c=(()=>{})}=e;const i=pn(t),d=pn(r),u=i.right-i.left,m=i.bottom-i.top,h=n-u/2,f=o-m/2,p=h,g=f-1.1*m,v=d.left,y=d.top;t.style.left=`${h}px`,t.style.top=`${f}px`;const b=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.6,opacity:1,transform:`translate(${p-h}px, ${g-f}px)`},{transform:`translate(${v-h}px, ${y-f}px)`}],{duration:l,delay:a,fill:"forwards"});return b.onfinish=()=>{s()},()=>{c(),b.cancel()}},Rn=e=>{let{particleDomNode:t,x:r,y:n,duration:o,delay:l,onfinish:a=(()=>{}),oncancel:s=(()=>{})}=e;const c=pn(t),i=r-(c.right-c.left)/2,d=n-(c.bottom-c.top)/2;t.style.left=`${i}px`,t.style.top=`${d}px`;const u=t.animate([{opacity:0,visibility:"visible",transform:"translate(0px, 0px)"},{offset:.1,opacity:1},{offset:.4,opacity:1,transform:"scale(1.2)"},{}],{duration:o,delay:l,fill:"forwards"});return u.onfinish=()=>{a()},()=>{s(),u.cancel()}},An=()=>{const e=r.useRef(),t=r.useRef();return r.useLayoutEffect((()=>{const r=e.current,n=t.current.getBBox();r.setAttribute("width",Math.ceil(n.width)),r.setAttribute("height",Math.ceil(n.height))}),[]),[e,t]},In=e=>{const t=pn(e);return hn(t)},On=e=>{let{addScoreParticle:t}=e;En({addScoreParticle:t}),Mn({addScoreParticle:t}),Pn({addScoreParticle:t}),Ln({addScoreParticle:t})},En=e=>{let{addScoreParticle:t}=e;const r=I(),n=A(),o=vt();Object.keys(r).forEach((e=>{const l=r[e],a=Ge(l,n),s=a&&oe(a);Ie((()=>{if(!o&&s)return t({id:`chest-slot-${e}-coin`,type:"bonus",value:100,symbol:C,chestSlot:e})}),[o,s])}))},Mn=e=>{let{addScoreParticle:t}=e;const r=I(),n=A(),o=vt();Object.keys(r).forEach((e=>{const l=r[e],a=Ge(l,n),s=a&&le(a);Ie((()=>{if(!o&&s)return t({id:`chest-slot-${e}-diamond`,type:"bonus",value:100,symbol:b,chestSlot:e})}),[o,s])}))},Ln=e=>{let{addScoreParticle:t}=e;const n=I(),o=A(),l=vt(),a=r.useMemo((()=>{const e=[];Object.keys(n).forEach((t=>{const r=n[t];if(!r)return;"dice"===r.type&&e.push(Ge(r,o))}));const{perfectBonus:t}=Ke(e);return Boolean(t)}),[n,o]);Ie((()=>{if(!l&&a)return t({id:"perfect",type:"perfect",value:500})}),[l,a])},Pn=e=>{let{addScoreParticle:t}=e;const n=I(),o=A(),l=P(),a=S(l),s=vt();te.forEach((e=>{const l=[];Object.keys(n).forEach((t=>{const r=n[t],s=Ge(r,o);s&&qn(s,e,a)&&l.push(t)}));const c=l.length,i=jn[c]||0,d=r.useRef(i),u=r.useRef((()=>{}));Ie((()=>{const r=d.current,n=Boolean(r&&i&&r<i),o=Boolean(r&&i&&r>i);if(d.current=i,h(a)&&ne(e))return;if(s)return;if(!i)return;if(o)return void u.current();n&&u.current();const m=t({id:`${c}-${e}-combo`,type:"combo",value:i-r,symbol:e,symbolCount:c});u.current=m;const f=l.map((e=>{const t=(document.querySelector(`[data-chest-slot="${e}"] image`)||document.querySelector(`[data-chest-slot="${e}"] img`)).animate([{transform:"scale(1)",transformOrigin:"center center"},{transform:"scale(1.2)",transformOrigin:"center center"},{transform:"scale(1)",transformOrigin:"center center"}],{duration:400});return()=>{t.cancel()}}));return()=>{m(),f.forEach((e=>{e()}))}}),[s,a,i])}))},qn=(e,t,r)=>{if(e===t)return!0;if(h(r)){if(re(e)&&ne(t))return!0;if(ne(e)&&re(t))return!0}return!1},jn={3:100,4:200,5:500,6:1e3,7:2e3,8:4e3},({useState:Tn,useEffect:$n}=r),Bn=()=>{const e=S(P()),t=Un();return o("div",{className:"score-area "+(t?"animated":""),children:e?o(Fn,{}):null})},Un=()=>{const e=S(P()),t=rt(),r=Ze(t,N),n=yt();if(!m(e))return!1;return!(r>=n)},Fn=()=>{const e=S(P()),t=$(),r=Un(),[n,l,a]=Wr(),s=U();return c(X,{children:[g(e)?o(Hn,{}):null,t?o(Yr,{}):null,o("button",{className:"round-score "+(r?"hidden":""),onClick:l,children:o(s?Wn:zn,{})}),m(e)?o(Kn,{}):null,o(Jr,{dialogIsOpen:n,closeDialog:a})]})},zn=()=>{const e=gt(),t=r.useRef(),[n,l]=Yt(),[a,s,i]=_r({totalScore:e,onScoreParticleMerged:l});On({addScoreParticle:s}),Yn({roundScoreDomNodeRef:t,scoreParticleMergedListener:n});const d=r.useRef(null),u=()=>{const e=d.current,t=Gn(e,600);return d.current=Date.now()+t,t};return c(X,{children:[o("span",{ref:t,className:"round-score--value",children:o(Vt,{value:i,condition:(e,t)=>e>t,duration:600})}),a.map((e=>o(kn,{totalScoreDomNodeRef:t,scoreParticle:e,animationDelayGetter:u},e.id)))]})},Gn=(e,t)=>{if(!e)return 0;const r=t-(Date.now()-e);return r<=0?0:r},Wn=()=>{const e=gt();return o("span",{className:"round-score--value",children:e})},Yn=e=>{let{roundScoreDomNodeRef:t,scoreParticleMergedListener:n}=e;const o=Zt(n);r.useEffect((()=>{if(!o)return;const e=t.current;return Zn({roundScoreDomNode:e})}),[o])},Zn=e=>{let{roundScoreDomNode:t,duration:r=500,easing:n="ease-in-out"}=e;const o=t.animate([{transform:"scale(1.8)"}],{duration:r,easing:n});return()=>{o.cancel()}},Hn=()=>{const e=G();return o("div",e?{className:"pirate-hook"}:{style:{display:"none"},className:"pirate-hook"})},Kn=()=>{const e=gt(),t=rt(),r=Ze(t,N),n=yt(),l=new Array(n).fill(""),a=r>=n,s=Oe((e=>e<r),[r]),[i,d]=Tn(!1);return $n((()=>{s&&d(!0)}),[s]),$n((()=>{if(i){const e=setTimeout((()=>{d(!1)}),300);return()=>{clearTimeout(e)}}return()=>{}}),[i]),c(X,{children:[o("div",{className:"ropes "+(a?"challenge-won":""),children:l.map(((e,t)=>o("div",r>=t+1?{className:`rope rope-${t+1} cut-rope`}:{className:`rope rope-${t+1}`},t)))}),i&&r<=n?c("div",{className:"sword-slice",children:[o("div",{className:"triangle-left"}),o("div",{className:"triangle-right"})]}):null,o("div",{className:`negative-round-score rotate-${r} ${a?"removed":""}`,children:e})]})},Xn=50,Jn=new URL(__v__("/other/cursed-grid.png"),t.meta.url),Vn=e=>{let{chestRef:t,diceOverChestListener:r}=e;const n=I(),a=dt(),s=Zt(r),i=S(P()),d=a&&B(i);return c("div",{className:"chest",children:[c("div",{ref:t,className:"dice-area "+(B(i)?"glow":""),style:l({},s?{outline:"2px dotted"}:{}),children:[o("div",{className:"box",children:Object.keys(n).map((e=>o("div",{className:"slot","data-chest-slot":e,children:o(_n,{chestSlotContent:n[e]})},e)))}),o("div",{className:"top-left-corner"}),o("div",{className:"top-right-corner"}),o("div",{className:"bottom-left-corner"}),o("div",{className:"bottom-right-corner"}),a&&!d?o(Qn,{}):null]}),o(Bn,{})]})},_n=e=>{let{chestSlotContent:t}=e;const r=S(P());if(!t)return null;if("symbol"===t.type){const e=t.value;return o("button",{className:"dice",style:{width:Xn,height:Xn,color:"#eaeaea",margin:"5px",backgroundColor:r.color1,borderColor:r.color2,borderWidth:"2px",borderStyle:"solid"},children:o(qe,{src:ee(e),draggable:"false",style:{width:"100%",height:"100%"}})})}return null},Qn=()=>o("div",{className:"cursed-cover",children:o(qe,{draggable:"false",src:Jn,alt:"cursed-cover"})}),eo={animals:{name:"Animaux",rule:"Les singes et les perroquest obtenus sur les dés comptent comme un même symbol dans une combinaison.",more:"Par exemple 2 perroquets et 3 singes forment une conbinaison de 5 dés identiques, soit 500 points."},chest:{name:"Coffre au trésor",rule:'Lorsque le joueur sauvegarde ses dés, grâce à la carte "Coffre au trésor" les dés sont protégés du mauvais sort.',more:"Ainsi même lorsque le joueur obtient 3 têtes de morts, son tour prends fin, mais il peut marquer les points totalisés grâce aux dés sauvegardés!"},coin:{name:"Pièce d'or",rule:"Le joueur commence son tour avec un symbol pièce d'or. Il rapporte des points aussi bien dans une combinaison de dés que comme simple pièce (+100)."},diamond:{name:"Diamant",rule:"Le joueur commence son tour avec un symbol diamant. Il rapporte des points aussi bien dans une combinaison de dés que comme simple diamant (+100)."},pirate:{name:"Capitaine des pirates",rule:"Grâce à l'aide du capitaine, tous les points comptabilisés pendant ce tour sont doublés !"},witch:{name:"Sorcière",rule:"Avec ses potions magiques, la sorcière permet exceptionnellement au joueur de relancer, une fois, un dé avec une tête de mort."},"1skull":{name:"Tête de mort",rule:"Le tour du joueur débute avec un symbole tête de mort."},"2skulls":{name:"2 têtes de mort",rule:"Le tour du joueur débute avec 2 symboles tête de mort."},"2sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 2 symbols sabres. Si il y parvient, il gagne +300 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -300 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"3sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 3 symbols sabres. Si il y parvient, il gagne +500 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -500 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."},"4sword-challenge":{name:"Bateau pirate",rule:"Le joueur doit obtenir au minimum 4 symbols sabres. Si il y parvient, il gagne +1000 points, en plus de son résultat aux dés. Si il échoue, le joueur marque -1000 points pour ce tour, quelque soit son résultat aux dés.",more:"Le score total ne peut pas descende en dessous de zéro. Ainsi si par exemple le joueur perds le défi au premier tour il restera à 0 points."}},to=e=>{let{dialogIsOpen:t,closeDialog:r,card:n}=e;const l=eo[n.type];return o(Xr,{className:"card-rules-dialog",isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0,title:"Carte",children:l?c(X,{children:[o("div",{className:"dialog-label",children:l.name}),o("div",{style:{textAlign:"center"},children:o(qe,{className:"current-card",src:ae(n),width:"150",alt:n.type})}),o("div",{className:"text-rule",children:l.rule}),l.more?o("div",{className:"text-rule",children:l.more}):null]}):"No rule"})},ro=["card"],no=(e,t)=>{let{card:r}=e,n=a(e,ro);return o("div",l(l({className:"card current-card",ref:t,width:"55",height:"55",style:{backgroundColor:r.color1,borderColor:r.color2}},n),{},{children:o(qe,{src:se(r),alt:r.type,width:"55",height:"55"})}))},oo=r.forwardRef(no),lo=new URL(__v__("/other/swords-disabled.png"),t.meta.url),ao=()=>{const e=P(),t=rt(),r=yt();if(!e)return null;const n=S(e);if(!m(n))return null;const l=Ze(t,N),a=new Array(r).fill("");return o("div",{className:"sword-challenge-indicators",children:a.map(((e,t)=>o(l>=t+1?so:co,{},t)))})},so=()=>o("div",{className:"sword-icon",children:o(qe,{src:i})}),co=()=>o("div",{className:"sword-icon disabled",children:o(qe,{src:lo})}),io=e=>{let{openScoreboard:t,headerSmallCardRef:r}=e;const n=S(P()),l=G();return c("div",{className:"header",children:[c("div",{className:"card-container",style:{opacity:l?"1":"0"},children:[o("div",{className:"small-card",children:n?o(uo,{headerSmallCardRef:r,currentCard:n}):o(mo,{})}),l&&o(ao,{})]}),o(ho,{openScoreboard:t}),o(fo,{})]})},uo=e=>{let{headerSmallCardRef:t,currentCard:n}=e;const[l,a]=r.useState(!1);return c(X,{children:[o(oo,{onClick:()=>{a(!0)},card:n,ref:t}),o(to,{card:n,dialogIsOpen:l,closeDialog:()=>{a(!1)}})]})},mo=()=>o("div",{className:"card default-card",style:{backgroundImage:`url(${ce})`,backgroundSize:"217px"}}),ho=e=>{let{openScoreboard:t}=e;const r=_e();return o(qe,{onClick:t,className:"avatar",src:r&&r.character.img,alt:"player",style:{borderColor:r&&r.character.color||"white"},width:"55",height:"55"})},fo=()=>{const e=_e(),t=e.score,r=Xt(t,{duration:1200,timingFunction:e=>1-Math.pow(1-e,5)});return o("div",{className:"total-score",children:o("span",{className:"score",style:{backgroundColor:e&&e.character.color||"white"},children:r?r.value:t})})},po=6.25,go=(e,t)=>{let{rolledAreaDomNode:r}=t;const n=pn(r),o=n.right-n.left,l=n.bottom-n.top,a={left:po,right:o-56.25,top:po,bottom:l-56.25},s=[];return e.forEach(((e,t)=>{e.visibleFaceIndex=bo(e);const{rectangle:r,rotation:n,rotatedRectangle:o}=(e=>{let t=0;const r=()=>{const n=vo(e,a),o=yo(),l=rn(n,o);return!s.some((e=>ln(l,e)))||t>50?{rectangle:n,rotation:o,rotatedRectangle:l}:(t++,r())};return r()})(e);s.push(o),e.rolledAreaZIndex=t+1,e.rolledAreaPosition=r[0],e.rotation=n})),e},vo=(e,t)=>{const r={x:Co(t.left,t.right),y:Co(t.top,t.bottom)};return[{x:r.x,y:r.y},{x:r.x+Xn,y:r.y},{x:r.x+Xn,y:r.y+Xn},{x:r.x,y:r.y+Xn}]},yo=()=>Co(-35,35),bo=e=>Co(0,e.faces.length-1),Co=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),No=e=>{let{rolledAreaRef:t}=e;const r=st(),n=O(),l=Qe(),a=ko(),s=S(P()),i=dt(),d=n.length<2&&!l,u=i&&B(s);return r?c("div",{className:"roll-action",children:[c("button",{onClick:()=>{a(t.current)},disabled:d||u,children:["Lancer",d&&!u&&o("span",{className:"button-subtitle",children:"(au moins 2 dés !)"})]}),u&&o(qe,{src:ie,className:"skull-symbol"})]}):null},ko=d(((e,t)=>{const{dices:r,rollCount:n,diceRolledIds:o}=e,a=(0===n?Object.keys(r):o).map((e=>r[e]));return go(a,{rolledAreaDomNode:t}),l(l({},e),{},{rollCount:n+1,witchUncursedDiceId:null,diceRolledIds:a.map((e=>e.id)),dices:l({},r)})})),xo=e=>{let{onRoundOver:t,rolledAreaRef:r}=e;return c("div",{className:"footer actions",children:[o(No,{rolledAreaRef:r}),o(So,{}),o(wo,{onRoundOver:t})]})},So=()=>{const e=gt(),t=xt(),r=ft(),n=ht(),l=e<0?"-":"+";return n?c("div",{className:"collect-action",children:[c("button",{onClick:()=>{t(e)},disabled:!r,children:[o("span",{children:"Collecter"}),c("span",{className:"score",children:[l," ",Math.abs(e)]})]}),!r&&o(qe,{src:ie,className:"skull-symbol"})]}):null},wo=e=>{let{onRoundOver:t}=e;const r=pt(),n=Ct(),l=gt(),a=dt(),s=vt(),c=rt();return r?o("div",{className:"next-round-action",children:o("button",{onClick:()=>{n(),t({reason:a?"3-skulls":s?"chalenge-failed":"user-collect",value:l,symbolsInChest:c})},children:"Terminer mon tour"})}):null},Do=new URL(__v__("/other/witch-label.png"),t.meta.url),Ro=e=>{let{cursedAreaRef:t}=e;const r=S(P());return c("div",{className:"skull-island",children:[de(r)?o(Io,{}):null,o("div",{className:"bottle",children:c("div",{className:"area",ref:t,children:[q(r)?o(Ao,{card:r}):null,T(r)?c(X,{children:[o(Ao,{card:r}),o(Ao,{card:r})]}):null]})})]})},Ao=e=>{let{card:t}=e;return o("button",{className:"dice",style:{width:Xn,height:Xn,color:"#eaeaea",margin:"1px 5px",backgroundColor:t.color1,borderColor:t.color2,borderWidth:"2px"},children:o(qe,{src:ie,style:{width:"100%",height:"100%"}})})},Io=()=>G()?c("div",{className:"witch-label",children:[o(qe,{src:Do}),c("svg",{x:"0px",y:"0px",width:"156.083px",height:"208.667px",viewBox:"0 0 156.083 208.667",children:[o("path",{id:"path_01",fill:"none",stroke:"#E4AD30",d:"M8.406,107.82 c2.541,2.178,2.375,2.875,14.25,3.5c14.782,0.778,19.26-11.965,19.26-11.965S47.918,88,40.251,72.917s-18.916,4.583-9.083,8.167 s27.759-1.338,35.142-12.417C74.75,56,77.583,45.333,79.25,37S78.477,15.833,66.31,3.833"}),o("path",{id:"path_02",fill:"none",stroke:"#E4AD30",d:"M44.031,110.094 c0,0,1,1.313-4.438,3.344s-14.244,7.281-32.125-2"}),o("path",{id:"path_03",fill:"none",stroke:"#E4AD30",d:"M42.125,103.688 c0,0,1.313,6.594-9.313,8.625S10.281,108.719,9.406,101"}),o("path",{id:"path_04",fill:"none",stroke:"#E4AD30",d:"M33.114,112.253c0,0,39.886-19.253,43.011,24.747 c0.372,0.447-0.959,1.208-2.542,1.625"})]})]}):o(qe,{style:{display:"none"},src:Do}),Oo=e=>{let{parent:t,children:r}=e;return t?K.createPortal(o(X,{children:r}),t):null},Eo=e=>{let{rotate:t,scale:r,translate:n}=e;return[...t?[`rotate(${t}deg)`]:[],...r&&1!==r?[`scale(${r})`]:[],...n?[`translate(${n})`]:[]].join("")},Mo=function(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,{trailing:o=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const l=function l(){for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];clearTimeout(t);const i=Date.now();if(r){const a=i-r;if(a<n){if(o){t=setTimeout((()=>l(...s)),n-a)}}else r=i,e(...s)}else r=i,e(...s)},a=()=>{clearTimeout(t)};return l.cancel=a,l},Lo=(e,t)=>{let{logLevel:r="warn",onGrip:n=(()=>{}),onLongGrip:o=(()=>{}),onClick:a=(()=>{}),onDrag:s=(()=>{}),onRelease:c=(()=>{}),onCancel:i=(()=>{}),longGripMs:d=300}=t;const u=ue({logLevel:r});let m,h,f=!1,p=()=>{},g=()=>{},v=()=>{};u.debug("enable drag on",e);const y=me(e,"dragstart",(e=>{e.preventDefault()})),b=me(e,"mousedown",(e=>{if(3===e.which)return void u.debug("ignore right click");R(qo(e),e);const t=Mo((e=>{I(qo(e),e)}));v=()=>t.cancel(),p=me(document,"mousemove",t),g=me(document,"mouseup",(e=>{g(),p(),O(qo(e),e)}))}),{passive:!0}),C=me(e,"touchstart",(e=>{R(jo(e),e);const t=Mo((e=>{I(jo(e),e)}));v=()=>t.cancel(),p=me(document,"touchmove",t),g=me(document,"touchend",(e=>{g(),p(),O(jo(e),e)}))}),{passive:!0}),N=me(e,"click",(e=>{f||"none"!==D||a(e)}));let k,x,S,w,D;const R=(t,r)=>{u.debug("gripping node at",t),h=!0,D="none",S=t,k=t,x=Po(e),n({x:x.x,y:x.y,event:r}),w=setTimeout(A,d)},A=()=>{f=!0,o()},I=(e,t)=>{if(k.x===e.x&&k.y===e.y)return void u.debug("no real move");k=e;const r=S.x-x.x,n=S.y-x.y,o={x:e.x-r,y:e.y-n},a=e.x-S.x,c=e.y-S.y;u.debug("move node at",o),s(l(l({event:t},o),{},{relativeX:a,relativeY:c,setDropEffect:e=>{D=e}}))},O=(e,t)=>{u.debug("releasing node"),h=!1,clearTimeout(w);const r=S.x-x.x,n=S.y-x.y;c({event:t,dropEffect:D,x:k.x-r,y:k.y-n}),m=setTimeout((()=>{f=!1}))};return e=>{y(),N(),b(),C(),p(),g(),clearTimeout(w),clearTimeout(m),v(),(e=>{h&&(u.debug("cancelling drag",e),h=!1,i({event:e}))})(e)}},Po=e=>{const t=e.getBoundingClientRect();return{x:t.left,y:t.top}},qo=e=>({x:e.pageX,y:e.pageY}),jo=e=>{const t=e.changedTouches[0];return{x:t.pageX,y:t.pageY}},({useEffect:To,useState:$o}=r),Bo=e=>{let{dice:t,diceAnimation:r,anmationDebug:n=!1,parentNode:l,zIndex:a,x:s,y:i,rotation:d,draggable:m,onDiceClick:h,onDiceDrag:f,onDiceDrop:p,onDiceDragEnd:g,disapear:v,appear:y,traceUpdate:b=!1}=e;const C=J(),N=he(t.id),k=fe(t.id),x=lt().includes(t.id),[S,w]=$o(!1),[D,R]=$o(null),A=Me(l),I=r?A:l;To((()=>{if(!m||!N||!C)return()=>{};let e=!1;const r=Lo(N,{onGrip:()=>{w(!0)},onClick:e=>{h(t,e)},onDrag:r=>{let{x:n,y:o,relativeX:l,relativeY:a,setDropEffect:s}=r;const c=gn({left:n,right:n+Xn,top:o,bottom:o+Xn},C);R({x:c.left,y:c.top}),e=e||Math.abs(l)>10||Math.abs(a)>10,e&&f(t,{relativeX:l,relativeY:a,setDropEffect:s,diceRectangle:c})},onRelease:e=>{let{dropEffect:r,x:n,y:o}=e;if("none"!==r){p(t,{diceRectangle:{left:n,right:n+Xn,top:o,bottom:o+Xn}})}w(!1),R(null),g(t)},onCancel:()=>{w(!1),R(null),g(t)}});return()=>{r()}}),[m,N,C,h,f,p,g]),To((()=>{if(!r||!N)return()=>{};const{from:e,to:t,onfinish:o}=r;n&&(Nn(e),Nn(t));const l=`translate(${Math.floor(t.x-e.x)}px, ${Math.floor(t.y-e.y)}px)`,a=N.parentNode.animate([{transform:l}],{duration:500,fill:"forwards",easing:"cubic-bezier(0, 0.55, 0.45, 1)"});return a.onfinish=o,()=>{a.cancel()}}),[N,r]);const O=M(t),E=r&&r.from?r.from.x:D?D.x:s,L=r&&r.from?r.from.y:D?D.y:i,P=D||r?1e3:a;return o(Oo,{parent:I,children:o("svg",{"data-dice-id":t.id,className:"dice",onClick:m?void 0:e=>{h(t,e)},style:{width:Xn,height:Xn,left:`${E}px`,top:`${L}px`,zIndex:P,cursor:m?S?"grabbing":"grab":void 0,position:D||r?"fixed":void 0},children:c("g",{ref:k,className:v?"dice-cursed-disapear":y?"dice-cursed-appear":"",style:{transform:Eo({rotate:d||0,scale:S?"1.1":"1"}),transitionProperty:"transform",transitionDuration:"500ms",transitionTimingFunction:"cubic-bezier(0, 0.55, 0.45, 1)",transformOrigin:"center center"},children:[o("rect",{className:"dice-background",width:"100%",height:"100%",rx:"5",ry:"5",fill:Uo(O,x).fill,stroke:Uo(O,x).stroke,strokeWidth:"1"}),o("image",{href:ee(u(t)),draggable:"false",style:{width:"100%",height:"100%"}})]})})})},Uo=(e,t)=>e?{fill:"black",stroke:"black"}:t?{fill:"none",stroke:"none"}:{fill:"#eaeaea",stroke:"#b9b9b9"},Fo=e=>{let{offscreenDomNode:t,chestDomNode:n,rolledAreaDomNode:a,cursedAreaDomNode:s,onDiceOverChestChange:c=(()=>{}),onDiceOverRolledAreaChange:i=(()=>{})}=e;const d=A(),u=I(),m=O(),h=L(),f=E(),p=pe(),g=S(P()),v=$(),y=it(),b=ot(),[C,N]=r.useReducer(((e,t)=>l(l({},e),{},{[t.key]:t.value})),{}),k=wt(),x=Ot(),w=It(),D=At(),R=Dt(),q=r.useRef(null);return Object.keys(d).map((e=>{const S=d[e],A=ol(S,{chestSlots:u,diceRolledIds:m,diceCursedIds:h}),I=ll(A,{chestDomNode:n,rolledAreaDomNode:a,cursedAreaDomNode:s,offscreenDomNode:t}),{parentNode:O}=I,E=S.id!==f&&O===a&&M(S),L=O===s,P=Yo(S,m),j=r.useCallback((e=>{const t=zo(e,{currentCard:g,witchCardEffectUsed:p,diceIsInRolledArea:P,diceIsInCursedArea:L,chestSlots:u,hasDicesToCurse:b,threeSkullsOrMore:y,scoreMarked:v});if("keep"===t){const t=el(u);x(e,t)}else"unkeep"===t?w(e):"uncurse"===t&&D(e)}),[P,L,u,v,y,g,p]),T=r.useCallback(((e,t)=>{q.current=Wo({dragDiceGesture:t,chestDomNode:n,rolledAreaDomNode:a});const r=Go(e,{diceIsInRolledArea:P,chestSlots:u,dropTargetRef:q,rolledAreaDomNode:a,chestDomNode:n,hasDicesToCurse:b,threeSkullsOrMore:y,scoreMarked:v});t.setDropEffect(r),c("keep"===r?e:null),i("unkeep"===r?e:null)}),[P,u,q,a,n,v,y,c,i]),$=r.useCallback(((e,t)=>{const r=Go(e,{diceIsInRolledArea:P,chestSlots:u,dropTargetRef:q,rolledAreaDomNode:a,chestDomNode:n,scoreMarked:v,threeSkullsOrMore:y});let o=!1,l=null;if("reposition-in-rolled-area"===r){const r=_o(t.diceRectangle,a),n=Qo(e,{dices:d,diceRolledIds:m});k(e,r,n)}else if("back-to-rolled-area"===r)o=!0,l=Jo(e.rolledAreaPosition,a);else if("keep"===r){const r=tl(e,{chestSlots:u,rectangle:t.diceRectangle,chestDomNode:n});x(e,r),o=!0,l=Vo(r,n)}else if("reposition-in-chest"===r){const r=tl(e,{chestSlots:u,rectangle:t.diceRectangle,chestDomNode:n});rl(e,u)!==r&&(R(e,r),o=!0,l=Vo(r,n))}else if("back-to-chest"===r){const t=rl(e,u);o=!0,l=Vo(t,n)}else if("unkeep"===r){const r=_o(t.diceRectangle,a);k(e,r,Qo(e,{dices:d,diceRolledIds:m})),w(e),o=!0,l=Jo(r,a)}o&&N({key:e.id,value:{from:{x:t.diceRectangle.left,y:t.diceRectangle.top},to:l,onfinish:()=>{setTimeout((()=>{N({key:e.id,value:null})}))}}})}),[P,u,q,a,n,v,y]),B=r.useCallback((()=>{c(null),i(null)}),[c,i]),U=l(l({key:S.id},I),{},{dice:S,diceAnimation:C[S.id],witchCardEffectUsed:p,disapear:E,appear:L,onDiceClick:j,onDiceDrag:T,onDiceDrop:$,onDiceDragEnd:B});return r.useMemo((()=>o(Bo,l({},U))),Object.keys(U).map((e=>U[e])))}))},zo=(e,t)=>{let{currentCard:r,witchCardEffectUsed:n,diceIsInRolledArea:o,diceIsInCursedArea:l,chestSlots:a,hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i}=t;return o?Ho(e,{hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i})?"keep":"none":Zo(e,a)?Ko(e,{threeSkullsOrMore:c,scoreMarked:i})?"unkeep":"none":l&&Xo(e,{currentCard:r,witchCardEffectUsed:n,scoreMarked:i,threeSkullsOrMore:c})?"uncurse":"none"},Go=(e,t)=>{let{diceIsInRolledArea:r,chestSlots:n,dropTargetRef:o,rolledAreaDomNode:l,chestDomNode:a,hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i}=t;return r?o.current===l?"reposition-in-rolled-area":o.current===a&&Ho(e,{hasDicesToCurse:s,threeSkullsOrMore:c,scoreMarked:i})?"keep":"back-to-rolled-area":Zo(e,n)?o.current===a?"reposition-in-chest":o.current===l&&Ko(e,{scoreMarked:i,threeSkullsOrMore:c})?"unkeep":"back-to-chest":"none"},Wo=e=>{let{dragDiceGesture:t,chestDomNode:r,rolledAreaDomNode:n}=e;if(bn(r,t.diceRectangle))return r;return bn(n,t.diceRectangle)?n:null},Yo=(e,t)=>t.includes(e.id),Zo=(e,t)=>Object.keys(t).some((r=>{const n=t[r];return n&&"dice"===n.type&&n.value===e.id})),Ho=(e,t)=>{let{hasDicesToCurse:r,threeSkullsOrMore:n,scoreMarked:o}=t;return!M(e)&&(!r&&(!n&&!o))},Ko=(e,t)=>{let{scoreMarked:r,threeSkullsOrMore:n}=t;return!r&&!n},Xo=(e,t)=>{let{currentCard:r,witchCardEffectUsed:n,scoreMarked:o,threeSkullsOrMore:l}=t;return!!de(r)&&(!n&&(!o&&!l))},Jo=(e,t)=>{const r=yn({left:e.x,top:e.y,right:0,bottom:0},t);return{x:r.left,y:r.top}},Vo=(e,t)=>{const r=nl(e,t),n=pn(r);return{x:n.left+5,y:n.top+5}},_o=(e,t)=>{const r=vn(e,t);return{x:r.left,y:r.top}},Qo=(e,t)=>{let{diceRolledIds:r,dices:n}=t;if(0===r.length)return 1;const o=r.slice(1).reduce(((e,t)=>{const r=n[t];return r.rolledAreaZIndex>e.rolledAreaZIndex?r:e}),n[r[0]]);return o===e?e.rolledAreaZIndex:o.rolledAreaZIndex+1},el=e=>Object.keys(e).find((t=>!e[t])),tl=(e,t)=>{let{chestSlots:r,rectangle:n,chestDomNode:o}=t;const l=new Map,a=[];Object.keys(r).forEach((t=>{const n=r[t];if(!n||"dice"===n.type&&n.value===e.id){const e=nl(t,o);l.set(e,t),a.push(e)}}));const s=Cn(a,n);return l.get(s)},rl=(e,t)=>Object.keys(t).find((r=>{const n=t[r];return n&&"dice"===n.type&&n.value===e.id})),nl=(e,t)=>t.querySelector(`[data-chest-slot="${e}"]`),ol=(e,t)=>{let{chestSlots:r,diceRolledIds:n,diceCursedIds:o}=t;const a=Object.keys(r).find((t=>r[t]&&"dice"===r[t].type&&r[t].value===e.id));return a?{type:"chest-slot",value:a}:n.includes(e.id)?{type:"rolled-area",value:l(l({},e.rolledAreaPosition),{},{rotation:e.rotation,zIndex:e.rolledAreaZIndex})}:o.includes(e.id)?{type:"cursed-area",value:void 0}:{type:"offscreen-area"}},ll=(e,t)=>{let{type:r,value:n}=e,{chestDomNode:o,rolledAreaDomNode:l,cursedAreaDomNode:a,offscreenDomNode:s}=t;return"chest-slot"===r?{parentNode:o.querySelector(`[data-chest-slot="${n}"]`),zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!0}:"rolled-area"===r?{parentNode:l,zIndex:n.zIndex,rotation:n.rotation,x:n.x,y:n.y,draggable:!0}:"cursed-area"===r?{parentNode:a,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}:{parentNode:s,zIndex:void 0,rotation:0,x:void 0,y:void 0,draggable:!1}},al=e=>{let{dialogIsOpen:t,closeDialog:n,headerSmallCardRef:l}=e;const a=Ve(),s=P(),i=S(s)||null,d=r.useRef(),u=r.useRef(),m=r.useRef();return o(Gr,{className:"draw-card-dialog dialog-spacing-10 dialog-spacing-fluid",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!1,children:c("div",{className:"dialog-content",children:[c("div",{className:"dialog-body",children:[c("div",{className:"dialog-label",children:[0===a.length&&!i&&"Paquet de cartes épuisé. Mélangez-le pour pouvoir piocher à nouveau !",0!==a.length&&!i&&"Piochez une carte pour le tour suivant.",i&&o("span",{className:"card-name",children:eo[i.type].name})]}),o("div",{className:"card-area",children:c("div",{style:{position:"relative"},children:[o(sl,{backCardRef:d,currentCard:i,remainingCardCount:a.length}),o(cl,{topCardRef:u,smallCardRef:m,currentCard:i})]})})]}),c("div",{className:"dialog-actions",children:[o(il,{backCardRef:d,cardDeck:a,currentCard:i}),i?o(hl,{headerSmallCardRef:l,smallCardRef:m,backCardRef:d,topCardRef:u,currentCard:i,closeDialog:n}):null]})]})})},sl=e=>{let{backCardRef:t,currentCard:r,remainingCardCount:n}=e;return c("div",{ref:t,className:"card default-card",style:{background:"none"},children:[o(qe,{src:ce,width:"150"}),r?null:o("div",{className:"remaining-cards-number",children:n})]})},cl=e=>{let{topCardRef:t,smallCardRef:r,currentCard:n}=e;return n?c(X,{children:[o("div",{className:"card current-card",ref:t,children:o("div",{className:"flip-card",children:c("div",{className:"flip-card-inner",children:[o("div",{className:"flip-card-front",children:o(qe,{className:"card default-card",src:ce})}),o("div",{className:"flip-card-back",children:o(qe,{className:"card-img",src:ae(n),width:"150",alt:n.type})})]})})}),o("div",{className:"small-card",children:o(oo,{card:n,ref:r})})]}):null},il=e=>{let{backCardRef:t,cardDeck:r,currentCard:n}=e;return n?null:0===r.length?o(ul,{backCardRef:t}):o(dl,{})},dl=()=>{const e=Tt();return o("button",{className:"button-card-main button-draw-card",onClick:e,children:"Piocher"})},ul=e=>{let{backCardRef:t}=e;const n=U(),l=Ut(),[a,s]=r.useState(!1);return r.useEffect((()=>a?(l(),n?(s(!1),()=>{}):ml({backCard:t.current,duration:1e3,onfinish:()=>{s(!1)}})):()=>{}),[a]),o("button",{className:"button-card-main button-shuffle-deck",onClick:()=>{s(!0)},children:"Mélanger"})},ml=e=>{let{backCard:t,duration:r,onfinish:n}=e;t.setAttribute("shaking-deck","");const o=setTimeout((()=>{t.removeAttribute("shaking-deck",""),n()}),r);return()=>{t.removeAttribute("shaking-deck",""),clearTimeout(o)}},hl=e=>{let{headerSmallCardRef:t,smallCardRef:n,backCardRef:l,topCardRef:a}=e;const s=U(),c=Nt(),[i,d]=r.useState(!1);return r.useEffect((()=>i?s?(c(),()=>{}):fl({headerSmallCard:t.current,smallCard:n.current,backCard:l.current,topCard:a.current,duration:500,onfinish:()=>{c()}}):()=>{}),[i]),o("button",{className:"button-card-main button-activate-card",onClick:()=>{i||d(!0)},children:"Commencer"})},fl=e=>{let{headerSmallCard:t,topCard:r,backCard:n,smallCard:o,duration:l,onfinish:a}=e;n.style.opacity=0;const s=pn(t),c=r.animate([{transform:"scale(1)",opacity:1},{transform:"scale(0)",opacity:0}],{duration:l,fill:"forwards"}),i=o.animate([{transform:"scale(0)",opacity:0,position:"fixed",top:`${s.top}.px`,left:`${s.left}.px`},{transform:"scale(1)",opacity:1,position:"fixed",top:`${s.top}.px`,left:`${s.left}.px`}],{duration:l,fill:"forwards"});return i.onfinish=a,()=>{c.cancel(),i.cancel()}},pl=e=>{let{openScoreboard:t,onRoundStart:n,onRoundOver:l}=e;const a=G(),[s,i]=r.useState(!1);r.useEffect((()=>{n()}),[]);const[d,u]=Yt(),[m,h]=Yt(),f=r.useRef();return c("div",{className:"round-container",children:[o(Ft,{}),o(io,{openScoreboard:t,headerSmallCardRef:f}),a?o(gl,{diceOverRolledAreaListener:d,diceOverChestListener:m,openScoreboard:t,onRoundOver:l,onRoundMounted:e=>{i(e)}}):null,s?o(Fo,{offscreenDomNode:s.offscreenDomNode,chestDomNode:s.chestDomNode,rolledAreaDomNode:s.rolledAreaDomNode,cursedAreaDomNode:s.cursedAreaDomNode,onDiceOverChestChange:h,onDiceOverRolledAreaChange:u}):null,o(al,{dialogIsOpen:!a,headerSmallCardRef:f})]})},gl=e=>{let{diceOverRolledAreaListener:t,diceOverChestListener:n,onRoundMounted:l,onRoundOver:a}=e;const s=r.useRef(null),i=r.useRef(null),d=r.useRef(null),u=r.useRef(null);return r.useEffect((()=>{l({rolledAreaDomNode:s.current,chestDomNode:i.current,cursedAreaDomNode:d.current,offscreenDomNode:u.current})}),[]),c(X,{children:[o(Mt,{}),c("div",{className:"chest-and-skulls",children:[o(Vn,{chestRef:i,diceOverChestListener:n}),o(Ro,{cursedAreaRef:d})]}),o(Ht,{rolledAreaRef:s,offscreenRef:u,diceOverRolledAreaListener:t}),o(xo,{onRoundOver:a,rolledAreaRef:s})]})},vl=e=>{let{closeDialog:t,dialogIsOpen:r,player:n}=e;const l=bt();return o(Gr,{className:"score-board-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:r,onRequestClose:t,requestCloseOnClickOutside:!0,children:c("div",{className:"dialog-content",children:[o("div",{className:"dialog-close",onClick:t,children:o(Hr,{})}),c("div",{className:"dialog-body",children:[c("div",{children:["Au tour de",o("div",{className:"dialog-label",children:n.character.name}),o(qe,{className:"player-img",src:n&&n.character.img,alt:"player",width:"40",height:"40",style:{boxShadow:`inset 0px 0px 0px 4px ${n&&n.character.color||"black"}`}})]}),o("div",{className:"dialog-actions",children:o("button",{onClick:()=>{t(),l(n)},children:"Jouer"})})]})]})})},yl=new URL(__v__("/other/win-treasure.png"),t.meta.url),bl=new URL(__v__("/other/boat.png"),t.meta.url),Cl=6e3,Nl={path1:"M39.582,739.564c0-91.824,39.191-96.32,38.045-166.691s-30.042-70.37-47.326-161.729s38.128-86.388,31.276-186.42C55.405,134.602-3.014,89.176,8.812,129.825c5.333,18.333,30.77-21,30.77-129.825",path2:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0",path3:"M39.582,739.564c0-71.926-15.437-155.074-17.437-253.074s30-185,31.087-217s-31.087-46-31.087-26s33,10,31-32s-31-110-31-144S39.582,0,39.582,0",path4:"M39.582,739.564c0-113.074-5.437-166.074-8.437-198.074s36-20.667,33.019-2c-1.796,11.248-24.583,13.333-23.699-22c1.229-49.158,22.68-111,23.68-169s-38-95-46-181S39.582,0,39.582,0"},kl=e=>{let{openedByUser:t,closeScoreboard:n,playerAnimation:l}=e;const a=x(),s=_e(),i=ge(),[d,u]=r.useState(!1),m=()=>{u(!0)},h=xl();return c("div",{className:"score-board-container",children:[t&&o("div",{className:"cross",onClick:n,children:"X"}),!i&&!s&&o("div",{className:"action-container",children:o("button",{className:"score-board-action",onClick:()=>{m()},children:"Commencer à jouer"})}),o(qe,{className:"win-treasure-img",src:yl,alt:"win-treasure",width:"230",height:"150"}),o("div",{className:"users-path",children:a.map((e=>o(Sl,{player:e,openedByUser:t,pathCoordinates:Nl[`path${e.id}`],score:e.score,character:e.character,openStartPlayerRoundDialog:m,isCurrentPlayer:s&&e.id===s.id,playerAnimation:l},e.id)))}),o(vl,{dialogIsOpen:d,closeDialog:()=>{u(!1)},player:h})]})},xl=()=>{const e=_e(),t=x();let r;if(e){const n=t.findIndex((t=>t.id===e.id));r=n===t.length-1?t[0]:t[n+1]}else r=t[0];return r},Sl=e=>{let{pathCoordinates:t,player:n,openedByUser:l,character:a,score:s,openStartPlayerRoundDialog:i,playerAnimation:d}=e;const u=r.useRef(null),m=r.useRef(null),h=r.useRef(null),f=r.useRef(null),p=xl(),[g,v]=r.useState(null),[y,b]=r.useState([]),[C,N]=r.useState(!1);return r.useEffect((()=>{d&&d.player===n?"user-collect"===d.roundOverReason?(v(d.score),b(d.symbolsInChest)):"3-skulls"===d.roundOverReason?N(!0):"chalenge-failed"===d.roundOverReason&&v(d.score):v(null)}),[d,n]),r.useEffect((()=>{if(!g)return;const{from:e,to:t}=g,r=m.current.animate([{offsetDistance:wl(e/Cl)},{offsetDistance:wl(t/Cl)}],{duration:1e3,fill:"forwards"}),n=f.current;let o=null;n&&(o=n.animate([{offsetDistance:wl(e/Cl)},{offsetDistance:wl(t/Cl)}],{duration:1e3,fill:"forwards"}));const l=u.current,a=l.getTotalLength();console.log("from",e),console.log("to",t);const s=l.animate([{strokeDashoffset:Dl(e/Cl,a)},{strokeDashoffset:Dl(t/Cl,a)}],{duration:1e3,fill:"forwards"});return s.onfinish=()=>{"finished"===r.playState&&v(null)},r.onfinish=()=>{"finished"===s.playState&&v(null)},()=>{s.cancel(),r.cancel(),o&&o.cancel()}}),[g]),r.useEffect((()=>{const e=u.current,t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=Dl(s/Cl,t)}),[s]),c("div",{className:"user-path",children:[c("svg",{viewBox:"0 0 79.164 739.564",width:"50",height:"450",fill:"none",stroke:"none",children:[o("path",{d:t,className:"path-background"}),o("path",{ref:u,d:t,className:"path-foreground"}),c("g",{className:"score-indicator",children:[o("image",{ref:m,href:bl,width:"26",height:"26",className:"boat",style:{offsetPath:`path('${t}')`,offsetDistance:wl(s/Cl)}}),y&&y.length>0&&o("g",{className:"animation-symbols",ref:f,style:{offsetPath:`path('${t}')`,offsetDistance:wl(s/Cl)},children:y.map(((e,t)=>o("image",{width:"30",height:"30",className:`symbol symbol-${t+1}`,href:ee(e)},t)))})]})]}),o("div",{className:"speech-bubble",children:s}),c("div",{className:"user-avatar "+(p.character.id!==a.id||l?"":"next-player"),onClick:()=>{p.character.id!==a.id||l||i()},children:[C&&o("div",{className:"animation-3skulls",ref:h,children:o(Rl,{})}),o(Al,{character:a})]})]})},wl=e=>100*e+"%",Dl=(e,t)=>t-e*t,Rl=()=>new Array(3).fill("").map(((e,t)=>o(qe,{width:"30",height:"30",className:`skull skull-${t+1}`,src:ie,animateLoaded:!1},t))),Al=e=>{let{character:t}=e;return o(qe,{className:"player-img",src:t.img,alt:"player",width:"40",height:"40",style:{boxShadow:`inset 0px 0px 0px 4px ${t.color||"black"}`}})},Il=()=>{const e=Ol();return c("div",{className:"game-configuration",children:[o("div",{className:"background-image"}),c("div",{className:"content",children:[o("div",{className:"title",children:"A l’abordage !"}),o("div",{className:"subtitle",children:"Combien de joueurs participent à l’aventure ?"}),o("div",{className:"buttons",children:[1,2,3,4,5].map((t=>o("button",{onClick:()=>{e(t)},children:t},t)))})]})]})},Ol=d(((e,t)=>l(l({},e),{},{players:new Array(t).fill("").map(((e,t)=>({id:t+1,number:t+1,score:0})))}))),El=String(new URL(__v__("/other/Luffy.png"),t.meta.url)),Ml=String(new URL(__v__("/other/miss_fortune.png"),t.meta.url)),Ll=String(new URL(__v__("/other/JackSparrow.png"),t.meta.url)),Pl=String(new URL(__v__("/other/BarbeRouge.png"),t.meta.url)),ql=String(new URL(__v__("/other/GinetteBoulette.png"),t.meta.url)),jl=String(new URL(__v__("/other/CapitaineCrochet.png"),t.meta.url)),Tl=[{id:1,name:"Luffy",color:"#ef9620",img:El},{id:2,name:"Miss Fortune",color:"#d90f1b",img:Ml},{id:3,name:"Jack Sparrow",color:"#007033",img:Ll},{id:4,name:"Barbe Rouge",color:"#7baac9",img:Pl},{id:5,name:"Ginette Boulette",color:"#e2500c",img:ql},{id:6,name:"Capitaine Crochet",color:"#952460",img:jl}],$l=e=>{let{players:t}=e;const n=zl(),l=Ul(),a=t.find((e=>!e.character));return Gl(),r.useEffect((()=>{Gl()}),[]),c("div",{className:"character-selection-page",children:[o(Bl,{}),a&&c(X,{children:[c("p",{children:["Joueur ",a.number," : quel pirate êtes vous ?"]}),c("div",{className:"characters-container",id:"menu-wrapper",children:[o("div",{className:"characters menu",children:Tl.map((e=>c("div",{className:"character item "+(Fl(e,t)?"":"disabled"),onClick:r=>{Fl(e,t)&&(r.target.animate([{transform:"scale(1)"},{transform:"scale(1.3)"},{transform:"scale(1)"}],{duration:400,fill:"forwards"}),n(a,e))},children:[o(qe,{className:"character-img",width:"40",height:"40",src:e&&e.img,alt:"player",style:{border:`4px solid ${e&&e.color||"black"}`}}),o("span",{children:e.name})]},e.id)))}),c("div",{className:"paddles",children:[o("button",{className:"left-paddle paddle hidden",children:"<"}),o("button",{className:"right-paddle paddle",onClick:()=>{Gl()},children:">"})]})]})]}),!a&&c("div",{className:"crew-completed",children:[o("p",{children:"L’équipage est au complet !"}),o(qe,{style:{opacity:.5},src:se({type:ve})}),o("button",{onClick:()=>{l()},children:"Démarrer la partie"})]})]})},Bl=()=>{const e=x();return c("div",{className:"crew "+(e.length>3?"large-crew":""),children:[o("div",{className:"title",children:"Votre equipage:"}),o("ul",{children:e.map((e=>c("li",{children:[e.character?o(qe,{className:"crew-member-img",width:"40px",height:"40px",src:e.character&&e.character.img,alt:"player",style:{border:`4px solid ${e.character&&e.character.color||"black"}`},loadWhenIntersecting:!1}):o("div",{className:"placeholder-img"}),o("span",{children:e.character?e.character.name:`Joueur${e.number}`})]},e.id)))})]})},Ul=d((e=>{const{cardIds:t}=e;return l(l({},e),{},{gameStarted:!0,cardIds:z(t)})})),Fl=(e,t)=>!t.some((t=>t.character&&t.character.name===e.name)),zl=d(((e,t,r)=>{const{players:n}=e;return t.character=r,l(l({},e),{},{players:[...n]})})),Gl=()=>{var e=document.getElementsByClassName("item").length,t=function(){return document.getElementById("menu-wrapper")?document.getElementById("menu-wrapper").offsetWidth:null},r=t(),n=123*e;window.onresize=()=>{r=t()};var o=n-r,l=document.querySelector(".left-paddle"),a=document.querySelector(".right-paddle");document.querySelector(".menu")&&(document.querySelector(".menu").onscroll=()=>{o=n-r;var e=document.querySelector(".menu").scrollLeft,t=o;e<=0?(l.classList.add("hidden"),a.classList.remove("hidden")):e<t?(l.classList.remove("hidden"),a.classList.remove("hidden")):e>=t&&(l.classList.remove("hidden"),a.classList.add("hidden"))}),a&&(a.onclick=()=>{if(document.querySelector(".menu")){const e=document.querySelector(".menu").scrollLeft,t=e+r;Kt({duration:300,onProgress:r=>{let{progress:n}=r;document.querySelector(".menu").scrollLeft=e+(t-e)*n}})}}),l&&(l.onclick=()=>{if(document.querySelector(".menu")){const e=document.querySelector(".menu").scrollLeft,t=e-r;Kt({duration:300,onProgress:r=>{let{progress:n}=r;document.querySelector(".menu").scrollLeft=e+(t-e)*n}})}})},Wl=e=>{let{playerAnimationListener:t}=e;const n=x(),l=k(),a=ge(),s=Yl(),c=Zl(),[i,d]=r.useState(!1),[u,m]=r.useState(null),[h,f]=r.useState(null),p=!a||i,g=n.find((e=>e.id===l)),v=r.useRef(null);return r.useEffect((()=>{f(u?{player:g,score:{from:v.current,to:g.score},roundOverReason:u.reason,symbolsInChest:u.symbolsInChest}:null)}),[u,l]),r.useEffect((()=>{if(t)return t(f)}),[t]),s?o(Il,{}):c?o($l,{players:n}):p?o(kl,{openedByUser:i,closeScoreboard:()=>{d(!1)},playerAnimation:h}):o(pl,{openScoreboard:()=>{d(!0)},onRoundStart:()=>{v.current=g.score,m(null)},onRoundOver:e=>{m(e)}})},Yl=()=>0===x().length,Zl=()=>!ye(),Hl=d((e=>l(l({},e),{},{animationsDisabled:!0}))),Kl=d((e=>l(l({},e),{},{animationsDisabled:!1}))),Xl=d((e=>l(l({},e),{},{soundDisabled:!0}))),Jl=d((e=>l(l({},e),{},{soundDisabled:!1}))),Vl=d((()=>be)),_l=()=>[Ql(),ea()],Ql=()=>{const[e,t]=r.useState();return r.useEffect((()=>Ce.listenAvailabilityChange((()=>{t(Ce.isAvailable())}))),[]),e},ea=()=>r.useCallback(Ce.prompt),ta=e=>{let{settingsDialogIsOpen:t}=e;return Ne?o(ra,{settingsDialogIsOpen:t}):null},ra=e=>{let{checkOnOpen:t=!0,settingsDialogIsOpen:n}=e;const[l,a]=r.useState(Ne.getUpdate());return r.useEffect((()=>Ne.listenUpdateChange((e=>{a(e)}))),[]),r.useEffect((()=>{t&&n&&Ne.checkForUpdate()}),[t,n]),c("fieldset",{style:{minHeight:"4em"},children:[o("legend",{children:"Mise a jour"}),o(l?na:oa,{})]})},na=()=>{const e=Ne.getUpdate(),[t,n]=r.useState(""),l=r.useCallback(fa((function(){return n("updating"),function(e,t){if(!t)return e&&e.then?e.then(pa):Promise.resolve()}(e.activate({onActivating:()=>n("activating"),onActivated:()=>n("activated"),onBecomesNavigatorController:()=>n("")}))})),[]);return c(X,{children:[c("p",{children:[""===t?"Mise a jour prête":null,"updating"===t||"activating"===t?"Mise a jour...":null,"activated"===t&&e.navigatorWillReload?"Mise a jour activée, la page va se recharger":null,"activated"===t&&!e.navigatorWillReload&&e.shouldBecomeNavigatorController?"Mise a jour activée, recharger la page pour installer":null,"activated"!==t||e.navigatorWillReload||e.shouldBecomeNavigatorController?null:"Mise a jour activée"]}),o("button",{disabled:Boolean(t),onClick:l,children:e.navigatorWillReload?"Recharger pour mettre a jour":"Mettre a jour"})]})},oa=()=>{const[e,t]=r.useState(""),n=r.useCallback(fa((function(){return t("fetching"),function(e){if(e&&e.then)return e.then(pa)}(ha((function(){return ma(Ne.checkForUpdate(),(function(e){e||t("notfound")}))}),(function(e){t("failed"),console.error(e)})))})),[]);return c(X,{children:[c("p",{children:["fetching"===e?"Recherche de mise a jour...":null,"notfound"===e?"Pas de mise a jour disponible.":null,"failed"===e?"Une erreur est survenue.":null]}),o("button",{disabled:"fetching"===e,onClick:n,children:"Chercher"})]})},la=new URL(__v__("/css/settings.css"),t.meta.url),aa=()=>{const[e,t,r]=Wr();return c(X,{children:[o(er,{href:la}),o("div",{id:"settings",onClick:()=>{t()},children:o("svg",{className:"settings-icon",width:"24px",height:"24px",viewBox:"0 0 24 24",children:o("path",{fill:"currentColor",d:"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"})})}),o(sa,{settingsDialogIsOpen:e,closeSettingsDialog:r})]})},sa=e=>{let{settingsDialogIsOpen:t,closeSettingsDialog:n}=e;const l=U(),a=Hl(),s=Kl(),i=ke(),d=Xl(),u=Jl(),m=Vl(),[h,f]=r.useState(!1),p=()=>{f(!0)};return o(Gr,{className:"settings-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:n,requestCloseOnClickOutside:!0,children:c("div",{className:"settings-dialog-content",children:[o("div",{className:"dialog-close",onClick:n,children:o(Hr,{})}),o("div",{className:"dialog-simple-title",children:"Settings"}),o("div",{className:"setting-element",children:c("label",{children:[o("input",{type:"checkbox",className:l?"checked":"unchecked",checked:l,onChange:e=>{e.target.checked?a():s()}}),l&&o(ia,{}),"Désactiver les animations"]})}),o("div",{className:"setting-element",children:c("label",{children:[o("input",{type:"checkbox",className:i?"checked":"unchecked",checked:i,onChange:e=>{e.target.checked?d():u()}}),i&&o(ia,{}),"Couper le son"]})}),o("div",{className:"setting-element",children:o("button",{onClick:()=>{p()},children:"Annuler la partie"})}),o(ca,{}),o(ta,{settingsDialogIsOpen:t}),o(da,{confirmCancelGameDialogIsOpen:h,closeConfirmCancelGameDialog:()=>{f(!1)},performCancelGame:()=>{m(),n()}})]})})},ca=()=>{const[e,t]=_l();return e?o("button",{onClick:()=>{t()},children:"Installer application"}):null},ia=()=>o("svg",{className:"check-icon",width:"20",height:"20",viewBox:"0 0 512 512",children:o("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})}),da=e=>{let{confirmCancelGameDialogIsOpen:t,closeConfirmCancelGameDialog:r,performCancelGame:n}=e;return o(Gr,{className:"confirm-cancel-game-dialog dialog-spacing-10 dialog-spacing-fluid dialog-spacing-left-fixed dialog-spacing-right-fixed",isOpen:t,onRequestClose:r,requestCloseOnClickOutside:!0,children:c("div",{className:"settings-dialog-content",children:[o("div",{className:"dialog-close",onClick:r,children:o(Hr,{})}),c("div",{className:"title-container",children:[o(qe,{className:"illustration",src:xe,width:"40",height:"40"}),o("div",{className:"title",children:"Êtes-vous certain de vouloir annuler la partie ?"})]}),o("div",{className:"content",children:"Cette action irréversible effacera la progression actuelle et remettra la partie à zéro !"}),o("div",{className:"confirm-action",children:o("button",{onClick:()=>{n(),r()},children:"Confirmer"})})]})})},e("App",(e=>c("div",{id:"main",ref:Se(),children:[o(aa,{}),o(ua,l({},e))]}))),ua=e=>{const t=we();return o(t?Wl:Ue,l({},e))}}}}));